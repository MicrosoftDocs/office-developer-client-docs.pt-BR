---
title: 'Problemas conhecidos no desenvolvimento do Excel XLL '
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
keywords:
- problemas conhecidos [excel 2007]
localization_priority: Normal
ms.assetid: 3dfecc0b-a91c-448e-8721-5d3486b625fa
description: 'Aplica-se a: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: 34784f6895386efe7e6c3ca7ec213c7d71931058
ms.sourcegitcommit: f139451a43598b59da22775333779df691df460a
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/27/2018
ms.locfileid: "26685176"
---
# <a name="known-issues-in-excel-xll-development"></a><span data-ttu-id="4511a-104">Problemas conhecidos no desenvolvimento do Excel XLL </span><span class="sxs-lookup"><span data-stu-id="4511a-104">For more information, see Known Issues in Excel XLL Development.</span></span>

 <span data-ttu-id="4511a-105">**Aplica-se a**: Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="4511a-105">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="4511a-106">Este tópico descreve problemas conhecidos no Microsoft Excel que podem ocorrer no desenvolvimento XLL.</span><span class="sxs-lookup"><span data-stu-id="4511a-106">This topic describes known issues in Microsoft Excel that you might encounter in XLL development.</span></span>
  
## <a name="unregistering-xll-commands-and-functions"></a><span data-ttu-id="4511a-107">Removendo o registro de comandos e funções do XLL</span><span class="sxs-lookup"><span data-stu-id="4511a-107">Unregistering XLL Commands and Functions</span></span>

<span data-ttu-id="4511a-108">Quando um XLL registra uma função ou comando, o Excel cria um novo nome para o recurso e associa uma referência para a função DLL com esse nome.</span><span class="sxs-lookup"><span data-stu-id="4511a-108">When an XLL registers a function or command, Excel creates a new name for the resource and associates a reference to the DLL function with that name.</span></span> <span data-ttu-id="4511a-109">O nome é retirado do quarto argumento *pxFunctionText* , da função [xlfRegister](xlfregister-form-1.md).</span><span class="sxs-lookup"><span data-stu-id="4511a-109">The name is taken from the fourth argument,  *pxFunctionText*  , of the [xlfRegister](xlfregister-form-1.md) function.</span></span> <span data-ttu-id="4511a-110">Esse nome estará oculto de caixas de diálogo normais para gerenciar nomes de planilha.</span><span class="sxs-lookup"><span data-stu-id="4511a-110">This name is hidden from the normal dialog boxes for managing worksheet names.</span></span> <span data-ttu-id="4511a-111">Para cancelar o registro de uma função ou comando, você deve excluir o nome usando a função [xlfSetName](xlfsetname.md), passando o nome, mas não passando uma definição.</span><span class="sxs-lookup"><span data-stu-id="4511a-111">To unregister a function or command, you must delete the name by using the [xlfSetName](xlfsetname.md) function, passing the name but not passing a definition.</span></span> <span data-ttu-id="4511a-112">No entanto, um bug impede que isso remova o nome das listas de Assistente de função.</span><span class="sxs-lookup"><span data-stu-id="4511a-112">However, a bug prevents this from removing the name from the Function Wizard lists.</span></span> 
  
## <a name="argument-description-string-truncation-in-the-function-wizard"></a><span data-ttu-id="4511a-113">Truncamento de cadeia de caracteres de descrição do argumento no Assistente de função</span><span class="sxs-lookup"><span data-stu-id="4511a-113">Argument Description String Truncation in the Function Wizard</span></span>

<span data-ttu-id="4511a-114">O parâmetro*pxArgumentHelp1* e todos os parâmetros subsequentes da função **xlfRegister** são cadeias de caracteres opcionais que correspondem aos argumentos da função XLL.</span><span class="sxs-lookup"><span data-stu-id="4511a-114">The  *pxArgumentHelp1*  parameter and all subsequent parameters of the **xlfRegister** function are optional strings that correspond to the arguments of the XLL function.</span></span> <span data-ttu-id="4511a-115">O Assistente de função exibe essas informações para fornecer ajuda na caixa de diálogo de construção do argumento.</span><span class="sxs-lookup"><span data-stu-id="4511a-115">The Function Wizard displays these to provide help in the argument construction dialog box.</span></span> <span data-ttu-id="4511a-116">Às vezes, o Excel trunca a cadeia de caracteres que corresponde ao argumento final por um ou dois caracteres ao exibi-lo na caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="4511a-116">Sometimes Excel truncates the string that corresponds to the final argument by one or two characters when displaying it in the dialog box.</span></span> <span data-ttu-id="4511a-117">Para evitar isso adicione uma "cadeia de caracteres vazia" adicional como o último parâmetro "ajuda de argumento" do seu registro de função.</span><span class="sxs-lookup"><span data-stu-id="4511a-117">You can avoid this by adding an additional "empty string" as the last "argument help" parameter of your function registration.</span></span>
  
## <a name="binary-name-scope-limitation"></a><span data-ttu-id="4511a-118">Limitação de escopo de nome binário</span><span class="sxs-lookup"><span data-stu-id="4511a-118">Binary Name Scope Limitation</span></span>

<span data-ttu-id="4511a-119">Nomes binários e seus dados podem ser recuperados somente quando a planilha que estava ativa no momento em que eles foram criados estiver ativa novamente.</span><span class="sxs-lookup"><span data-stu-id="4511a-119">Binary names and their data can be retrieved only when the worksheet that was active at the time they were created is again active.</span></span> <span data-ttu-id="4511a-120">Como as funções de planilha não podem ativar planilhas em uma pasta de trabalho (somente comandos podem fazer isso), aplicativos de nomes binários são muito limitados.</span><span class="sxs-lookup"><span data-stu-id="4511a-120">Because worksheet functions cannot activate worksheets within a workbook (only commands can do this), applications of binary names are very limited.</span></span> <span data-ttu-id="4511a-121">Por exemplo, se você tiver um comando que é chamado somente de uma determinada planilha, você poderá usar um nome binário para armazenar dados relacionadas ao comando.</span><span class="sxs-lookup"><span data-stu-id="4511a-121">If you have a command that is only invoked from a particular worksheet, for example, you could use a binary name to store command-related data.</span></span>
  
## <a name="xlset-and-workbooks-with-array-formulas"></a><span data-ttu-id="4511a-122">xlSet e Workbooks com fórmulas de matriz</span><span class="sxs-lookup"><span data-stu-id="4511a-122">xlSet and Workbooks with Array Formulas</span></span>

<span data-ttu-id="4511a-123">No Excel 2003 e em versões anteriores, a [função xlSet ](xlset.md)falha se você tentar atribuir valores a um intervalo em uma planilha que não seja a planilha ativa, em que o intervalo equivalente na planilha ativa contém uma fórmula de matriz.</span><span class="sxs-lookup"><span data-stu-id="4511a-123">In Excel 2003 and earlier versions, the [xlSet function](xlset.md) fails if you try to assign values to a range on a worksheet that is not the active worksheet, where the equivalent range on the active sheet contains an array formula.</span></span> <span data-ttu-id="4511a-124">Nesse caso, o Excel exibirá a mensagem "Não é possível alterar parte de uma matriz."</span><span class="sxs-lookup"><span data-stu-id="4511a-124">In this case, Excel displays the message "You cannot change part of an array."</span></span> <span data-ttu-id="4511a-125">Esse problema foi corrigido no Excel 2007.</span><span class="sxs-lookup"><span data-stu-id="4511a-125">This feature was deprecated in Microsoft Office Excel 2007.</span></span> 
  
## <a name="circular-references-are-tolerated-in-data-tables"></a><span data-ttu-id="4511a-126">Referências circulares são toleradas nas tabelas de dados</span><span class="sxs-lookup"><span data-stu-id="4511a-126">Circular References are Tolerated in Data Tables</span></span>

<span data-ttu-id="4511a-127">O Excel no momento não gera um erro se o cálculo no qual uma tabela de dados é baseada refere-se a algo na própria tabela.</span><span class="sxs-lookup"><span data-stu-id="4511a-127">Excel currently does not raise an error if the calculation that a data table is based on refers to something in the table itself.</span></span> <span data-ttu-id="4511a-128">Por mais improvável que esse cenário seja, você deve ter cuidado ao criar ou modificar fórmulas usadas para calcular valores de tabela de dados.</span><span class="sxs-lookup"><span data-stu-id="4511a-128">As unlikely as this scenario might be, you should be careful when you are creating or modifying formulas that are used to calculate data table values.</span></span>
  
## <a name="converting-an-integer-xloper12-to-an-xloper"></a><span data-ttu-id="4511a-129">Converter um número inteiro XLOPER12 em XLOPER</span><span class="sxs-lookup"><span data-stu-id="4511a-129">Converting an Integer XLOPER12 to an XLOPER</span></span>

<span data-ttu-id="4511a-130">Como o tipo inteiro **xltypeInt** é um inteiro assinado de 32 bits no tipo de dados **XLOPER12**, mas é apenas um inteiro assinado de 16 bits no tipo de dados **XLOPER**, é possível que alguns valores inteiros **XLOPER12** não possam estar contidos em um inteiro **XLOPER**.</span><span class="sxs-lookup"><span data-stu-id="4511a-130">Because the integer type **xltypeInt** is a 32-bit signed integer in the **XLOPER12** data type, but it is only a 16-bit signed integer in the **XLOPER** data type, it is possible that some integer **XLOPER12** values cannot be contained in an integer **XLOPER**.</span></span> <span data-ttu-id="4511a-131">Onde o Excel converte internamente esse tipo, a alternativa para esse problema é converter o tipo em um ponto flutuante **xltypeNum** **XLOPER**.</span><span class="sxs-lookup"><span data-stu-id="4511a-131">Where Excel converts this type internally, it gets around this problem by converting the type to a floating-point **xltypeNum** **XLOPER**.</span></span>
  
<span data-ttu-id="4511a-132">A estrutura da função [XLOper12ToXLOper](xloper12toxloper.md) espelha esse comportamento para ser consistente com o Excel internamente.</span><span class="sxs-lookup"><span data-stu-id="4511a-132">The Framework [XLOper12ToXLOper](xloper12toxloper.md) function mirrors this behavior to be consistent with Excel internally.</span></span> <span data-ttu-id="4511a-133">Ao ligar para essa função, você não deve considerar que o **XLOPER** fornecido sempre será **xltypeInt**; leitura **my_xloper.val.w** retornará um valor falso se o **my_xloper** tipo for **xltypeNum**.</span><span class="sxs-lookup"><span data-stu-id="4511a-133">When you call this function, you should not assume that the returned **XLOPER** will always be **xltypeInt**; reading **my_xloper.val.w** gives a false value if the **my_xloper** type is **xltypeNum**.</span></span>
  
## <a name="returning-xloper-or-xloper12-by-modifying-arguments-in-place"></a><span data-ttu-id="4511a-134">Retornar XLOPER ou XLOPER12 modificando argumentos in-loco</span><span class="sxs-lookup"><span data-stu-id="4511a-134">Returning XLOPER or XLOPER12 by Modifying Arguments in Place</span></span>

<span data-ttu-id="4511a-135">Excel permite o registro de funções que retornam um **XLOPER** ou **XLOPER12** modificando um argumento no local.</span><span class="sxs-lookup"><span data-stu-id="4511a-135">Excel permits the registration of functions that return an **XLOPER** or **XLOPER12** by modifying an argument in place.</span></span> <span data-ttu-id="4511a-136">No entanto, se um argumento **XLOPER**/ **XLOPER12** aponta para a memória, e o ponteiro do mouse for substituído pelo valor de retorno da função DLL, o Excel pode estender a memória.</span><span class="sxs-lookup"><span data-stu-id="4511a-136">However, if an **XLOPER**/ **XLOPER12** argument points to memory, and the pointer is then overwritten by the return value of the DLL function, Excel can leak memory.</span></span> <span data-ttu-id="4511a-137">O Excel não exibe um erro, mas ele pode falhar.</span><span class="sxs-lookup"><span data-stu-id="4511a-137">Excel does not display an error, but it might eventually crash.</span></span> <span data-ttu-id="4511a-138">Além disso, se O DLL alocar memória para o valor de retorno, o Excel pode tentar liberar essa memória, o que pode causar uma falha do aplicativo imediatamente.</span><span class="sxs-lookup"><span data-stu-id="4511a-138">Also, if the DLL allocated memory for the return value, Excel might try to free that memory, which could cause an immediate application crash.</span></span> <span data-ttu-id="4511a-139">Portanto, não modifique os argumentos **XLOPER**/ **XLOPER12** no local.</span><span class="sxs-lookup"><span data-stu-id="4511a-139">Therefore, you should not modify **XLOPER**/ **XLOPER12** arguments in place.</span></span> <span data-ttu-id="4511a-140">Todos os argumentos **XLOPER** ou **XLOPER12** devem ser tratados estritamente como somente leitura.</span><span class="sxs-lookup"><span data-stu-id="4511a-140">All **XLOPER** or **XLOPER12** arguments should be treated as strictly read-only.</span></span> 
  
<span data-ttu-id="4511a-141">Para saber mais, consulte [Gerenciamento de Memória no Excel](memory-management-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="4511a-141">For more information, see [Memory Management in Excel](memory-management-in-excel.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="4511a-142">Confira também</span><span class="sxs-lookup"><span data-stu-id="4511a-142">See also</span></span>



[<span data-ttu-id="4511a-143">XLOper12ToXLOper</span><span class="sxs-lookup"><span data-stu-id="4511a-143">XLOper12ToXLOper</span></span>](xloper12toxloper.md)


[<span data-ttu-id="4511a-144">Desenvolvimento de XLLs do Excel</span><span class="sxs-lookup"><span data-stu-id="4511a-144">Developing Excel XLLs</span></span>](developing-excel-xlls.md)
  
[<span data-ttu-id="4511a-145">Excel XLL SDK API Function Reference</span><span class="sxs-lookup"><span data-stu-id="4511a-145">Excel XLL SDK API Function Reference</span></span>](excel-xll-sdk-api-function-reference.md)
  
[<span data-ttu-id="4511a-146">Gerenciamento de Memória no Excel</span><span class="sxs-lookup"><span data-stu-id="4511a-146">Memory Management in Excel</span></span>](memory-management-in-excel.md)

