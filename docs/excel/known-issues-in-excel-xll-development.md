---
title: Problemas conhecidos no desenvolvimento de XLL do Excel
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
keywords:
- problemas conhecidos [excel 2007]
localization_priority: Normal
ms.assetid: 3dfecc0b-a91c-448e-8721-5d3486b625fa
description: 'Aplica-se a: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: 9cdbb10ea68723bd7e1cd9289e8592a7cc087c46
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19765379"
---
# <a name="known-issues-in-excel-xll-development"></a><span data-ttu-id="a1ef0-104">Problemas conhecidos no desenvolvimento de XLL do Excel</span><span class="sxs-lookup"><span data-stu-id="a1ef0-104">Known Issues in Excel XLL Development</span></span>

 <span data-ttu-id="a1ef0-105">**Aplica-se a**: Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="a1ef0-105">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="a1ef0-106">Este tópico descreve os problemas conhecidos do Microsoft Excel que podem ser encontrados no desenvolvimento de XLL.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-106">This topic describes known issues in Microsoft Excel that you might encounter in XLL development.</span></span>
  
## <a name="unregistering-xll-commands-and-functions"></a><span data-ttu-id="a1ef0-107">Cancelando o registro dos comandos XLL e funções</span><span class="sxs-lookup"><span data-stu-id="a1ef0-107">Unregistering XLL Commands and Functions</span></span>

<span data-ttu-id="a1ef0-108">Quando um XLL registra uma função ou comando, o Excel cria um novo nome para o recurso e associa uma referência para a função DLL com esse nome.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-108">When an XLL registers a function or command, Excel creates a new name for the resource and associates a reference to the DLL function with that name.</span></span> <span data-ttu-id="a1ef0-109">O nome será obtido do quarto argumento, *pxFunctionText* , da função [xlfRegister](xlfregister-form-1.md) .</span><span class="sxs-lookup"><span data-stu-id="a1ef0-109">The name is taken from the fourth argument,  *pxFunctionText*  , of the [xlfRegister](xlfregister-form-1.md) function.</span></span> <span data-ttu-id="a1ef0-110">Esse nome é oculto as caixas de diálogo normal para gerenciar os nomes de planilha.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-110">This name is hidden from the normal dialog boxes for managing worksheet names.</span></span> <span data-ttu-id="a1ef0-111">Para cancelar o registro de um comando ou uma função, você deve excluir o nome por usando a função [xlfSetName](xlfsetname.md) , passando o nome, mas não passando uma definição.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-111">To unregister a function or command, you must delete the name by using the [xlfSetName](xlfsetname.md) function, passing the name but not passing a definition.</span></span> <span data-ttu-id="a1ef0-112">No entanto, um bug impede que isso removendo o nome das listas Assistente de função.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-112">However, a bug prevents this from removing the name from the Function Wizard lists.</span></span> 
  
## <a name="argument-description-string-truncation-in-the-function-wizard"></a><span data-ttu-id="a1ef0-113">Truncamento de cadeia de caracteres de descrição do argumento no Assistente de função</span><span class="sxs-lookup"><span data-stu-id="a1ef0-113">Argument Description String Truncation in the Function Wizard</span></span>

<span data-ttu-id="a1ef0-114">O parâmetro *pxArgumentHelp1* e todos os parâmetros subsequentes da função **xlfRegister** são cadeias de caracteres opcionais que correspondem aos argumentos da função XLL.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-114">The  *pxArgumentHelp1*  parameter and all subsequent parameters of the **xlfRegister** function are optional strings that correspond to the arguments of the XLL function.</span></span> <span data-ttu-id="a1ef0-115">O Assistente de função exibe essas para fornecer ajuda na caixa de diálogo do argumento construção.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-115">The Function Wizard displays these to provide help in the argument construction dialog box.</span></span> <span data-ttu-id="a1ef0-116">Em alguns casos, o Excel trunca a cadeia de caracteres que corresponde ao argumento final por um ou dois caracteres quando exibi-las na caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-116">Sometimes Excel truncates the string that corresponds to the final argument by one or two characters when displaying it in the dialog box.</span></span> <span data-ttu-id="a1ef0-117">Você pode evitar isso adicionando um ou dois espaços até o final da cadeia de caracteres final.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-117">You can avoid this by adding one or two spaces to the end of the final string.</span></span> 
  
## <a name="binary-name-scope-limitation"></a><span data-ttu-id="a1ef0-118">Limitação de escopo de nome binário</span><span class="sxs-lookup"><span data-stu-id="a1ef0-118">Binary Name Scope Limitation</span></span>

<span data-ttu-id="a1ef0-119">Nomes de binários e seus dados podem ser recuperados somente quando a planilha que estava ativa no momento em que eles foram criados novamente está ativa.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-119">Binary names and their data can be retrieved only when the worksheet that was active at the time they were created is again active.</span></span> <span data-ttu-id="a1ef0-120">Porque as funções de planilha não é possível ativar planilhas em uma pasta de trabalho (somente comandos podem fazer isso), aplicativos de nomes binários são muito limitados.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-120">Because worksheet functions cannot activate worksheets within a workbook (only commands can do this), applications of binary names are very limited.</span></span> <span data-ttu-id="a1ef0-121">Por exemplo, se você tiver um comando que é invocado somente de uma determinada planilha, você poderá usar um nome binário para armazenar dados relacionados ao comando.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-121">If you have a command that is only invoked from a particular worksheet, for example, you could use a binary name to store command-related data.</span></span>
  
## <a name="xlset-and-workbooks-with-array-formulas"></a><span data-ttu-id="a1ef0-122">xlSet e pastas de trabalho com fórmulas de matriz</span><span class="sxs-lookup"><span data-stu-id="a1ef0-122">xlSet and Workbooks with Array Formulas</span></span>

<span data-ttu-id="a1ef0-123">No Excel 2003 e versões anteriores, a [função xlSet](xlset.md) falhará se você tentar atribuir valores para um intervalo em uma planilha que não seja a planilha ativa, onde o equivalente intervalo na planilha ativa contém uma fórmula de matriz.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-123">In Excel 2003 and earlier versions, the [xlSet function](xlset.md) fails if you try to assign values to a range on a worksheet that is not the active worksheet, where the equivalent range on the active sheet contains an array formula.</span></span> <span data-ttu-id="a1ef0-124">Nesse caso, o Excel exibe a mensagem "Não é possível alterar parte de uma matriz."</span><span class="sxs-lookup"><span data-stu-id="a1ef0-124">In this case, Excel displays the message "You cannot change part of an array."</span></span> <span data-ttu-id="a1ef0-125">Isso foi corrigido no Excel 2007.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-125">This was fixed in Excel 2007.</span></span> 
  
## <a name="circular-references-are-tolerated-in-data-tables"></a><span data-ttu-id="a1ef0-126">Referências circulares são toleradas nas tabelas de dados</span><span class="sxs-lookup"><span data-stu-id="a1ef0-126">Circular References are Tolerated in Data Tables</span></span>

<span data-ttu-id="a1ef0-127">Excel atualmente não gera um erro se o cálculo baseado em uma tabela de dados se refere a algo na tabela em si.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-127">Excel currently does not raise an error if the calculation that a data table is based on refers to something in the table itself.</span></span> <span data-ttu-id="a1ef0-128">Como é improvável como esse cenário pode ser, tenha cuidado quando você está criando ou modificando as fórmulas que são usadas para calcular os valores da tabela de dados.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-128">As unlikely as this scenario might be, you should be careful when you are creating or modifying formulas that are used to calculate data table values.</span></span>
  
## <a name="converting-an-integer-xloper12-to-an-xloper"></a><span data-ttu-id="a1ef0-129">Convertendo XLOPER12 inteiro para XLOPER</span><span class="sxs-lookup"><span data-stu-id="a1ef0-129">Converting an Integer XLOPER12 to an XLOPER</span></span>

<span data-ttu-id="a1ef0-130">Porque o tipo de inteiro **xltypeInt** é um inteiro assinado de 32 bits no tipo de dados **XLOPER12** , mas é apenas um inteiro assinado de 16 bits no tipo de dados **XLOPER** , é possível que alguns valores de **XLOPER12** inteiro não podem estar contidos em um inteiro **XLOPER**.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-130">Because the integer type **xltypeInt** is a 32-bit signed integer in the **XLOPER12** data type, but it is only a 16-bit signed integer in the **XLOPER** data type, it is possible that some integer **XLOPER12** values cannot be contained in an integer **XLOPER**.</span></span> <span data-ttu-id="a1ef0-131">Onde o Excel converte desse tipo internamente, ele obtém alternativa para esse problema, convertendo o tipo para um ponto de flutuação **xltypeNum** **XLOPER**.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-131">Where Excel converts this type internally, it gets around this problem by converting the type to a floating-point **xltypeNum** **XLOPER**.</span></span>
  
<span data-ttu-id="a1ef0-132">A função Framework [XLOper12ToXLOper](xloper12toxloper.md) espelha esse comportamento para ser consistente com o Excel internamente.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-132">The Framework [XLOper12ToXLOper](xloper12toxloper.md) function mirrors this behavior to be consistent with Excel internally.</span></span> <span data-ttu-id="a1ef0-133">Quando você chamar essa função, você não deve considerar retornado **XLOPER** sempre será **xltypeInt**; ler **my_xloper.val.w** retornará um valor false se o tipo de **my_xloper** for **xltypeNum**.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-133">When you call this function, you should not assume that the returned **XLOPER** will always be **xltypeInt**; reading **my_xloper.val.w** gives a false value if the **my_xloper** type is **xltypeNum**.</span></span>
  
## <a name="returning-xloper-or-xloper12-by-modifying-arguments-in-place"></a><span data-ttu-id="a1ef0-134">Retornando XLOPER ou XLOPER12 modificando argumentos in-loco</span><span class="sxs-lookup"><span data-stu-id="a1ef0-134">Returning XLOPER or XLOPER12 by Modifying Arguments in Place</span></span>

<span data-ttu-id="a1ef0-135">Excel permite que o registro de funções que retornam um **XLOPER** ou **XLOPER12** modificando um argumento in-loco.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-135">Excel permits the registration of functions that return an **XLOPER** or **XLOPER12** by modifying an argument in place.</span></span> <span data-ttu-id="a1ef0-136">No entanto, se um **XLOPER**/ **XLOPER12** pontos de argumento a memória e o ponteiro, em seguida, será substituído pelo valor de retorno da função DLL, Excel pode causar o vazamento de memória.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-136">However, if an **XLOPER**/ **XLOPER12** argument points to memory, and the pointer is then overwritten by the return value of the DLL function, Excel can leak memory.</span></span> <span data-ttu-id="a1ef0-137">Excel não exibe um erro, mas ela pode travar eventualmente.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-137">Excel does not display an error, but it might eventually crash.</span></span> <span data-ttu-id="a1ef0-138">Além disso, se a DLL de memória alocada para o valor de retorno, Excel está tentando gratuito que a memória, que pode causar uma falha de aplicativo imediata.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-138">Also, if the DLL allocated memory for the return value, Excel might try to free that memory, which could cause an immediate application crash.</span></span> <span data-ttu-id="a1ef0-139">Portanto, você não deve modificar **XLOPER**/ argumentos**XLOPER12** in-loco.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-139">Therefore, you should not modify **XLOPER**/ **XLOPER12** arguments in place.</span></span> <span data-ttu-id="a1ef0-140">Todos os **XLOPER** ou **XLOPER12** argumentos devem ser tratados como estritamente somente leitura.</span><span class="sxs-lookup"><span data-stu-id="a1ef0-140">All **XLOPER** or **XLOPER12** arguments should be treated as strictly read-only.</span></span> 
  
<span data-ttu-id="a1ef0-141">Para saber mais, consulte [Memory Management in Excel](memory-management-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="a1ef0-141">For more information, see [Memory Management in Excel](memory-management-in-excel.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="a1ef0-142">Ver tamb�m</span><span class="sxs-lookup"><span data-stu-id="a1ef0-142">See also</span></span>



[<span data-ttu-id="a1ef0-143">XLOper12ToXLOper</span><span class="sxs-lookup"><span data-stu-id="a1ef0-143">XLOper12ToXLOper</span></span>](xloper12toxloper.md)


[<span data-ttu-id="a1ef0-144">Desenvolvimento de XLLs do Excel</span><span class="sxs-lookup"><span data-stu-id="a1ef0-144">Developing Excel XLLs</span></span>](developing-excel-xlls.md)
  
[<span data-ttu-id="a1ef0-145">Excel XLL SDK API Function Reference</span><span class="sxs-lookup"><span data-stu-id="a1ef0-145">Excel XLL SDK API Function Reference</span></span>](excel-xll-sdk-api-function-reference.md)
  
[<span data-ttu-id="a1ef0-146">Gerenciamento de memória no Excel</span><span class="sxs-lookup"><span data-stu-id="a1ef0-146">Memory Management in Excel</span></span>](memory-management-in-excel.md)

