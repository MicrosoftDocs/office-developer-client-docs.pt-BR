---
title: Programação com a API de C no Excel
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
keywords:
- c api [excel 2007],programming interfaces [Excel 2007],C API [Excel 2007], when to use,C API [Excel 2007], relation to XLM,Excel programming interfaces
localization_priority: Normal
ms.assetid: 142bc0ce-7d16-4b69-9799-ce6558da2def
description: 'Aplica-se a: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: 459e57d41ef7497c535e51944bbaf24daee84167
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19765431"
---
# <a name="programming-with-the-c-api-in-excel"></a><span data-ttu-id="2a49a-104">Programação com a API de C no Excel</span><span class="sxs-lookup"><span data-stu-id="2a49a-104">Programming with the C API in Excel</span></span>

 <span data-ttu-id="2a49a-105">**Aplica-se a**: Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="2a49a-105">Applies to: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="2a49a-p101">Você pode usar a API de C e o Excel 2013 XLL Software Development Kit para criar funções de planilha de alto desempenho para o Excel 2013. As atualizações da API de C do Excel 2013 refletem o suporte contínuo aos usuários para os quais o desempenho da funcionalidade de terceiros ou interna é fundamental.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p101">You can use the Microsoft Excel 2013 XLL Software Development Kit and the C API to create high-performance worksheet functions for Excel 2013. The upgrades to the Excel 2013 C API reflect ongoing support for users for whom the performance of third-party or in-house functionality is critical.</span></span>
  
## <a name="excel-programming-interfaces"></a><span data-ttu-id="2a49a-108">Interfaces de Programação do Excel</span><span class="sxs-lookup"><span data-stu-id="2a49a-108">Excel Programming Interfaces</span></span>

<span data-ttu-id="2a49a-p102">O Excel oferece várias opções para desenvolver aplicativos que se integrem a ele. As interfaces de programação do Excel foram adicionadas a versões anteriores na seguinte ordem:</span><span class="sxs-lookup"><span data-stu-id="2a49a-p102">Excel provides several options for developing applications that interface with it. The Excel programming interfaces were added to earlier versions in the following order:</span></span>
  
- <span data-ttu-id="2a49a-p103">**Linguagem de macro XLM:** a primeira linguagem acessível ao usuário para a extensão do Excel e a base da API de C. Embora ainda seja compatível com o Excel 2010, o XLM foi substituído há muito tempo pelo Visual Basic for Applications (VBA).</span><span class="sxs-lookup"><span data-stu-id="2a49a-p103">**XLM macro language:** The first user-accessible language for the extension of Excel and the basis of the C API. Although still supported in Excel 2010, XLM has long been superseded by Visual Basic for Applications (VBA).</span></span> 
    
- <span data-ttu-id="2a49a-p104">**API de C e XLLs:** DLLs integradas ao Excel. Essas DLLs oferecem a interface mais rápida e mais direta para a adição de funções de planilha de alto desempenho, embora às custas de alguma complexidade em comparação com as tecnologias mais recentes.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p104">**C API and XLLs:** DLLs that are integrated with Excel. These DLLs provide the most direct and fastest interface for the addition of high-performance worksheet functions, although at the cost of some complexity compared with later technologies.</span></span> 
    
- <span data-ttu-id="2a49a-p105">**VBA:** objetos com código do Visual Basic que estão associados a objetos de pasta de trabalho do Excel. O VBA permite interceptações de eventos, a personalização e a adição de funções e comandos definidos pelo usuário. O VBA é a opção de extensibilidade mais comumente usada e de maior disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p105">**VBA:** Visual Basic code objects that are associated with Excel workbook objects. VBA allows event trapping, customization, and the addition of user-defined functions and commands. VBA is the most commonly used and most easily available of the extensibility options.</span></span> 
    
- <span data-ttu-id="2a49a-p106">**COM:** o padrão de interoperabilidade para aplicativos baseados no Windows, pelo qual o Excel expõe eventos e objetos. O VBA usa o COM para interagir com o Excel. O Excel exporta as bibliotecas do tipo COM que podem ajudar a criar aplicativos e recursos de código C++ COM que podem controlar o Excel externamente.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p106">**COM:** The interoperability standard for Windows-based applications, through which Excel exposes its events and objects. VBA uses COM to interact with Excel. Excel exports COM type libraries that can help you create C++ COM code resources and applications that can control Excel externally.</span></span> 
    
- <span data-ttu-id="2a49a-p107">**O Microsoft .NET Framework:** o ambiente de código gerenciado para várias linguagens projetado para o desenvolvimento rápido de aplicativos para ambientes distribuídos. A linguagem de programação primária para código baseada no .NET Framework é C#, embora muitas linguagens possam ser compiladas para a linguagem intermediária da Microsoft (MSIL). O Excel 2013 pode acessar recursos de código contidos em assemblies do .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p107">**The Microsoft .NET Framework:** The multi-language managed code environment designed for rapid application development for distributed environments. The primary programming language for code that is based on the .NET Framework is C#, although many languages can be compiled to the Microsoft intermediate language (MSIL). Excel 2013 can access code resources contained within .NET Framework assemblies.</span></span> 
    
## <a name="when-to-use-the-c-api"></a><span data-ttu-id="2a49a-124">Quando Usar a API de C</span><span class="sxs-lookup"><span data-stu-id="2a49a-124">When to Use the C API</span></span>

<span data-ttu-id="2a49a-p108">A principal razão para gravar XLLs e usar a API de C é criar funções de planilha de alto desempenho. Embora as funções XLL sejam frequentemente chamadas de funções definidas pelo usuário, o tempo investido para obter a compreensão e as habilidades necessárias para gravar XLLs tornam essa tecnologia inviável para a maioria dos usuários. No entanto, os aplicativos com funções de alto desempenho (no Excel 2013, a capacidade de gravar interfaces com vários threads para criar recursos de servidor eficientes) fazem dessa uma parte crucial da extensibilidade do Excel.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p108">The primary reason for writing XLLs and using the C API is to create high-performance worksheet functions. Although XLL functions are frequently referred to as user-defined functions, the investment in time to obtain the understanding and skills that are required to write XLLs make this a technology impractical for most users. Nevertheless, the applications of high-performance functions—and, in Excel 2013, the ability to write multithreaded interfaces to powerful server resources—make this a very important part of Excel extensibility.</span></span> 
  
<span data-ttu-id="2a49a-128">A revisão da API de C introduzida no Excel 2007 trata principalmente dos aspectos relacionados a cálculos de alto desempenho, em vez de recursos como a interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="2a49a-128">The revision of the C API that was introduced in Excel 2007 is mainly concerned with the aspects relating to high-performance calculations, rather than features such as the user interface.</span></span>
  
### <a name="writing-high-performance-user-defined-worksheet-functions"></a><span data-ttu-id="2a49a-129">Gravando funções de planilha de alto desempenho definidas pelo usuário</span><span class="sxs-lookup"><span data-stu-id="2a49a-129">Writing High-Performance User-Defined Worksheet Functions</span></span>

<span data-ttu-id="2a49a-p109">A API de C do Excel é a opção ideal quando você deseja criar funções de planilha de alto desempenho criando suplementos XLL. A API de C oferece o acesso mais direto aos dados da planilha. Os XLLs oferecem ao Excel o acesso mais direto aos recursos da DLL. O desempenho dos XLLs é aprimorado no Excel 2013 pela adição de novos tipos de dados e, sobretudo, do suporte para a execução de funções definidas pelo usuário em servidores clusterizados.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p109">The Excel C API is the ideal choice when you want to create high-performance worksheet functions by creating XLL add-ins. The C API provides you with the most direct access to worksheet data. XLLs provide Excel with the most direct access to the DLL resources. The performance of XLLs is further enhanced in Excel 2013 by the addition of new data types and, most importantly, support for running user-defined functions on clustered servers.</span></span>
  
<span data-ttu-id="2a49a-p110">Trabalhar com os XLLs tem um custo: a API de C não tem os recursos de desenvolvimento rápido de nível superior do VBA, COM ou o .NET Framework. O gerenciamento de memória é de nível baixo e, portanto, atribui uma maior responsabilidade ao desenvolvedor. Muitos recursos do Excel que são expostos pelo COM, tornando-os disponíveis por meio do VBA e o .NET Framework, não são expostos à API de C.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p110">Working with XLLs comes at a cost: The C API has none of the higher-level rapid development features of VBA, COM, or the .NET Framework. Memory management is low level and, therefore, puts greater responsibility on the developer. Many Excel features that are exposed via COM, making them available through VBA and the .NET Framework, are not exposed to the C API.</span></span>
  
### <a name="accessing-multithreaded-servers-by-using-xll-worksheet-functions"></a><span data-ttu-id="2a49a-136">Acessando Servidores de Vários Threads Usando Funções de Planilha XLL</span><span class="sxs-lookup"><span data-stu-id="2a49a-136">Accessing Multithreaded Servers by Using XLL Worksheet Functions</span></span>

<span data-ttu-id="2a49a-p111">O recálculo de vários threads (MTR), que foi introduzido no Excel 2007, permite criar funções de planilha XLL seguras para threads. Use essas funções para acessar servidores de vários threads. As seções posteriores descrevem com mais detalhes como isso pode aumentar significativamente o desempenho observado pelo usuário. Para usuários do Excel que muitas vezes precisam acessar uma grande quantidade de energia de processamento, a combinação de um XLL que usa MTR e um servidor de cálculo avançada fornece a solução de desempenho mais elevado.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p111">Multithreaded recalculation (MTR), which was introduced in Excel 2007, enables you to create thread-safe XLL worksheet functions. You can use these functions to access multithreaded servers. Later sections describe more fully how this can dramatically increase the performance observed by the user. For Excel users who sometimes need access to a lot of processing power, the combination of an XLL that uses MTR and a powerful calculation server provides the highest-performance solution.</span></span>
  
### <a name="customizing-the-excel-user-interface"></a><span data-ttu-id="2a49a-141">Personalizando a interface de usuário do Excel</span><span class="sxs-lookup"><span data-stu-id="2a49a-141">Customizing the Excel User Interface</span></span>

<span data-ttu-id="2a49a-p112">Para muitas versões do Excel, a API de C não tem sido a melhor opção para personalizar a interface do usuário. O VBA possui o melhor acesso a objetos e eventos do Excel. A interface do usuário introduzida no Excel 2007 é significativamente diferente das versões anteriores em aparência e tecnologia subjacente. É possível personalizar melhor esta interface usando recursos de código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p112">For many versions of Excel, the C API has not been the best choice for customizing the user interface. VBA has superior access to Excel objects and events. The user interface introduced in Excel 2007 is significantly different from earlier versions both in appearance and underlying technology. You can best customize this interface by using managed code resources.</span></span>
  
### <a name="creating-applications-that-can-be-accessed-on-the-internet"></a><span data-ttu-id="2a49a-146">Criando aplicativos que possam ser acessados pela Internet</span><span class="sxs-lookup"><span data-stu-id="2a49a-146">Creating Applications that Can Be Accessed on the Internet</span></span>

<span data-ttu-id="2a49a-p113">Os Serviços do Excel, introduzidos com o sistema Microsoft Office 2007, oferecem a melhor maneira de conceder aos usuários acesso a pastas de trabalho e a funcionalidades do Excel usando ferramentas padrão do navegador da Web. Com linguagens e recursos de desenvolvimento do .NET Framework, essas tecnologias representam uma parte importante da implantação do Excel para usuários no futuro.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p113">Excel Services, introduced with the 2007 Microsoft Office system, provides the best way to give users access to workbooks and Excel functionality by using standard Web browser tools. Together with .NET Framework development languages and resources, these technologies represent an important part of Excel deployment to users in the future.</span></span>
  
### <a name="controlling-excel-from-external-applications"></a><span data-ttu-id="2a49a-149">Controlando o Excel de aplicativos externos</span><span class="sxs-lookup"><span data-stu-id="2a49a-149">Controlling Excel from External Applications</span></span>

<span data-ttu-id="2a49a-p114">O Excel expõe seus objetos, métodos e eventos por meio da interface COM. É possível, portanto, usar COM para criar aplicativos independentes que podem iniciar e controlar uma sessão do Excel ou controlar uma sessão existente do Excel. Acesse a interface do Excel exposta por COM em várias linguagens de desenvolvimento, incluindo C++ e VBA. Da mesma forma, o .NET Framework e C# fornecem uma interface para o Excel que permite acessar e controlar o Excel remotamente.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p114">Excel exposes its objects, methods, and events through the COM interface. You can, therefore, use COM to create stand-alone applications that can start and control an Excel session or control an existing Excel session. You can access the COM-exposed Excel interface within several development languages, including C++ and VBA. C# and the .NET Framework similarly provide an interface to Excel that enables remote access to and control of Excel.</span></span>
  
## <a name="asynchronous-calling-of-excel"></a><span data-ttu-id="2a49a-154">Chamada assíncrona do Excel</span><span class="sxs-lookup"><span data-stu-id="2a49a-154">Asynchronous Calling of Excel</span></span>

<span data-ttu-id="2a49a-p115">O Excel permite que XLLs chamem a API de C somente quando o Excel tiver passado o controle para o XLL. Uma função de planilha chamada pelo Excel pode fazer chamadas novamente para o Excel usando a API de C. Um comando XLL chamado pelo Excel pode chamar a API de C. Comandos e funções DLL e XLL chamados pelo VBA quando o próprio VBA tiver sido chamado pelo Excel podem chamar a API de C. Não é possível, por exemplo, definir um retorno de chamada de tempo limite do Windows no XLL e chamar a API de C dele. Também não é possível chamar a API de C de um thread em segundo plano criado pelo XLL. Não é recomendável chamar o Excel de forma assíncrona usando COM de uma DLL ou XLL.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p115">Excel allows XLLs to call the C API only when Excel has passed control to the XLL. A worksheet function that is called by Excel can call back into Excel by using the C API. An XLL command that is called by Excel can call the C API. DLL and XLL functions and commands that are called by VBA when VBA has itself been called by Excel can call the C API. You cannot, for example, set a timed Windows callback into your XLL and call the C API from it, and you cannot call the C API from a background thread created by your XLL. Calling Excel asynchronously by using COM from a DLL or XLL is not recommended.</span></span>
  
<span data-ttu-id="2a49a-p116">Isso é muito limitador, já que podem haver aplicativos nos quais você deseja que o Excel reaja a um evento de forma assíncrona. Por exemplo, talvez você queira que o Excel recupere uma parte dos dados na Internet e recalcule sempre que esses dados forem alterados. Ou talvez você queira que um thread em segundo plano realize um cálculo e faça com que o Excel calcule novamente assim que ele for concluído.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p116">This is very limiting because there may be applications in which you want Excel to react to an event asynchronously. For example, you might want Excel to retrieve a piece of data on the Internet and recalculate whenever that data changes. Or you might want a background thread to perform a calculation and have Excel recalculate when it is finished.</span></span>
  
<span data-ttu-id="2a49a-p117">Isso pode ser feito ao fazer com que o Excel sonde alterações ativamente, mas é ineficiente e limitador porque frequentemente envolve a interrupção da atividade normal do Excel. É possível configurar comandos repetidos com tempo limite usando a API de C ou o VBA, embora essa não seja a solução ideal.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p117">You can do this by having Excel actively poll for changes, but this is inefficient and limiting because it involves Excel frequently interrupting its regular activity. You can set up repeated timed command using the C API or VBA, although this is not an ideal solution.</span></span>
  
<span data-ttu-id="2a49a-p118">A condição ideal seria ter um processo externo mais eficiente para verificar a alteração nos dados e que esse processo externo acionasse o Excel para recuperar a atualização e realizar um recálculo. É possível fazer isso usando um aplicativo que faz interface com o Excel usando COM. O COM não é restrito da mesma forma como a API de C para fazer chamadas somente quando o Excel tiver explicitamente passado o controle para ele.Os aplicativos COM podem chamar métodos do Excel sempre que o Excel estiver em um estado de prontidão, embora essas chamadas de método possam ser ignoradas se as caixas de diálogo estiverem sendo exibidas, quando os menus estiverem recolhidos ou quando uma macro estiver em execução.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p118">Ideally you would want a more efficient external process to check for the change in data, and for that external process to trigger Excel to retrieve the update and perform a recalculation. You can do this by using an application that interfaces to Excel by using COM. COM is not restricted in the same manner as the C API to making calls only when Excel has explicitly passed it control. COM applications can invoke Excel methods whenever Excel is in a ready state, although these method calls might be ignored if dialog boxes are being displayed, menus are pulled down, or when a macro is executing.</span></span>
  
## <a name="c-api-and-its-relation-to-xlm"></a><span data-ttu-id="2a49a-170">A API de C e sua relação com XLM</span><span class="sxs-lookup"><span data-stu-id="2a49a-170">C API and Its Relation to XLM</span></span>

<span data-ttu-id="2a49a-p119">A linguagem de macro (XLM) do Excel foi o primeiro ambiente de programação acessível ao usuário fornecido no Excel. Ela permitia aos usuários criar funções e comandos personalizados em folhas de macro especiais parecidas com planilhas comuns. As folhas de macro XLM ainda são compatíveis com o Excel 2013. Use todas as funções de planilha de costume, como **SOMA** e **LOG** na folha de macro, além dos seguintes itens que não podem ser inseridos na planilha:</span><span class="sxs-lookup"><span data-stu-id="2a49a-p119">The Excel macro (XLM) language was the first user-accessible programming environment provided in Excel. It enabled users to create custom commands and functions on special macro sheets that look like ordinary worksheets. XLM macro sheets are still supported in Excel 2013. You can use all the usual worksheet functions like **SUM** and **LOG** on a macro sheet, in addition to the following items that cannot be entered on a worksheet:</span></span> 
  
- <span data-ttu-id="2a49a-175">Funções de informação do espaço de trabalho, como **INFO.CÉL** e **INFO.PASTA.TRABALHO**.</span><span class="sxs-lookup"><span data-stu-id="2a49a-175">Workspace information functions such as **GET.CELL** and **GET.WORKBOOK**.</span></span>
    
- <span data-ttu-id="2a49a-176">Funções equivalentes a comandos que permitem a automação de operações comuns de usuário, como **DEFINE.NAME** e **PASTE**.</span><span class="sxs-lookup"><span data-stu-id="2a49a-176">Command-equivalent functions that enable automation of ordinary user operations such as **DEFINE.NAME** and **PASTE**.</span></span>
    
- <span data-ttu-id="2a49a-177">Funções relacionadas a suplementos como **REGISTRO**.</span><span class="sxs-lookup"><span data-stu-id="2a49a-177">Functions that relate to add-ins such as **REGISTER**.</span></span>
    
- <span data-ttu-id="2a49a-178">Interceptações de eventos equivalentes a comandos como **ON.ENTRY** e **ON.TIME**.</span><span class="sxs-lookup"><span data-stu-id="2a49a-178">Command-equivalent event traps such as **ON.ENRTY** and **ON.TIME**.</span></span>
    
- <span data-ttu-id="2a49a-179">Operações específicas da função de macro como **ARGUMENTO** e **TEMPORÁRIO**.</span><span class="sxs-lookup"><span data-stu-id="2a49a-179">Macro function-specific operations such as **ARGUMENT** and **VOLATILE**.</span></span>
    
- <span data-ttu-id="2a49a-180">Operações de controle de fluxo como **IRPARA** e **RETORNO**.</span><span class="sxs-lookup"><span data-stu-id="2a49a-180">Flow-control operations such as **GOTO** and **RETURN**.</span></span>
    
<span data-ttu-id="2a49a-p120">Havia uma versão limitada da API de C no Excel versão 3. No entanto, no Excel versão 4, a linguagem XLM foi mapeada para a API de C. Desde então, as DLLs podem chamar todas as funções de planilha, comandos e funções de informação das folhas de macro e configurar interceptações de evento. As DLLs não podem chamar funções de controle de fluxo XLM de dentro da API de C. Esses comandos e funções de folhas de macro estão documentados no arquivo da Ajuda XLMacr8.hlp (anteriormente conhecido como Macrofun.hlp). Para obter este arquivo de ajuda, acesse o [Centro de Download da Microsoft](http://download.microsoft.com) e pesquise "XLMacr8.hlp".</span><span class="sxs-lookup"><span data-stu-id="2a49a-p120">A limited version of the C API existed in Excel version 3. However, in Excel version 4, the XLM language was mapped to the C API. Since then, DLLs have been able to call all worksheet functions, macro sheet information functions, and commands, and to set event traps. DLLs cannot call XLM flow control functions from within the C API. These macro-sheet functions and commands are documented in the Help file XLMacr8.hlp (formerly named Macrofun.hlp). To obtain this help file, go to the [Microsoft Download Center](http://download.microsoft.com) and search for "XLMacr8.hlp".</span></span> 
  
> [!NOTE]
> <span data-ttu-id="2a49a-187">O Windows Vista e o Windows 7 não são diretamente compatíveis com arquivos .hlp, mas é possível baixar o [Programa da Ajuda do Windows (WinHlp32.exe) para Windows Vista](http://go.microsoft.com/fwlink/?LinkID=82148) ou o [Programa da Ajuda do Windows (WinHlp32.exe) para Windows 7](http://www.microsoft.com/download/en/details.aspx?id=91) da Microsoft para permitir que esses arquivos sejam abertos.</span><span class="sxs-lookup"><span data-stu-id="2a49a-187">Windows Vista and Windows 7 do not directly support .hlp files, but you can download the [Windows Help program (WinHlp32.exe) for Windows Vista](http://go.microsoft.com/fwlink/?LinkID=82148) or the [Windows Help program (WinHlp32.exe) for Windows 7](http://www.microsoft.com/download/en/details.aspx?id=91) from Microsoft that enables them to be opened.</span></span> 
  
<span data-ttu-id="2a49a-p121">As DLLs chamam equivalentes da API de C dessas funções e comandos, usando as funções de retorno de chamada **Excel4**, **Excel4v**, **Excel12** e **Excel12v** (sendo que as duas últimas funções foram introduzidas no Excel 2007). As constantes enumeradas que correspondem a cada função e comando são definidas em um arquivo de cabeçalho e passadas como um dos argumentos desses retornos de chamada. Por exemplo, **INFO.CÉL** é representada como **xlfGetCell**, **REGISTRO** como **xlfRegister** e **DEFINE.NAME** como **xlcDefineName**.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p121">DLLs call C API equivalents of these functions and commands by using the callback functions **Excel4**, **Excel4v**, **Excel12**, and **Excel12v** (the last two were introduced in Excel 2007). Enumerated constants that correspond to each function and command are defined in a header file and passed as one of the arguments to these callbacks. For example, **GET.CELL** is represented by **xlfGetCell**, **REGISTER** by **xlfRegister**, and **DEFINE.NAME** by **xlcDefineName**.</span></span>
  
<span data-ttu-id="2a49a-p122">Além de fornecer as funções de planilha e as funções e comandos de folhas de macro, a API de C fornece enumerações de função e de comando que só podem ser chamadas usando esses retornos de chamada de dentro de uma DLL. Por exemplo, **xlGetName** permite que a DLL encontre por conta própria o caminho completo e o nome do arquivo, o que é necessário ao registrar funções e comandos com o Excel.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p122">In addition to providing the worksheet functions and macro-sheet functions and commands, the C API provides function and command enumerations that can be called only by using these callbacks from within a DLL. For example, **xlGetName** enables the DLL to find out its own the full path and file name, which is required when you register functions and commands with Excel.</span></span> 
  
<span data-ttu-id="2a49a-p123">Desde a introdução das folhas do Visual Basic for Applications (VBA) no Excel versão 5 e do Editor do Visual Basic (VBE) na versão 8 (Excel 97), a maneira mais fácil para os usuários personalizarem o Excel é usar o VBA em vez de o XLM. Consequentemente, muitas das novas funcionalidades apresentadas em versões posteriores do Excel estão disponíveis no VBA, mas não no XLM ou na API de C. Por exemplo, vários comandos, interceptações de eventos e recursos aprimorados de caixa de diálogo são disponibilizadas no VBA, mas não no XLM ou na API de C.</span><span class="sxs-lookup"><span data-stu-id="2a49a-p123">Since the introduction of Visual Basic for Applications (VBA) sheets in Excel version 5, and the Visual Basic Editor (VBE) in version 8 (Excel 97), the easiest way for users to customize Excel is to use VBA instead of XLM. Consequently, much of the new functionality introduced in later versions of Excel is available through VBA, but not through XLM or the C API. For example, several commands, event traps, and enhanced dialog box capabilities are available through VBA, but not through XLM or the C API.</span></span>
  
<span data-ttu-id="2a49a-196">Para saber mais, confira [What's New in the C API for Excel](what-s-new-in-the-c-api-for-excel.md).</span><span class="sxs-lookup"><span data-stu-id="2a49a-196">For more information, see [What's New in the C API for Excel](what-s-new-in-the-c-api-for-excel.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="2a49a-197">Confira também</span><span class="sxs-lookup"><span data-stu-id="2a49a-197">See also</span></span>



[<span data-ttu-id="2a49a-198">Novidades na API de C do Excel</span><span class="sxs-lookup"><span data-stu-id="2a49a-198">What's New in the C API for Excel</span></span>](what-s-new-in-the-c-api-for-excel.md)
  
[<span data-ttu-id="2a49a-199">Retorno de chamada da API de C: funções Excel4, Excel12</span><span class="sxs-lookup"><span data-stu-id="2a49a-199">C API Callback Functions Excel4, Excel12</span></span>](c-api-callback-functions-excel4-excel12.md)


[<span data-ttu-id="2a49a-200">Introdução ao Excel XLL SDK</span><span class="sxs-lookup"><span data-stu-id="2a49a-200">Getting Started with the Excel XLL SDK</span></span>](getting-started-with-the-excel-xll-sdk.md)

