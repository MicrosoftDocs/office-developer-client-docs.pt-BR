---
title: Criar XLLs
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
keywords:
- DLLs [excel 2007], ligações para excel, função xlAutoFree [Excel 2007], função xlAutoFree12 [Excel 2007],xlcall32.lib [Excel 2007], função xlAutoRegister [Excel 2007],xlcall.cpp [Excel 2007], xlAutoRemove função [Excel 2007], xlAddInManagerInfo função [Excel 2007], função xlAutoAdd [Excel 2007], função xlAutoOpen [Excel 2007], xlAutoClose função [Excel 2007], DLLs [Excel 2007], transformando em XLLs, XLLs [Excel 2007], ligações para Excel, função xlAutoRegister12 [Excel 2007],xlcall.h [Excel função de xlAddInManagerInfo12 de 2007], [Excel 2007]
localization_priority: Normal
ms.assetid: 7754998f-4e13-4a37-9724-43b6ee6c919b
description: 'Aplica-se a: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: de347d34768c25adf0d96642b4fade781ae26a9c
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19765273"
---
# <a name="creating-xlls"></a><span data-ttu-id="174e0-104">Criar XLLs</span><span class="sxs-lookup"><span data-stu-id="174e0-104">Creating XLLs</span></span>

<span data-ttu-id="174e0-105">**Aplica-se a**: Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="174e0-105">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="174e0-106">Se sua DLL é autônomo ou depende somente em outras bibliotecas, você deve saber como habilitar o Microsoft Excel acessar suas funções e comandos.</span><span class="sxs-lookup"><span data-stu-id="174e0-106">If your DLL is self-contained or relies only on other libraries, you must know how to enable Microsoft Excel to access its functions and commands.</span></span> <span data-ttu-id="174e0-107">Para obter mais informações, consulte [Acesso DLLs no Excel](how-to-access-dlls-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="174e0-107">For more information, see [Access DLLs in Excel](how-to-access-dlls-in-excel.md).</span></span> 
  
<span data-ttu-id="174e0-108">No entanto, se sua DLL precisar acessar a funcionalidade do Excel (por exemplo, para obter o conteúdo de uma célula, chamar uma função de planilha ou de investigar Excel para obter informações de espaço de trabalho), seu código deve ser capaz de retorno de chamada para o Excel.</span><span class="sxs-lookup"><span data-stu-id="174e0-108">However, if your DLL needs to access Excel functionality (for example, to get the contents of a cell, to call a worksheet function, or to interrogate Excel to obtain workspace information), your code must be able to call back into Excel.</span></span>
  
<span data-ttu-id="174e0-109">A API C do Excel fornece várias funções que permitem DLLs para retorno de chamada para o Excel.</span><span class="sxs-lookup"><span data-stu-id="174e0-109">The Excel C API provides several functions that enable DLLs to call back into Excel.</span></span> <span data-ttu-id="174e0-110">Para acessar esses, a DLL deve ser vinculada estaticamente em tempo de compilação com a biblioteca do Excel de 32 bits, xlcall32.</span><span class="sxs-lookup"><span data-stu-id="174e0-110">To access these, the DLL must be linked statically at compile time with the Excel 32-bit library, xlcall32.lib.</span></span> <span data-ttu-id="174e0-111">A biblioteca estática é página de download da Microsoft como parte do Microsoft Excel 2013 XLL SDK, que inclui as versões de 32 bits e 64 bits desta biblioteca.</span><span class="sxs-lookup"><span data-stu-id="174e0-111">The static library is downloadable from Microsoft as part of the Microsoft Excel 2013 XLL SDK, which includes both 32-bit and 64-bit versions of this library.</span></span>
  
## <a name="enabling-dlls-to-call-back-into-excel"></a><span data-ttu-id="174e0-112">Habilitando DLLs a chamada para o Excel</span><span class="sxs-lookup"><span data-stu-id="174e0-112">Enabling DLLs to Call Back into Excel</span></span>

<span data-ttu-id="174e0-113">Para uma DLL seja capaz de acessar a funcionalidade do Excel e obter ou definir informações de espaço de trabalho, ele deve primeiro obter os endereços das funções do retorno de chamada Excel **Excel4**, **Excel4v**, **Excel12**e **Excel12v**.</span><span class="sxs-lookup"><span data-stu-id="174e0-113">For a DLL to be able to access the functionality in Excel and get or set workspace information, it must first obtain the addresses of the Excel callback functions **Excel4**, **Excel4v**, **Excel12**, and **Excel12v**.</span></span> <span data-ttu-id="174e0-114">As duas últimas introduzidas no Excel 2007 e estão disponíveis nas versões subsequentes.</span><span class="sxs-lookup"><span data-stu-id="174e0-114">The last two were introduced in Excel 2007 and are available in subsequent versions.</span></span> <span data-ttu-id="174e0-115">Para acessar todos esses, o projeto DLL deve incluir referências para os seguintes arquivos do Excel 2013 XLL SDK.</span><span class="sxs-lookup"><span data-stu-id="174e0-115">To access all of these, the DLL project must include references to the following files from the Excel 2013 XLL SDK.</span></span> <span data-ttu-id="174e0-116">Se você deseja acessar apenas os retornos de duas primeiras chamada (em qualquer versão do Excel), o seu projeto deve incluir somente os primeiros dois arquivos.</span><span class="sxs-lookup"><span data-stu-id="174e0-116">If you want to access only the first two callbacks (in any version of Excel), your project needs to include only the first two files.</span></span>
  
### <a name="xlcallh"></a><span data-ttu-id="174e0-117">Xlcall. h</span><span class="sxs-lookup"><span data-stu-id="174e0-117">Xlcall.h</span></span>

<span data-ttu-id="174e0-118">O arquivo de xlcall. h contém os seguintes itens:</span><span class="sxs-lookup"><span data-stu-id="174e0-118">The Xlcall.h file contains the following items:</span></span>
  
- <span data-ttu-id="174e0-119">Protótipos de função para todas as funções de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="174e0-119">Function prototypes for all callback functions.</span></span>
    
- <span data-ttu-id="174e0-120">Definições das estruturas de dados que os retornos de chamada usam para trocar dados entre o Excel e DLL/XLL e tipos de dados constante.</span><span class="sxs-lookup"><span data-stu-id="174e0-120">Definitions of the data structures that the callbacks use to exchange data between the DLL/XLL and Excel, and data-type constant definitions.</span></span>
    
- <span data-ttu-id="174e0-121">Definições de equivalentes de função e comando do C API do planilha, funções de folha de macro e comandos do Excel com suporte.</span><span class="sxs-lookup"><span data-stu-id="174e0-121">Definitions of the C API function and command equivalents of the worksheet, macro sheet functions, and supported Excel commands.</span></span>
    
- <span data-ttu-id="174e0-122">Valores de retorno de definições de função de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="174e0-122">Definitions of callback function return values.</span></span>
    
<span data-ttu-id="174e0-123">Você deve usar o **#include** diretriz para esse arquivo, diretamente ou indiretamente por meio de outro arquivo de cabeçalho, em todos os arquivos que acessar a API C ou que lidam com tipos de dados que usa a API C.</span><span class="sxs-lookup"><span data-stu-id="174e0-123">You should use the **#include** directive for this file, directly or indirectly via another header file, in all files that access the C API or that handle data types that the C API uses.</span></span> 
  
### <a name="xlcall32lib"></a><span data-ttu-id="174e0-124">Xlcall32</span><span class="sxs-lookup"><span data-stu-id="174e0-124">Xlcall32.lib</span></span>

<span data-ttu-id="174e0-125">A biblioteca xlcall32 exporta os dois primeiros retornos de chamada, **Excel4** e **Excel4v**e também a função **XlCallVer** .</span><span class="sxs-lookup"><span data-stu-id="174e0-125">The Xlcall32.lib library exports the first two callbacks, **Excel4** and **Excel4v**, and also the **XlCallVer** function.</span></span> <span data-ttu-id="174e0-126">Sem uma referência a essa biblioteca em seu projeto, o vinculador não pode criar o XLL, se você tiver usado qualquer um desses retornos de chamada em seu código.</span><span class="sxs-lookup"><span data-stu-id="174e0-126">Without a reference to this library in your project, the linker cannot create the XLL if you have used any of these callbacks in your code.</span></span> <span data-ttu-id="174e0-127">(Você pode obter os endereços dessas funções vinculando dinamicamente a xlcall32 equivalentes que são copiados para seu sistema como parte de uma instalação normal do Excel).</span><span class="sxs-lookup"><span data-stu-id="174e0-127">(You can obtain the addresses of these functions by linking dynamically to the equivalent Xlcall32.dll that is copied to your system as part of a normal Excel installation.)</span></span> 
  
### <a name="xlcallcpp"></a><span data-ttu-id="174e0-128">Xlcall.cpp</span><span class="sxs-lookup"><span data-stu-id="174e0-128">Xlcall.cpp</span></span>

<span data-ttu-id="174e0-129">Os retornos de chamada do Excel **Excel12** e **Excel12v** não são exportados no xlcall32.</span><span class="sxs-lookup"><span data-stu-id="174e0-129">The Excel callbacks **Excel12** and **Excel12v** are not exported in Xlcall32.lib.</span></span> <span data-ttu-id="174e0-130">Isso garante que os projetos XLL que você criar iniciada no Excel 2007 também funcionará com versões anteriores do Excel.</span><span class="sxs-lookup"><span data-stu-id="174e0-130">This ensures that XLL projects that you create starting in Excel 2007 will also work with earlier versions of Excel.</span></span> <span data-ttu-id="174e0-131">O módulo Xlcall.cpp contém código para o **Excel12** e funções **Excel12v** , o qual ligar para uma entrada de Excel aponte iniciada no Excel 2007 ou retornam um valor de erro de segurança, se você estiver executando uma versão anterior do Excel.</span><span class="sxs-lookup"><span data-stu-id="174e0-131">The Xlcall.cpp module contains code for the **Excel12** and **Excel12v** functions, which call into an Excel entry point starting in Excel 2007, or return a safe error value if you are running an earlier version of Excel.</span></span> <span data-ttu-id="174e0-132">Você deve incluir esse módulo em seu projeto, se você quiser criar um XLL executado iniciando no Excel 2007 e o que é possível usar os novos tipos de dados que lidam com grades maiores e mais cadeias de caracteres Unicode.</span><span class="sxs-lookup"><span data-stu-id="174e0-132">You should include this module in your project if you want to create an XLL that runs starting in Excel 2007 and that is able to use the new data types that handle larger grids and longer Unicode strings.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="174e0-133">Iniciando com o SDK do Excel 2010, esse arquivo pode ser compilado para XLLs de 32 bits e 64 bits.</span><span class="sxs-lookup"><span data-stu-id="174e0-133">Starting with the Excel 2010 SDK, this file can be compiled for both 32-bit and 64-bit XLLs.</span></span> 
  
## <a name="turning-dlls-into-xlls-add-in-manager-interface-functions"></a><span data-ttu-id="174e0-134">Transformando DLLs em XLLs: Gerenciador de funções da Interface de suplemento</span><span class="sxs-lookup"><span data-stu-id="174e0-134">Turning DLLs into XLLs: Add-in Manager Interface Functions</span></span>

<span data-ttu-id="174e0-135">Um XLL é uma DLL que exporta vários procedimentos que são chamados pelo Excel ou o Gerenciador de suplemento do Excel.</span><span class="sxs-lookup"><span data-stu-id="174e0-135">An XLL is a DLL that exports several procedures that are called by Excel or the Excel Add-in Manager.</span></span> <span data-ttu-id="174e0-136">Estes procedimentos são descritos resumidamente aqui e abordados em detalhes no [Gerenciador de suplementos e funções da Interface XLL](add-in-manager-and-xll-interface-functions.md).</span><span class="sxs-lookup"><span data-stu-id="174e0-136">These procedures are described briefly here and discussed in detail in [Add-in Manager and XLL Interface Functions](add-in-manager-and-xll-interface-functions.md).</span></span> <span data-ttu-id="174e0-137">Todos esses retornos de chamada DLL começam com o prefixo **xlAuto**.</span><span class="sxs-lookup"><span data-stu-id="174e0-137">All of these DLL callbacks start with the prefix **xlAuto**.</span></span> <span data-ttu-id="174e0-138">Somente um destes procedimentos, o comando **xlAutoOpen**, é necessário.</span><span class="sxs-lookup"><span data-stu-id="174e0-138">Only one of these, the command **xlAutoOpen**, is required.</span></span> <span data-ttu-id="174e0-139">Ele é chamado quando o suplemento é ativado, e ele geralmente é utilizado para registrar as funções XLL e comandos com o Excel e outras tarefas de inicialização.</span><span class="sxs-lookup"><span data-stu-id="174e0-139">It is called when the add-in is activated, and it is typically used to register XLL functions and commands with Excel and to do other initialization tasks.</span></span> <span data-ttu-id="174e0-140">As assinaturas de função e exemplos de implementações de todas as funções **xlAuto** são fornecidos nas seções posteriores.</span><span class="sxs-lookup"><span data-stu-id="174e0-140">The function signatures and example implementations of all of the **xlAuto** functions are provided in later sections.</span></span> 
  
<span data-ttu-id="174e0-141">Embora **xlAutoOpen** seja a única pessoa necessária esses retornos de, seu suplemento talvez também precisa exportar outras pessoas dependendo do seu comportamento.</span><span class="sxs-lookup"><span data-stu-id="174e0-141">Even though **xlAutoOpen** is the only required one of these callbacks, your add-in may also need to export others depending on its behavior.</span></span> 
  
<span data-ttu-id="174e0-142">Excel 2007 introduziu um novo tipo de dados, **XLOPER12**, para acomodar grades maiores e para oferecer suporte a cadeias de caracteres Unicode longas.</span><span class="sxs-lookup"><span data-stu-id="174e0-142">Excel 2007 introduced a new data type, **XLOPER12**, to accommodate larger grids and to support long Unicode strings.</span></span> <span data-ttu-id="174e0-143">**XLOPER12** é descrito mais adiante neste tópico.</span><span class="sxs-lookup"><span data-stu-id="174e0-143">**XLOPER12** is described later in this topic.</span></span> <span data-ttu-id="174e0-144">Enquanto funções **xlAuto** levar ou retornam o tipo de dados antigo **XLOPER**, novas versões dessas funções foram introduzidas no Excel 2007 que usam tipos de dados **XLOPER12** .</span><span class="sxs-lookup"><span data-stu-id="174e0-144">Whereas **xlAuto** functions take or return the old data type **XLOPER**, new versions of these functions were introduced in Excel 2007 that use **XLOPER12** data types.</span></span> <span data-ttu-id="174e0-145">Com exceção de **xlAutoFree12**, que em alguns casos, você deve implementar para evitar a memória **XLOPER12** vazamento, você com segurança pode omitir todas as versão 12 **xlAuto** funções, nesse caso, iniciando no Excel 2007, chamadas de Excel **XLOPER** versões.</span><span class="sxs-lookup"><span data-stu-id="174e0-145">With the exception of **xlAutoFree12**, which you must sometimes implement to avoid **XLOPER12** memory leaks, you can safely omit all the version 12 **xlAuto** functions, in which case, starting in Excel 2007, Excel calls the **XLOPER** versions.</span></span> 
  
### <a name="xlautoopen"></a><span data-ttu-id="174e0-146">xlAutoOpen</span><span class="sxs-lookup"><span data-stu-id="174e0-146">xlAutoOpen</span></span>

<span data-ttu-id="174e0-147">Excel chama a função [xlAutoOpen](xlautoopen.md) sempre que o XLL é ativado.</span><span class="sxs-lookup"><span data-stu-id="174e0-147">Excel calls the [xlAutoOpen](xlautoopen.md) function whenever the XLL is activated.</span></span> <span data-ttu-id="174e0-148">O suplemento será ativado no início de uma sessão do Excel se ele estava ativo na última sessão Excel que terminou normalmente.</span><span class="sxs-lookup"><span data-stu-id="174e0-148">The add-in will be activated at the start of an Excel session if it was active in the last Excel session that ended normally.</span></span> <span data-ttu-id="174e0-149">O suplemento é ativado se ele for carregado durante uma sessão do Excel.</span><span class="sxs-lookup"><span data-stu-id="174e0-149">The add-in is activated if it is loaded during an Excel session.</span></span> <span data-ttu-id="174e0-150">O suplemento pode ser desativado reativado durante uma sessão do Excel e a função for chamada em reativação.</span><span class="sxs-lookup"><span data-stu-id="174e0-150">The add-in can be deactivated and reactivated during an Excel session, and the function is called on reactivation.</span></span> 
  
<span data-ttu-id="174e0-151">Você deve usar **xlAutoOpen** para registrar os comandos e funções XLL, inicializar estruturas de dados, personalize a interface do usuário e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="174e0-151">You should use **xlAutoOpen** to register XLL functions and commands, initialize data structures, customize the user interface, and so on.</span></span> 
  
<span data-ttu-id="174e0-152">Se seu suplemento implementa e exporta a função [xlAutoRegister](xlautoregister-xlautoregister12.md) ou a função [xlAutoRegister12](xlautoregister-xlautoregister12.md) , Excel poderá tentar ativar e registrar um comando ou uma função sem primeiro chamar a função **xlAutoOpen** .</span><span class="sxs-lookup"><span data-stu-id="174e0-152">If your add-in implements and exports the [xlAutoRegister](xlautoregister-xlautoregister12.md) function or the [xlAutoRegister12](xlautoregister-xlautoregister12.md) function, Excel might attempt to activate and register a function or command without first calling the **xlAutoOpen** function.</span></span> <span data-ttu-id="174e0-153">Nesse caso, você deve assegurar que o add-in é suficientemente inicializado para sua função ou o comando funcione corretamente.</span><span class="sxs-lookup"><span data-stu-id="174e0-153">In this case, you should ensure that your add-in is sufficiently initialized for your function or command to work properly.</span></span> <span data-ttu-id="174e0-154">Se não for, você deve falhar ou a tentativa de registrar a função ou o comando ou realizar a inicialização necessária.</span><span class="sxs-lookup"><span data-stu-id="174e0-154">If it is not, you should either fail the attempt to register the function or command, or carry out the necessary initialization.</span></span> 
  
### <a name="xlautoclose"></a><span data-ttu-id="174e0-155">xlAutoClose</span><span class="sxs-lookup"><span data-stu-id="174e0-155">xlAutoClose</span></span>

<span data-ttu-id="174e0-156">Excel chama a função [xlAutoClose](xlautoclose.md) sempre que o XLL é desativado.</span><span class="sxs-lookup"><span data-stu-id="174e0-156">Excel calls the [xlAutoClose](xlautoclose.md) function whenever the XLL is deactivated.</span></span> <span data-ttu-id="174e0-157">O suplemento será desativado quando uma sessão do Excel é encerrada normalmente.</span><span class="sxs-lookup"><span data-stu-id="174e0-157">The add-in will be deactivated when an Excel session ends normally.</span></span> <span data-ttu-id="174e0-158">Se o usuário desativa o suplemento durante uma sessão do Excel, a função é chamada.</span><span class="sxs-lookup"><span data-stu-id="174e0-158">If the user deactivates the add-in during an Excel session, the function is called.</span></span> 
  
<span data-ttu-id="174e0-159">Você deve usar **xlAutoClose** para cancelar o registro de funções e comandos, liberar recursos, desfazer personalizações e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="174e0-159">You should use **xlAutoClose** to unregister functions and commands, release resources, undo customizations, and so on.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="174e0-160">Há um problema conhecido com o cancelamento de registro de funções e comandos.</span><span class="sxs-lookup"><span data-stu-id="174e0-160">There is a known issue with the unregistration of functions and commands.</span></span> <span data-ttu-id="174e0-161">Para obter mais informações, consulte [Problemas conhecidos no desenvolvimento de XLL do Excel](known-issues-in-excel-xll-development.md).</span><span class="sxs-lookup"><span data-stu-id="174e0-161">For more information, see [Known Issues in Excel XLL Development](known-issues-in-excel-xll-development.md).</span></span> 
  
### <a name="xlautoadd"></a><span data-ttu-id="174e0-162">xlAutoAdd</span><span class="sxs-lookup"><span data-stu-id="174e0-162">xlAutoAdd</span></span>

<span data-ttu-id="174e0-163">Excel chama a [função xlAutoAdd](xlautoadd.md) sempre que o usuário ativa o XLL durante uma sessão do Excel usando o Gerenciador de suplemento.</span><span class="sxs-lookup"><span data-stu-id="174e0-163">Excel calls the [xlAutoAdd function](xlautoadd.md) whenever the user activates the XLL during an Excel session by using the Add-In Manager.</span></span> <span data-ttu-id="174e0-164">Essa função não é chamada quando o Excel é iniciado e carrega um suplemento pré-instalado.</span><span class="sxs-lookup"><span data-stu-id="174e0-164">This function is not called when Excel starts and loads a preinstalled add-in.</span></span> 
  
<span data-ttu-id="174e0-165">Você pode usar esta função para exibir uma caixa de diálogo personalizada que informa ao usuário que o suplemento foi ativado, para ler ou gravar no registro ou para verificar as informações de licenciamento.</span><span class="sxs-lookup"><span data-stu-id="174e0-165">You can use this function to display a custom dialog box that tells the user that the add-in has been activated, to read from or write to the registry, or to check licensing information.</span></span>
  
### <a name="xlautoremove"></a><span data-ttu-id="174e0-166">xlAutoRemove</span><span class="sxs-lookup"><span data-stu-id="174e0-166">xlAutoRemove</span></span>

<span data-ttu-id="174e0-167">Excel chama a função [xlAutoRemove](xlautoremove.md) sempre que o usuário desativa o XLL durante uma sessão do Excel usando o Gerenciador de suplemento.</span><span class="sxs-lookup"><span data-stu-id="174e0-167">Excel calls the [xlAutoRemove](xlautoremove.md) function whenever the user deactivates the XLL during an Excel session by using the Add-In Manager.</span></span> <span data-ttu-id="174e0-168">Essa função não é chamada quando uma sessão do Excel é fechado, normalmente ou modo anormal, com o suplemento instalado.</span><span class="sxs-lookup"><span data-stu-id="174e0-168">This function is not called when an Excel session closes, normally or abnormally, with the add-in installed.</span></span> 
  
<span data-ttu-id="174e0-169">Você pode usar esta função para exibir uma caixa de diálogo personalizada que informa ao usuário que o suplemento foi desativado, ou para ler ou gravar no registro.</span><span class="sxs-lookup"><span data-stu-id="174e0-169">You can use this function to display a custom dialog box that tells the user that the add-in has been deactivated, or to read from or write to the registry.</span></span>
  
### <a name="xladdinmanagerinfoxladdinmanagerinfo12"></a><span data-ttu-id="174e0-170">xlAddInManagerInfo/xlAddInManagerInfo12</span><span class="sxs-lookup"><span data-stu-id="174e0-170">xlAddInManagerInfo/xlAddInManagerInfo12</span></span>

<span data-ttu-id="174e0-171">Excel chama a função [xlAddInManagerInfo](xladdinmanagerinfo-xladdinmanagerinfo12.md) quando o Gerenciador de suplementos é invocado pela primeira vez em uma sessão do Excel.</span><span class="sxs-lookup"><span data-stu-id="174e0-171">Excel calls the [xlAddInManagerInfo](xladdinmanagerinfo-xladdinmanagerinfo12.md) function when the Add-in Manager is invoked for the first time in an Excel session.</span></span> <span data-ttu-id="174e0-172">Se o Excel passa um argumento igual a 1, essa função deve retornar uma cadeia de caracteres (geralmente, o nome do add-in); Caso contrário, ele deverá retornar **#VALUE!**.</span><span class="sxs-lookup"><span data-stu-id="174e0-172">If Excel passes an argument equal to 1, this function should return a string (typically, the name of the add-in); otherwise, it should return **#VALUE!**.</span></span>
  
<span data-ttu-id="174e0-173">Iniciando no Excel 2007, Excel chama a função **xlAddInManagerInfo12** em preferência a função **xlAddInManagerInfo** se ele é exportado pelo XLL.</span><span class="sxs-lookup"><span data-stu-id="174e0-173">Starting in Excel 2007, Excel calls the **xlAddInManagerInfo12** function in preference to the **xlAddInManagerInfo** function if it is exported by the XLL.</span></span> <span data-ttu-id="174e0-174">A função **xlAddInManagerInfo12** deve funcionar da mesma maneira como a função **xlAddInManagerInfo** para evitar específicos da versão diferenças no comportamento da XLL.</span><span class="sxs-lookup"><span data-stu-id="174e0-174">The **xlAddInManagerInfo12** function should work in the same way as the **xlAddInManagerInfo** function to avoid version-specific differences in the behavior of the XLL.</span></span> <span data-ttu-id="174e0-175">A função **xlAddInManagerInfo12** deve retornar um tipo de dados **XLOPER12** , enquanto a função **xlAddInManagerInfo** deve retornar um tipo de dados **XLOPER** .</span><span class="sxs-lookup"><span data-stu-id="174e0-175">The **xlAddInManagerInfo12** function should return an **XLOPER12** data type, whereas the **xlAddInManagerInfo** function should return an **XLOPER** data type.</span></span> 
  
### <a name="xlautoregisterxlautoregister12"></a><span data-ttu-id="174e0-176">xlAutoRegister/xlAutoRegister12</span><span class="sxs-lookup"><span data-stu-id="174e0-176">xlAutoRegister/xlAutoRegister12</span></span>

<span data-ttu-id="174e0-177">Excel chama a função [xlAutoRegister](xlautoregister-xlautoregister12.md) sempre que foi feita uma chamada para a função XLM **registrar**ou a função equivalente [xlfRegister](xlfregister-form-1.md) de API C, com o retorno e os tipos de argumento ausentes para a função que está sendo registrada.</span><span class="sxs-lookup"><span data-stu-id="174e0-177">Excel calls the [xlAutoRegister](xlautoregister-xlautoregister12.md) function whenever a call has been made to the XLM function **REGISTER**, or the C API equivalent [xlfRegister](xlfregister-form-1.md) function, with the return and argument types missing for the function being registered.</span></span> <span data-ttu-id="174e0-178">A função **xlAutoRegister** permite que o XLL pesquisar seus listas internas de funções exportadas e comandos para registrar a função com o argumento e retornar tipos especificados.</span><span class="sxs-lookup"><span data-stu-id="174e0-178">The **xlAutoRegister** function allows the XLL to search its internal lists of exported functions and commands to register the function with the argument and return the specified types.</span></span> 
  
<span data-ttu-id="174e0-179">Iniciando no Excel 2007, Excel chama a função **xlAddInRegister12** em preferência a função **xlAddInRegister** se ele é exportado pelo XLL.</span><span class="sxs-lookup"><span data-stu-id="174e0-179">Starting in Excel 2007, Excel calls the **xlAddInRegister12** function in preference to the **xlAddInRegister** function if it is exported by the XLL.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="174e0-180">Se **xlAddInRegister**/ **xlAddInRegister12** tentam registrar a função sem fornecer o argumento e retornar tipos, uma recursiva chamar loop ocorre que eventualmente estourar a pilha de chamada e faz com que o Excel fechar ou parar respondendo.</span><span class="sxs-lookup"><span data-stu-id="174e0-180">If **xlAddInRegister**/ **xlAddInRegister12** tries to register the function without supplying the argument and return types, a recursive calling loop occurs that eventually overflows the call stack and causes Excel to close or stop responding.</span></span> 
  
### <a name="xlautofreexlautofree12"></a><span data-ttu-id="174e0-181">xlAutoFree/xlAutoFree12</span><span class="sxs-lookup"><span data-stu-id="174e0-181">xlAutoFree/xlAutoFree12</span></span>

<span data-ttu-id="174e0-182">Excel chama a função [xlAutoFree/xlAutoFree12](xlautofree-xlautofree12.md) logo depois que uma função de planilha XLL retorna **XLOPER**/ o tipo de dados**XLOPER12** com um sinalizador definido que informa que o Excel não há memória que o XLL precisa release.</span><span class="sxs-lookup"><span data-stu-id="174e0-182">Excel calls the [xlAutoFree/xlAutoFree12](xlautofree-xlautofree12.md) function just after an XLL worksheet function returns an **XLOPER**/ **XLOPER12** data type with a flag set that tells Excel there is memory that the XLL still needs to release.</span></span> <span data-ttu-id="174e0-183">Isso permite que o XLL retornar alocadas dinamicamente matrizes, cadeias de caracteres e as referências externas à planilha sem vazamento de memória.</span><span class="sxs-lookup"><span data-stu-id="174e0-183">This enables the XLL to return dynamically allocated arrays, strings, and external references to the worksheet without memory leaks.</span></span> <span data-ttu-id="174e0-184">Iniciando no Excel 2007, o tipo de dados **XLOPER12** é suportado.</span><span class="sxs-lookup"><span data-stu-id="174e0-184">Starting in Excel 2007, the **XLOPER12** data type is supported.</span></span> <span data-ttu-id="174e0-185">Para saber mais, consulte [Memory Management in Excel](memory-management-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="174e0-185">For more information, see [Memory Management in Excel](memory-management-in-excel.md).</span></span>
  
> [!NOTE]
> <span data-ttu-id="174e0-186">Iniciando no Excel 2007, quando Excel está configurado para usar o recálculo de planilha multithreaded, o **xlAutoFree**/ **xlAutoFree12** função é chamada no mesmo thread que foi usado apenas para chamar a função que retornados a ele.</span><span class="sxs-lookup"><span data-stu-id="174e0-186">Starting in Excel 2007, when Excel is configured to use multithreaded worksheet recalculation, the **xlAutoFree**/ **xlAutoFree12** function is called on the same thread that was just used to call the function that returned it.</span></span> <span data-ttu-id="174e0-187">A chamada para **xlAutoFree**/ **xlAutoFree12** sempre é feita antes de alguma célula da planilha subsequentes é avaliada naquele segmento.</span><span class="sxs-lookup"><span data-stu-id="174e0-187">The call to **xlAutoFree**/ **xlAutoFree12** is always made before any subsequent worksheet cells are evaluated on that thread.</span></span> <span data-ttu-id="174e0-188">Isso simplifica o design de thread-safe em seu XLL.</span><span class="sxs-lookup"><span data-stu-id="174e0-188">This simplifies thread-safe design in your XLL.</span></span> <span data-ttu-id="174e0-189">Para obter mais informações, consulte [Multithreaded recálculo no Excel](multithreaded-recalculation-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="174e0-189">For more information, see [Multithreaded Recalculation in Excel](multithreaded-recalculation-in-excel.md).</span></span> 
  
### <a name="creating-64-bit-xlls"></a><span data-ttu-id="174e0-190">Criando XLLs de 64 bits</span><span class="sxs-lookup"><span data-stu-id="174e0-190">Creating 64-bit XLLs</span></span>

<span data-ttu-id="174e0-191">Excel e funções definidas pelo usuário podem ser executados em sistemas operacionais de 64 bits para aproveitar os benefícios de desempenho sobre os sistemas operacionais de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="174e0-191">Excel and user-defined functions can run on 64-bit operating systems to take advantage of performance benefits over 32-bit operating systems.</span></span> <span data-ttu-id="174e0-192">Excel passa valores nas estruturas **XLOPER12** que incluem informações sobre os tipos de dados.</span><span class="sxs-lookup"><span data-stu-id="174e0-192">Excel passes values in **XLOPER12** structures that include information about the types for the data.</span></span> <span data-ttu-id="174e0-193">Tenha cuidado ao converter entre valores na estrutura **XLOPER12** e tipos nativos como **int** ou ponteiros para preservar os valores no tipo de maior.</span><span class="sxs-lookup"><span data-stu-id="174e0-193">Be careful when you convert between values in the **XLOPER12** structure and native types like **int** or pointers to preserve the values in the larger type.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="174e0-194">Confira também</span><span class="sxs-lookup"><span data-stu-id="174e0-194">See also</span></span>



[<span data-ttu-id="174e0-195">Chamar funções de XLL no Assistente de função ou nas caixas de diálogo Substituir</span><span class="sxs-lookup"><span data-stu-id="174e0-195">Call XLL Functions from the Function Wizard or Replace Dialog Boxes</span></span>](how-to-call-xll-functions-from-the-function-wizard-or-replace-dialog-boxes.md)
  
[<span data-ttu-id="174e0-196">Gerenciador de Suplemento e Funções da Interface XLL</span><span class="sxs-lookup"><span data-stu-id="174e0-196">Add-in Manager and XLL Interface Functions</span></span>](add-in-manager-and-xll-interface-functions.md)
  
[<span data-ttu-id="174e0-197">Desenvolvimento de XLLs do Excel</span><span class="sxs-lookup"><span data-stu-id="174e0-197">Developing Excel XLLs</span></span>](developing-excel-xlls.md)

