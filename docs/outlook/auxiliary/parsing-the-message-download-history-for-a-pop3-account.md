---
title: Analisar o histórico de download de mensagens de uma conta POP3
manager: soliver
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
localization_priority: Normal
ms.assetid: 394e1430-04d6-4d61-be13-eb695309fa73
description: Este tópico descreve a estrutura do BLOB POP3 que representa o histórico de download de mensagens de uma conta POP3, para identificar as mensagens que foram baixadas ou excluídas dessa conta.
ms.openlocfilehash: ffed3178e4e8b45f17fc335575a7febd77d40902
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19766041"
---
# <a name="parsing-the-message-download-history-for-a-pop3-account"></a><span data-ttu-id="ba55b-103">Analisar o histórico de download de mensagens de uma conta POP3</span><span class="sxs-lookup"><span data-stu-id="ba55b-103">Parsing the message download history for a POP3 account</span></span>

<span data-ttu-id="ba55b-104">Este tópico descreve a estrutura do BLOB POP3 que representa o histórico de download de mensagens de uma conta POP3, para identificar as mensagens que foram baixadas ou excluídas dessa conta.</span><span class="sxs-lookup"><span data-stu-id="ba55b-104">This topic describes the structure of the POP3 BLOB that represents the message download history of a POP3 account, to identify the messages that have been downloaded or deleted on that account.</span></span>

<span data-ttu-id="ba55b-105"><a name="OL15Con_AuxRef_ParsingMsgsHistory_WhyParseHistory"> </a></span><span class="sxs-lookup"><span data-stu-id="ba55b-105"></span></span>

## <a name="why-parse-the-message-download-history"></a><span data-ttu-id="ba55b-106">Por que analisar o histórico de download de mensagens?</span><span class="sxs-lookup"><span data-stu-id="ba55b-106">Why parse the message download history?</span></span>

<span data-ttu-id="ba55b-107">O provedor de Post Office Protocol (POP) para o Outlook permite que os usuários para recuperar e baixar novas mensagens de email no seu dispositivo local e subsequentemente deixar ou excluir essas mensagens de email no servidor de email.</span><span class="sxs-lookup"><span data-stu-id="ba55b-107">The Post Office Protocol (POP) provider for Outlook allows users to retrieve and download new email messages on their local device, and subsequently to leave or delete these email messages on the mail server.</span></span> <span data-ttu-id="ba55b-108">Quando o cliente de email verifica novas mensagens baixar, ele deve ser capaz de identificar e baixe somente as novas mensagens para essa caixa de entrada.</span><span class="sxs-lookup"><span data-stu-id="ba55b-108">When the mail client checks for new messages to download, it has to be able to identify and download only the new messages for that Inbox.</span></span> <span data-ttu-id="ba55b-109">O cliente de email faz isso usando primeiro o comando UIDL (ID exclusiva listando) para obter um mapa de cada mensagem que nunca foi entregue para essa caixa de entrada para um identificador exclusivo (UID).</span><span class="sxs-lookup"><span data-stu-id="ba55b-109">The mail client does this by first using the UIDL (Unique ID Listing) command to obtain a map of each message that has ever been delivered to that Inbox to a unique identifier (UID).</span></span> <span data-ttu-id="ba55b-110">O cliente também obtém o histórico de download da mensagem para mensagens que foram baixadas ou excluídas da caixa de entrada em que o cliente.</span><span class="sxs-lookup"><span data-stu-id="ba55b-110">The client also gets the message download history for messages that have been downloaded or deleted for the Inbox on that client.</span></span> <span data-ttu-id="ba55b-111">Usando o mapa UID da mensagem e o histórico de download, o cliente pode, em seguida, identifique essas mensagens ausentes do histórico de como novo e, portanto, deve ser baixado.</span><span class="sxs-lookup"><span data-stu-id="ba55b-111">Using the message UID map and download history, the client can then identify those messages that are absent from the history as new and, hence, should be downloaded.</span></span>
  
<span data-ttu-id="ba55b-112">Para obter as mensagens de histórico de download para uma caixa de entrada:</span><span class="sxs-lookup"><span data-stu-id="ba55b-112">To get the messages download history for an Inbox:</span></span>
  
- <span data-ttu-id="ba55b-113">Siga as etapas em [localizar a mensagem baixar o histórico de uma conta POP3](locating-the-message-download-history-for-a-pop3-account.md) para localizar a propriedade [PidTagAttachDataBinary](http://msdn.microsoft.com/library/3b0a8b28-863e-4b96-a4c0-fdb8f40555b9%28Office.15%29.aspx) , que contém um objeto binário grande (BLOB) que representa o histórico de mensagens para uma conta POP3.</span><span class="sxs-lookup"><span data-stu-id="ba55b-113">Follow the steps in [Locating the message download history for a POP3 account](locating-the-message-download-history-for-a-pop3-account.md) to find the [PidTagAttachDataBinary](http://msdn.microsoft.com/library/3b0a8b28-863e-4b96-a4c0-fdb8f40555b9%28Office.15%29.aspx) property, which contains a binary large object (BLOB) that represents the message history for a POP3 account.</span></span> 
    
- <span data-ttu-id="ba55b-114">Leia este tópico, que descreve a estrutura do BLOB e mostra um exemplo BLOB para identificar mensagens que foram baixadas ou excluídas da caixa de entrada da conta POP3.</span><span class="sxs-lookup"><span data-stu-id="ba55b-114">Read this topic, which describes the structure of the BLOB, and shows an example BLOB to identify messages that have been downloaded or deleted for the Inbox of the POP3 account.</span></span>

<span data-ttu-id="ba55b-115"><a name="OL15Con_AuxRef_ParsingMsgsHistory_BLOBStructure"> </a></span><span class="sxs-lookup"><span data-stu-id="ba55b-115"></span></span>

## <a name="pop-blob-structure"></a><span data-ttu-id="ba55b-116">Estrutura de BLOB POP</span><span class="sxs-lookup"><span data-stu-id="ba55b-116">POP BLOB structure</span></span>

<span data-ttu-id="ba55b-117">A estrutura de BLOB POP, conforme descrito na tabela 1, começa com dois campos, **versão** e **contagem**, seguido por um número de **contagem** de marcas de recurso, cada um deles é terminada em nulo.</span><span class="sxs-lookup"><span data-stu-id="ba55b-117">The POP BLOB structure, as described in Table 1, begins with two fields, **Version** and **Count**, followed by a **Count** number of resource tags, each of which is null-terminated.</span></span> 
  
<span data-ttu-id="ba55b-118">**Tabela 1. Estrutura do BLOB que representa a mensagem baixar o histórico de uma conta POP3**</span><span class="sxs-lookup"><span data-stu-id="ba55b-118">**Table 1. Structure of the BLOB that represents the message download history of a POP3 account**</span></span>

|<span data-ttu-id="ba55b-119">**Campo no BLOB**</span><span class="sxs-lookup"><span data-stu-id="ba55b-119">**Field in BLOB**</span></span>|<span data-ttu-id="ba55b-120">**Size**</span><span class="sxs-lookup"><span data-stu-id="ba55b-120">**Size**</span></span>|<span data-ttu-id="ba55b-121">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="ba55b-121">**Description**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="ba55b-122">**Versão**</span><span class="sxs-lookup"><span data-stu-id="ba55b-122">**Version**</span></span> <br/> |<span data-ttu-id="ba55b-123">2 bytes</span><span class="sxs-lookup"><span data-stu-id="ba55b-123">2 bytes</span></span>  <br/> |<span data-ttu-id="ba55b-124">Deve ser 3 (**PBLOB_VERSION_NUM**).</span><span class="sxs-lookup"><span data-stu-id="ba55b-124">Must be 3 (**PBLOB_VERSION_NUM**).</span></span>  <br/> |
|<span data-ttu-id="ba55b-125">**Count**</span><span class="sxs-lookup"><span data-stu-id="ba55b-125">**Count**</span></span> <br/> |<span data-ttu-id="ba55b-126">2 bytes</span><span class="sxs-lookup"><span data-stu-id="ba55b-126">2 bytes</span></span>  <br/> |<span data-ttu-id="ba55b-127">O número de marcas de recurso neste BLOB.</span><span class="sxs-lookup"><span data-stu-id="ba55b-127">The number of resource tags in this BLOB.</span></span>  <br/> |
|<span data-ttu-id="ba55b-128">Marca de recurso</span><span class="sxs-lookup"><span data-stu-id="ba55b-128">Resource tag</span></span>  <br/> |<span data-ttu-id="ba55b-129">Variável</span><span class="sxs-lookup"><span data-stu-id="ba55b-129">Variable</span></span>  <br/> |<span data-ttu-id="ba55b-130">0 ou mais terminada em nulo UTF-8 cadeias de caracteres que codificar as marcas de recurso.</span><span class="sxs-lookup"><span data-stu-id="ba55b-130">0 or more null-terminated UTF-8 strings that encode the resource tags.</span></span> <span data-ttu-id="ba55b-131">O número de sequências de caracteres terminada em nulo deve corresponder a **contagem**.</span><span class="sxs-lookup"><span data-stu-id="ba55b-131">The number of null-terminated strings must match **Count**.</span></span>  <br/> |
   
<span data-ttu-id="ba55b-132">Cada marca de recurso Especifica a operação que será aplicada a uma mensagem, alguns metadados de data / hora sobre a operação e codifica o UID da mensagem.</span><span class="sxs-lookup"><span data-stu-id="ba55b-132">Each resource tag specifies the operation that is applied to a message, some date-time metadata about the operation, and encodes the UID of the message.</span></span> <span data-ttu-id="ba55b-133">O formato de uma cadeia de caracteres de marca de recurso é decomposto da seguinte maneira e é ainda mais explicado na tabela 2.</span><span class="sxs-lookup"><span data-stu-id="ba55b-133">The format of a resource tag string is broken down as follows, and is further explained in Table 2.</span></span> 
  
`Ocyyyymmddhhmmssuuu...`
  
<span data-ttu-id="ba55b-134">**Tabela 2. Estrutura de uma marca de recurso**</span><span class="sxs-lookup"><span data-stu-id="ba55b-134">**Table 2. Structure of a resource tag**</span></span>

|<span data-ttu-id="ba55b-135">**Campo em uma marca de recurso**</span><span class="sxs-lookup"><span data-stu-id="ba55b-135">**Field in a resource tag**</span></span>|<span data-ttu-id="ba55b-136">**Size**</span><span class="sxs-lookup"><span data-stu-id="ba55b-136">**Size**</span></span>|<span data-ttu-id="ba55b-137">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="ba55b-137">**Description**</span></span>|
|:-----|:-----|:-----|
| `O` <br/> |<span data-ttu-id="ba55b-138">1 caractere</span><span class="sxs-lookup"><span data-stu-id="ba55b-138">1 character</span></span>  <br/> |<span data-ttu-id="ba55b-139">A operação é executada na mensagem de email.</span><span class="sxs-lookup"><span data-stu-id="ba55b-139">The operation performed on the email message.</span></span> <span data-ttu-id="ba55b-140">O valor deve ser "+", "-", ou "&amp;", que indica uma get bem-sucedida, excluir ou operação get-e-delete, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="ba55b-140">The value must be "+", "-", or "&amp;", which indicates a successful get, delete, or get-and-delete operation, respectively.</span></span>  <br/> |
| `c` <br/> |<span data-ttu-id="ba55b-141">1 caractere</span><span class="sxs-lookup"><span data-stu-id="ba55b-141">1 character</span></span>  <br/> |<span data-ttu-id="ba55b-142">A parte do conteúdo da mensagem envolvido na operação.</span><span class="sxs-lookup"><span data-stu-id="ba55b-142">The part of the message content involved in the operation.</span></span> <span data-ttu-id="ba55b-143">O valor deve ser "", "h" ou "b", que indica o conteúdo de nenhum, cabeçalho ou corpo, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="ba55b-143">The value must be " ", "h", or "b", which indicates the content of none, header, or body, respectively.</span></span>  <br/> |
| `yyyy` <br/> |<span data-ttu-id="ba55b-144">4 caracteres</span><span class="sxs-lookup"><span data-stu-id="ba55b-144">4 characters</span></span>  <br/> |<span data-ttu-id="ba55b-145">O ano com quatro dígitos da operação.</span><span class="sxs-lookup"><span data-stu-id="ba55b-145">The four-digit year of the operation.</span></span>  <br/> |
| `MM` <br/> |<span data-ttu-id="ba55b-146">2 caracteres</span><span class="sxs-lookup"><span data-stu-id="ba55b-146">2 characters</span></span>  <br/> |<span data-ttu-id="ba55b-147">O mês com dois dígitos da operação.</span><span class="sxs-lookup"><span data-stu-id="ba55b-147">The two-digit month of the operation.</span></span>  <br/> |
| `dd` <br/> |<span data-ttu-id="ba55b-148">2 caracteres</span><span class="sxs-lookup"><span data-stu-id="ba55b-148">2 characters</span></span>  <br/> |<span data-ttu-id="ba55b-149">O dia de dois dígitos da operação.</span><span class="sxs-lookup"><span data-stu-id="ba55b-149">The two-digit day of the operation.</span></span>  <br/> |
| `hh` <br/> |<span data-ttu-id="ba55b-150">2 caracteres</span><span class="sxs-lookup"><span data-stu-id="ba55b-150">2 characters</span></span>  <br/> |<span data-ttu-id="ba55b-151">A hora de dois dígitos da operação.</span><span class="sxs-lookup"><span data-stu-id="ba55b-151">The two-digit hour of the operation.</span></span>  <br/> |
| `mm` <br/> |<span data-ttu-id="ba55b-152">2 caracteres</span><span class="sxs-lookup"><span data-stu-id="ba55b-152">2 characters</span></span>  <br/> |<span data-ttu-id="ba55b-153">O minuto de dois dígitos da operação.</span><span class="sxs-lookup"><span data-stu-id="ba55b-153">The two-digit minute of the operation.</span></span>  <br/> |
| `ss` <br/> |<span data-ttu-id="ba55b-154">2 caracteres</span><span class="sxs-lookup"><span data-stu-id="ba55b-154">2 characters</span></span>  <br/> |<span data-ttu-id="ba55b-155">O segundo com dois dígitos da operação.</span><span class="sxs-lookup"><span data-stu-id="ba55b-155">The two-digit second of the operation.</span></span>  <br/> |
| `uuu…` <br/> |<span data-ttu-id="ba55b-156">Comprimento variável</span><span class="sxs-lookup"><span data-stu-id="ba55b-156">Variable length</span></span>  <br/> |<span data-ttu-id="ba55b-157">O UID codificado de uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="ba55b-157">The encoded UID of a message.</span></span>  <br/> |

<span data-ttu-id="ba55b-158"><a name="OL15Con_AuxRef_ParsingMsgsHistory_Example"> </a></span><span class="sxs-lookup"><span data-stu-id="ba55b-158"></span></span>

## <a name="example"></a><span data-ttu-id="ba55b-159">Exemplo</span><span class="sxs-lookup"><span data-stu-id="ba55b-159">Example</span></span>

<span data-ttu-id="ba55b-160">A Figura 1 mostra um exemplo de um BLOB que representa o histórico de download de mensagens de uma conta POP.</span><span class="sxs-lookup"><span data-stu-id="ba55b-160">Figure 1 shows an example of a BLOB that represents the message download history of a POP account.</span></span> 
  
<span data-ttu-id="ba55b-161">**Figura 1. Estrutura de BLOB de exemplo para a mensagem de baixar o histórico de uma conta POP3**</span><span class="sxs-lookup"><span data-stu-id="ba55b-161">**Figure 1. Example BLOB structure for the message download history of a POP3 account**</span></span>

![BLOB for messages download history of POP3 account](media/OL15Con_AuxRef_ParsingMsgsHistory_Blob.gif)
  
<span data-ttu-id="ba55b-163">Com base na estrutura descrita na tabela 1 e a tabela 2, esse BLOB representa o histórico de download, 23 de mensagens de email.</span><span class="sxs-lookup"><span data-stu-id="ba55b-163">Based on the structure described in Table 1 and Table 2, this BLOB represents the download history of 23 email messages.</span></span>
  
<span data-ttu-id="ba55b-164">Para analisar o UID bruto na marca de cada recurso, esteja ciente de que o UID segue esta codificação: caracteres em um UID são principalmente caracteres alfanuméricos, e cada caractere não-alfanuméricos precedido pelo caractere ASCII "$" (0x24).</span><span class="sxs-lookup"><span data-stu-id="ba55b-164">To parse the raw UID in each resource tag, be aware that the UID follows this encoding: characters in a UID are mostly alphanumeric characters, and each non-alphanumeric character is preceded by the ASCII character "$" (0x24).</span></span> <span data-ttu-id="ba55b-165">Para que o ASCII caracteres $2d representam o não alfanuméricos caractere "-".</span><span class="sxs-lookup"><span data-stu-id="ba55b-165">So the ASCII characters $2d represent the non-alphanumeric character "-".</span></span> <span data-ttu-id="ba55b-166">A Figura 2 mostra um exemplo de como converter primeiro o UID bruto na marca de recurso 1 à representação ASCII, em seguida, convertendo qualquer caractere não-alfanuméricos precedido por "$" para produzir o UID real:</span><span class="sxs-lookup"><span data-stu-id="ba55b-166">Figure 2 shows an example of first converting the raw UID in resource tag 1 to the ASCII representation, then converting any non-alphanumeric character preceded by "$" to produce the actual UID:</span></span>
  
`0BC535DB-EA63-11E1-A75C-00215AD7BB74`
  
<span data-ttu-id="ba55b-167">**Figura 2. Convertendo o UID bruto em uma marca de recurso para a mensagem real UID**</span><span class="sxs-lookup"><span data-stu-id="ba55b-167">**Figure 2. Converting the raw UID in a resource tag to the actual message UID**</span></span>

![Converting raw UID in BLOB to actual message UID](media/OL15Con_AuxRef_ParsingMsgsHistory_BlobRscTag.gif)
  
<span data-ttu-id="ba55b-169">Interpretar a marca de recurso 1 neste BLOB: a mensagem com o UID `0BC535DB-EA63-11E1-A75C-00215AD7BB74` foi recuperado com êxito em 6 de setembro de 2012, em 13:11:38.</span><span class="sxs-lookup"><span data-stu-id="ba55b-169">To interpret resource tag 1 in this BLOB: the message with the UID  `0BC535DB-EA63-11E1-A75C-00215AD7BB74` was successfully retrieved on September 6, 2012, at 13:11:38.</span></span> 
  
<span data-ttu-id="ba55b-170">Da mesma forma, você pode analisar as demais marcas de 22 de recurso para esse BLOB.</span><span class="sxs-lookup"><span data-stu-id="ba55b-170">You can similarly parse the remaining 22 resource tags for that BLOB.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="ba55b-171">Confira também</span><span class="sxs-lookup"><span data-stu-id="ba55b-171">See also</span></span>
<span data-ttu-id="ba55b-172"><a name="OL15Con_AuxRef_ParsingMsgsHistory_AdditionalRsc"> </a></span><span class="sxs-lookup"><span data-stu-id="ba55b-172"></span></span>

- [<span data-ttu-id="ba55b-173">Gerenciar o download de mensagens de contas POP3</span><span class="sxs-lookup"><span data-stu-id="ba55b-173">Managing message downloads for POP3 accounts</span></span>](managing-message-downloads-for-pop3-accounts.md)    
- [<span data-ttu-id="ba55b-174">Localizar o histórico de download de mensagens de uma conta POP3</span><span class="sxs-lookup"><span data-stu-id="ba55b-174">Locating the message download history for a POP3 account</span></span>](locating-the-message-download-history-for-a-pop3-account.md)    
- [<span data-ttu-id="ba55b-175">Analisar o histórico UIDL POP3</span><span class="sxs-lookup"><span data-stu-id="ba55b-175">Parsing the POP3 UIDL History</span></span>](http://blogs.msdn.com/b/stephen_griffin/archive/2012/12/04/parsing-the-pop3-uidl-history.aspx)
    

