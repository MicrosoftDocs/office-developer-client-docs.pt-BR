---
title: Identidade primária de MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 8787a873-6752-4b17-8ea3-8fed793e1371
description: 'Última modificação: 9 de março de 2015'
ms.openlocfilehash: de1fe8fd5ef5a6e79934478c62b2403c48f85b5e
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22565876"
---
# <a name="mapi-primary-identity"></a><span data-ttu-id="6a9e6-103">Identidade primária de MAPI</span><span class="sxs-lookup"><span data-stu-id="6a9e6-103">MAPI Primary Identity</span></span>

  
  
<span data-ttu-id="6a9e6-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="6a9e6-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="6a9e6-105">A maioria das sessões MAPI tem um provedor de serviço específico que fornece a identidade principal para a sessão.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-105">Most MAPI sessions have a particular service provider that supplies the primary identity for the session.</span></span> <span data-ttu-id="6a9e6-106">Normalmente, ele é um provedor de catálogo de endereços, que fornece a identidade por meio de uma de suas mensagens de objetos de usuário ou listas de distribuição.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-106">Typically, it is an address book provider, which supplies identity through one of its messaging user objects or distribution lists.</span></span> <span data-ttu-id="6a9e6-107">Na verdade, MAPI recomenda que os serviços de mensagem que inclui um provedor de catálogo de endereços usam um dos seus objetos referente à identidade do principal.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-107">In fact, MAPI recommends that message services that include an address book provider use one of its objects for the primary identity.</span></span> <span data-ttu-id="6a9e6-108">Quando um provedor de serviços que pertence a um serviço de mensagem fornece a identidade principal, todos os outros provedores de serviço no serviço de mensagem compartilham essa identidade.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-108">When a service provider that belongs to a message service supplies the primary identity, all of the other service providers in the message service share this identity.</span></span>
  
<span data-ttu-id="6a9e6-109">O MAPISVC. Arquivo de configuração INF possui entradas relacionadas à identidade no nível do provedor de serviço e serviço de mensagem.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-109">The MAPISVC.INF configuration file has entries relating to identity at both the message service and service provider level.</span></span> <span data-ttu-id="6a9e6-110">Seções do serviço de mensagem devem incluir uma entrada que afirma que se ou não o serviço pode fornecer a identidade principal; seções do provedor de serviço incluem uma entrada semelhante somente quando o provedor pode fornecer uma identidade.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-110">Message service sections must include an entry that states whether or not the service can supply the primary identity; service provider sections include a similar entry only when the provider can supply an identity.</span></span>
  
<span data-ttu-id="6a9e6-111">A tabela a seguir lista as entradas que aparecem no serviço de mensagem e seções de provedor de serviço no MAPISVC. Arquivo INF.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-111">The following table lists the entries that appear in the message service and service provider sections in the MAPISVC.INF file.</span></span>
  
|<span data-ttu-id="6a9e6-112">**Fornecedor de identidade primária**</span><span class="sxs-lookup"><span data-stu-id="6a9e6-112">**Primary identity supplier**</span></span>|<span data-ttu-id="6a9e6-113">**Configuração de PR_RESOURCE_FLAGS**</span><span class="sxs-lookup"><span data-stu-id="6a9e6-113">**PR_RESOURCE_FLAGS setting**</span></span>|
|:-----|:-----|
|<span data-ttu-id="6a9e6-114">Serviço de mensagem</span><span class="sxs-lookup"><span data-stu-id="6a9e6-114">Message service</span></span>  <br/> | `SERVICE_PRIMARY_IDENTITY` <br/> |
|<span data-ttu-id="6a9e6-115">Não, o serviço de mensagem</span><span class="sxs-lookup"><span data-stu-id="6a9e6-115">Not the message service</span></span>  <br/> | `SERVICE_NO_PRIMARY_IDENTITY` <br/> |
|<span data-ttu-id="6a9e6-116">Provedor de serviços</span><span class="sxs-lookup"><span data-stu-id="6a9e6-116">Service provider</span></span>  <br/> | `STATUS_PRIMARY_IDENTITY` <br/> |
   
<span data-ttu-id="6a9e6-117">Embora vários serviços de mensagem podem declarar a capacidade de fornecer a identidade de uma sessão principal, o serviço de apenas uma mensagem é selecionado para fazê-lo.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-117">Although multiple message services can declare their ability to provide a session's primary identity, only one message service is selected to do so.</span></span> <span data-ttu-id="6a9e6-118">Esta seleção pode ocorrer:</span><span class="sxs-lookup"><span data-stu-id="6a9e6-118">This selection can occur:</span></span>
  
- <span data-ttu-id="6a9e6-119">Quando um perfil é criado.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-119">When a profile is created.</span></span>
    
- <span data-ttu-id="6a9e6-120">Quando um cliente chama **IMsgServiceAdmin::SetPrimaryIdentity** para estabelecer explicitamente um serviço de mensagem específica como um provedor de identidade a sessão.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-120">When a client calls **IMsgServiceAdmin::SetPrimaryIdentity** to explicitly establish a particular message service as the provider of the session identity.</span></span> <span data-ttu-id="6a9e6-121">Para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-121">For more information.</span></span> <span data-ttu-id="6a9e6-122">Consulte [IMsgServiceAdmin::SetPrimaryIdentity](imsgserviceadmin-setprimaryidentity.md).</span><span class="sxs-lookup"><span data-stu-id="6a9e6-122">See [IMsgServiceAdmin::SetPrimaryIdentity](imsgserviceadmin-setprimaryidentity.md).</span></span>
    
<span data-ttu-id="6a9e6-123">Quando um perfil é criado, MAPI designa o primeiro serviço de mensagem a ser configurado que inclui um provedor com o sinalizador STATUS_PRIMARY_IDENTITY definido em sua propriedade **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) para fornecer a identidade principal .</span><span class="sxs-lookup"><span data-stu-id="6a9e6-123">When a profile is created, MAPI designates the first message service to be configured that includes a provider with the STATUS_PRIMARY_IDENTITY flag set in its **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) property to supply the primary identity.</span></span> <span data-ttu-id="6a9e6-124">Dentro do serviço de mensagem designados, o primeiro provedor a ser configurado com esse sinalizador definido de recursos é escolhido para fornecer a identidade do serviço.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-124">Within the designated message service, the first provider to be configured with this resource flag set is chosen to provide the identity for the service.</span></span> <span data-ttu-id="6a9e6-125">O sinalizador STATUS_PRIMARY_IDENTITY está desmarcado para todos os outros provedores no serviço de designada e outros serviços de mensagem no perfil.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-125">The STATUS_PRIMARY_IDENTITY flag is cleared for all other providers in the designated service and other message services in the profile.</span></span> <span data-ttu-id="6a9e6-126">Se a qualquer momento, o provedor fornecendo identidade primária for removido do perfil, MAPI atribui a função que pode fornecer a identidade para o próximo provedor a ser configurado.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-126">If at any time the provider supplying primary identity is removed from the profile, MAPI assigns the role to the next provider to be configured that can supply identity.</span></span> <span data-ttu-id="6a9e6-127">Isso é determinado pela aparência do `PR_RESOURCE_FLAGS=STATUS_PRIMARY_IDENTITY` entrada na seção do provedor em MAPISVC.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-127">This is determined by the appearance of the  `PR_RESOURCE_FLAGS=STATUS_PRIMARY_IDENTITY` entry in the provider's section in MAPISVC.INF.</span></span> 
  
<span data-ttu-id="6a9e6-128">Quando um cliente chama o método de **IMsgServiceAdmin::SetPrimaryIdentity** do serviço de uma mensagem, ela especifica a MAPIUID para um provedor de serviço dentro do serviço de destino.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-128">When a client calls a message service's **IMsgServiceAdmin::SetPrimaryIdentity** method, it specifies the MAPIUID for a service provider within the target service.</span></span> <span data-ttu-id="6a9e6-129">Para obter mais informações, consulte [MAPIUID](mapiuid.md).</span><span class="sxs-lookup"><span data-stu-id="6a9e6-129">For more information, see [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="6a9e6-130">O provedor de serviço representado pelo **MAPIUID** é atribuído ao fornecer a identidade principal para o serviço de mensagem e para a sessão e todos os outros provedores no serviço compartilharão essa identidade.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-130">The service provider represented by the **MAPIUID** is assigned to supply the primary identity for the message service and for the session, and all of the other providers in the service will share this identity.</span></span> 
  
<span data-ttu-id="6a9e6-131">Cada provedor no serviço de mensagem responsável por fornecer a identidade principal atualiza sua linha da tabela de status para incluir as propriedades a seguir.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-131">Every provider in the message service responsible for supplying the primary identity updates its row in the status table to include the following properties.</span></span>
  
|<span data-ttu-id="6a9e6-132">**Propriedade identity principal**</span><span class="sxs-lookup"><span data-stu-id="6a9e6-132">**Primary identity property**</span></span>|<span data-ttu-id="6a9e6-133">**Definida como**</span><span class="sxs-lookup"><span data-stu-id="6a9e6-133">**Set to**</span></span>|
|:-----|:-----|
|<span data-ttu-id="6a9e6-134">**PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6a9e6-134">**PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="6a9e6-135">Nome para exibição do objeto fornecendo a identidade principal.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-135">Display name of the object supplying the primary identity.</span></span>  <br/> |
|<span data-ttu-id="6a9e6-136">**PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6a9e6-136">**PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="6a9e6-137">Chave de pesquisa para o objeto fornecendo a identidade principal.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-137">Search key for the object supplying the primary identity.</span></span>  <br/> |
|<span data-ttu-id="6a9e6-138">**PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="6a9e6-138">**PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="6a9e6-139">Identificador de entrada para o objeto fornecendo a identidade principal.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-139">Entry identifier for the object supplying the primary identity.</span></span>  <br/> |
   
 <span data-ttu-id="6a9e6-140">**Para recuperar o identificador de entrada para o objeto fornecendo a identidade principal**</span><span class="sxs-lookup"><span data-stu-id="6a9e6-140">**To retrieve the entry identifier for the object supplying the primary identity**</span></span>
  
- <span data-ttu-id="6a9e6-141">Chame o método **IMAPISession::QueryIdentity** .</span><span class="sxs-lookup"><span data-stu-id="6a9e6-141">Call the **IMAPISession::QueryIdentity** method.</span></span> <span data-ttu-id="6a9e6-142">Para obter mais informações, consulte [IMAPISession::QueryIdentity](imapisession-queryidentity.md).</span><span class="sxs-lookup"><span data-stu-id="6a9e6-142">For more information, see [IMAPISession::QueryIdentity](imapisession-queryidentity.md).</span></span> <span data-ttu-id="6a9e6-143">**QueryIdentity** procura na tabela de status para a linha que contém o valor STATUS_PRIMARY_IDENTITY em uma coluna **PR_RESOURCE_FLAGS** e retorna o correspondente **PR_IDENTITY_ENTRYID** como o identificador de entrada para o principal identidade.</span><span class="sxs-lookup"><span data-stu-id="6a9e6-143">**QueryIdentity** searches the status table for the row that contains the value STATUS_PRIMARY_IDENTITY in its **PR_RESOURCE_FLAGS** column and returns the corresponding **PR_IDENTITY_ENTRYID** as the entry identifier for the primary identity.</span></span> 
    

