---
title: Visão geral de objetos de suporte
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 5b062891-39ab-4334-9706-5b376719d5e4
description: '�ltima altera��o: s�bado, 23 de julho de 2011'
ms.openlocfilehash: 7f43a50d08daedc623fa1e4570eafa5d58be71f6
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22577433"
---
# <a name="support-object-overview"></a><span data-ttu-id="fb9a1-103">Visão geral de objetos de suporte</span><span class="sxs-lookup"><span data-stu-id="fb9a1-103">Support Object Overview</span></span>

  
  
<span data-ttu-id="fb9a1-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="fb9a1-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="fb9a1-105">MAPI representa um objeto de suporte, um objeto que implementa o [IMAPISupport: IUnknown](imapisupportiunknown.md) interface, para todos os provedores de serviço durante o logon e para todos os serviços de mensagem durante a configuração.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-105">MAPI furnishes a support object, an object that implements the [IMAPISupport : IUnknown](imapisupportiunknown.md) interface, for all service providers during logon and for all message services during configuration.</span></span> 
  
<span data-ttu-id="fb9a1-106">Objetos de suporte não estão acessíveis por clientes; eles são implementados pelo MAPI e chamados apenas por provedores de serviços.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-106">Support objects are not accessible by clients; they are implemented by MAPI and called only by service providers.</span></span> <span data-ttu-id="fb9a1-107">A interface **IMAPISupport** é especificada no arquivo de cabeçalho Mapispi.h.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-107">The **IMAPISupport** interface is specified in the Mapispi.h header file.</span></span> <span data-ttu-id="fb9a1-108">Seu identificador é IID_IMAPISup e seu tipo de ponteiro é LPMAPISUP.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-108">Its identifier is IID_IMAPISup and its pointer type is LPMAPISUP.</span></span> <span data-ttu-id="fb9a1-109">Sem propriedades MAPI são expostas pelos objetos de suporte.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-109">No MAPI properties are exposed by support objects.</span></span> 
  
<span data-ttu-id="fb9a1-110">Um provedor pode ser fornecido como um ou mais objetos de suporte, dependendo o número de vezes que MAPI faz o provedor de logon ou o número de vezes que é chamada de função de entrada de serviço de mensagem do provedor.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-110">A provider can be given one or more support objects, depending on the number of times MAPI logs the provider on or the number of times the provider's message service entry function is called.</span></span> <span data-ttu-id="fb9a1-111">Normalmente, um provedor será registrado pelo menos uma vez por sessão.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-111">Typically, a provider will be logged on at least once per session.</span></span> <span data-ttu-id="fb9a1-112">Provedores de transporte e o catálogo de endereço estão conectados toda vez que um cliente inicia uma sessão com uma entrada de perfil que solicita-los.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-112">Address book and transport providers are logged on every time a client starts a session with a profile entry that requests them.</span></span> <span data-ttu-id="fb9a1-113">Provedores de armazenamento de mensagem são registradas toda vez que um cliente chama o método [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md) .</span><span class="sxs-lookup"><span data-stu-id="fb9a1-113">Message store providers are logged on every time a client calls the [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md) method.</span></span> 
  
<span data-ttu-id="fb9a1-114">No caso de vários logons em uma sessão, você pode escolher tanto de reter e usar a cada objeto de suporte separadamente ou de reter e usar somente o primeiro, descartar cada objeto de suporte subsequentes.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-114">In the case of multiple logons in a session, you can choose either to retain and use each support object separately or to retain and use only the first, discarding each subsequent support object.</span></span> <span data-ttu-id="fb9a1-115">Para manter um objeto de suporte, chame seu método de **AddRef** .</span><span class="sxs-lookup"><span data-stu-id="fb9a1-115">To retain a support object, call its **IUnknown::AddRef** method.</span></span> <span data-ttu-id="fb9a1-116">Chamar **AddRef** em um objeto de suporte que você deseja reter durante uma sessão é extremamente importante; Se a chamada não for feita, o MAPI libera o objeto de suporte e libera sua memória.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-116">Calling **AddRef** on a support object that you want to retain throughout a session is extremely important; if the call is not made, MAPI releases the support object and frees its memory.</span></span> 
  
<span data-ttu-id="fb9a1-117">A finalidade do objeto suporte é fornecer implementações para um grande número de métodos normalmente usados pelos provedores.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-117">The purpose of the support object is to provide implementations for a fairly large number of methods commonly used by the providers.</span></span> <span data-ttu-id="fb9a1-118">Cada objeto de suporte também contém dados contextuais específicos para sua própria instância, como a sessão que o provedor está sendo executado no, a seção de perfil, que o provedor está usando e informações de erro para a sessão.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-118">Each support object also contains contextual data specific to its own instance, such as the session the provider is running in, the profile section the provider is using, and error information for the session.</span></span> 
  
<span data-ttu-id="fb9a1-119">Há quatro tipos diferentes de objetos de suporte: uma para cada tipo de provedor principais (catálogo de endereços, repositório de mensagem e transporte) e outra para suporte de configuração.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-119">There are four different types of support objects: one for each major provider type (address book, message store, and transport) and one for configuration support.</span></span> 
  
<span data-ttu-id="fb9a1-120">MAPI personaliza a cada objeto de suporte, incluindo implementações dos métodos que são relevantes para o seu uso.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-120">MAPI customizes each support object by including implementations of methods that are relevant for its usage.</span></span> <span data-ttu-id="fb9a1-121">Implementações de alguns métodos, como [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md), estão incluídas em todos os objetos de suporte.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-121">Implementations of some methods, such as [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md), are included in all support objects.</span></span> <span data-ttu-id="fb9a1-122">Implementações de outros métodos, como [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md), aplicam-se somente aos objetos de suporte específico.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-122">Implementations of other methods, such as [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md), apply only to particular support objects.</span></span> <span data-ttu-id="fb9a1-123">Somente o repositório de mensagens e os provedores de transporte podem usar esse método; Quando um provedor de catálogo de endereços ou de um serviço de mensagem tente chamá-lo, MAPI retorna MAPI_E_NO_SUPPORT.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-123">Only message store and transport providers can use this method; when an address book provider or a message service try to call it, MAPI returns MAPI_E_NO_SUPPORT.</span></span>
  
<span data-ttu-id="fb9a1-124">Objetos de suporte podem ser usados para realizar várias tarefas, como o seguinte:</span><span class="sxs-lookup"><span data-stu-id="fb9a1-124">Support objects can be used to accomplish many tasks, such as the following:</span></span>
  
- <span data-ttu-id="fb9a1-125">Acessando uma seção de perfil.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-125">Accessing a profile section.</span></span>
    
- <span data-ttu-id="fb9a1-126">Copiar pastas ou mensagens.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-126">Copying folders or messages.</span></span> <span data-ttu-id="fb9a1-127">Para obter mais informações, consulte [copiar ou mover uma mensagem ou uma pasta](copying-or-moving-a-message-or-a-folder.md).</span><span class="sxs-lookup"><span data-stu-id="fb9a1-127">For more information, see [Copying or Moving a Message or a Folder](copying-or-moving-a-message-or-a-folder.md).</span></span>
    
- <span data-ttu-id="fb9a1-128">Acessando os objetos que pertencem a outros provedores.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-128">Accessing objects that belong to other providers.</span></span> <span data-ttu-id="fb9a1-129">Para obter mais informações, consulte [comparação e acesso a objetos com suporte](supporting-object-access-and-comparison.md).</span><span class="sxs-lookup"><span data-stu-id="fb9a1-129">For more information, see [Supporting Object Access and Comparison](supporting-object-access-and-comparison.md).</span></span> 
    
- <span data-ttu-id="fb9a1-130">Manipulação de notificação de evento.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-130">Handling event notification.</span></span> <span data-ttu-id="fb9a1-131">Para obter mais informações, consulte [Suporte a notificação de evento](supporting-event-notification.md).</span><span class="sxs-lookup"><span data-stu-id="fb9a1-131">For more information, see [Supporting Event Notification](supporting-event-notification.md).</span></span>
    
- <span data-ttu-id="fb9a1-132">Alocar e liberar memória.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-132">Allocating and freeing memory.</span></span>
    
- <span data-ttu-id="fb9a1-133">Obtendo um identificador exclusivo.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-133">Obtaining a unique identifier.</span></span>
    
- <span data-ttu-id="fb9a1-134">A invalidação de objetos.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-134">Invalidating objects.</span></span>
    
- <span data-ttu-id="fb9a1-135">Tratamento de erros.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-135">Handling errors.</span></span>
    
- <span data-ttu-id="fb9a1-136">Registrando pré-processador de mensagem.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-136">Registering message preprocessors.</span></span> 
    
- <span data-ttu-id="fb9a1-137">Preparando os relatórios de entrega de mensagem.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-137">Preparing message delivery reports.</span></span> 
    
<span data-ttu-id="fb9a1-138">Ao fazer logon, MAPI chama o método de logon do objeto de provedor de cada provedor de serviço.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-138">At logon time, MAPI calls the logon method of each service provider's provider object.</span></span> <span data-ttu-id="fb9a1-139">Para provedores de catálogo de endereços, MAPI chama [IABProvider::Logon](iabprovider-logon.md).</span><span class="sxs-lookup"><span data-stu-id="fb9a1-139">For address book providers, MAPI calls [IABProvider::Logon](iabprovider-logon.md).</span></span> <span data-ttu-id="fb9a1-140">Para provedores de repositório de mensagem, MAPI chama [IMSProvider::Logon](imsprovider-logon.md).</span><span class="sxs-lookup"><span data-stu-id="fb9a1-140">For message store providers, MAPI calls [IMSProvider::Logon](imsprovider-logon.md).</span></span> <span data-ttu-id="fb9a1-141">Para provedores de transporte, MAPI chama [IXPProvider::TransportLogon](ixpprovider-transportlogon.md).</span><span class="sxs-lookup"><span data-stu-id="fb9a1-141">For transport providers, MAPI calls [IXPProvider::TransportLogon](ixpprovider-transportlogon.md).</span></span> <span data-ttu-id="fb9a1-142">MAPI passa um ponteiro para o objeto de suporte apropriado em um dos parâmetros a este método.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-142">MAPI passes a pointer to the appropriate support object in one of the parameters to this method.</span></span> <span data-ttu-id="fb9a1-143">Por sua vez, o método logon instancia um objeto de logon, passando-lhe o ponteiro de objeto de suporte.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-143">The logon method in turn instantiates a logon object, passing it the support object pointer.</span></span> <span data-ttu-id="fb9a1-144">O objeto de logon chama o suporte ao método do objeto **AddRef** para mantê-la, se necessário.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-144">The logon object calls the support object's **IUnknown::AddRef** method to retain it, if necessary.</span></span> <span data-ttu-id="fb9a1-145">Para obter mais informações sobre o processo de logon para provedores de serviços, consulte [Iniciando um provedor de serviços](starting-a-service-provider.md).</span><span class="sxs-lookup"><span data-stu-id="fb9a1-145">For more information about the logon process for service providers, see [Starting a Service Provider](starting-a-service-provider.md).</span></span>
  
<span data-ttu-id="fb9a1-146">Quando um cliente fizer logoff, MAPI chama o método de logoff do objeto logon.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-146">When a client logs off, MAPI calls the logon object's logoff method.</span></span> <span data-ttu-id="fb9a1-147">O método logoff chama o suporte ao método do objeto **IUnknown:: Release** para indicar que o provedor não são mais pretende chamar qualquer um dos métodos de suporte.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-147">The logoff method calls the support object's **IUnknown::Release** method to indicate that the provider no longer intends to call any of the support methods.</span></span> <span data-ttu-id="fb9a1-148">Assim como acontece com o logon, os métodos de logoff têm nomes ligeiramente diferentes.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-148">As with logon, the logoff methods have slightly different names.</span></span> <span data-ttu-id="fb9a1-149">As interfaces [IABLogon](iablogoniunknown.md) e [IMSLogon](imslogoniunknown.md) possuem métodos de **Logoff** ; a interface de [IXPLogon](ixplogoniunknown.md) tem um método [TransportLogoff](ixplogon-transportlogoff.md) .</span><span class="sxs-lookup"><span data-stu-id="fb9a1-149">The [IABLogon](iablogoniunknown.md) and [IMSLogon](imslogoniunknown.md) interfaces have **Logoff** methods; the [IXPLogon](ixplogoniunknown.md) interface has a [TransportLogoff](ixplogon-transportlogoff.md) method.</span></span> 
  
<span data-ttu-id="fb9a1-150">Funções de ponto de entrada de serviço de mensagem são chamadas quando uma tentativa de logon falha com o erro MAPI_E_UNCONFIGURED ou quando um cliente inicia uma solicitação de configuração.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-150">Message service entry point functions are called when a logon attempt fails with the error MAPI_E_UNCONFIGURED or when a client initiates a configuration request.</span></span> <span data-ttu-id="fb9a1-151">MAPI instancia um objeto de configuração de suporte e chama a função de ponto de entrada de serviço de mensagem para o provedor não configurado ou o provedor cuja configuração está prestes a ser alterada.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-151">MAPI instantiates a configuration support object and calls the message service entry point function for either the unconfigured provider or the provider whose configuration is about to change.</span></span> <span data-ttu-id="fb9a1-152">Ao contrário de outros objetos de suporte, objetos de configuração de suporte são válidos até o ponto de entrada a função retorna; Serviços de mensagem não chamar métodos de **AddRef** desses objetos para mantê-los.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-152">Unlike the other support objects, configuration support objects are valid only until the entry point function returns; message services do not call these objects' **AddRef** methods to retain them.</span></span> 
  
<span data-ttu-id="fb9a1-153">Normalmente, MAPI faz chamadas para a função do ponto de entrada do provedor, uma mensagem serviço, mas, em alguns casos, um provedor é solicitado a fazer a chamada.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-153">Typically, MAPI makes calls to a provider's message service entry point function, but sometimes a provider is asked to make the call.</span></span> <span data-ttu-id="fb9a1-154">Isso pode ocorrer quando um cliente chama o método [IMAPIStatus:: SettingsDialog](imapistatus-settingsdialog.md) de um provedor para solicitar o provedor para exibir sua folha de propriedades de configuração.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-154">This can occur when a client calls a provider's [IMAPIStatus::SettingsDialog](imapistatus-settingsdialog.md) method to prompt the provider to display its configuration property sheet.</span></span> <span data-ttu-id="fb9a1-155">**SettingsDialog** deve chamar [IMAPISupport::GetSvcConfigSupportObj](imapisupport-getsvcconfigsupportobj.md) para obter um objeto de suporte de configuração que ele pode passar para a função de ponto de entrada de serviço de mensagem.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-155">**SettingsDialog** should call [IMAPISupport::GetSvcConfigSupportObj](imapisupport-getsvcconfigsupportobj.md) to obtain a configuration support object that it can pass to the message service entry point function.</span></span> 
  
<span data-ttu-id="fb9a1-156">O método [IMAPISupport::GetMemAllocRoutines](imapisupport-getmemallocroutines.md) está disponível para determinar os endereços das funções de memória alocação e desalocação sem ter que deseja estabelecer um vínculo com MAPI.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-156">The [IMAPISupport::GetMemAllocRoutines](imapisupport-getmemallocroutines.md) method is available for determining the addresses of the memory allocation and deallocation functions without having to link with MAPI.</span></span> <span data-ttu-id="fb9a1-157">Usar **GetMemAllocRoutines** também facilita rastrear o vazamento de memória, envolvendo as chamadas de função de alocação com código de depuração.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-157">Using **GetMemAllocRoutines** also makes it easier to trace memory leaks by surrounding the allocation function calls with debugging code.</span></span> <span data-ttu-id="fb9a1-158">Se você chamar **GetMemAllocRoutines**, conforme é recomendado, fazê-lo antes de chamar a função [CreateIProp](createiprop.md) , que requer os endereços de função de alocação como parâmetros.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-158">If you call **GetMemAllocRoutines**, as is recommended, do so before calling the [CreateIProp](createiprop.md) function, which requires the allocation function addresses as parameters.</span></span> 
  
<span data-ttu-id="fb9a1-159">Quando você precisar criar um novo catálogo de endereços ou mensagem armazenar objeto, crie e defina uma chave de pesquisa para o objeto em sua propriedade **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="fb9a1-159">When you need to create a new address book or message store object, create and set a search key for the object in its **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) property.</span></span> <span data-ttu-id="fb9a1-160">Chame [IMAPISupport::NewUID](imapisupport-newuid.md) para obter um identificador exclusivo a serem usados na criação de uma chave de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-160">Call [IMAPISupport::NewUID](imapisupport-newuid.md) to obtain a unique identifier to use in building a search key.</span></span> <span data-ttu-id="fb9a1-161">Não use seu próprio codificadas [MAPIUID](mapiuid.md).</span><span class="sxs-lookup"><span data-stu-id="fb9a1-161">Do not use your own hard-coded [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="fb9a1-162">De um provedor **MAPIUID** deve ser usado apenas para os identificadores de entrada.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-162">A provider's **MAPIUID** should be used only for entry identifiers.</span></span> <span data-ttu-id="fb9a1-163">Para obter mais informações sobre a construção de chaves de pesquisa, consulte [MAPI registro e chaves de pesquisa](mapi-record-and-search-keys.md).</span><span class="sxs-lookup"><span data-stu-id="fb9a1-163">For more information about constructing search keys, see [MAPI Record and Search Keys](mapi-record-and-search-keys.md).</span></span>
  
<span data-ttu-id="fb9a1-164">Um aplicativo cliente em alguns casos, pode liberar um objeto sem liberar um ou mais dos seus objetos afiliados.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-164">A client application can sometimes release an object without releasing one or more of its affiliated objects.</span></span> <span data-ttu-id="fb9a1-165">Nesse caso, talvez seja necessário um provedor inutilizar um objeto não lançado.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-165">In such a case, a provider may need to render an unreleased object unusable.</span></span> <span data-ttu-id="fb9a1-166">Para fazer isso, o provedor libera todos os recursos conectados com o objeto e, em seguida, chama [IMAPISupport::MakeInvalid](imapisupport-makeinvalid.md) para invalidar vtable do objeto.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-166">To do this, the provider frees all of the resources connected with the object and then calls [IMAPISupport::MakeInvalid](imapisupport-makeinvalid.md) to invalidate the object's vtable.</span></span> <span data-ttu-id="fb9a1-167">**MakeInvalid** substitui os métodos de **IUnknown** do vtable (**QueryInterface**, **AddRef**e **Release**) com implementações de MAPI padrão e faz com que todos os outros métodos retornar MAPI_E_INVALID_OBJECT.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-167">**MakeInvalid** replaces the vtable's **IUnknown** methods (**QueryInterface**, **AddRef**, and **Release**) with standard MAPI implementations and causes all other methods to return MAPI_E_INVALID_OBJECT.</span></span> <span data-ttu-id="fb9a1-168">**MakeInvalid** também libera a memória de todos os objetos que não seja o vtable.</span><span class="sxs-lookup"><span data-stu-id="fb9a1-168">**MakeInvalid** also frees all the object's memory other than the vtable.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="fb9a1-169">Confira também</span><span class="sxs-lookup"><span data-stu-id="fb9a1-169">See also</span></span>



[<span data-ttu-id="fb9a1-170">Provedores de serviços MAPI</span><span class="sxs-lookup"><span data-stu-id="fb9a1-170">MAPI Service Providers</span></span>](mapi-service-providers.md)

