---
title: Mensagens de relatório MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 824eb670-16b7-49bf-9992-39fe0586a552
description: 'Última modificação: 9 de março de 2015'
ms.openlocfilehash: addf93cadae418017a40ba448328d2e1fc1decf6
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19767930"
---
# <a name="mapi-report-messages"></a><span data-ttu-id="4a4a3-103">Mensagens de relatório MAPI</span><span class="sxs-lookup"><span data-stu-id="4a4a3-103">MAPI Report Messages</span></span>

  
  
<span data-ttu-id="4a4a3-104">**Aplica-se a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="4a4a3-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="4a4a3-105">Relatar informações de status presente mensagens sobre uma mensagem ao remetente.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-105">Report messages present status information about a message to its sender.</span></span>
  
<span data-ttu-id="4a4a3-106">Há dois tipos gerais de mensagens de relatório:</span><span class="sxs-lookup"><span data-stu-id="4a4a3-106">There are two general types of report messages:</span></span>
  
- <span data-ttu-id="4a4a3-107">Leia os relatórios de status.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-107">Read status reports.</span></span>
    
- <span data-ttu-id="4a4a3-108">Relatórios de status de entrega.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-108">Delivery status reports.</span></span>
    
## <a name="read-status-reports"></a><span data-ttu-id="4a4a3-109">Relatórios de Status de leitura</span><span class="sxs-lookup"><span data-stu-id="4a4a3-109">Read Status Reports</span></span>

<span data-ttu-id="4a4a3-110">Relatórios de status de leitura são iniciados por provedores de armazenamento de mensagens através de uma chamada ao método [IMAPISupport::ReadReceipt](imapisupport-readreceipt.md) e são enviados ao destinatário representado pelo identificador de entrada no **PR_REPORT_ENTRYID** ([PidTagReportEntryId](pidtagreportentryid-canonical-property.md)) propriedade.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-110">Read status reports are initiated by message store providers through a call to the [IMAPISupport::ReadReceipt](imapisupport-readreceipt.md) method and are sent to the recipient represented by the entry identifier in the **PR_REPORT_ENTRYID** ([PidTagReportEntryId](pidtagreportentryid-canonical-property.md)) property.</span></span> <span data-ttu-id="4a4a3-111">Relatórios de status de leitura não são gerados automaticamente. aplicativos cliente que deseja recebê-las devem solicitar explicitamente-los.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-111">Read status reports are not generated automatically; client applications that want to receive them must explicitly request them.</span></span>
  
<span data-ttu-id="4a4a3-112">Um relatório de leitura indica que o sinalizador de leitura de uma mensagem tiver sido definido, que pode ocorrer quando a mensagem é aberta, impressa, movida ou copiada.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-112">A read report indicates that the read flag of a message has been set, which can occur when the message is opened, printed, moved, or copied.</span></span> <span data-ttu-id="4a4a3-113">Se ou não um provedor de armazenamento de mensagem gera um relatório de leitura em resposta a uma movimentação ou cópia operação depende de onde a mensagem será.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-113">Whether or not a message store provider generates a read report in response to a move or copy operation depends on where the message is going.</span></span> <span data-ttu-id="4a4a3-114">Se estiver sendo movido ou copiadas para outro repositório de mensagem, um ponto de relatório leitura provavelmente sempre ser enviadas.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-114">If it is being moved or copied to another message store, a read report will most likely always be sent.</span></span> <span data-ttu-id="4a4a3-115">Se ele está sendo movido ou copiadas no armazenamento da mensagem atual, um relatório de leitura pode ou não pode ser enviado.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-115">If it is being moved or copied in the current message store, a read report might or might not be sent.</span></span> 
  
<span data-ttu-id="4a4a3-116">Um relatório nonread indica que o sinalizador de leitura de uma mensagem não estiver definido e a mensagem não foi aberta tanto antes de ser colocada na pasta Itens excluídos ou antes de expirar um limite de tempo.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-116">A nonread report indicates that the read flag of a message is not set and that the message was not opened either before being placed in the Deleted Items folder or before the expiration of a time limit.</span></span> <span data-ttu-id="4a4a3-117">Clientes podem chamar o método [IMessage::SetReadFlag](imessage-setreadflag.md) ou [IMAPIFolder::SetReadFlags](imapifolder-setreadflags.md) para definir ou limpar o sinalizador de leitura da mensagem.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-117">Clients can call the [IMessage::SetReadFlag](imessage-setreadflag.md) or [IMAPIFolder::SetReadFlags](imapifolder-setreadflags.md) method to set or clear a message's read flag.</span></span> 
  
## <a name="delivery-status-reports"></a><span data-ttu-id="4a4a3-118">Relatórios de Status de entrega</span><span class="sxs-lookup"><span data-stu-id="4a4a3-118">Delivery Status Reports</span></span>

<span data-ttu-id="4a4a3-119">Status de entrega é refletida em um relatório de entrega, que é enviado quando uma mensagem alcançou o receptor pretendido, e em um relatório de não entrega, que é enviado quando uma mensagem não poderia chegar a um destinatário.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-119">Delivery status is reflected in a delivery report, which is sent when a message has reached its intended recipient, and in a nondelivery report, which is sent when a message could not reach a recipient.</span></span> <span data-ttu-id="4a4a3-120">Relatórios de status de entrega são enviados ao destinatário representado pelo identificador de entrada na propriedade **PR_REPORT_ENTRYID** ou ao remetente se esta propriedade não estiver presente.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-120">Delivery status reports are sent to the recipient represented by the entry identifier in the **PR_REPORT_ENTRYID** property or to the sender if this property is not present.</span></span> 
  
<span data-ttu-id="4a4a3-121">Notificações de entrega são enviadas somente mediante solicitação e não incluir a mensagem original.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-121">Delivery reports are sent by request only and do not include the original message.</span></span> <span data-ttu-id="4a4a3-122">NDRs são enviados automaticamente, a menos que uma solicitação for feita para suprimi-los.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-122">Nondelivery reports are sent automatically unless a request is made to suppress them.</span></span> <span data-ttu-id="4a4a3-123">NDRs incluem a mensagem original como um anexo para habilitar o destinatário do relatório reenviar a mensagem no caso de qualquer item bloqueado a entrega não é mais um problema.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-123">Nondelivery reports include the original message as an attachment to enable the report's recipient to resend the message in case whatever blocked the delivery is no longer a problem.</span></span> <span data-ttu-id="4a4a3-124">A mensagem anexada se parece com o original, como ela se encontrava quando o método de [IMessage::SubmitMessage](imessage-submitmessage.md) foi acionado para enviá-la inicialmente.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-124">The attached message resembles the original as it existed when the [IMessage::SubmitMessage](imessage-submitmessage.md) method was called to send it initially.</span></span> 
  
<span data-ttu-id="4a4a3-125">Um ou mais relatórios de status de entrega gerados por provedores de transporte quando eles chamam o método [IMAPISupport::StatusRecips](imapisupport-statusrecips.md) .</span><span class="sxs-lookup"><span data-stu-id="4a4a3-125">One or more delivery status reports are generated by transport providers when they call the [IMAPISupport::StatusRecips](imapisupport-statusrecips.md) method.</span></span> <span data-ttu-id="4a4a3-126">Uma lista de destinatários de uma mensagem é composto por provedores de transporte.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-126">Transport providers compose a list of recipients for a message.</span></span> <span data-ttu-id="4a4a3-127">Ou não um destinatário recebe um relatório e o tipo de relatório que é gerado depende dos seguintes fatores:</span><span class="sxs-lookup"><span data-stu-id="4a4a3-127">Whether or not a recipient receives a report and the type of report that is generated depends on the following:</span></span> 
  
- <span data-ttu-id="4a4a3-128">Notificações de entrega vá para destinatários que defina a propriedade **PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorDeliveryReportRequested](pidtagoriginatordeliveryreportrequested-canonical-property.md)) como TRUE antes que a mensagem foi colocada no repositório de mensagem.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-128">Delivery reports go to recipients that set the **PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorDeliveryReportRequested](pidtagoriginatordeliveryreportrequested-canonical-property.md)) property to TRUE before the message was placed in the message store.</span></span>
    
- <span data-ttu-id="4a4a3-129">NDRs vá para destinatários que não definido a propriedade **PR_ORIGINATOR_NON_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorNonDeliveryReportRequested](pidtagoriginatornondeliveryreportrequested-canonical-property.md)) como FALSE.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-129">Nondelivery reports go to recipients that did not set the **PR_ORIGINATOR_NON_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorNonDeliveryReportRequested](pidtagoriginatornondeliveryreportrequested-canonical-property.md)) property to FALSE.</span></span> 
    
<span data-ttu-id="4a4a3-130">Quase todas as informações necessárias para exibir um relatório de não entrega está contida na tabela de destinatário da mensagem anexada.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-130">Almost all of the information necessary to display a nondelivery report is contained in the recipient table of the attached message.</span></span> <span data-ttu-id="4a4a3-131">Algumas propriedades são provenientes do relatório em si.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-131">A few properties are from the report itself.</span></span> <span data-ttu-id="4a4a3-132">Para relatórios de entrega, as informações necessárias estão contidas na tabela de destinatário do relatório e, em algumas propriedades do relatório.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-132">For delivery reports, the necessary information is contained in the recipient table of the report and in a few report properties.</span></span> 
  
<span data-ttu-id="4a4a3-133">Os relatórios são mensagens com classes de mensagem distintos, com base na classe da mensagem enviada.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-133">Reports are messages with distinct message classes, based on the class of the sent message.</span></span> <span data-ttu-id="4a4a3-134">A maioria dos provedores de serviço usam uma convenção de nomenclatura no qual a classe da mensagem é composta de várias partes separadas por pontos.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-134">Most service providers use a naming convention whereby the message class is composed of several parts separated by periods.</span></span> <span data-ttu-id="4a4a3-135">A primeira parte é "Relatório" e a última parte é uma constante que representa o tipo de relatório.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-135">The first part is "Report" and the last part is a constant that represents the report type.</span></span> <span data-ttu-id="4a4a3-136">Parte do meio é reservado para a classe da mensagem enviada.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-136">The middle part is reserved for the class of the sent message.</span></span> <span data-ttu-id="4a4a3-137">Por exemplo, como um relatório de entrega usa o DR constante, a classe de mensagem para uma entrega informar sobre um IPM. Mensagem de Observação seria **Report.IPM.Note.DR**.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-137">For example, because a delivery report uses the constant DR, the message class for a delivery report about an IPM.Note message would be **Report.IPM.Note.DR**.</span></span>
  
<span data-ttu-id="4a4a3-138">A tabela a seguir mostra as constantes que representam os tipos de relatórios.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-138">The following table shows the constants that represent the types of reports.</span></span>
  
|<span data-ttu-id="4a4a3-139">**Tipo de relatório**</span><span class="sxs-lookup"><span data-stu-id="4a4a3-139">**Report type**</span></span>|<span data-ttu-id="4a4a3-140">**Constante usada na classe da mensagem**</span><span class="sxs-lookup"><span data-stu-id="4a4a3-140">**Constant used in message class**</span></span>|
|:-----|:-----|
|<span data-ttu-id="4a4a3-141">Read</span><span class="sxs-lookup"><span data-stu-id="4a4a3-141">Read</span></span>  <br/> |<span data-ttu-id="4a4a3-142">IPNRN</span><span class="sxs-lookup"><span data-stu-id="4a4a3-142">IPNRN</span></span>  <br/> |
|<span data-ttu-id="4a4a3-143">Nonread</span><span class="sxs-lookup"><span data-stu-id="4a4a3-143">Nonread</span></span>  <br/> |<span data-ttu-id="4a4a3-144">IPNNRN</span><span class="sxs-lookup"><span data-stu-id="4a4a3-144">IPNNRN</span></span>  <br/> |
|<span data-ttu-id="4a4a3-145">Entrega</span><span class="sxs-lookup"><span data-stu-id="4a4a3-145">Delivery</span></span>  <br/> |<span data-ttu-id="4a4a3-146">RECUPERAÇÃO DE DESASTRES</span><span class="sxs-lookup"><span data-stu-id="4a4a3-146">DR</span></span>  <br/> |
|<span data-ttu-id="4a4a3-147">Não entrega</span><span class="sxs-lookup"><span data-stu-id="4a4a3-147">Nondelivery</span></span>  <br/> |<span data-ttu-id="4a4a3-148">NDR</span><span class="sxs-lookup"><span data-stu-id="4a4a3-148">NDR</span></span>  <br/> |
   
<span data-ttu-id="4a4a3-149">Clientes Interactive podem exibir mensagens de relatório usando formulários padrão fornecidos pelo MAPI ou formulários personalizados que foram registrados com o Gerenciador de formulário para a classe de mensagem do relatório.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-149">Interactive clients can display report messages by using standard forms provided by MAPI, or custom forms that have been registered with the form manager for the report's message class.</span></span> <span data-ttu-id="4a4a3-150">Clientes que recebem um relatório de não entrega para um IPM. Mensagem de anotação, por exemplo, pode exibir o formulário padrão do MAPI que apresenta uma lista de destinatários com falha e um sugerido motivo da falha.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-150">Clients that receive a nondelivery report for an IPM.Note message, for example, can display the standard MAPI form that presents a list of the failed recipients and a suggested reason for the failure.</span></span> <span data-ttu-id="4a4a3-151">O formulário também permite que o usuário reenviar a mensagem, se desejado.</span><span class="sxs-lookup"><span data-stu-id="4a4a3-151">The form also enables the user to resend the message, if desired.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="4a4a3-152">Confira também</span><span class="sxs-lookup"><span data-stu-id="4a4a3-152">See also</span></span>



[<span data-ttu-id="4a4a3-153">Mensagens MAPI</span><span class="sxs-lookup"><span data-stu-id="4a4a3-153">MAPI Messages</span></span>](mapi-messages.md)

