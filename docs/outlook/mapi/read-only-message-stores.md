---
title: Repositórios de mensagem de somente leitura
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 752ff2d6-ca64-4507-adf1-4c054c321203
description: '�ltima altera��o: s�bado, 23 de julho de 2011'
ms.openlocfilehash: f82c213b6e0737c27c4e979fc90109b38b0746f0
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19770222"
---
# <a name="read-only-message-stores"></a><span data-ttu-id="36cfe-103">Repositórios de mensagem de somente leitura</span><span class="sxs-lookup"><span data-stu-id="36cfe-103">Read-Only Message Stores</span></span>

  
  
<span data-ttu-id="36cfe-104">**Aplica-se a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="36cfe-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="36cfe-105">Um armazenamento de mensagens de somente leitura é uma nos quais não o cliente MAPI nem o MAPI spooler pode criar, modificar ou excluir os objetos no repositório de mensagem.</span><span class="sxs-lookup"><span data-stu-id="36cfe-105">A read-only message store is one in which neither the MAPI client nor the MAPI spooler can create, modify, or delete the objects in the message store.</span></span> <span data-ttu-id="36cfe-106">Há vários motivos por que talvez você queira implementar um armazenamento de mensagens de somente leitura.</span><span class="sxs-lookup"><span data-stu-id="36cfe-106">There are many reasons why you might want to implement a read-only message store.</span></span> <span data-ttu-id="36cfe-107">Por exemplo, uma empresa de relatórios de crédito poderia usar um repositório de somente leitura para permitir que seus clientes ou funcionários ver, mas não alterar relatórios de crédito individuais.</span><span class="sxs-lookup"><span data-stu-id="36cfe-107">For example, a credit reporting firm could use a read-only store to allow its customers or employees to see but not change individual credit reports.</span></span> <span data-ttu-id="36cfe-108">A escolha de fazer com que uma mensagem de somente leitura armazenar tem implicações para a estrutura do provedor de armazenamento de e para o store em si.</span><span class="sxs-lookup"><span data-stu-id="36cfe-108">Choosing to make a read-only message store has implications for the structure of the store provider and for the store itself.</span></span> <span data-ttu-id="36cfe-109">Por exemplo, um armazenamento de mensagens somente leitura não pode ter uma pasta de caixa de saída, porque e clientes MAPI seriam solicitar a criação de novas mensagens de saída nessa pasta.</span><span class="sxs-lookup"><span data-stu-id="36cfe-109">For example, a read-only message store cannot have an Outbox folder, because then MAPI clients would request that new outgoing messages be created in that folder.</span></span> <span data-ttu-id="36cfe-110">Da mesma forma, é responsabilidade do provedor de repositório para garantir a integridade do mecanismo de armazenamento subjacente.</span><span class="sxs-lookup"><span data-stu-id="36cfe-110">Similarly, it is the store provider's responsibility to ensure the integrity of the underlying storage mechanism.</span></span>
  
<span data-ttu-id="36cfe-111">Há três sinalizadores que podem ser definidos na propriedade de **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) do armazenamento de mensagens que oferecem suporte a diferentes níveis de acesso somente leitura.</span><span class="sxs-lookup"><span data-stu-id="36cfe-111">There are three flags that can be set in the message store's **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property that support different levels of read-only access.</span></span> <span data-ttu-id="36cfe-112">O sinalizador STORE_READONLY indica que todas as [IMAPIProp: IUnknown](imapipropiunknown.md) interfaces de objetos no repositório de mensagem são somente leitura.</span><span class="sxs-lookup"><span data-stu-id="36cfe-112">The STORE_READONLY flag indicates that all [IMAPIProp : IUnknown](imapipropiunknown.md) interfaces on objects in the message store are read-only.</span></span> <span data-ttu-id="36cfe-113">O sinalizador STORE_MODIFY_OK indica que as mensagens existentes no armazenamento de mensagens podem ser modificadas, mas novas pastas e mensagens não podem ser criadas.</span><span class="sxs-lookup"><span data-stu-id="36cfe-113">The STORE_MODIFY_OK flag indicates that existing messages in the message store may be modified, but new folders and messages may not be created.</span></span> <span data-ttu-id="36cfe-114">O sinalizador STORE_CREATE_OK indica que as novas mensagens e pastas podem ser criadas, mas indica que nada sobre se a objetos existentes podem ser modificados.</span><span class="sxs-lookup"><span data-stu-id="36cfe-114">The STORE_CREATE_OK flag indicates that new messages and folders may be created, but indicates nothing about whether existing objects may be modified.</span></span> 
  
<span data-ttu-id="36cfe-115">O fato de que os clientes MAPI e o MAPI spooler talvez não sejam capazes de criar, modificar ou excluir objetos no repositório de mensagem não significa que nunca altere o conteúdo do mecanismo de armazenamento subjacente.</span><span class="sxs-lookup"><span data-stu-id="36cfe-115">The fact that MAPI clients and the MAPI spooler may not be able to create, modify, or delete objects in the message store does not mean that the contents of the underlying storage mechanism never change.</span></span> <span data-ttu-id="36cfe-116">Nem significa que seu provedor de armazenamento nunca precisa de permissão de gravação para o mecanismo de armazenamento subjacente.</span><span class="sxs-lookup"><span data-stu-id="36cfe-116">Nor does it mean that your store provider never needs write permission to the underlying storage mechanism.</span></span> <span data-ttu-id="36cfe-117">Em algumas circunstâncias essas duas condições podem aplicar, mas não no caso geral de uma mensagem de somente leitura armazenar.</span><span class="sxs-lookup"><span data-stu-id="36cfe-117">In some circumstances those two conditions may apply, but not in the general case of a read-only message store.</span></span> <span data-ttu-id="36cfe-118">O nível de acesso que o seu provedor de armazenamento requer e ou não o seu provedor de armazenamento nunca muda dados em que o mecanismo de armazenamento subjacente principalmente depende da natureza específica do provedor de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="36cfe-118">The level of access that your store provider requires and whether or not your store provider ever changes data in the underlying storage mechanism depends mainly on the specific nature of your store provider.</span></span>
  
<span data-ttu-id="36cfe-119">Por exemplo, se você estiver escrevendo um provedor de armazenamento para fornecer a clientes MAPI acesso a um banco de dados armazenado em um dispositivo de CD-ROM, o mecanismo de armazenamento subjacente não é possível alterar e seu provedor de armazenamento pode ter permissão somente leitura para ele.</span><span class="sxs-lookup"><span data-stu-id="36cfe-119">For example, if you are writing a store provider to give MAPI clients access to a database stored on a CD-ROM device, the underlying storage mechanism cannot change and your store provider can have read-only permission for it.</span></span> <span data-ttu-id="36cfe-120">Se, no entanto, você está escrevendo um provedor de armazenamento para fornecer a clientes MAPI acesso somente leitura para um banco de dados de pasta pública, mas o provedor de repositório precisa acompanhar o status de lido/de mensagens para cada usuário, o provedor de armazenamento precisará gravar novos dados para o mecanismo de armazenamento subjacente.</span><span class="sxs-lookup"><span data-stu-id="36cfe-120">If, however, you are writing a store provider to give MAPI clients read-only access to a public folder database, but the store provider needs to keep track of the read/unread status of messages for each user, the store provider will need to write new data to the underlying storage mechanism.</span></span> <span data-ttu-id="36cfe-121">Entretanto, nem exemplo o provedor de armazenamento nunca tem que criar, modificar ou excluir pastas ou mensagens por solicitação dos clientes MAPI ou o spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="36cfe-121">However, in neither example does the store provider ever have to create, modify, or delete folders or messages at the request of MAPI clients or the MAPI spooler.</span></span>
  
<span data-ttu-id="36cfe-122">A lista de short dos motivos que um provedor de armazenamento precisaria gravar dados em um mecanismo de armazenamento subjacente que seja somente leitura é da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="36cfe-122">The short list of reasons that a store provider would need to write data to an underlying storage mechanism that is otherwise read-only is as follows:</span></span>
  
- <span data-ttu-id="36cfe-123">Para armazenar o lido/status de mensagens.</span><span class="sxs-lookup"><span data-stu-id="36cfe-123">To store the read/unread status of messages.</span></span>
    
- <span data-ttu-id="36cfe-124">Para implementar notificações de leitura/nonread.</span><span class="sxs-lookup"><span data-stu-id="36cfe-124">To implement read/nonread notifications.</span></span> 
    
- <span data-ttu-id="36cfe-125">Para armazenar os modos de exibição.</span><span class="sxs-lookup"><span data-stu-id="36cfe-125">To store views.</span></span>
    
- <span data-ttu-id="36cfe-126">Para armazenar em cache os índices persistentes para ordens de classificação de pasta definida pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="36cfe-126">To cache persistent indexes for user-defined folder sort orders.</span></span>
    
- <span data-ttu-id="36cfe-127">Para armazenar a ordem de classificação do conteúdo de uma pasta (suporte [IMAPIFolder::SaveContentsSort](imapifolder-savecontentssort.md)).</span><span class="sxs-lookup"><span data-stu-id="36cfe-127">To store the sort order of a folder's contents (supporting [IMAPIFolder::SaveContentsSort](imapifolder-savecontentssort.md)).</span></span>
    
- <span data-ttu-id="36cfe-128">Para armazenar os critérios de pesquisa, pesquisa de estado e resultados, se o provedor de armazenamento de mensagem suporta pesquisas (suporte [IMAPIContainer::SetSearchCriteria](imapicontainer-setsearchcriteria.md)).</span><span class="sxs-lookup"><span data-stu-id="36cfe-128">To store search criteria, search state, and results, if the message store provider supports searches (supporting [IMAPIContainer::SetSearchCriteria](imapicontainer-setsearchcriteria.md)).</span></span>
    
<span data-ttu-id="36cfe-129">Se o seu provedor de armazenamento de mensagem nunca pode gravar dados para o mecanismo de armazenamento subjacente, precisará implementar esses recursos usando um mecanismo de armazenamento distinto fora o mecanismo de armazenamento subjacente.</span><span class="sxs-lookup"><span data-stu-id="36cfe-129">If your message store provider can never write data to the underlying storage mechanism, it will need to implement these features by using a separate storage mechanism outside of the underlying storage mechanism.</span></span> <span data-ttu-id="36cfe-130">Por exemplo, um provedor de armazenamento de mensagem de somente leitura poderia armazenar o lido/status de mensagens no repositório em um arquivo no computador do usuário.</span><span class="sxs-lookup"><span data-stu-id="36cfe-130">For example, a read-only message store provider could store the read/unread status of messages in the store in a file on the user's computer.</span></span> <span data-ttu-id="36cfe-131">Essa estratégia apresenta as dificuldades adicionais, mas pode ser a maneira feasable somente para somente leitura mensagem provedores de armazenamento para implementar alguns recursos.</span><span class="sxs-lookup"><span data-stu-id="36cfe-131">This strategy presents additional difficulties but may be the only feasable way for read-only message store providers to implement some features.</span></span> <span data-ttu-id="36cfe-132">Por exemplo, manter o conteúdo do mecanismo de armazenamento distinto sincronizado com os objetos no armazenamento de mensagens é mais difícil que armazenar o status de lido/diretamente no repositório de mensagem em si.</span><span class="sxs-lookup"><span data-stu-id="36cfe-132">For example, keeping the contents of the separate storage mechanism synchronized with the objects in the message store is more difficult than storing the read/unread status directly in the message store itself.</span></span>
  
<span data-ttu-id="36cfe-133">Pesquisando apresenta uma complicação adicional para provedores de armazenamento de mensagem de somente leitura.</span><span class="sxs-lookup"><span data-stu-id="36cfe-133">Searching presents an additional complication for read-only message store providers.</span></span> <span data-ttu-id="36cfe-134">Clientes usam a pasta especificada na propriedade de **PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md)) do objeto repositório de mensagem para localizar a pasta usada para resultados de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="36cfe-134">Clients use the folder specified in the message store object's **PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md)) property to locate the folder used for search results.</span></span> <span data-ttu-id="36cfe-135">Provedores de armazenamento de mensagem de somente leitura geralmente não é possível instalar uma pasta de resultados de pesquisa permanente para o repositório de mensagem.</span><span class="sxs-lookup"><span data-stu-id="36cfe-135">Read-only message store providers often cannot install a permanent search-results folder into the message store.</span></span> <span data-ttu-id="36cfe-136">Nessa situação, o provedor de armazenamento de mensagem deve armazenar um identificador de entrada na propriedade **PR_FINDER_ENTRYID** que possa reconhecer quando os clientes abrem pastas para que ele possa criar dinamicamente uma pasta de resultados de pesquisa em vez de leitura de um partir do mecanismo de armazenamento subjacente.</span><span class="sxs-lookup"><span data-stu-id="36cfe-136">In that situation, the message store provider should store an entry identifier in the **PR_FINDER_ENTRYID** property that it can recognize when clients open folders so that it can dynamically create a search-results folder instead of reading one from the underlying storage mechanism.</span></span> <span data-ttu-id="36cfe-137">No entanto, como vários provedores de armazenamento de mensagem de somente leitura criar todas as suas pastas dinamicamente, isso normalmente não é uma quantidade excessiva de uma carga.</span><span class="sxs-lookup"><span data-stu-id="36cfe-137">However, because many read-only message store providers create all their folders dynamically, this is usually not too much of a burden.</span></span> 
  
<span data-ttu-id="36cfe-138">O fato de que o seu provedor de armazenamento de mensagens é somente leitura é anunciado na propriedade **PR_STORE_SUPPORT_MASK** do objeto de provedor de repositório.</span><span class="sxs-lookup"><span data-stu-id="36cfe-138">The fact that your message store provider is read-only is advertised in the store provider object's **PR_STORE_SUPPORT_MASK** property.</span></span> <span data-ttu-id="36cfe-139">No entanto, não contam nos clientes respeitar essa propriedade; código do seu provedor de repositório imponha o status somente leitura do mecanismo de armazenamento subjacente.</span><span class="sxs-lookup"><span data-stu-id="36cfe-139">However, do not count on clients to respect that property; your store provider's code should enforce the read-only status of the underlying storage mechanism.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="36cfe-140">Confira também</span><span class="sxs-lookup"><span data-stu-id="36cfe-140">See also</span></span>



[<span data-ttu-id="36cfe-141">Desenvolvendo um provedor de armazenamento de mensagens MAPI</span><span class="sxs-lookup"><span data-stu-id="36cfe-141">Developing a MAPI Message Store Provider</span></span>](developing-a-mapi-message-store-provider.md)

