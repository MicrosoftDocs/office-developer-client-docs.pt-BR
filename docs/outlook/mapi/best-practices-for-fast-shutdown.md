---
title: Práticas recomendadas para o desligamento rápido
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ae8a9214-e53f-4c57-8dbe-aa7cc6903aa8
description: '�ltima altera��o: s�bado, 23 de julho de 2011'
ms.openlocfilehash: c92347ab1a786196e7f0d99b286e8f4134ce7c24
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22590698"
---
# <a name="best-practices-for-fast-shutdown"></a><span data-ttu-id="c9e3c-103">Práticas recomendadas para o desligamento rápido</span><span class="sxs-lookup"><span data-stu-id="c9e3c-103">Best Practices for Fast Shutdown</span></span>

  
  
<span data-ttu-id="c9e3c-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="c9e3c-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="c9e3c-105">Este tópico fornece práticas recomendadas para os administradores, os clientes MAPI e provedores MAPI usar configurações de registro do Windows e as interfaces de desligamento rápido para minimizar a perda de dados durante o desligamento do cliente.</span><span class="sxs-lookup"><span data-stu-id="c9e3c-105">This topic recommends best practices for administrators, MAPI clients, and MAPI providers to use Windows registry settings and the fast shutdown interfaces to minimize data loss during client shutdown.</span></span>
  
- <span data-ttu-id="c9e3c-106">Para um cliente MAPI realizar desligamento rápido com êxito, para que os processos de provedor não provocam perda de dados, o cliente MAPI do primeiro deve chamar o método [IMAPIClientShutdown::QueryFastShutdown](imapiclientshutdown-queryfastshutdown.md) .</span><span class="sxs-lookup"><span data-stu-id="c9e3c-106">For a MAPI client to carry out fast shutdown successfully so that provider processes do not incur data loss, the MAPI client should first call the [IMAPIClientShutdown::QueryFastShutdown](imapiclientshutdown-queryfastshutdown.md) method.</span></span> <span data-ttu-id="c9e3c-107">O cliente deve então prosseguir com os métodos [IMAPIClientShutdown::NotifyProcessShutdown](imapiclientshutdown-notifyprocessshutdown.md) e [IMAPIClientShutdown::DoFastShutdown](imapiclientshutdown-dofastshutdown.md) com base no suporte do subsistema MAPI para fast desligamento, conforme indicado pelo valor de retorno de ** IMAPIClientShutdown::QueryFastShutdown**.</span><span class="sxs-lookup"><span data-stu-id="c9e3c-107">The client should then proceed with the [IMAPIClientShutdown::NotifyProcessShutdown](imapiclientshutdown-notifyprocessshutdown.md) and [IMAPIClientShutdown::DoFastShutdown](imapiclientshutdown-dofastshutdown.md) methods based on the MAPI subsystem's support for fast shutdown, as indicated by the return value of **IMAPIClientShutdown::QueryFastShutdown**.</span></span> <span data-ttu-id="c9e3c-108">Como um cliente MAPI, o Microsoft Outlook não chama **IMAPIClientShutdown::NotifyProcessShutdown** ou **IMAPIClientShutdown::DoFastShutdown** se **IMAPIClientShutdown::QueryFastShutdown** retornará um erro.</span><span class="sxs-lookup"><span data-stu-id="c9e3c-108">As a MAPI client, Microsoft Outlook does not call **IMAPIClientShutdown::NotifyProcessShutdown** or **IMAPIClientShutdown::DoFastShutdown** if **IMAPIClientShutdown::QueryFastShutdown** returns an error.</span></span> <span data-ttu-id="c9e3c-109">Se o administrador tiver desabilitado o desligamento rápido no registro do Windows, o subsistema de MAPI retornaria MAPI_E_NO_SUPPORT para **IMAPIClientShutdown::QueryFastShutdown**.</span><span class="sxs-lookup"><span data-stu-id="c9e3c-109">If the administrator has disabled fast shutdown in the Windows registry, the MAPI subsystem would return MAPI_E_NO_SUPPORT to **IMAPIClientShutdown::QueryFastShutdown**.</span></span> <span data-ttu-id="c9e3c-110">Nesse caso, o subsistema de MAPI não seria informe sair de provedores de MAPI de um processo de cliente imediata.</span><span class="sxs-lookup"><span data-stu-id="c9e3c-110">In this case, the MAPI subsystem would not inform MAPI providers of an immediate client process exit.</span></span> <span data-ttu-id="c9e3c-111">Portanto, se um cliente MAPI ignora este código de retorno de erro, prossegue para rápida desligamento e desconecta todas as referências externas, todos os provedores MAPI carregados terá a perda de dados.</span><span class="sxs-lookup"><span data-stu-id="c9e3c-111">Therefore, if a MAPI client disregards this error return code, proceeds to do fast shutdown, and disconnects all external references, all loaded MAPI providers will have data loss.</span></span> 
    
- <span data-ttu-id="c9e3c-112">Provedores MAPI deverá implementar o [IMAPIProviderShutdown: IUnknown](imapiprovidershutdowniunknown.md) interface para realizar as etapas necessárias e em tempo hábil para evitar a perda de dados por cliente desconectando as referências externas antes de que sai do cliente.</span><span class="sxs-lookup"><span data-stu-id="c9e3c-112">MAPI providers should implement the [IMAPIProviderShutdown : IUnknown](imapiprovidershutdowniunknown.md) interface to carry out timely and necessary steps to avoid data loss due to the client disconnecting external references before the client exits.</span></span> <span data-ttu-id="c9e3c-113">Um provedor deve adiar tudo que é não essenciais ao salvar dados em seu repositório de dados primário.</span><span class="sxs-lookup"><span data-stu-id="c9e3c-113">A provider should postpone everything else that is nonessential to saving data to its primary data store.</span></span> <span data-ttu-id="c9e3c-114">Por exemplo, um provedor de transporte deve adiar operações de plano de fundo desnecessárias que procurar por novos email, que um provedor de catálogo de endereços deve adiar baixando alterações recentes do seu servidor, e um provedor de armazenamento deve adiar tarefas de manutenção, como compactação ou indexação.</span><span class="sxs-lookup"><span data-stu-id="c9e3c-114">For example, a transport provider should postpone unnecessary background operations that check for new mail, an address book provider should postpone downloading recent changes from its server, and a store provider should postpone maintenance tasks such as compacting or indexing.</span></span> 
    
- <span data-ttu-id="c9e3c-115">Os usuários que desejem que os clientes MAPI para sair assim que eles fechá-los devem usar a configuração do registro padrão que permite o desligamento rápido, a menos que um provedor recusa.</span><span class="sxs-lookup"><span data-stu-id="c9e3c-115">Users who want MAPI clients to exit as soon as they close them should use the default registry setting that enables fast shutdown unless a provider opts out.</span></span>
    
- <span data-ttu-id="c9e3c-116">Depois que um cliente MAPI chama **IMAPIClientShutdown::DoFastShutdown**, ele não verifique todas as chamadas adicionais para MAPI, incluindo a função [MAPIUninitialize](mapiuninitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="c9e3c-116">Once a MAPI client calls **IMAPIClientShutdown::DoFastShutdown**, it should not make any additional calls to MAPI, including the [MAPIUninitialize](mapiuninitialize.md) function.</span></span> <span data-ttu-id="c9e3c-117">O cliente não deve usar o MAPI para o restante do tempo de vida do processo do cliente.</span><span class="sxs-lookup"><span data-stu-id="c9e3c-117">The client should not use MAPI for the rest of the client process's lifetime.</span></span> 
    
- <span data-ttu-id="c9e3c-118">Um cliente MAPI nunca diretamente deve chamar a interface de **IMAPIProviderShutdown** de um provedor.</span><span class="sxs-lookup"><span data-stu-id="c9e3c-118">A MAPI client should never directly call a provider's **IMAPIProviderShutdown** interface.</span></span> <span data-ttu-id="c9e3c-119">Clientes MAPI sempre devem usar o [IMAPIClientShutdown: IUnknown](imapiclientshutdowniunknown.md) interface.</span><span class="sxs-lookup"><span data-stu-id="c9e3c-119">MAPI clients should always use the [IMAPIClientShutdown : IUnknown](imapiclientshutdowniunknown.md) interface.</span></span> 
    
- <span data-ttu-id="c9e3c-120">Se precisar de um provedor MAPI garantir que desligamento rápido não seja usado enquanto ele for carregado, ele deve implementar a interface **IMAPIProviderShutdown** e retornar MAPI_E_NO_SUPPORT para o método **IMAPIProviderShutdown::QueryFastShutdown** .</span><span class="sxs-lookup"><span data-stu-id="c9e3c-120">If a MAPI provider needs to ensure that fast shutdown is not used while it is loaded, it should implement the **IMAPIProviderShutdown** interface and return MAPI_E_NO_SUPPORT for the **IMAPIProviderShutdown::QueryFastShutdown** method.</span></span> <span data-ttu-id="c9e3c-121">No entanto, para clientes MAPI, como o Outlook, isso fará com que o cliente abandonar desligamento rápido e levar mais tempo para serem desligados.</span><span class="sxs-lookup"><span data-stu-id="c9e3c-121">However, for MAPI clients such as Outlook, this will cause the client to abandon fast shutdown and take a longer time to shut down.</span></span> 
    
## <a name="see-also"></a><span data-ttu-id="c9e3c-122">Confira também</span><span class="sxs-lookup"><span data-stu-id="c9e3c-122">See also</span></span>



[<span data-ttu-id="c9e3c-123">Desligamento do cliente em MAPI</span><span class="sxs-lookup"><span data-stu-id="c9e3c-123">Client Shutdown in MAPI</span></span>](client-shutdown-in-mapi.md)
  
[<span data-ttu-id="c9e3c-124">Visão geral do desligamento rápido</span><span class="sxs-lookup"><span data-stu-id="c9e3c-124">Fast Shutdown Overview</span></span>](fast-shutdown-overview.md)
  
[<span data-ttu-id="c9e3c-125">Opções de usuário do desligamento rápido</span><span class="sxs-lookup"><span data-stu-id="c9e3c-125">Fast Shutdown User Options</span></span>](fast-shutdown-user-options.md)

