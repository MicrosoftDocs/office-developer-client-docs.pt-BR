---
title: Fazer logon no MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 05bafe43-a78a-4659-92f0-0b4fe444c64f
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: cce43301ac73a5646e263b2ab92700e57804637d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419706"
---
# <a name="logging-on-to-mapi"></a><span data-ttu-id="b4b4e-103">Fazer logon no MAPI</span><span class="sxs-lookup"><span data-stu-id="b4b4e-103">Logging on to MAPI</span></span>
 
<span data-ttu-id="b4b4e-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="b4b4e-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="b4b4e-105">Os aplicativos cliente fazem logoff no subsistema MAPI chamando a **função MAPILogonEx.**</span><span class="sxs-lookup"><span data-stu-id="b4b4e-105">Client applications log on to the MAPI subsystem by calling the **MAPILogonEx** function.</span></span> <span data-ttu-id="b4b4e-106">Para obter mais informações, [consulte MAPILogonEx](mapilogonex.md).</span><span class="sxs-lookup"><span data-stu-id="b4b4e-106">For more information, see [MAPILogonEx](mapilogonex.md).</span></span> <span data-ttu-id="b4b4e-107">**O MAPILogonEx valida** a seleção de perfil e a configuração de cada provedor de serviços no perfil.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-107">**MAPILogonEx** validates the profile selection and the configuration of each service provider in the profile.</span></span> <span data-ttu-id="b4b4e-108">Depois de configurado, o MAPI inicia os provedores de agendas antes de iniciar os provedores de armazenamento de mensagens.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-108">Once configured, MAPI starts the address book providers before starting the message store providers.</span></span> <span data-ttu-id="b4b4e-109">Os provedores de transporte são iniciados quando seus serviços são necessários pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-109">Transport providers are started when their services are first required.</span></span> 
  
## <a name="choose-a-profile"></a><span data-ttu-id="b4b4e-110">Escolher um perfil</span><span class="sxs-lookup"><span data-stu-id="b4b4e-110">Choose a profile</span></span>
  
- <span data-ttu-id="b4b4e-111">Passe uma cadeia de caracteres que representa o nome do perfil no parâmetro  _lpszProfileName_ para **MAPILogonEx** ou...</span><span class="sxs-lookup"><span data-stu-id="b4b4e-111">Pass in a character string that represents the name of the profile in the  _lpszProfileName_ parameter to **MAPILogonEx**, or...</span></span>
    
- <span data-ttu-id="b4b4e-112">Permita que o usuário especifique o perfil passando NULL no parâmetro  _lpszProfileName_ e definindo o sinalizador MAPI_LOGON_UI, ou...</span><span class="sxs-lookup"><span data-stu-id="b4b4e-112">Allow the user to specify the profile by passing NULL in the  _lpszProfileName_ parameter and setting the MAPI_LOGON_UI flag, or...</span></span> 

- <span data-ttu-id="b4b4e-113">Selecione o perfil padrão passando NULL no parâmetro  _lpszProfileName_ e definindo o MAPI_USE_DEFAULT padrão.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-113">Select the default profile by passing NULL in the  _lpszProfileName_ parameter and setting the MAPI_USE_DEFAULT flag.</span></span> 
    
<span data-ttu-id="b4b4e-114">Se você precisar de um perfil específico diferente do perfil padrão, deverá salvar seu nome em seu próprio banco de dados de configuração ou usar uma convenção de nomenal específica.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-114">If you require a specific profile other than the default profile, you must save its name in your own configuration database or use a specific naming convention.</span></span> <span data-ttu-id="b4b4e-115">MAPI does not expose any profile attributes other than the name and default flag in the profile table, and the default profile flag is reserved for messaging client and related IPM applications.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-115">MAPI does not expose any profile attributes other than the name and default flag in the profile table, and the default profile flag is reserved for messaging client and related IPM applications.</span></span>
  
<span data-ttu-id="b4b4e-116">Clientes que fornecem informações parciais de configuração de perfil ou provedor para **MAPILogonEx** devem solicitar ao usuário os dados adicionais, permitindo que uma caixa de diálogo seja exibida.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-116">Clients that supply partial profile or provider configuration information to **MAPILogonEx** must prompt the user for the additional data by allowing a dialog box to be displayed.</span></span> <span data-ttu-id="b4b4e-117">Se as informações estão ausentes e **o MAPILogonEx não** pode solicitar que o usuário as fornegue, o logon falhará.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-117">If information is missing and **MAPILogonEx** cannot prompt the user to supply it, the logon fails.</span></span> <span data-ttu-id="b4b4e-118">Clientes que não precisam de entrada do usuário podem suprimir a exibição da caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-118">Clients that do not need user input can suppress the dialog box display.</span></span> 
  
<span data-ttu-id="b4b4e-119">Os sinalizadores que **MAPILogonEx** usa para habilitar uma interface do usuário são mutuamente exclusivos; somente um pode ser definido.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-119">The flags that **MAPILogonEx** uses to enable a user interface are mutually exclusive; only one can be set.</span></span> <span data-ttu-id="b4b4e-120">Deixar esses sinalizadores sem sinal suprime a exibição de uma interface do usuário, fazendo com que **MAPILogonEx** falhe se as informações necessárias não são fornecidas.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-120">Leaving these flags unset suppresses the display of a user interface, causing **MAPILogonEx** to fail if necessary information is missing.</span></span> <span data-ttu-id="b4b4e-121">Ou seja, se você desabilitar a interface do usuário e passar NULL para o parâmetro  _lpszProfileName_ e não definir o sinalizador MAPI_USE_DEFAULT, **o MAPILogonEx** falhará porque não é possível recuperar um nome de perfil.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-121">That is, if you disable the user interface and pass NULL for the  _lpszProfileName_ parameter and do not set the MAPI_USE_DEFAULT flag, **MAPILogonEx** will fail because it cannot retrieve a profile name.</span></span> 
  
<span data-ttu-id="b4b4e-122">A sessão que **o MAPILogonEx** estabelece pode ser uma sessão de mensagens individual, uma sessão de mensagens compartilhada ou uma sessão não-desastrável.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-122">The session that **MAPILogonEx** establishes can be an individual messaging session, a shared messaging session, or a nonmessaging session.</span></span> <span data-ttu-id="b4b4e-123">Sessões de mensagens individuais são conexões privadas entre seu cliente e o subsistema MAPI e podem ser estabelecidas definindo o sinalizador MAPI_NEW_SESSION na chamada para **MAPILogonEx**.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-123">Individual messaging sessions are private connections between your client and the MAPI subsystem and can be established by setting the MAPI_NEW_SESSION flag in the call to **MAPILogonEx**.</span></span>
  
<span data-ttu-id="b4b4e-124">As sessões de mensagens compartilhadas são conexões que vários clientes de mensagens podem usar.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-124">Shared messaging sessions are connections that multiple messaging clients can use.</span></span> <span data-ttu-id="b4b4e-125">As sessões compartilhadas geralmente são estabelecidas para que os clientes usem o mesmo perfil.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-125">Shared sessions are typically established for clients use the same profile.</span></span> <span data-ttu-id="b4b4e-126">Para estabelecer uma nova sessão como uma sessão compartilhada, de definida a MAPI_ALLOW_OTHERS configuração.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-126">To establish a new session as a shared session, set the MAPI_ALLOW_OTHERS flag.</span></span> 
  
## <a name="use-an-existing-shared-session"></a><span data-ttu-id="b4b4e-127">Usar uma sessão compartilhada existente</span><span class="sxs-lookup"><span data-stu-id="b4b4e-127">Use an existing shared session</span></span>
  
- <span data-ttu-id="b4b4e-128">Não de definida a MAPI_NEW_SESSION sinalizador.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-128">Do not set the MAPI_NEW_SESSION flag.</span></span>
    
- <span data-ttu-id="b4b4e-129">Não de definida a MAPI_ALLOW_OTHERS sinalizador.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-129">Do not set the MAPI_ALLOW_OTHERS flag.</span></span>
    
- <span data-ttu-id="b4b4e-130">Passe NULL para o _parâmetro lpszProfileName._</span><span class="sxs-lookup"><span data-stu-id="b4b4e-130">Pass NULL for the  _lpszProfileName_ parameter.</span></span> 
    
- <span data-ttu-id="b4b4e-131">Passe NULL para o _parâmetro lpszPassword._</span><span class="sxs-lookup"><span data-stu-id="b4b4e-131">Pass NULL for the  _lpszPassword_ parameter.</span></span> 
    
<span data-ttu-id="b4b4e-132">As sessões não-desaessaria permitem que os clientes acessem o subsistema MAPI, mas não permitem que mensagens sejam enviadas ou recebidas.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-132">Nonmessaging sessions allow clients to access the MAPI subsystem, but do not allow messages to be sent or received.</span></span> <span data-ttu-id="b4b4e-133">Aplicativos de configuração ou administração são exemplos de clientes que talvez precisem estabelecer sessões não-desessariamente.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-133">Configuration or administration applications are examples of clients that might need to establish nonmessaging sessions.</span></span> <span data-ttu-id="b4b4e-134">Para solicitar uma sessão que não seja desaessaria, de definida a MAPI_NO_MAIL configuração.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-134">To request a nonmessaging session, set the MAPI_NO_MAIL flag.</span></span> <span data-ttu-id="b4b4e-135">A configuração desse sinalizador registra seu cliente sem informar o spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-135">Setting this flag logs your client on without informing the MAPI spooler.</span></span> <span data-ttu-id="b4b4e-136">Clientes que se registram no MAPI com esse sinalizador não podem esperar receber relatórios de status de leitura.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-136">Clients that log on to MAPI with this flag cannot expect to ever receive read status reports.</span></span>
  
<span data-ttu-id="b4b4e-137">O MAPI_NO_MAIL sinalizador só deve ser definido:</span><span class="sxs-lookup"><span data-stu-id="b4b4e-137">The MAPI_NO_MAIL flag should only be set:</span></span>
  
- <span data-ttu-id="b4b4e-138">Se o cliente não enviar ou receber mensagens durante a sessão.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-138">If your client will not send or receive messages during the session.</span></span>
    
- <span data-ttu-id="b4b4e-139">Se seu cliente tiver controle total sobre o conteúdo do perfil e as mensagens serão enviadas e recebidas usando provedores de transporte e armazenamento de mensagens fortemente a par, como os provedores do Microsoft Exchange.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-139">If your client has complete control over the contents of the profile and messages are sent and received using tightly coupled message store and transport providers, such as the Microsoft Exchange providers.</span></span>
    
<span data-ttu-id="b4b4e-140">Um cliente de mensagens pode compartilhar uma sessão com um cliente não-desaessariado.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-140">A messaging client can share a session with a nonmessaging client.</span></span> <span data-ttu-id="b4b4e-141">As características de um membro de uma sessão compartilhada não são afetadas pelas características de outros membros.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-141">The characteristics of one member of a shared session are not affected by the characteristics of other members.</span></span> <span data-ttu-id="b4b4e-142">Ou seja, se você fizer logon com os sinalizadores MAPI_NO_MAIL e MAPI_ALLOW_OTHERS definidos, um cliente de mensagens que faça logon em sua sessão não terá efeito sobre a operação do seu cliente e vice-versa.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-142">That is, if you log on with the MAPI_NO_MAIL and MAPI_ALLOW_OTHERS flags set, a messaging client logging on to your session has no affect on the operation of your client and vice versa.</span></span> <span data-ttu-id="b4b4e-143">O cliente de mensagens ainda poderá enviar e receber mensagens, e seu cliente não.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-143">The messaging client will still be able to send and receive messages and your client will not.</span></span>
  
<span data-ttu-id="b4b4e-144">**MAPILogonEx** define alguns outros sinalizadores que você pode definir:</span><span class="sxs-lookup"><span data-stu-id="b4b4e-144">**MAPILogonEx** defines a few other flags that you can set:</span></span> 
  
- <span data-ttu-id="b4b4e-145">MAPI_FORCE_DOWNLOAD indica que as mensagens de entrada devem ser baixadas antes que **MAPILogonEx seja** retornada.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-145">MAPI_FORCE_DOWNLOAD indicates that incoming messages should be downloaded before **MAPILogonEx** returns.</span></span> <span data-ttu-id="b4b4e-146">Não definir esse sinalizador faz com que as mensagens sejam baixadas em segundo plano posteriormente.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-146">Not setting this flag causes messages to be downloaded in the background at a later time.</span></span> 
    
- <span data-ttu-id="b4b4e-147">MAPI_SERVICE_UI_ALWAYS solicita que todos os serviços de mensagens no perfil exibem uma caixa de diálogo de configuração.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-147">MAPI_SERVICE_UI_ALWAYS requests that every message service in the profile display a configuration dialog box.</span></span>
    
- <span data-ttu-id="b4b4e-148">MAPI_NT_SERVICE indica que seu cliente é implementado como um serviço do Windows.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-148">MAPI_NT_SERVICE indicates that your client is implemented as a Windows service.</span></span> <span data-ttu-id="b4b4e-149">Esse sinalizador deve ser definido se o cliente for um serviço.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-149">This flag must be set if your client is a service.</span></span>
    
<span data-ttu-id="b4b4e-150">A cada logon bem-sucedido, **MAPILogonEx** retorna um ponteiro para uma sessão MAPI.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-150">With every successful logon, **MAPILogonEx** returns a pointer to a MAPI session.</span></span> <span data-ttu-id="b4b4e-151">Você pode usar esse ponteiro para chamar os métodos da interface **IMAPISession.**</span><span class="sxs-lookup"><span data-stu-id="b4b4e-151">You can use this pointer to call the methods of the **IMAPISession** interface.</span></span> <span data-ttu-id="b4b4e-152">Para obter mais informações, [consulte IMAPISession : IUnknown](imapisessioniunknown.md).</span><span class="sxs-lookup"><span data-stu-id="b4b4e-152">For more information, see [IMAPISession : IUnknown](imapisessioniunknown.md).</span></span> <span data-ttu-id="b4b4e-153">Ponteiros de sessão, independentemente do tipo de sessão, são exclusivos para os clientes que os recebem e não são válidos entre tarefas.</span><span class="sxs-lookup"><span data-stu-id="b4b4e-153">Session pointers, regardless of the type of session, are unique to the clients that receive them and are not valid across tasks.</span></span>
  

