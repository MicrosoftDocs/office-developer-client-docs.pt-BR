---
title: Criar e armazenar mensagens em repositórios de mensagens
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: cc74b31c-d7ed-4fcf-9535-a2f9222901b7
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: 7c923a330c542dff8b1bbc476461ccd21680a5b7
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32332897"
---
# <a name="creating-and-storing-messages-in-message-stores"></a><span data-ttu-id="781b6-103">Criar e armazenar mensagens em repositórios de mensagens</span><span class="sxs-lookup"><span data-stu-id="781b6-103">Creating and Storing Messages in Message Stores</span></span>

  
  
<span data-ttu-id="781b6-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="781b6-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="781b6-105">Como o seu provedor de repositório de mensagens cria e armazena mensagens no mecanismo de armazenamento subjacente depende fortemente do próprio mecanismo de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="781b6-105">How your message store provider creates and stores messages in the underlying storage mechanism depends heavily on the underlying storage mechanism itself.</span></span> <span data-ttu-id="781b6-106">Em geral, você precisa apenas escrever o código para preservar as propriedades de uma mensagem e seus valores.</span><span class="sxs-lookup"><span data-stu-id="781b6-106">In general, you need only to write code to preserve the properties of a message and their values.</span></span>
  
<span data-ttu-id="781b6-107">Quando o provedor de repositório de mensagens cria uma nova mensagem, ele precisa criar a mensagem com as propriedades requeridas para mensagens.</span><span class="sxs-lookup"><span data-stu-id="781b6-107">When the message store provider creates a new message, the provider needs to create the message with the required properties for messages.</span></span> <span data-ttu-id="781b6-108">Você pode encontrar uma lista dessas propriedades na documentação da interface [IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md).</span><span class="sxs-lookup"><span data-stu-id="781b6-108">A list of these properties can be found in the documentation for the [IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md) interface.</span></span> <span data-ttu-id="781b6-109">Depois disso, os aplicativos clientes acrescentam quaisquer propriedades adicionais com os métodos [IMAPIProp](imapipropiunknown.md).</span><span class="sxs-lookup"><span data-stu-id="781b6-109">After that, client applications add any additional properties with [IMAPIProp](imapipropiunknown.md) methods.</span></span> 
  
<span data-ttu-id="781b6-110">Quando o provedor de repositório de mensagens salva uma mensagem no mecanismo de armazenamento subjacente, o provedor precisa iterar sobre as propriedades das mensagens e salvá-las no mecanismo de armazenamento subjacente para que possam ser totalmente recuperadas se a mensagem for aberta mais tarde.</span><span class="sxs-lookup"><span data-stu-id="781b6-110">When the message store provider saves a message to the underlying storage mechanism, the provider needs to iterate over the message's properties, and save them to the underlying storage mechanism such that they can be fully recovered if the message is later opened.</span></span>
  
<span data-ttu-id="781b6-111">A MAPI requer que as propriedades nas interfaces [IMessage](imessageimapiprop.md) sejam negociadas, o que significa que as alterações feitas nessas propriedades não se tornem permanentes até que o método [IMAPIProp::SaveChanges](imapiprop-savechanges.md) seja chamado no objeto da mensagem.</span><span class="sxs-lookup"><span data-stu-id="781b6-111">MAPI requires that the properties on [IMessage](imessageimapiprop.md) interfaces are transacted, meaning that changes made to them do not become permanent until the [IMAPIProp::SaveChanges](imapiprop-savechanges.md) method is called on the message object.</span></span> <span data-ttu-id="781b6-112">O provedor de repositório de mensagem é responsável pela implementação desse comportamento.</span><span class="sxs-lookup"><span data-stu-id="781b6-112">The message store provider is responsible for implementing this behavior.</span></span> <span data-ttu-id="781b6-113">Geralmente, isso não é difícil; significa simplesmente manter as propriedades na memória enquanto elas estão sendo modificadas e confirmá-las para o mecanismo de armazenamento subjacente quando **SaveChanges** for chamado.</span><span class="sxs-lookup"><span data-stu-id="781b6-113">Usually this is not difficult; it simply means holding properties in memory while they are being modified and committing them to the underlying storage mechanism when **SaveChanges** is called.</span></span> 
  
<span data-ttu-id="781b6-114">Algumas propriedades em objetos de mensagem tem semântica especial para aplicativos clientes em relação ao método **SaveChanges** método, como descrito a seguir:</span><span class="sxs-lookup"><span data-stu-id="781b6-114">Some properties on message objects have special semantics for client applications with respect to the **SaveChanges** method, as follows:</span></span> 
  
- <span data-ttu-id="781b6-115">Algumas propriedades devem ser de leitura/gravação antes de **SaveChanges** ser chamado, mas do tipo somente leitura depois disso.</span><span class="sxs-lookup"><span data-stu-id="781b6-115">Some properties should be read/write before **SaveChanges** is called, but read-only afterward.</span></span> <span data-ttu-id="781b6-116">Por exemplo, **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) é definida inicialmente pelo aplicativo cliente que cria a mensagem (sendo assim de leitura/gravação), mas não pode ser alterada depois da primeira chamada para **SaveChanges**.</span><span class="sxs-lookup"><span data-stu-id="781b6-116">For example, **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) is set initially by the client application that creates the message (and thus is read/write) but cannot be changed after the first call to **SaveChanges**.</span></span>
    
- <span data-ttu-id="781b6-117">Algumas propriedades têm relações especiais com propriedades das pastas em que estão ou com métodos **IMAPIFolder**.</span><span class="sxs-lookup"><span data-stu-id="781b6-117">Some properties have special relations to properties on the folder they are in or to **IMAPIFolder** methods.</span></span> <span data-ttu-id="781b6-118">Por exemplo, a propriedade **PR_MESSAGE_FLAGS** está relacionada com os sinalizadores usados na chamada [IMAPIFolder::CreateMessage](imapifolder-createmessage.md).</span><span class="sxs-lookup"><span data-stu-id="781b6-118">For example, the **PR_MESSAGE_FLAGS** property is related to the flags used on the [IMAPIFolder::CreateMessage](imapifolder-createmessage.md) call.</span></span> 
    
- <span data-ttu-id="781b6-119">Algumas propriedades podem não estar disponíveis até que **SaveChanges** seja chamado pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="781b6-119">Some properties may not be available until **SaveChanges** is called for the first time.</span></span> <span data-ttu-id="781b6-120">Por exemplo, a propriedade **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) pode não estar disponível até que **SaveChanges** seja chamado.</span><span class="sxs-lookup"><span data-stu-id="781b6-120">For example, the **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) property may not be available until **SaveChanges** is called.</span></span> 
    
- <span data-ttu-id="781b6-121">Algumas propriedades podem ter relações especiais com outras propriedades do objeto de mensagem.</span><span class="sxs-lookup"><span data-stu-id="781b6-121">Some properties can have special relationships to other properties on the message object.</span></span> <span data-ttu-id="781b6-122">Por exemplo, a propriedade **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) geralmente deriva da propriedade **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) nos provedores de repositório de mensagens que suportam mensagens no Formato Rich Text.</span><span class="sxs-lookup"><span data-stu-id="781b6-122">For example, the **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) property is usually derived from the **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) property in message store providers that support Rich Text Format messages.</span></span>
    
- <span data-ttu-id="781b6-123">Algumas propriedades são usadas por mais de um tipo de objeto relacionado aos repositórios de mensagens.</span><span class="sxs-lookup"><span data-stu-id="781b6-123">Some properties are used by more than one object type related to message stores.</span></span> <span data-ttu-id="781b6-124">Por exemplo, a propriedade **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) é necessária na pasta e nos objetos de mensagem, bem como nos objetos de repositórios de mensagens.</span><span class="sxs-lookup"><span data-stu-id="781b6-124">For example, the **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property is required on folder and message objects as well as message store objects.</span></span>
    
<span data-ttu-id="781b6-125">É responsabilidade do provedor de repositórios de mensagem implementar a semântica correta para essas propriedades.</span><span class="sxs-lookup"><span data-stu-id="781b6-125">It is the responsibility of the message store provider to implement the correct semantics for such properties.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="781b6-126">Confira também</span><span class="sxs-lookup"><span data-stu-id="781b6-126">See also</span></span>



[<span data-ttu-id="781b6-127">Implementar mensagens em repositórios de mensagens</span><span class="sxs-lookup"><span data-stu-id="781b6-127">Implementing Messages in Message Stores</span></span>](implementing-messages-in-message-stores.md)

