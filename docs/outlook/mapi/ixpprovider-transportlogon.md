---
title: IXPProviderTransportLogon
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IXPProvider.TransportLogon
api_type:
- COM
ms.assetid: 534929f2-36a2-463d-8c4c-d86060cde127
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: 96e81442125ae49e0c2856a1cf3a97a16d3453cf
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22583334"
---
# <a name="ixpprovidertransportlogon"></a><span data-ttu-id="68668-103">IXPProvider::TransportLogon</span><span class="sxs-lookup"><span data-stu-id="68668-103">IXPProvider::TransportLogon</span></span>

<span data-ttu-id="68668-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="68668-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="68668-105">Estabelece uma sessão em que um aplicativo cliente faz logon em um provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="68668-105">Establishes a session in which a client application logs on to a transport provider.</span></span> 
  
```cpp
HRESULT TransportLogon(
  LPMAPISUP lpMAPISup,
  ULONG_PTR ulUIParam,
  LPSTR lpszProfileName,
  ULONG FAR * lpulFlags,
  LPMAPIERROR FAR * lppMAPIError,
  LPXPLOGON FAR * lppXPLogon
);
```

## <a name="parameters"></a><span data-ttu-id="68668-106">Parâmetros</span><span class="sxs-lookup"><span data-stu-id="68668-106">Parameters</span></span>

<span data-ttu-id="68668-107">_lpMAPISup_: [in] ponteiro para objeto de suporte do provedor de transporte para funções de retorno de chamada dentro de MAPI para esta sessão.</span><span class="sxs-lookup"><span data-stu-id="68668-107">_lpMAPISup_: [in] Pointer to the transport provider's support object for callback functions within MAPI for this session.</span></span> <span data-ttu-id="68668-108">Este objeto permanece válido até que o provedor de transporte libera a ele.</span><span class="sxs-lookup"><span data-stu-id="68668-108">This object remains valid until the transport provider releases it.</span></span>
    
<span data-ttu-id="68668-109">_ulUIParam_: [alça para a janela pai de todas as caixas de diálogo ou windows esse método exibe in].</span><span class="sxs-lookup"><span data-stu-id="68668-109">_ulUIParam_: [in] Handle to the parent window of any dialog boxes or windows this method displays.</span></span> <span data-ttu-id="68668-110">O parâmetro _ulUIParam_ pode ser não-nulo, por exemplo, quando o LOGON_SETUP sinalizar é definida no parâmetro _lpulFlags_ .</span><span class="sxs-lookup"><span data-stu-id="68668-110">The  _ulUIParam_ parameter can be non-null, for example when the LOGON_SETUP flag is set in the  _lpulFlags_ parameter.</span></span> 
    
<span data-ttu-id="68668-111">_lpszProfileName_: [in] ponteiro para o nome do perfil do usuário.</span><span class="sxs-lookup"><span data-stu-id="68668-111">_lpszProfileName_: [in] Pointer to the profile name of the user.</span></span> <span data-ttu-id="68668-112">O parâmetro _lpszProfileName_ é usado principalmente quando uma caixa de diálogo deve ser apresentada.</span><span class="sxs-lookup"><span data-stu-id="68668-112">The  _lpszProfileName_ parameter is primarily used when a dialog box must be presented.</span></span> 
    
<span data-ttu-id="68668-113">_lpulFlags_: [in, out] Bitmask dos sinalizadores que controla como a sessão de logon é estabelecida.</span><span class="sxs-lookup"><span data-stu-id="68668-113">_lpulFlags_: [in, out] Bitmask of flags that controls how the logon session is established.</span></span> <span data-ttu-id="68668-114">Sinalizadores a seguir podem ser definidos na entrada pelo spooler MAPI:</span><span class="sxs-lookup"><span data-stu-id="68668-114">The following flags can be set on input by the MAPI spooler:</span></span>
    
  - <span data-ttu-id="68668-115">LOGON_NO_CONNECT: A conta de usuário está fazendo logon com esse provedor de transporte para fins que não seja de transmissão e recepção de mensagens.</span><span class="sxs-lookup"><span data-stu-id="68668-115">LOGON_NO_CONNECT: The user account is logging on to this transport provider for purposes other than transmission and reception of messages.</span></span> <span data-ttu-id="68668-116">O provedor de transporte não deve tentar fazer quaisquer conexões com outros sistemas de mensagens.</span><span class="sxs-lookup"><span data-stu-id="68668-116">The transport provider should not attempt to make any connections to other messaging systems.</span></span>
        
  - <span data-ttu-id="68668-117">LOGON_NO_DIALOG: Nenhuma caixa de diálogo deve ser exibida, mesmo se as credenciais de usuário que foram salvos no momento são inválidos ou insuficientes para logon.</span><span class="sxs-lookup"><span data-stu-id="68668-117">LOGON_NO_DIALOG: No dialog box should be displayed even if the currently saved user credentials are invalid or insufficient for logon.</span></span>
        
  - <span data-ttu-id="68668-118">LOGON_NO_INBOUND: O provedor de transporte não precisa inicializar para recepção de mensagens e não deve aceitar mensagens de entrada.</span><span class="sxs-lookup"><span data-stu-id="68668-118">LOGON_NO_INBOUND: The transport provider does not have to initialize for reception of messages and should not accept incoming messages.</span></span> <span data-ttu-id="68668-119">O MAPI spooler pode usar o método [IXPLogon::TransportNotify](ixplogon-transportnotify.md) posteriormente para sinalizar o provedor de transporte para habilitar o processamento de mensagens de entrada.</span><span class="sxs-lookup"><span data-stu-id="68668-119">The MAPI spooler can use the [IXPLogon::TransportNotify](ixplogon-transportnotify.md) method later to signal the transport provider to enable incoming message processing.</span></span> 
        
  - <span data-ttu-id="68668-120">LOGON_NO_OUTBOUND: O provedor de transporte não tem ao inicializar o envio de mensagens, como o spooler MAPI não fornecerá nenhum.</span><span class="sxs-lookup"><span data-stu-id="68668-120">LOGON_NO_OUTBOUND: The transport provider does not have to initialize for sending messages, as the MAPI spooler does not provide any.</span></span> <span data-ttu-id="68668-121">Se um aplicativo cliente requer uma conexão a um provedor remoto durante a composição de uma mensagem para que ele possa fazer chamadas de método [IXPLogon::AddressTypes](ixplogon-addresstypes.md) , o provedor de transporte verifique a conexão.</span><span class="sxs-lookup"><span data-stu-id="68668-121">If a client application requires a connection to a remote provider during the composition of a message so that it can make [IXPLogon::AddressTypes](ixplogon-addresstypes.md) method calls, the transport provider should make the connection.</span></span> <span data-ttu-id="68668-122">O MAPI spooler pode usar **TransportNotify** para sinalizar o provedor de transporte quando começam a saída de operações.</span><span class="sxs-lookup"><span data-stu-id="68668-122">The MAPI spooler can use **TransportNotify** to signal the transport provider when outgoing operations can begin.</span></span> 
      
  - <span data-ttu-id="68668-123">MAPI_UNICODE: A sequência no passado para o nome do perfil está no formato Unicode.</span><span class="sxs-lookup"><span data-stu-id="68668-123">MAPI_UNICODE: The passed-in string for the profile name is in Unicode format.</span></span> <span data-ttu-id="68668-124">Se o MAPI\_sinalizador UNICODE não estiver definida, a cadeia de caracteres é no formato ANSI.</span><span class="sxs-lookup"><span data-stu-id="68668-124">If the MAPI\_UNICODE flag is not set, the string is in ANSI format.</span></span>
      
    <span data-ttu-id="68668-125">Sinalizadores a seguir podem ser definidos em saída pelo provedor de transporte:</span><span class="sxs-lookup"><span data-stu-id="68668-125">The following flags can be set on output by the transport provider:</span></span>
      
  - <span data-ttu-id="68668-126">LOGON_SP_IDLE: Solicitações o MAPI spooler frequentemente chamar método de [IXPLogon::Idle](ixplogon-idle.md) do provedor de transporte para o processamento de tempo ocioso.</span><span class="sxs-lookup"><span data-stu-id="68668-126">LOGON_SP_IDLE: Requests that the MAPI spooler frequently call the transport provider's [IXPLogon::Idle](ixplogon-idle.md) method for idle-time processing.</span></span> 
      
  - <span data-ttu-id="68668-127">LOGON_SP_POLL: Solicita que o MAPI spooler frequentemente chamar o método [IXPLogon::Poll](ixplogon-poll.md) no objeto retornado de logon para verificar novas mensagens.</span><span class="sxs-lookup"><span data-stu-id="68668-127">LOGON_SP_POLL: Requests that the MAPI spooler frequently call the [IXPLogon::Poll](ixplogon-poll.md) method on the returned logon object to check for new messages.</span></span> <span data-ttu-id="68668-128">Se esse sinalizador não estiver definida, o MAPI spooler apenas verifica novas mensagens quando o provedor de transporte usa o método [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) para notificar o spooler que não existem novas mensagens para processar.</span><span class="sxs-lookup"><span data-stu-id="68668-128">If this flag is not set, the MAPI spooler only checks for new messages when the transport provider uses the [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) method to notify the spooler that there are new messages to process.</span></span> <span data-ttu-id="68668-129">Um provedor de transporte se torna efetivamente somente enviar, não definindo esse sinalizador e por não notificar o MAPI spooler de recebimento da mensagem.</span><span class="sxs-lookup"><span data-stu-id="68668-129">A transport provider effectively becomes send-only by not setting this flag and by not notifying the MAPI spooler of message receipt.</span></span> 
      
  - <span data-ttu-id="68668-130">LOGON_SP_RESOLVE: Solicitações que resolve o MAPI spooler total endereços de todos os endereços de mensagem para destinatários não suportados por este provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="68668-130">LOGON_SP_RESOLVE: Requests that the MAPI spooler resolve to full addresses all message addresses for recipients not supported by this transport provider.</span></span> <span data-ttu-id="68668-131">Portanto, se o provedor de transporte pode construir um caminho de resposta para todos os destinatários.</span><span class="sxs-lookup"><span data-stu-id="68668-131">Therefore that the transport provider can construct a reply path for all recipients.</span></span>
      
  - <span data-ttu-id="68668-132">MAPI_UNICODE: As cadeias de caracteres retornadas na estrutura de [MAPIERROR](mapierror.md) , se houver, estão no formato Unicode.</span><span class="sxs-lookup"><span data-stu-id="68668-132">MAPI_UNICODE: The returned strings in the [MAPIERROR](mapierror.md) structure, if any, are in Unicode format.</span></span> <span data-ttu-id="68668-133">Se o sinalizador MAPI_UNICODE não estiver definido, as cadeias de caracteres estão no formato ANSI.</span><span class="sxs-lookup"><span data-stu-id="68668-133">If the MAPI_UNICODE flag is not set, the strings are in ANSI format.</span></span> 
    
<span data-ttu-id="68668-134">_lppMAPIError_: [out] ponteiro para um ponteiro para a estrutura **MAPIERROR** retornado, se houver, que contém informações de versão, componente e contexto para o erro.</span><span class="sxs-lookup"><span data-stu-id="68668-134">_lppMAPIError_: [out] Pointer to a pointer to the returned **MAPIERROR** structure, if any, that contains version, component, and context information for the error.</span></span> <span data-ttu-id="68668-135">O parâmetro _lppMAPIError_ pode ser definido como NULL se não houver nenhuma estrutura **MAPIERROR** para retornar.</span><span class="sxs-lookup"><span data-stu-id="68668-135">The  _lppMAPIError_ parameter can be set to NULL if there is no **MAPIERROR** structure to return.</span></span> 
    
<span data-ttu-id="68668-136">_lppXPLogon_: [out] ponteiro para o ponteiro para o objeto de logon do provedor de transporte retornado.</span><span class="sxs-lookup"><span data-stu-id="68668-136">_lppXPLogon_: [out] Pointer to the pointer to the returned transport provider logon object.</span></span>
    
## <a name="return-value"></a><span data-ttu-id="68668-137">Valor de retorno</span><span class="sxs-lookup"><span data-stu-id="68668-137">Return value</span></span>

<span data-ttu-id="68668-138">S_OK: A chamada foi bem-sucedida e retornou o valor esperado ou os valores.</span><span class="sxs-lookup"><span data-stu-id="68668-138">S_OK: The call succeeded and has returned the expected value or values.</span></span>
    
<span data-ttu-id="68668-139">MAPI_E_FAILONEPROVIDER: Este provedor não pode fazer logon, mas esse erro não deve desabilitar o serviço.</span><span class="sxs-lookup"><span data-stu-id="68668-139">MAPI_E_FAILONEPROVIDER: This provider cannot log on, but this error should not disable the service.</span></span> 
    
<span data-ttu-id="68668-140">MAPI_E_UNCONFIGURED: O perfil não conter informações suficientes para que o logon seja concluída.</span><span class="sxs-lookup"><span data-stu-id="68668-140">MAPI_E_UNCONFIGURED: The profile does not contain enough information for the logon to be completed.</span></span> <span data-ttu-id="68668-141">MAPI chama a função de ponto de entrada do serviço de mensagem do provedor.</span><span class="sxs-lookup"><span data-stu-id="68668-141">MAPI calls the provider's message service entry point function.</span></span>
    
<span data-ttu-id="68668-142">MAPI_E_UNKNOWN_CPID: O provedor não oferece suporte a página de código do cliente.</span><span class="sxs-lookup"><span data-stu-id="68668-142">MAPI_E_UNKNOWN_CPID: The provider cannot support the client's code page.</span></span>
    
<span data-ttu-id="68668-143">MAPI_E_UNKNOWN_LCID: O provedor não oferece suporte a informações de localidade do cliente.</span><span class="sxs-lookup"><span data-stu-id="68668-143">MAPI_E_UNKNOWN_LCID: The provider cannot support the client's locale information.</span></span>
    
<span data-ttu-id="68668-144">MAPI_E_USER_CANCEL: O usuário cancelou a operação, geralmente clicando no botão **Cancelar** em uma caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="68668-144">MAPI_E_USER_CANCEL: The user canceled the operation, typically by clicking the **Cancel** button in a dialog box.</span></span> 
    
## <a name="remarks"></a><span data-ttu-id="68668-145">Comentários</span><span class="sxs-lookup"><span data-stu-id="68668-145">Remarks</span></span>

<span data-ttu-id="68668-146">O MAPI spooler chama o método **IXPProvider::TransportLogon** para estabelecer uma sessão de logon para um usuário.</span><span class="sxs-lookup"><span data-stu-id="68668-146">The MAPI spooler calls the **IXPProvider::TransportLogon** method to establish a logon session for a user.</span></span> 
  
<span data-ttu-id="68668-147">A maioria dos provedores de transporte use o método de [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) fornecido com o objeto de suporte apontado pelo parâmetro _lpMAPISup_ para salvar e recuperar informações de identidade do usuário, os endereços de servidor e credenciais.</span><span class="sxs-lookup"><span data-stu-id="68668-147">Most transport providers use the [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) method provided with the support object pointed to by the  _lpMAPISup_ parameter for saving and retrieving user identity information, server addresses, and credentials.</span></span> <span data-ttu-id="68668-148">Usando o **OpenProfileSection**, um provedor de transporte pode salvar informações arbitrárias e associá-lo a um logon para um determinado recurso.</span><span class="sxs-lookup"><span data-stu-id="68668-148">By using **OpenProfileSection**, a transport provider can save arbitrary information and associate it with a logon to a particular resource.</span></span> <span data-ttu-id="68668-149">Por exemplo, um provedor pode usar **OpenProfileSection** para salvar o nome da conta e a senha associada a uma determinada sessão e quaisquer nomes de servidor ou outras informações necessárias que são necessárias para acessar os recursos para a sessão.</span><span class="sxs-lookup"><span data-stu-id="68668-149">For example, a provider can use **OpenProfileSection** to save the account name and password associated with a particular session and any server names or other necessary information that are required to access resources for that session.</span></span> <span data-ttu-id="68668-150">MAPI oculta informações associadas a um recurso contra o acesso externo.</span><span class="sxs-lookup"><span data-stu-id="68668-150">MAPI hides information associated with a resource from outside access.</span></span> <span data-ttu-id="68668-151">Seção de perfil e torná-los disponível por meio de _lpMAPISup_ é gerenciada pelo spooler MAPI para que dados relacionados nesse contexto do usuário são separados da dados para outros contextos.</span><span class="sxs-lookup"><span data-stu-id="68668-151">The profile section made available through  _lpMAPISup_ is managed by the MAPI spooler so data related to this user context is separated from data for other contexts.</span></span> 
  
<span data-ttu-id="68668-152">O provedor de transporte deve chamar o método **AddRef** no objeto suporte e manter uma cópia do ponteiro para este objeto como parte do objeto de logon do provedor.</span><span class="sxs-lookup"><span data-stu-id="68668-152">The transport provider must call the **IUnknown::AddRef** method on the support object and keep a copy of the pointer to this object as part of the provider logon object.</span></span> 
  
<span data-ttu-id="68668-153">O nome de exibição de perfil no _lpszProfileName_ é fornecido para que o provedor de transporte possa ser usado em caixas de diálogo de logon ou mensagens de erro.</span><span class="sxs-lookup"><span data-stu-id="68668-153">The profile display name in  _lpszProfileName_ is provided so the transport provider can use it in error messages or logon dialog boxes.</span></span> <span data-ttu-id="68668-154">Se o provedor retém esse nome, ele deve ser copiado para o armazenamento alocado pelo provedor.</span><span class="sxs-lookup"><span data-stu-id="68668-154">If the provider retains this name, it must be copied to storage allocated by the provider.</span></span> 
  
<span data-ttu-id="68668-155">Talvez seja necessário fazer trabalho adicional no logon para estabelecer as credenciais de uma boa necessárias para operações entre provedores complementares provedores de transporte que estejam intimamente ligadas a outros provedores de serviços.</span><span class="sxs-lookup"><span data-stu-id="68668-155">Transport providers that are tightly coupled with other service providers may have to do additional work at logon to establish the good credentials required for operations between companion providers.</span></span>
  
<span data-ttu-id="68668-156">Geralmente, os provedores de transporte são abertos quando o usuário fizer logon pela primeira vez a um perfil.</span><span class="sxs-lookup"><span data-stu-id="68668-156">Usually, transport providers are opened when the user first logs on to a profile.</span></span> <span data-ttu-id="68668-157">Porque o primeiro logon para um perfil, portanto, geralmente vem antes do logon em qualquer armazenamento de mensagem, o MAPI spooler geralmente chama **TransportLogon** com os LOGON_NO_INBOUND LOGON_NO_OUTBOUND sinalizadores e definir no _lpulFlags_.</span><span class="sxs-lookup"><span data-stu-id="68668-157">Because the first logon to a profile therefore generally comes before logon to any message store, the MAPI spooler usually calls **TransportLogon** with both the LOGON_NO_INBOUND and LOGON_NO_OUTBOUND flags set in  _lpulFlags_.</span></span> <span data-ttu-id="68668-158">Posteriormente, quando os repositórios de mensagem apropriada estão disponíveis na sessão de perfil, o MAPI spooler chama **TransportNotify** para iniciar as operações de entrada e saídas para o provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="68668-158">Later, when the appropriate message stores are available in the profile session, the MAPI spooler calls **TransportNotify** to initiate incoming and outgoing operations for the transport provider.</span></span> 
  
<span data-ttu-id="68668-159">Passando o sinalizador LOGON_NO_CONNECT os sinais de _lpulFlags_ operação offline do provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="68668-159">Passing the LOGON_NO_CONNECT flag in  _lpulFlags_ signals offline operation of the transport provider.</span></span> <span data-ttu-id="68668-160">Este sinalizador indica que nenhuma conexões externas devem ser feitas; Se o provedor de transporte não é possível estabelecer uma sessão sem uma conexão externa, ele deverá retornar um valor de erro para o logon.</span><span class="sxs-lookup"><span data-stu-id="68668-160">This flag indicates no external connections should be made; if the transport provider cannot establish a session without an external connection, it should return an error value for the logon.</span></span> 
  
<span data-ttu-id="68668-161">Um provedor de transporte deve definir o sinalizador LOGON_SP_IDLE em _lpulFlags_ em tempo de inicialização se ele foi projetado para usar o tempo que o sistema caso contrário gasta ocioso.</span><span class="sxs-lookup"><span data-stu-id="68668-161">A transport provider should set the LOGON_SP_IDLE flag in  _lpulFlags_ at initialization time if it is designed to use time that the system otherwise spends idle.</span></span> <span data-ttu-id="68668-162">Esse período é frequentemente usado para lidar com operações automáticas, como download, automática de mensagens atingiu o tempo mensagem Baixando ou atingiu o tempo de envio da mensagem.</span><span class="sxs-lookup"><span data-stu-id="68668-162">Such time is often used to handle automatic operations, such as automatic message downloading, timed message downloading, or timed message submission.</span></span> <span data-ttu-id="68668-163">Se esse sinalizador estiver definido, o MAPI spooler chama **ocioso** quando ocorre de tempo ocioso do sistema iniciar essas operações.</span><span class="sxs-lookup"><span data-stu-id="68668-163">If this flag is set, the MAPI spooler calls **Idle** when system idle time occurs to initiate such operations.</span></span> <span data-ttu-id="68668-164">O MAPI spooler não chamar **ocioso** em intervalos definidos; em vez disso, ele é chamado somente durante o tempo ocioso true.</span><span class="sxs-lookup"><span data-stu-id="68668-164">The MAPI spooler does not call **Idle** at set intervals; rather, it is called only during true idle time.</span></span> <span data-ttu-id="68668-165">Portanto, os provedores não devem funcionar em qualquer pressuposição sobre frequência seus métodos **Idle** serão chamados.</span><span class="sxs-lookup"><span data-stu-id="68668-165">Therefore, providers should not work on any assumption about how frequently their **Idle** methods will be called.</span></span> <span data-ttu-id="68668-166">Os provedores que suportam as operações de tempo ocioso devem fornecer uma interface de usuário de configuração para ele na sua folha de propriedades do provedor.</span><span class="sxs-lookup"><span data-stu-id="68668-166">Providers that support idle-time operations should supply a configuration user interface for it in their provider property sheet.</span></span> 
  
<span data-ttu-id="68668-167">Se o logon do provedor de transporte for bem sucedido, o provedor deve retornar no parâmetro _lppXPLogon_ um ponteiro para um objeto de logon.</span><span class="sxs-lookup"><span data-stu-id="68668-167">If the transport provider logon succeeds, the provider should return in the  _lppXPLogon_ parameter a pointer to a logon object.</span></span> <span data-ttu-id="68668-168">O MAPI spooler usarão este objeto para acesso do provedor adicionais.</span><span class="sxs-lookup"><span data-stu-id="68668-168">The MAPI spooler will use this object for additional provider access.</span></span> <span data-ttu-id="68668-169">Se **TransportLogon** exibe uma caixa de diálogo de logon e o usuário cancela logon normalmente clicando no botão **Cancelar** na caixa de diálogo o provedor deve retornar MAPI_E_USER_CANCEL.</span><span class="sxs-lookup"><span data-stu-id="68668-169">If **TransportLogon** displays a logon dialog box and the user cancels logon typically by clicking the **Cancel** button in the dialog box the provider should return MAPI_E_USER_CANCEL.</span></span> 
  
<span data-ttu-id="68668-170">Para a maioria dos valores de erro retornado da **TransportLogon**, MAPI desabilita os serviços de mensagem ao qual o provedor pertence.</span><span class="sxs-lookup"><span data-stu-id="68668-170">For most error values returned from **TransportLogon**, MAPI disables the message services to which the provider belongs.</span></span> <span data-ttu-id="68668-171">MAPI não chamará qualquer provedor que pertencem a esse serviço para o restante da sessão MAPI.</span><span class="sxs-lookup"><span data-stu-id="68668-171">MAPI will not call any providers that belong to that service for the rest of the MAPI session.</span></span> <span data-ttu-id="68668-172">Por outro lado, quando **TransportLogon** retorna o valor de erro MAPI_E_FAILONEPROVIDER de seu logon, MAPI não desabilite o serviço de mensagem ao qual o provedor pertence.</span><span class="sxs-lookup"><span data-stu-id="68668-172">In contrast, when **TransportLogon** returns the MAPI_E_FAILONEPROVIDER error value from its logon, MAPI does not disable the message service to which the provider belongs.</span></span> <span data-ttu-id="68668-173">**TransportLogon** deve retornar MAPI_E_FAILONEPROVIDER se encontra um erro dizendo que não garantem a desabilitação do serviço para o restante da sessão.</span><span class="sxs-lookup"><span data-stu-id="68668-173">**TransportLogon** should return MAPI_E_FAILONEPROVIDER if it encounters an error that does not warrant disabling the service for the rest of the session.</span></span> 
  
<span data-ttu-id="68668-174">Se um provedor retorna MAPI_E_UNCONFIGURED de seu logon, MAPI será chamada de função de entrada de serviço de mensagem do provedor e tente novamente o logon.</span><span class="sxs-lookup"><span data-stu-id="68668-174">If a provider returns MAPI_E_UNCONFIGURED from its logon, MAPI will call the provider's message service entry function and then retry the logon.</span></span> <span data-ttu-id="68668-175">MAPI passa MSG_SERVICE_CONFIGURE como contexto, para fornecer o serviço a oportunidade de se configurar.</span><span class="sxs-lookup"><span data-stu-id="68668-175">MAPI passes MSG_SERVICE_CONFIGURE as the context, to give the service a chance to configure itself.</span></span> <span data-ttu-id="68668-176">Se o cliente tiver escolhido permitir que uma interface de usuário de fazer logon, o serviço pode representar sua folha de propriedades de configuração para que o usuário pode digitar informações de configuração.</span><span class="sxs-lookup"><span data-stu-id="68668-176">If the client has chosen to allow a user interface on the logon, the service can present its configuration property sheet so that the user can enter configuration information.</span></span> 
  
<span data-ttu-id="68668-177">Se o provedor localiza que todas as informações necessárias não estão no perfil, ele deverá retornar MAPI_E_UNCONFIGURED para que a função de ponto de entrada do serviço de mensagem do provedor chamadas de MAPI.</span><span class="sxs-lookup"><span data-stu-id="68668-177">If the provider finds that all the required information is not in the profile, it should return MAPI_E_UNCONFIGURED so that MAPI calls the provider's message service entry point function.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="68668-178">Confira também</span><span class="sxs-lookup"><span data-stu-id="68668-178">See also</span></span>

- [<span data-ttu-id="68668-179">IXPProvider : IUnknown</span><span class="sxs-lookup"><span data-stu-id="68668-179">IXPProvider : IUnknown</span></span>](ixpprovideriunknown.md)  
- [<span data-ttu-id="68668-180">IMAPISupport::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="68668-180">IMAPISupport::OpenProfileSection</span></span>](imapisupport-openprofilesection.md)  
- [<span data-ttu-id="68668-181">IMAPISupport::SpoolerNotify</span><span class="sxs-lookup"><span data-stu-id="68668-181">IMAPISupport::SpoolerNotify</span></span>](imapisupport-spoolernotify.md)  
- [<span data-ttu-id="68668-182">IXPLogon::AddressTypes</span><span class="sxs-lookup"><span data-stu-id="68668-182">IXPLogon::AddressTypes</span></span>](ixplogon-addresstypes.md)  
- [<span data-ttu-id="68668-183">IXPLogon::Idle</span><span class="sxs-lookup"><span data-stu-id="68668-183">IXPLogon::Idle</span></span>](ixplogon-idle.md)  
- [<span data-ttu-id="68668-184">IXPLogon::Poll</span><span class="sxs-lookup"><span data-stu-id="68668-184">IXPLogon::Poll</span></span>](ixplogon-poll.md)  
- [<span data-ttu-id="68668-185">IXPLogon::TransportNotify</span><span class="sxs-lookup"><span data-stu-id="68668-185">IXPLogon::TransportNotify</span></span>](ixplogon-transportnotify.md) 
- [<span data-ttu-id="68668-186">MAPIERROR</span><span class="sxs-lookup"><span data-stu-id="68668-186">MAPIERROR</span></span>](mapierror.md)

