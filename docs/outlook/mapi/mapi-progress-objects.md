---
title: Objetos de progresso MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e446004e-1ef2-4e58-b764-de7b4dcefaf1
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: c6079a62464231536c0fa6b5bacc291997fe38d9
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22567920"
---
# <a name="mapi-progress-objects"></a><span data-ttu-id="a41f4-103">Objetos de progresso MAPI</span><span class="sxs-lookup"><span data-stu-id="a41f4-103">MAPI Progress Objects</span></span>

  
  
<span data-ttu-id="a41f4-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a41f4-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="a41f4-105">Com os métodos e os dados de um objeto de andamento, você pode controlar como os relatórios no indicador de progresso.</span><span class="sxs-lookup"><span data-stu-id="a41f4-105">With the methods and data of a progress object, you can control how the indicator reports progress.</span></span> <span data-ttu-id="a41f4-106">Embora um cliente ou MAPI implementa o objeto de andamento, a maioria da responsabilidade de garantir a exatidão da exibição de progresso cai em provedores de serviços.</span><span class="sxs-lookup"><span data-stu-id="a41f4-106">Although a client or MAPI implements the progress object, most of the burden of ensuring the correctness of the progress display falls on service providers.</span></span> <span data-ttu-id="a41f4-107">Você pode garantir a precisão especificando uma ordem específica e um valor para os parâmetros que são passados para os métodos do objeto de progresso.</span><span class="sxs-lookup"><span data-stu-id="a41f4-107">You can guarantee its accuracy by specifying a particular order and value for the parameters that are passed to progress object methods.</span></span>
  
<span data-ttu-id="a41f4-108">Os seguintes parâmetros são passados para os objetos de andamento:</span><span class="sxs-lookup"><span data-stu-id="a41f4-108">The following parameters are passed to progress objects:</span></span>
  
- <span data-ttu-id="a41f4-109">Uma bitmask dos sinalizadores, definido com [IMAPIProgress::SetLimits](imapiprogress-setlimits.md) e recuperadas com [IMAPIProgress::GetFlags](imapiprogress-getflags.md).</span><span class="sxs-lookup"><span data-stu-id="a41f4-109">A bitmask of flags, set with [IMAPIProgress::SetLimits](imapiprogress-setlimits.md) and retrieved with [IMAPIProgress::GetFlags](imapiprogress-getflags.md).</span></span>
    
- <span data-ttu-id="a41f4-110">Um valor mínimo (global e local), definidas com **SetLimits** e recuperadas com [IMAPIProgress::GetMin](imapiprogress-getmin.md).</span><span class="sxs-lookup"><span data-stu-id="a41f4-110">A minimum value (local and global), set with **SetLimits** and retrieved with [IMAPIProgress::GetMin](imapiprogress-getmin.md).</span></span>
    
- <span data-ttu-id="a41f4-111">Um valor máximo (global e local), definidas com **SetLimits** e recuperadas com [IMAPIProgress::GetMax](imapiprogress-getmax.md).</span><span class="sxs-lookup"><span data-stu-id="a41f4-111">A maximum value (local and global), set with **SetLimits** and retrieved with [IMAPIProgress::GetMax](imapiprogress-getmax.md).</span></span>
    
- <span data-ttu-id="a41f4-112">Um valor que indica a porcentagem atual de conclusão da operação, passada para [IMAPIProgress::Progress](imapiprogress-progress.md).</span><span class="sxs-lookup"><span data-stu-id="a41f4-112">A value that indicates the current percentage of completion of the operation, passed to [IMAPIProgress::Progress](imapiprogress-progress.md).</span></span>
    
- <span data-ttu-id="a41f4-113">Uma contagem do número de objetos que até o momento foram processados, passadas para **o progresso**.</span><span class="sxs-lookup"><span data-stu-id="a41f4-113">A count of the number of objects that have so far been processed, passed to **Progress**.</span></span>
    
- <span data-ttu-id="a41f4-114">Uma contagem do número total de objetos envolvidos na operação, passada para **o progresso**.</span><span class="sxs-lookup"><span data-stu-id="a41f4-114">A count of the total number of objects involved in the operation, passed to **Progress**.</span></span>
    
<span data-ttu-id="a41f4-115">Todos os provedores de serviço começam sua exibição progresso processamento com uma chamada para **IMAPIProgress::GetFlags** para recuperar os sinalizadores presentes configuração.</span><span class="sxs-lookup"><span data-stu-id="a41f4-115">All service providers begin their progress display processing with a call to **IMAPIProgress::GetFlags** to retrieve the present flags setting.</span></span> <span data-ttu-id="a41f4-116">Atualmente, os sinalizadores podem ser definidos somente para MAPI_TOP_LEVEL.</span><span class="sxs-lookup"><span data-stu-id="a41f4-116">Currently, the flags can be set only to MAPI_TOP_LEVEL.</span></span> <span data-ttu-id="a41f4-117">Clientes e MAPI inicializar o sinalizador para MAPI_TOP_LEVEL, a terceira em provedores de serviços para desmarcá-la quando apropriado.</span><span class="sxs-lookup"><span data-stu-id="a41f4-117">Clients and MAPI initialize the flag to MAPI_TOP_LEVEL, relying on service providers to clear it when appropriate.</span></span> 
  
<span data-ttu-id="a41f4-118">O valor de flags for definido como MAPI_TOP_LEVEL enquanto você estiver trabalhando com o objeto de nível superior na operação.</span><span class="sxs-lookup"><span data-stu-id="a41f4-118">The flags value is set to MAPI_TOP_LEVEL while you are working with the top-level object in the operation.</span></span> <span data-ttu-id="a41f4-119">O objeto de nível superior é o objeto que é chamado pelo cliente para iniciar uma operação.</span><span class="sxs-lookup"><span data-stu-id="a41f4-119">The top-level object is the object that is called by the client to begin an operation.</span></span> <span data-ttu-id="a41f4-120">Em uma operação de cópia da pasta, essa é a pasta que está sendo copiada.</span><span class="sxs-lookup"><span data-stu-id="a41f4-120">In a folder copy operation, this is the folder being copied.</span></span> <span data-ttu-id="a41f4-121">Em uma operação de exclusão de pasta, essa é a pasta que está sendo excluída.</span><span class="sxs-lookup"><span data-stu-id="a41f4-121">In a folder delete operation, this is the folder being deleted.</span></span> <span data-ttu-id="a41f4-122">Quando você faz uma chamada para o processo de um objeto de nível inferior ou subobjeto, desmarque o valor flags.</span><span class="sxs-lookup"><span data-stu-id="a41f4-122">When you make a call to process a lower level object, or subobject, clear the flags value.</span></span> <span data-ttu-id="a41f4-123">Em uma operação de cópia da pasta, subobjetos são as subpastas que estão na pasta que está sendo copiada.</span><span class="sxs-lookup"><span data-stu-id="a41f4-123">In a folder copy operation, subobjects are the subfolders that are in the folder being copied.</span></span> 
  
<span data-ttu-id="a41f4-124">MAPI permite diferenciar entre objetos de nível superior e subobjetos com o sinalizador MAPI_TOP_LEVEL para que todos os objetos envolvidos em uma operação podem usar a mesma implementação [IMAPIProgress](imapiprogressiunknown.md) para mostrar o progresso, causando assim a exibição de indicador para Continue suavemente em uma única direção positiva.</span><span class="sxs-lookup"><span data-stu-id="a41f4-124">MAPI allows you to differentiate between top-level objects and subobjects with the MAPI_TOP_LEVEL flag so that all objects involved in an operation can use the same [IMAPIProgress](imapiprogressiunknown.md) implementation to show progress, thereby causing the indicator display to proceed smoothly in a single positive direction.</span></span> <span data-ttu-id="a41f4-125">Ou não o sinalizador MAPI_TOP_LEVEL é definido afeta as configurações dos outros parâmetros em chamadas subsequentes ao objeto de andamento.</span><span class="sxs-lookup"><span data-stu-id="a41f4-125">Whether or not the MAPI_TOP_LEVEL flag is set affects the settings of the other parameters in subsequent calls to the progress object.</span></span> 
  
<span data-ttu-id="a41f4-126">Como ele pode ser não trivial para definir valores de parâmetro apropriado para uma exibição de progresso em todos os níveis de uma operação de vários níveis, alguns provedores de serviços optar por não mostrar o progresso para subobjetos.</span><span class="sxs-lookup"><span data-stu-id="a41f4-126">Because it can be nontrivial to set appropriate parameter values for a progress display at all levels of a multilevel operation, some service providers elect not to show progress for subobjects.</span></span> 
  
 <span data-ttu-id="a41f4-127">**Para evitar mostrando o andamento para subobjetos**</span><span class="sxs-lookup"><span data-stu-id="a41f4-127">**To avoid showing progress for subobjects**</span></span>
  
- <span data-ttu-id="a41f4-128">Passe nulo para o parâmetro _lpProgress_ na chamada para processar um Subobjeto.</span><span class="sxs-lookup"><span data-stu-id="a41f4-128">Pass NULL for the  _lpProgress_ parameter in the call to process a subobject.</span></span> <span data-ttu-id="a41f4-129">Por exemplo, se você estiver copiando pastas, isso é a chamada ao método de [IMAPIFolder::CopyFolder](imapifolder-copyfolder.md) uma subpasta.</span><span class="sxs-lookup"><span data-stu-id="a41f4-129">For example, if you are copying folders, this is the call to a subfolder's [IMAPIFolder::CopyFolder](imapifolder-copyfolder.md) method.</span></span> 
    
- <span data-ttu-id="a41f4-130">Escreva código especial para determinar como interpretar o parâmetro _lpProgress_ .</span><span class="sxs-lookup"><span data-stu-id="a41f4-130">Write special code to determine how to interpret the  _lpProgress_ parameter.</span></span> <span data-ttu-id="a41f4-131">Porque um valor nulo para o parâmetro _lpProgress_ também pode significar que o cliente deve exibir o progresso usando a implementação de MAPI, código especial é necessário para determinar quando ignorar o parâmetro _lpProgress_ e quando chamadas [ IMAPISupport::DoProgressDialog](imapisupport-doprogressdialog.md).</span><span class="sxs-lookup"><span data-stu-id="a41f4-131">Because a NULL value for the  _lpProgress_ parameter can also mean that the client should display progress by using the MAPI implementation, special code is necessary to determine when to ignore the  _lpProgress_ parameter and when to call [IMAPISupport::DoProgressDialog](imapisupport-doprogressdialog.md).</span></span>
    
<span data-ttu-id="a41f4-132">Chame **IMAPIProgress::SetLimits** para definir ou limpar o sinalizador MAPI_TOP_LEVEL e para definir os valores máximo e mínimo de globais e locais.</span><span class="sxs-lookup"><span data-stu-id="a41f4-132">Call **IMAPIProgress::SetLimits** to set or clear the MAPI_TOP_LEVEL flag and to set local and global minimum and maximum values.</span></span> <span data-ttu-id="a41f4-133">O valor dos sinalizadores afeta a definição se o objeto de progresso entende os valores mínimos e máximo para ser local ou global.</span><span class="sxs-lookup"><span data-stu-id="a41f4-133">The value of the flags setting affects whether the progress object understands the minimum and maximum values to be local or global.</span></span> <span data-ttu-id="a41f4-134">Quando o sinalizador MAPI_TOP_LEVEL estiver definido, esses valores são considerados globais e são usados para calcular o progresso de toda a operação.</span><span class="sxs-lookup"><span data-stu-id="a41f4-134">When the MAPI_TOP_LEVEL flag is set, these values are considered global and are used to calculate progress for the entire operation.</span></span> <span data-ttu-id="a41f4-135">Objetos de progresso inicializar o valor mínimo global como 0 e o valor máximo global a 1000.</span><span class="sxs-lookup"><span data-stu-id="a41f4-135">Progress objects initialize the global minimum value to 0 and the global maximum value to 1000.</span></span> 
  
<span data-ttu-id="a41f4-136">Quando MAPI_TOP_LEVEL não estiver definida, os valores mínimos e máximo são considerados locais e são usados internamente pelo provedores para exibir o progresso de subobjetos de nível inferiores.</span><span class="sxs-lookup"><span data-stu-id="a41f4-136">When MAPI_TOP_LEVEL is not set, the minimum and maximum values are considered local and are used internally by providers to display progress for lower level subobjects.</span></span> <span data-ttu-id="a41f4-137">Objetos de progresso salvar os valores mínimos e máximo locais somente para que pode ser retornados para provedores quando **GetMin** e **GetMax** são chamados.</span><span class="sxs-lookup"><span data-stu-id="a41f4-137">Progress objects save the local minimum and maximum values only so that they can be returned to providers when **GetMin** and **GetMax** are called.</span></span> 
  
<span data-ttu-id="a41f4-138">O valor, contagem de objeto e parâmetros total de objetos são de entrada para o método **IMAPIProgress::Progress** .</span><span class="sxs-lookup"><span data-stu-id="a41f4-138">The value, object count, and object total parameters are input to the **IMAPIProgress::Progress** method.</span></span> <span data-ttu-id="a41f4-139">O parâmetro value, um número que indica a porcentagem de progresso, é necessário.</span><span class="sxs-lookup"><span data-stu-id="a41f4-139">The value parameter, a number that indicates the percentage of progress, is required.</span></span> <span data-ttu-id="a41f4-140">Se o sinalizador MAPI_TOP_LEVEL estiver definido, você também pode passar uma contagem de objetos e um total de objeto.</span><span class="sxs-lookup"><span data-stu-id="a41f4-140">If the MAPI_TOP_LEVEL flag is set, you can also pass an object count and an object total.</span></span> <span data-ttu-id="a41f4-141">Alguns clientes usam esses valores para exibir uma frase como "5 itens concluída fora de 10" com o indicador de progresso.</span><span class="sxs-lookup"><span data-stu-id="a41f4-141">Some clients use these values to display a phrase such as "5 items completed out of 10" with the progress indicator.</span></span> <span data-ttu-id="a41f4-142">Progresso de uma operação pode ser informado estritamente como uma porcentagem, ou como uma porcentagem e em termos de número de itens que tenham sido processadas sem total a serem processados.</span><span class="sxs-lookup"><span data-stu-id="a41f4-142">Progress on an operation can be reported strictly as a percentage or as a percentage and in terms of the number of items that have been processed out of the total to be processed.</span></span> <span data-ttu-id="a41f4-143">Por exemplo, se você for um provedor de armazenamento de mensagem e você estiver executando uma operação de cópia que está copiando 10 pastas, o indicador de progresso pode fornecer o usuário com informações adicionais exibindo uma frase como "1 de 10", "2 de 10", "3 de 10" , e assim por diante, até que a operação seja concluída.</span><span class="sxs-lookup"><span data-stu-id="a41f4-143">For example, if you are a message store provider and you are performing a copy operation that is copying 10 folders, the progress indicator can supply the user with additional information by displaying a phrase such as "1 of 10", "2 of 10", "3 of 10", and so on until the operation is complete.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="a41f4-144">Confira também</span><span class="sxs-lookup"><span data-stu-id="a41f4-144">See also</span></span>



[<span data-ttu-id="a41f4-145">Indicadores de progresso MAPI</span><span class="sxs-lookup"><span data-stu-id="a41f4-145">MAPI Progress Indicators</span></span>](mapi-progress-indicators.md)

