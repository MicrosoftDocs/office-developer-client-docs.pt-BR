---
title: Servidores de formulário MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 855292b8-028e-4c1e-87ed-3f20b9ba584a
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: 3c95f6a1d4d50dd6552c6e786d17c40da14f3f3c
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419104"
---
# <a name="mapi-form-servers"></a><span data-ttu-id="2f9cf-103">Servidores de formulário MAPI</span><span class="sxs-lookup"><span data-stu-id="2f9cf-103">MAPI Form Servers</span></span>

  
  
<span data-ttu-id="2f9cf-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="2f9cf-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="2f9cf-105">Da perspectiva do usuário, um formulário geralmente é uma folha de propriedades para uma mensagem ou um formulário de entrada de dados que permite aos usuários inserir informações estruturadas.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-105">From the user's perspective, a form is usually a property sheet for a message or a data-entry form that enables users to enter structured information.</span></span> <span data-ttu-id="2f9cf-106">No entanto, pode ser qualquer interface do usuário associada a uma classe de mensagem.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-106">However, it can be any user interface that is associated with a message class.</span></span> <span data-ttu-id="2f9cf-107">Do ponto de vista de um programador, um formulário consiste em:</span><span class="sxs-lookup"><span data-stu-id="2f9cf-107">From a programmer's point of view, a form consists of:</span></span>
  
- <span data-ttu-id="2f9cf-108">Um tipo de mensagem MAPI com sua própria classe de mensagem e identificador OLE.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-108">A type of MAPI message with its own message class and OLE identifier.</span></span>
    
- <span data-ttu-id="2f9cf-109">O arquivo executável que implementa o servidor de formulário.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-109">The executable file that implements the form server.</span></span>
    
- <span data-ttu-id="2f9cf-110">Uma coleção de propriedades MAPI — personalizadas ou de outra forma — que o servidor de formulário usa.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-110">A collection of MAPI properties — custom or otherwise — that the form server uses.</span></span> <span data-ttu-id="2f9cf-111">Alguns ou todos eles podem estar disponíveis para clientes de mensagens para uso.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-111">Some or all of these may be available to messaging clients for use.</span></span>
    
- <span data-ttu-id="2f9cf-112">O arquivo de configuração que descreve o formulário e é usado pelo gerenciador de formulário.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-112">The configuration file that describes the form and is used by the form manager.</span></span>
    
<span data-ttu-id="2f9cf-113">Como os formulários são [objetos IMessage,](imessageimapiprop.md) eles exibem propriedades e comportamento consistentes com objetos de mensagem MAPI.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-113">Because forms are [IMessage](imessageimapiprop.md) objects, they exhibit properties and behavior that is consistent with MAPI message objects.</span></span> <span data-ttu-id="2f9cf-114">No entanto, como os formulários podem ter propriedades personalizadas, controles e uma renderização de exibição específica do aplicativo, as interfaces MAPI que os formulários usam são genéricas o suficiente para permitir qualquer tipo de interface necessária.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-114">However, because forms can have custom properties, controls, and a display rendering that is application-specific, the MAPI interfaces that forms use are generic enough to permit any sort of interface that is needed.</span></span> <span data-ttu-id="2f9cf-115">A definição real de um formulário é armazenada em uma biblioteca de formulário, o que é discutido posteriormente nesta seção.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-115">The actual definition of a form is stored in a form library, which is discussed later in this section.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="2f9cf-116">Mais precisamente, todas as mensagens são instâncias de formulários MAPI.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-116">More accurately, all messages are instances of MAPI forms.</span></span> <span data-ttu-id="2f9cf-117">No entanto, geralmente é mais fácil pensar em formulários personalizados como casos especiais de mensagens, já que formulários para composição e leitura de mensagens de email típicas são os formulários mais usados.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-117">However, it is usually easier to think of custom forms as special cases of messages, since forms for composing and reading typical email messages are the most commonly used forms.</span></span> <span data-ttu-id="2f9cf-118">O fato de que todas as mensagens são apenas formulários fornece aos formulários personalizados o mesmo status de qualquer outra mensagem no sistema MAPI.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-118">The fact that all messages are really just forms gives custom forms the same status as any other message in the MAPI system.</span></span> 
  
<span data-ttu-id="2f9cf-119">Cada formulário tem um conjunto de propriedades, algumas das quais são visíveis na interface do usuário do formulário.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-119">Every form has a set of properties, some of which are visible in the form's user interface.</span></span> <span data-ttu-id="2f9cf-120">Normalmente, as propriedades são corresponder aos campos na interface do usuário do formulário.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-120">Usually, properties are matched to fields in the form's user interface.</span></span> <span data-ttu-id="2f9cf-121">Por exemplo, um formulário de pedido de compra pode ter os campos Item, Descrição, Preço, Imposto e Subtotal.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-121">For example, a purchase order form might have the fields Item, Description, Price, Tax, and Subtotal.</span></span> <span data-ttu-id="2f9cf-122">Esses campos são simplesmente renderizações visuais de propriedades de formulário com os mesmos nomes.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-122">These fields are simply visual renderings of form properties of the same names.</span></span> <span data-ttu-id="2f9cf-123">Os clientes garantem quais propriedades são suportadas por uma classe de mensagem específica por meio do método [IMAPIFormInfo::CalcFormPropSet,](imapiforminfo-calcformpropset.md) que é implementado pelo gerenciador de formulário MAPI.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-123">Clients ascertain which properties are supported by a particular message class through the [IMAPIFormInfo::CalcFormPropSet](imapiforminfo-calcformpropset.md) method, which is implemented by the MAPI form manager.</span></span> 
  
<span data-ttu-id="2f9cf-124">Assim como as mensagens básicas, os formulários MAPI podem conter todas as propriedades de mensagem padrão, como o remetente, o destinatário pretendido e quando a mensagem foi enviada.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-124">Like basic messages, MAPI forms can contain all the standard message properties such as the sender, the intended recipient, and when the message was sent.</span></span> <span data-ttu-id="2f9cf-125">Os formulários também podem conter qualquer número de propriedades personalizadas específicas do formulário.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-125">Forms can also contain any number of custom properties that are specific to the form.</span></span> <span data-ttu-id="2f9cf-126">Por exemplo, um formulário "Relatório de Bugs" pode conter propriedades personalizadas para Tipo de Bug, Severidade de Bug e Versão do Produto.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-126">For example a "Bug Report" form might contain custom properties for Bug Type, Bug Severity, and Product Version.</span></span>
  
<span data-ttu-id="2f9cf-127">Para criar um formulário, você deve implementar um servidor de formulário.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-127">To create a form you must implement a form server.</span></span> <span data-ttu-id="2f9cf-128">O servidor de formulário é o arquivo executável carregado quando um cliente de mensagens precisa exibir uma mensagem que é do tipo suportado pelo servidor de formulário.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-128">The form server is the executable file that is loaded when a messaging client needs to display a message that is the type supported by the form server.</span></span> <span data-ttu-id="2f9cf-129">O servidor de formulário, por sua vez, cria objetos de formulário conforme necessário para exibir mensagens específicas e manipular interações do usuário com essas mensagens.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-129">The form server in turn creates form objects as necessary to display specific messages and handle user interactions with those messages.</span></span>
  
<span data-ttu-id="2f9cf-130">Cada servidor de formulário tem um arquivo de configuração associado a ele.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-130">Every form server has a configuration file associated with it.</span></span> <span data-ttu-id="2f9cf-131">Esse arquivo contém informações que descrevem o servidor de formulário para o benefício do gerenciador de formulário.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-131">This file contains information that describes the form server for the benefit of the form manager.</span></span> <span data-ttu-id="2f9cf-132">O gerenciador de formulário usa essas informações ao instalar o servidor de formulário em uma biblioteca de formulário.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-132">The form manager uses this information when installing the form server into a form library.</span></span>
  
<span data-ttu-id="2f9cf-133">Para obter detalhes sobre como criar as partes de um formulário, consulte [Developing MAPI Form Servers](developing-mapi-form-servers.md).</span><span class="sxs-lookup"><span data-stu-id="2f9cf-133">For details on creating the parts of a form, see [Developing MAPI Form Servers](developing-mapi-form-servers.md).</span></span>
  
<span data-ttu-id="2f9cf-134">Os servidores de formulário aderem ao Com (Component Object Model).</span><span class="sxs-lookup"><span data-stu-id="2f9cf-134">Form servers adhere to the Component Object Model (COM).</span></span> <span data-ttu-id="2f9cf-135">Os servidores de formulário são executados como executáveis autônomos, não como servidores in-proc.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-135">Form servers run as standalone executables, not as in-proc servers.</span></span> <span data-ttu-id="2f9cf-136">Para obter mais informações, consulte a seção COM e ActiveX Object Services no SDK do Windows.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-136">For more information, see the COM and ActiveX Object Services section in the Windows SDK.</span></span>
  
<span data-ttu-id="2f9cf-137">Um identificador de classe exclusivo (CLSID) identifica cada servidor de formulário.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-137">A unique class identifier (CLSID) identifies each form server.</span></span> <span data-ttu-id="2f9cf-138">Sempre há um mapeamento um para um entre um identificador de classe e sua classe de mensagem.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-138">There is always a one-to-one mapping between a class identifier and its message class.</span></span> <span data-ttu-id="2f9cf-139">Isso não significa, no entanto, que um servidor de formulário só pode trabalhar com mensagens de uma classe de mensagem.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-139">This does not mean, however, that a form server can only work with messages of one message class.</span></span> <span data-ttu-id="2f9cf-140">Se nenhum servidor de formulário estiver disponível para fazer o serviço de uma mensagem de uma classe específica, o gerenciador de formulário que está sendo usado deve tentar encontrar um servidor de formulário para uma classe de mensagem mais alto na hierarquia de classe de mensagens; o gerenciador de formulário padrão fornecido com o SDK do Windows faz isso.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-140">If no form server is available to service a message of a particular class, the form manager being used should attempt to find a form server for a message class higher in the message class hierarchy; the default form manager supplied with the Windows SDK does this.</span></span> <span data-ttu-id="2f9cf-141">Esse servidor de formulário provavelmente poderá renderizar apenas um subconjunto das propriedades da mensagem (aquelas com suporte da superclasse), mas será melhor do que nada.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-141">Such a form server will probably be able to render only a subset of the message's properties (the ones supported by the superclass), but it will be better than nothing.</span></span> <span data-ttu-id="2f9cf-142">O que acontece quando nenhum servidor de formulário correspondente é encontrado é um detalhe de implementação específico do gerenciador de formulário que está sendo usado; o gerenciador de formulário padrão não abre mensagens quando isso acontece.</span><span class="sxs-lookup"><span data-stu-id="2f9cf-142">What happens when no matching form server is found at all is an implementation detail specific to the form manager being used; the default form manager does not open messages when this happens.</span></span>
  
<span data-ttu-id="2f9cf-143">Para obter mais informações, consulte [CLASSES de mensagens MAPI.](mapi-message-classes.md)</span><span class="sxs-lookup"><span data-stu-id="2f9cf-143">For more information, see [MAPI Message Classes](mapi-message-classes.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="2f9cf-144">Confira também</span><span class="sxs-lookup"><span data-stu-id="2f9cf-144">See also</span></span>



[<span data-ttu-id="2f9cf-145">Formulários MAPI</span><span class="sxs-lookup"><span data-stu-id="2f9cf-145">MAPI Forms</span></span>](mapi-forms.md)

