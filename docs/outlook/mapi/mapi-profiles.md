---
title: Perfis MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 493c87a4-317d-47ec-850b-342cac59594b
description: '�ltima altera��o: segunda-feira, 9 de mar�o de 2015'
ms.openlocfilehash: 7f241fde8aedeae9debc66f728ee21c1c6bed6fb
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19767909"
---
# <a name="mapi-profiles"></a><span data-ttu-id="5bc12-103">Perfis MAPI</span><span class="sxs-lookup"><span data-stu-id="5bc12-103">MAPI Profiles</span></span>

  
  
<span data-ttu-id="5bc12-104">**Aplica-se a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="5bc12-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="5bc12-105">Um perfil armazena informações sobre provedores de serviço e serviços de mensagem que estão instalados em um computador.</span><span class="sxs-lookup"><span data-stu-id="5bc12-105">A profile stores information about service providers and message services that are installed on a computer.</span></span> <span data-ttu-id="5bc12-106">Para cada sessão, um cliente na hora do logon seleciona um único perfil que descreve os provedores e serviços a serem usados.</span><span class="sxs-lookup"><span data-stu-id="5bc12-106">For every session, a client at logon time selects one profile that describes the providers and services to be used.</span></span> <span data-ttu-id="5bc12-107">Um cliente pode escolher entre uma coleção de perfis e, se desejado, estabeleça uma como padrão.</span><span class="sxs-lookup"><span data-stu-id="5bc12-107">A client can choose from a collection of profiles and, if desired, establish one as the default.</span></span> <span data-ttu-id="5bc12-108">O perfil padrão será o que é selecionada automaticamente quando um cliente inicia uma sessão e não tiver especificado explicitamente um perfil.</span><span class="sxs-lookup"><span data-stu-id="5bc12-108">The default profile is the profile that is selected automatically when a client starts a session and has not explicitly specified a profile.</span></span>
  
<span data-ttu-id="5bc12-109">Também nestes tópicos, você encontrará uma discussão sobre o cache de apelidos, que é armazenado em um stream binário.</span><span class="sxs-lookup"><span data-stu-id="5bc12-109">Also in these topics, you will find a discussion of the nickname cache, which is stored in a binary stream.</span></span>
  
- [<span data-ttu-id="5bc12-110">Cache de apelidos</span><span class="sxs-lookup"><span data-stu-id="5bc12-110">Nickname cache</span></span>](nickname-cache.md)
    
- [<span data-ttu-id="5bc12-111">Fluxo de preenchimento automático</span><span class="sxs-lookup"><span data-stu-id="5bc12-111">Autocomplete Stream</span></span>](autocomplete-stream.md)
    
- [<span data-ttu-id="5bc12-112">Análise de arquivo binário</span><span class="sxs-lookup"><span data-stu-id="5bc12-112">Binary File Parsing</span></span>](http://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)
    
## <a name="profile-sections"></a><span data-ttu-id="5bc12-113">Seções de perfil</span><span class="sxs-lookup"><span data-stu-id="5bc12-113">Profile Sections</span></span>

<span data-ttu-id="5bc12-114">Perfis são divididos em seções que clientes e provedores de serviços de acesso para exibir propriedades de perfil para os usuários ou fazer alterações na configuração.</span><span class="sxs-lookup"><span data-stu-id="5bc12-114">Profiles are divided into sections that clients and service providers access to display profile properties to users or to make configuration changes.</span></span> <span data-ttu-id="5bc12-115">Uma seção de perfil é um objeto MAPI que implementa a interface **IProfSect** , uma interface que derive da **IMAPIProp** e não tem nenhuma métodos adicionais.</span><span class="sxs-lookup"><span data-stu-id="5bc12-115">A profile section is a MAPI object that implements the **IProfSect** interface, an interface that derives from **IMAPIProp** and has no additional methods.</span></span> <span data-ttu-id="5bc12-116">Para obter mais informações, consulte [IProfSect: IMAPIProp](iprofsectimapiprop.md).</span><span class="sxs-lookup"><span data-stu-id="5bc12-116">For more information, see [IProfSect : IMAPIProp](iprofsectimapiprop.md).</span></span> <span data-ttu-id="5bc12-117">Sua única finalidade é manipular as propriedades de uma seção de perfil.</span><span class="sxs-lookup"><span data-stu-id="5bc12-117">Its only purpose is to manipulate the properties of a profile section.</span></span> <span data-ttu-id="5bc12-118">Para recuperar um ponteiro **IProfSect** a uma seção de perfil específico, clientes e provedores de serviços chame os métodos a seguir.</span><span class="sxs-lookup"><span data-stu-id="5bc12-118">To retrieve an **IProfSect** pointer to a particular profile section, clients and service providers call the following methods.</span></span> 
  
|||
|:-----|:-----|
|<span data-ttu-id="5bc12-119">Clientes podem chamar:</span><span class="sxs-lookup"><span data-stu-id="5bc12-119">Clients can call:</span></span>  <br/> |[<span data-ttu-id="5bc12-120">IMAPISession::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="5bc12-120">IMAPISession::OpenProfileSection</span></span>](imapisession-openprofilesection.md) <br/> |
|<span data-ttu-id="5bc12-121">Provedores de serviços podem chamar:</span><span class="sxs-lookup"><span data-stu-id="5bc12-121">Service providers can call:</span></span>  <br/> |[<span data-ttu-id="5bc12-122">IMAPISupport::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="5bc12-122">IMAPISupport::OpenProfileSection</span></span>](imapisupport-openprofilesection.md) <br/> |
|<span data-ttu-id="5bc12-123">Clientes ou provedores podem chamar:</span><span class="sxs-lookup"><span data-stu-id="5bc12-123">Either clients or providers can call:</span></span>  <br/> |[<span data-ttu-id="5bc12-124">IProviderAdmin::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="5bc12-124">IProviderAdmin::OpenProfileSection</span></span>](iprovideradmin-openprofilesection.md) <br/> |
   
<span data-ttu-id="5bc12-125">Os perfis são organizados hierarquicamente muito semelhante a MAPISVC. Arquivo INF.</span><span class="sxs-lookup"><span data-stu-id="5bc12-125">Profiles are organized hierarchically much like the MAPISVC.INF file.</span></span> <span data-ttu-id="5bc12-126">Na parte superior da hierarquia, há seções de perfil que contêm informações relevantes para o perfil.</span><span class="sxs-lookup"><span data-stu-id="5bc12-126">At the top of the hierarchy, there are profile sections that contain information relevant to the profile.</span></span> <span data-ttu-id="5bc12-127">O nível intermediário inclui seções que contêm informações sobre um serviço de mensagem específica e o nível inferior inclui seções que contêm informações sobre um dos provedores de serviço em um serviço de mensagem.</span><span class="sxs-lookup"><span data-stu-id="5bc12-127">The middle level includes sections that contain information about a particular message service and the lower level includes sections that contain information about one of the service providers in a message service.</span></span> 
  
<span data-ttu-id="5bc12-128">Cada perfil tem várias propriedades necessárias que são armazenadas em um ou mais das seções do perfil.</span><span class="sxs-lookup"><span data-stu-id="5bc12-128">Every profile has several required properties that are stored in one or more of the sections of the profile.</span></span> <span data-ttu-id="5bc12-129">Por exemplo, cada perfil tem as propriedades de **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) e o **PR_PROFILE_NAME** ([PidTagProfileName](pidtagprofilename-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="5bc12-129">For example, every profile has the **PR_PROFILE_NAME** ([PidTagProfileName](pidtagprofilename-canonical-property.md)) and **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) properties.</span></span> <span data-ttu-id="5bc12-130">Chave de pesquisa de um perfil é definido como o valor definido em MAPIGUID. H como MUID_PROFILE_INSTANCE e sempre é garantido que ser exclusivo entre todos os perfis.</span><span class="sxs-lookup"><span data-stu-id="5bc12-130">A profile's search key is set to the value defined in MAPIGUID.H as MUID_PROFILE_INSTANCE and is always guaranteed to be unique among all profiles.</span></span> <span data-ttu-id="5bc12-131">Embora os dois perfis podem ter o mesmo nome, eles não podem ter a mesma chave de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="5bc12-131">Although two profiles can have the same name, they cannot have the same search key.</span></span> <span data-ttu-id="5bc12-132">Chaves de pesquisa devem ser tratadas como dados binários em vez de dados de qualquer tipo específico.</span><span class="sxs-lookup"><span data-stu-id="5bc12-132">Search keys should be treated as binary data instead of data of any particular type.</span></span>
  
<span data-ttu-id="5bc12-133">Provedores de armazenamento de mensagem são necessários para incluir propriedade de **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) do seu armazenamento de mensagens nas seções perfil para o perfil e para sua mensagem de provedor de armazenamento e manter essas entradas sincronizadas.</span><span class="sxs-lookup"><span data-stu-id="5bc12-133">Message store providers are required to include their message store's **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) property in the profile sections for the profile and for their message store provider and to keep these entries synchronized.</span></span> <span data-ttu-id="5bc12-134">Quando um armazenamento de mensagens é criado, o provedor define **PR_DISPLAY_NAME** com base no valor armazenado nestas seções de perfil.</span><span class="sxs-lookup"><span data-stu-id="5bc12-134">When a message store is created, the provider sets **PR_DISPLAY_NAME** based on the value stored in these profile sections.</span></span> 
  
<span data-ttu-id="5bc12-135">Há dois principais diferenças entre as seções de perfil e outros objetos que herdam **IMAPIProp**:</span><span class="sxs-lookup"><span data-stu-id="5bc12-135">There are two major differences between profile sections and other objects that inherit from **IMAPIProp**:</span></span> 
  
- <span data-ttu-id="5bc12-136">As seções de perfil não suportam transações.</span><span class="sxs-lookup"><span data-stu-id="5bc12-136">Profile sections do not support transactions.</span></span>
    
- <span data-ttu-id="5bc12-137">As seções de perfil não dão suporte a propriedades nomeadas, retornando MAPI_E_NO_SUPPORT de suas implementações **IMAPIProp::GetIDsFromNames** e **IMAPIProp::GetNamesFromIDs** .</span><span class="sxs-lookup"><span data-stu-id="5bc12-137">Profile sections do not support named properties, returning MAPI_E_NO_SUPPORT from their **IMAPIProp::GetIDsFromNames** and **IMAPIProp::GetNamesFromIDs** implementations.</span></span> <span data-ttu-id="5bc12-138">Para obter mais informações, consulte [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) e [IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md).</span><span class="sxs-lookup"><span data-stu-id="5bc12-138">For more information, see [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) and [IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md).</span></span>
    
<span data-ttu-id="5bc12-139">Porque as seções de perfil não suportam transações, quaisquer alterações feitas nas chamadas para **IMAPIProp::CopyProps**, **CopyTo**ou **SetProps** imediatamente entrarão em vigor.</span><span class="sxs-lookup"><span data-stu-id="5bc12-139">Because profile sections do not support transactions, any changes made with calls to **IMAPIProp::CopyProps**, **CopyTo**, or **SetProps** immediately take effect.</span></span> <span data-ttu-id="5bc12-140">Para obter mais informações, consulte [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span><span class="sxs-lookup"><span data-stu-id="5bc12-140">For more information, see [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span> <span data-ttu-id="5bc12-141">Clientes e provedores de serviços podem chamar o método de **IMAPIProp::SaveChanges** de uma seção perfil e ele será bem-sucedida, mas não afeta os dados da seção de perfil.</span><span class="sxs-lookup"><span data-stu-id="5bc12-141">Clients and service providers can call a profile section's **IMAPIProp::SaveChanges** method and it will succeed, but it does not affect the profile section data.</span></span> <span data-ttu-id="5bc12-142">Para obter mais informações, consulte [IMAPIProp::SaveChanges](imapiprop-savechanges.md).</span><span class="sxs-lookup"><span data-stu-id="5bc12-142">For more information, see [IMAPIProp::SaveChanges](imapiprop-savechanges.md).</span></span> <span data-ttu-id="5bc12-143">Ter alterações ocorrem imediatamente pode afetar como provedores de serviços de implementam as folhas de propriedades que são usadas pelos clientes para exibir propriedades de perfil para os usuários.</span><span class="sxs-lookup"><span data-stu-id="5bc12-143">Having changes occur immediately can affect how service providers implement the property sheets that clients use to display profile properties to users.</span></span> <span data-ttu-id="5bc12-144">Provedores de serviços que deseja que os usuários sejam capazes de adiamento ou desfazer alterações devem implementar suas folhas de propriedades com cópias das seções de perfil, em vez das seções reais.</span><span class="sxs-lookup"><span data-stu-id="5bc12-144">Service providers that want users to be able to postpone or undo changes must implement their property sheets with copies of profile sections instead of the real sections.</span></span> <span data-ttu-id="5bc12-145">Usando cópias, os usuários podem fazer alterações e, em seguida, mais tarde Cancelar essas alterações, deixando inalterada as seções de perfil original.</span><span class="sxs-lookup"><span data-stu-id="5bc12-145">By using copies, users can make changes and then later cancel those changes, leaving the original profile sections untouched.</span></span> 
  
<span data-ttu-id="5bc12-146">A ordem na qual informações aparecem em um perfil afeta como MAPI configura recursos e faz as atribuições em uma sessão.</span><span class="sxs-lookup"><span data-stu-id="5bc12-146">The order in which information appears in a profile affects how MAPI configures resources and makes assignments in a session.</span></span> <span data-ttu-id="5bc12-147">As atribuições a seguir são afetadas por ordem de perfil:</span><span class="sxs-lookup"><span data-stu-id="5bc12-147">The following assignments are affected by profile order:</span></span>
  
- <span data-ttu-id="5bc12-148">Armazenamento de mensagens padrão</span><span class="sxs-lookup"><span data-stu-id="5bc12-148">Default message store</span></span>
    
- <span data-ttu-id="5bc12-149">Catálogo particular de endereços</span><span class="sxs-lookup"><span data-stu-id="5bc12-149">Personal address book</span></span>
    
- <span data-ttu-id="5bc12-150">Caminho de pesquisa do repositório de mensagem padrão</span><span class="sxs-lookup"><span data-stu-id="5bc12-150">Default message store search path</span></span>
    
- <span data-ttu-id="5bc12-151">Padrão de caminho de pesquisa do catálogo de endereços</span><span class="sxs-lookup"><span data-stu-id="5bc12-151">Default address book search path</span></span>
    
- <span data-ttu-id="5bc12-152">Ordem de provedor de transporte</span><span class="sxs-lookup"><span data-stu-id="5bc12-152">Transport provider order</span></span>
    
<span data-ttu-id="5bc12-153">MAPI define o armazenamento de mensagens padrão a ser o primeiro armazenamento de mensagens no perfil que tem o sinalizador STATUS_DEFAULT_STORE definido em sua propriedade **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)), que indica que ele pode ser o repositório padrão.</span><span class="sxs-lookup"><span data-stu-id="5bc12-153">MAPI sets the default message store to be the first message store in the profile that has the STATUS_DEFAULT_STORE flag set in its **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) property, which indicates that it can be the default store.</span></span> <span data-ttu-id="5bc12-154">Clientes podem substituir essa configuração chamando **IMAPISession::SetDefaultStore**.</span><span class="sxs-lookup"><span data-stu-id="5bc12-154">Clients can override this setting by calling **IMAPISession::SetDefaultStore**.</span></span> <span data-ttu-id="5bc12-155">Para obter mais informações, consulte [IMAPISession::SetDefaultStore](imapisession-setdefaultstore.md).</span><span class="sxs-lookup"><span data-stu-id="5bc12-155">For more information, see [IMAPISession::SetDefaultStore](imapisession-setdefaultstore.md).</span></span>
  
<span data-ttu-id="5bc12-156">MAPI cria uma ordem de transporte para lidar com as mensagens de entrada e saídas.</span><span class="sxs-lookup"><span data-stu-id="5bc12-156">MAPI creates a transport order for handling outgoing and incoming messages.</span></span> <span data-ttu-id="5bc12-157">Quando mais de um provedor de transporte foi registrado para uma mensagem de um determinado tipo, o MAPI usa nesta ordem para determinar qual provedor deve lidar com a mensagem.</span><span class="sxs-lookup"><span data-stu-id="5bc12-157">When more than one transport provider has registered for a message of a particular type, MAPI uses this order to determine which provider should handle the message.</span></span> <span data-ttu-id="5bc12-158">MAPI define a ordem de transporte a ser a ordem na qual o transporte provedores foram adicionados ao perfil com uma exceção – os transportes que defina o sinalizador STATUS_XP_PREFER_LAST em suas propriedades **PR_RESOURCE_FLAGS** posicionados última na ordem.</span><span class="sxs-lookup"><span data-stu-id="5bc12-158">MAPI sets the transport order to be the order in which the transport providers were added to the profile with one exception--the transports that set the STATUS_XP_PREFER_LAST flag in their **PR_RESOURCE_FLAGS** property are positioned last in the order.</span></span> <span data-ttu-id="5bc12-159">Os clientes podem definir a ordem de transporte chamando **IMsgServiceAdmin::MsgServiceTransportOrder**.</span><span class="sxs-lookup"><span data-stu-id="5bc12-159">Clients can set the transport order by calling **IMsgServiceAdmin::MsgServiceTransportOrder**.</span></span> <span data-ttu-id="5bc12-160">Para obter mais informações, consulte [IMsgServiceAdmin::MsgServiceTransportOrder](imsgserviceadmin-msgservicetransportorder.md).</span><span class="sxs-lookup"><span data-stu-id="5bc12-160">For more information, see [IMsgServiceAdmin::MsgServiceTransportOrder](imsgserviceadmin-msgservicetransportorder.md).</span></span>
  
<span data-ttu-id="5bc12-161">Estas diretrizes para pedidos de provedores de serviço e serviços de mensagem em alguns casos, podem entrar em conflito.</span><span class="sxs-lookup"><span data-stu-id="5bc12-161">These guidelines for ordering service providers and message services might sometimes conflict.</span></span> <span data-ttu-id="5bc12-162">Se houver um conflito, seu código deve resolver o conflito.</span><span class="sxs-lookup"><span data-stu-id="5bc12-162">If there is a conflict, your code should resolve the conflict.</span></span> <span data-ttu-id="5bc12-163">Você pode usar o programa do painel de controle de email para inspecionar um perfil que você criou para determinar se os provedores foram configurados conforme o esperado.</span><span class="sxs-lookup"><span data-stu-id="5bc12-163">You can use the Mail Control Panel program to inspect a profile that you have created to determine whether the providers have been configured as expected.</span></span>
  

