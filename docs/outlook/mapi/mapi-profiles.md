---
title: Perfis MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 493c87a4-317d-47ec-850b-342cac59594b
description: 'Última modificação: 9 de março de 2015'
ms.openlocfilehash: 9db1f8e163e44a44df1e798cebccb3639325275e
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32340079"
---
# <a name="mapi-profiles"></a><span data-ttu-id="e7f62-103">Perfis MAPI</span><span class="sxs-lookup"><span data-stu-id="e7f62-103">MAPI Profiles</span></span>

  
  
<span data-ttu-id="e7f62-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="e7f62-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="e7f62-105">Um perfil armazena informações sobre provedores de serviços e serviços de mensagens instalados em um computador.</span><span class="sxs-lookup"><span data-stu-id="e7f62-105">A profile stores information about service providers and message services that are installed on a computer.</span></span> <span data-ttu-id="e7f62-106">Para cada sessão, um cliente no momento do logon seleciona um perfil que descreve os provedores e serviços a serem usados.</span><span class="sxs-lookup"><span data-stu-id="e7f62-106">For every session, a client at logon time selects one profile that describes the providers and services to be used.</span></span> <span data-ttu-id="e7f62-107">Um cliente pode escolher entre um conjunto de perfis e, se desejado, estabelecer um como padrão.</span><span class="sxs-lookup"><span data-stu-id="e7f62-107">A client can choose from a collection of profiles and, if desired, establish one as the default.</span></span> <span data-ttu-id="e7f62-108">O perfil padrão é o perfil selecionado automaticamente quando um cliente inicia uma sessão e não especificou explicitamente um perfil.</span><span class="sxs-lookup"><span data-stu-id="e7f62-108">The default profile is the profile that is selected automatically when a client starts a session and has not explicitly specified a profile.</span></span>
  
<span data-ttu-id="e7f62-109">Além disso, nestes tópicos, você encontrará uma discussão sobre o cache de apelidos, que é armazenado em um fluxo binário.</span><span class="sxs-lookup"><span data-stu-id="e7f62-109">Also in these topics, you will find a discussion of the nickname cache, which is stored in a binary stream.</span></span>
  
- [<span data-ttu-id="e7f62-110">Cache de apelidos</span><span class="sxs-lookup"><span data-stu-id="e7f62-110">Nickname cache</span></span>](nickname-cache.md)
    
- [<span data-ttu-id="e7f62-111">Fluxo de Preenchimento Automático</span><span class="sxs-lookup"><span data-stu-id="e7f62-111">Autocomplete Stream</span></span>](autocomplete-stream.md)
    
- [<span data-ttu-id="e7f62-112">Análise de arquivo binário</span><span class="sxs-lookup"><span data-stu-id="e7f62-112">Binary File Parsing</span></span>](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)
    
## <a name="profile-sections"></a><span data-ttu-id="e7f62-113">Seções de Perfil</span><span class="sxs-lookup"><span data-stu-id="e7f62-113">Profile Sections</span></span>

<span data-ttu-id="e7f62-114">Os perfis são divididos em seções que os clientes e provedores de serviços acessam para exibir as propriedades de perfil para os usuários ou para fazer alterações na configuração.</span><span class="sxs-lookup"><span data-stu-id="e7f62-114">Profiles are divided into sections that clients and service providers access to display profile properties to users or to make configuration changes.</span></span> <span data-ttu-id="e7f62-115">Uma seção de perfil é um objeto MAPI que implementa a interface **IProfSect,** uma interface que deriva de **IMAPIProp** e não tem métodos adicionais.</span><span class="sxs-lookup"><span data-stu-id="e7f62-115">A profile section is a MAPI object that implements the **IProfSect** interface, an interface that derives from **IMAPIProp** and has no additional methods.</span></span> <span data-ttu-id="e7f62-116">Para obter mais informações, consulte [IProfSect : IMAPIProp](iprofsectimapiprop.md).</span><span class="sxs-lookup"><span data-stu-id="e7f62-116">For more information, see [IProfSect : IMAPIProp](iprofsectimapiprop.md).</span></span> <span data-ttu-id="e7f62-117">Sua única finalidade é manipular as propriedades de uma seção de perfil.</span><span class="sxs-lookup"><span data-stu-id="e7f62-117">Its only purpose is to manipulate the properties of a profile section.</span></span> <span data-ttu-id="e7f62-118">Para recuperar um **ponteiro IProfSect** para uma seção de perfil específica, os clientes e provedores de serviços chamam os métodos a seguir.</span><span class="sxs-lookup"><span data-stu-id="e7f62-118">To retrieve an **IProfSect** pointer to a particular profile section, clients and service providers call the following methods.</span></span> 
  
|||
|:-----|:-----|
|<span data-ttu-id="e7f62-119">Os clientes podem chamar:</span><span class="sxs-lookup"><span data-stu-id="e7f62-119">Clients can call:</span></span>  <br/> |[<span data-ttu-id="e7f62-120">IMAPISession::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="e7f62-120">IMAPISession::OpenProfileSection</span></span>](imapisession-openprofilesection.md) <br/> |
|<span data-ttu-id="e7f62-121">Os provedores de serviços podem chamar:</span><span class="sxs-lookup"><span data-stu-id="e7f62-121">Service providers can call:</span></span>  <br/> |[<span data-ttu-id="e7f62-122">IMAPISupport::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="e7f62-122">IMAPISupport::OpenProfileSection</span></span>](imapisupport-openprofilesection.md) <br/> |
|<span data-ttu-id="e7f62-123">Clientes ou provedores podem chamar:</span><span class="sxs-lookup"><span data-stu-id="e7f62-123">Either clients or providers can call:</span></span>  <br/> |[<span data-ttu-id="e7f62-124">IProviderAdmin::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="e7f62-124">IProviderAdmin::OpenProfileSection</span></span>](iprovideradmin-openprofilesection.md) <br/> |
   
<span data-ttu-id="e7f62-125">Os perfis são organizados hierarquicamente de forma muito parecido com o MAPISVC. Arquivo INF.</span><span class="sxs-lookup"><span data-stu-id="e7f62-125">Profiles are organized hierarchically much like the MAPISVC.INF file.</span></span> <span data-ttu-id="e7f62-126">Na parte superior da hierarquia, há seções de perfil que contêm informações relevantes para o perfil.</span><span class="sxs-lookup"><span data-stu-id="e7f62-126">At the top of the hierarchy, there are profile sections that contain information relevant to the profile.</span></span> <span data-ttu-id="e7f62-127">O nível intermediário inclui seções que contêm informações sobre um determinado serviço de mensagens e o nível inferior inclui seções que contêm informações sobre um dos provedores de serviços em um serviço de mensagens.</span><span class="sxs-lookup"><span data-stu-id="e7f62-127">The middle level includes sections that contain information about a particular message service and the lower level includes sections that contain information about one of the service providers in a message service.</span></span> 
  
<span data-ttu-id="e7f62-128">Cada perfil tem várias propriedades necessárias que são armazenadas em uma ou mais das seções do perfil.</span><span class="sxs-lookup"><span data-stu-id="e7f62-128">Every profile has several required properties that are stored in one or more of the sections of the profile.</span></span> <span data-ttu-id="e7f62-129">Por exemplo, cada perfil tem PR_PROFILE_NAME **(** [PidTagProfileName](pidtagprofilename-canonical-property.md)) e **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) propriedades.</span><span class="sxs-lookup"><span data-stu-id="e7f62-129">For example, every profile has the **PR_PROFILE_NAME** ([PidTagProfileName](pidtagprofilename-canonical-property.md)) and **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) properties.</span></span> <span data-ttu-id="e7f62-130">A chave de pesquisa de um perfil é definida como o valor definido em MAPIGUID. H como MUID_PROFILE_INSTANCE e é sempre garantido ser exclusivo entre todos os perfis.</span><span class="sxs-lookup"><span data-stu-id="e7f62-130">A profile's search key is set to the value defined in MAPIGUID.H as MUID_PROFILE_INSTANCE and is always guaranteed to be unique among all profiles.</span></span> <span data-ttu-id="e7f62-131">Embora dois perfis possam ter o mesmo nome, eles não podem ter a mesma chave de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="e7f62-131">Although two profiles can have the same name, they cannot have the same search key.</span></span> <span data-ttu-id="e7f62-132">As chaves de pesquisa devem ser tratadas como dados binários em vez de dados de qualquer tipo específico.</span><span class="sxs-lookup"><span data-stu-id="e7f62-132">Search keys should be treated as binary data instead of data of any particular type.</span></span>
  
<span data-ttu-id="e7f62-133">Os provedores de armazenamento de mensagens são obrigados a incluir a propriedade **PR_DISPLAY_NAME** ([PidTagDisplayName)](pidtagdisplayname-canonical-property.md)do seu armazenamento de mensagens nas seções de perfil para o perfil e para seu provedor de armazenamento de mensagens e para manter essas entradas sincronizadas.</span><span class="sxs-lookup"><span data-stu-id="e7f62-133">Message store providers are required to include their message store's **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) property in the profile sections for the profile and for their message store provider and to keep these entries synchronized.</span></span> <span data-ttu-id="e7f62-134">Quando um armazenamento de mensagens é criado, o provedor **define PR_DISPLAY_NAME** com base no valor armazenado nessas seções de perfil.</span><span class="sxs-lookup"><span data-stu-id="e7f62-134">When a message store is created, the provider sets **PR_DISPLAY_NAME** based on the value stored in these profile sections.</span></span> 
  
<span data-ttu-id="e7f62-135">Há duas diferenças principais entre seções de perfil e outros objetos que herdam de **IMAPIProp:**</span><span class="sxs-lookup"><span data-stu-id="e7f62-135">There are two major differences between profile sections and other objects that inherit from **IMAPIProp**:</span></span> 
  
- <span data-ttu-id="e7f62-136">As seções de perfil não são suportadas por transações.</span><span class="sxs-lookup"><span data-stu-id="e7f62-136">Profile sections do not support transactions.</span></span>
    
- <span data-ttu-id="e7f62-137">As seções de perfil não têm suporte para propriedades nomeadas, retornando MAPI_E_NO_SUPPORT de suas implementações **IMAPIProp::GetIDsFromNames** e **IMAPIProp::GetNamesFromIDs.**</span><span class="sxs-lookup"><span data-stu-id="e7f62-137">Profile sections do not support named properties, returning MAPI_E_NO_SUPPORT from their **IMAPIProp::GetIDsFromNames** and **IMAPIProp::GetNamesFromIDs** implementations.</span></span> <span data-ttu-id="e7f62-138">Para obter mais informações, consulte [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) e [IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md).</span><span class="sxs-lookup"><span data-stu-id="e7f62-138">For more information, see [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) and [IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md).</span></span>
    
<span data-ttu-id="e7f62-139">Como as seções de perfil não suportam transações, qualquer alteração feita com chamadas para **IMAPIProp::CopyProps**, **CopyTo** ou **SetProps** entrou em vigor imediatamente.</span><span class="sxs-lookup"><span data-stu-id="e7f62-139">Because profile sections do not support transactions, any changes made with calls to **IMAPIProp::CopyProps**, **CopyTo**, or **SetProps** immediately take effect.</span></span> <span data-ttu-id="e7f62-140">Para obter mais informações, [consulte IMAPIProp::CopyProps](imapiprop-copyprops.md).</span><span class="sxs-lookup"><span data-stu-id="e7f62-140">For more information, see [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span> <span data-ttu-id="e7f62-141">Clientes e provedores de serviços podem chamar o método **IMAPIProp::SaveChanges** da seção de perfil e ele terá êxito, mas não afeta os dados da seção de perfil.</span><span class="sxs-lookup"><span data-stu-id="e7f62-141">Clients and service providers can call a profile section's **IMAPIProp::SaveChanges** method and it will succeed, but it does not affect the profile section data.</span></span> <span data-ttu-id="e7f62-142">Para obter mais informações, [consulte IMAPIProp::SaveChanges](imapiprop-savechanges.md).</span><span class="sxs-lookup"><span data-stu-id="e7f62-142">For more information, see [IMAPIProp::SaveChanges](imapiprop-savechanges.md).</span></span> <span data-ttu-id="e7f62-143">As alterações que ocorrem imediatamente podem afetar como os provedores de serviços implementam as folhas de propriedades que os clientes usam para exibir as propriedades de perfil para os usuários.</span><span class="sxs-lookup"><span data-stu-id="e7f62-143">Having changes occur immediately can affect how service providers implement the property sheets that clients use to display profile properties to users.</span></span> <span data-ttu-id="e7f62-144">Provedores de serviços que querem que os usuários sejam capazes de adiar ou desfazer alterações devem implementar suas folhas de propriedades com cópias de seções de perfil em vez das seções reais.</span><span class="sxs-lookup"><span data-stu-id="e7f62-144">Service providers that want users to be able to postpone or undo changes must implement their property sheets with copies of profile sections instead of the real sections.</span></span> <span data-ttu-id="e7f62-145">Usando cópias, os usuários podem fazer alterações e, em seguida, cancelar essas alterações, deixando as seções de perfil originais intocadas.</span><span class="sxs-lookup"><span data-stu-id="e7f62-145">By using copies, users can make changes and then later cancel those changes, leaving the original profile sections untouched.</span></span> 
  
<span data-ttu-id="e7f62-146">A ordem na qual as informações aparecem em um perfil afeta como o MAPI configura recursos e faz atribuições em uma sessão.</span><span class="sxs-lookup"><span data-stu-id="e7f62-146">The order in which information appears in a profile affects how MAPI configures resources and makes assignments in a session.</span></span> <span data-ttu-id="e7f62-147">As atribuições a seguir são afetadas pela ordem do perfil:</span><span class="sxs-lookup"><span data-stu-id="e7f62-147">The following assignments are affected by profile order:</span></span>
  
- <span data-ttu-id="e7f62-148">Armazenamento de mensagens padrão</span><span class="sxs-lookup"><span data-stu-id="e7f62-148">Default message store</span></span>
    
- <span data-ttu-id="e7f62-149">Personal address book</span><span class="sxs-lookup"><span data-stu-id="e7f62-149">Personal address book</span></span>
    
- <span data-ttu-id="e7f62-150">Caminho de pesquisa do armazenamento de mensagens padrão</span><span class="sxs-lookup"><span data-stu-id="e7f62-150">Default message store search path</span></span>
    
- <span data-ttu-id="e7f62-151">Caminho de pesquisa do livro de endereços padrão</span><span class="sxs-lookup"><span data-stu-id="e7f62-151">Default address book search path</span></span>
    
- <span data-ttu-id="e7f62-152">Ordem do provedor de transporte</span><span class="sxs-lookup"><span data-stu-id="e7f62-152">Transport provider order</span></span>
    
<span data-ttu-id="e7f62-153">MAPI sets the default message store to be the first message store in the profile that has the STATUS_DEFAULT_STORE flag set in its **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) property, which indicates that it can be the default store.</span><span class="sxs-lookup"><span data-stu-id="e7f62-153">MAPI sets the default message store to be the first message store in the profile that has the STATUS_DEFAULT_STORE flag set in its **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) property, which indicates that it can be the default store.</span></span> <span data-ttu-id="e7f62-154">Os clientes podem substituir essa configuração chamando **IMAPISession::SetDefaultStore**.</span><span class="sxs-lookup"><span data-stu-id="e7f62-154">Clients can override this setting by calling **IMAPISession::SetDefaultStore**.</span></span> <span data-ttu-id="e7f62-155">Para obter mais informações, [consulte IMAPISession::SetDefaultStore](imapisession-setdefaultstore.md).</span><span class="sxs-lookup"><span data-stu-id="e7f62-155">For more information, see [IMAPISession::SetDefaultStore](imapisession-setdefaultstore.md).</span></span>
  
<span data-ttu-id="e7f62-156">MAPI creates a transport order for handling outgoing and incoming messages.</span><span class="sxs-lookup"><span data-stu-id="e7f62-156">MAPI creates a transport order for handling outgoing and incoming messages.</span></span> <span data-ttu-id="e7f62-157">Quando mais de um provedor de transporte é registrado para uma mensagem de um tipo específico, o MAPI usa essa ordem para determinar qual provedor deve lidar com a mensagem.</span><span class="sxs-lookup"><span data-stu-id="e7f62-157">When more than one transport provider has registered for a message of a particular type, MAPI uses this order to determine which provider should handle the message.</span></span> <span data-ttu-id="e7f62-158">MAPI sets the transport order to be the order in which the transport providers were added to the profile with one exception -- the transports that set the STATUS_XP_PREFER_LAST flag in their **PR_RESOURCE_FLAGS** property are positioned last in the order.</span><span class="sxs-lookup"><span data-stu-id="e7f62-158">MAPI sets the transport order to be the order in which the transport providers were added to the profile with one exception--the transports that set the STATUS_XP_PREFER_LAST flag in their **PR_RESOURCE_FLAGS** property are positioned last in the order.</span></span> <span data-ttu-id="e7f62-159">Os clientes podem definir a ordem de transporte **chamando IMsgServiceAdmin::MsgServiceTransportOrder**.</span><span class="sxs-lookup"><span data-stu-id="e7f62-159">Clients can set the transport order by calling **IMsgServiceAdmin::MsgServiceTransportOrder**.</span></span> <span data-ttu-id="e7f62-160">Para obter mais informações, consulte [IMsgServiceAdmin::MsgServiceTransportOrder](imsgserviceadmin-msgservicetransportorder.md).</span><span class="sxs-lookup"><span data-stu-id="e7f62-160">For more information, see [IMsgServiceAdmin::MsgServiceTransportOrder](imsgserviceadmin-msgservicetransportorder.md).</span></span>
  
<span data-ttu-id="e7f62-161">Essas diretrizes para ordenação de provedores de serviços e serviços de mensagens podem, às vezes, conflitar.</span><span class="sxs-lookup"><span data-stu-id="e7f62-161">These guidelines for ordering service providers and message services might sometimes conflict.</span></span> <span data-ttu-id="e7f62-162">Se houver um conflito, seu código deverá resolver o conflito.</span><span class="sxs-lookup"><span data-stu-id="e7f62-162">If there is a conflict, your code should resolve the conflict.</span></span> <span data-ttu-id="e7f62-163">Você pode usar o programa Painel de Controle de Email para inspecionar um perfil criado para determinar se os provedores foram configurados conforme o esperado.</span><span class="sxs-lookup"><span data-stu-id="e7f62-163">You can use the Mail Control Panel program to inspect a profile that you have created to determine whether the providers have been configured as expected.</span></span>
  

