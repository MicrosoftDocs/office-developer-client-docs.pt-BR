---
title: Abrir uma pasta de repositório de mensagens
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d858e4fe-822e-4330-9ed3-4b7d22fa51dc
description: 'Última modificação: 9 de março de 2015'
ms.openlocfilehash: 63b8224ad56e2b9985c9d733e2a3c27c67eb2f7f
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19768178"
---
# <a name="opening-a-message-store-folder"></a><span data-ttu-id="965dc-103">Abrir uma pasta de repositório de mensagens</span><span class="sxs-lookup"><span data-stu-id="965dc-103">Opening a message store folder</span></span>

<span data-ttu-id="965dc-104">**Aplica-se a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="965dc-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="965dc-105">Antes de qualquer pasta pode ser aberta, seu identificador de entrada deve estar disponível.</span><span class="sxs-lookup"><span data-stu-id="965dc-105">Before any folder can be opened, its entry identifier must be available.</span></span> <span data-ttu-id="965dc-106">Para a maioria das pastas, isso significa que a recuperação de suas propriedades **PR_ENTRYID** .</span><span class="sxs-lookup"><span data-stu-id="965dc-106">For most folders, this means retrieving their **PR_ENTRYID** properties.</span></span> <span data-ttu-id="965dc-107">Para pastas especiais, como algumas das pastas subárvore IPM e outras pastas raiz, MAPI define propriedades de identificador de entrada especiais que estão acessíveis chamando o método de **IMAPIProp::GetProps** do armazenamento de mensagens.</span><span class="sxs-lookup"><span data-stu-id="965dc-107">For special folders, such as some of the IPM subtree folders and other root folders, MAPI defines special entry identifier properties that are accessible by calling the message store's **IMAPIProp::GetProps** method.</span></span> <span data-ttu-id="965dc-108">Esses identificadores de entrada são sempre longo prazo e são nomeados da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="965dc-108">These entry identifiers are always long-term and are named as follows:</span></span> 
  
|<span data-ttu-id="965dc-109">**Folder**</span><span class="sxs-lookup"><span data-stu-id="965dc-109">**Folder**</span></span>|<span data-ttu-id="965dc-110">**Propriedade do identificador de entrada**</span><span class="sxs-lookup"><span data-stu-id="965dc-110">**Entry identifier property**</span></span>|
|:-----|:-----|
|<span data-ttu-id="965dc-111">Pasta caixa de saída</span><span class="sxs-lookup"><span data-stu-id="965dc-111">Outbox folder</span></span>  <br/> |<span data-ttu-id="965dc-112">**PR_IPM_OUTBOX_ENTRYID** ([PidTagIpmOutboxEntryId](pidtagipmoutboxentryid-canonical-property.md)) (Somente para classe de mensagem IPM)</span><span class="sxs-lookup"><span data-stu-id="965dc-112">**PR_IPM_OUTBOX_ENTRYID** ([PidTagIpmOutboxEntryId](pidtagipmoutboxentryid-canonical-property.md)) (IPM message class only)</span></span>  <br/> |
|<span data-ttu-id="965dc-113">Pasta de itens excluídos</span><span class="sxs-lookup"><span data-stu-id="965dc-113">Deleted Items folder</span></span>  <br/> |<span data-ttu-id="965dc-114">**PR_IPM_WASTEBASKET_ENTRYID** ([PidTagIpmWastebasketEntryId](pidtagipmwastebasketentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="965dc-114">**PR_IPM_WASTEBASKET_ENTRYID** ([PidTagIpmWastebasketEntryId](pidtagipmwastebasketentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="965dc-115">Pasta Itens enviados</span><span class="sxs-lookup"><span data-stu-id="965dc-115">Sent Items folder</span></span>  <br/> |<span data-ttu-id="965dc-116">**PR_IPM_SENTMAIL_ENTRYID** ([PidTagIpmSentMailEntryId](pidtagipmsentmailentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="965dc-116">**PR_IPM_SENTMAIL_ENTRYID** ([PidTagIpmSentMailEntryId](pidtagipmsentmailentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="965dc-117">Pasta de raiz IPM</span><span class="sxs-lookup"><span data-stu-id="965dc-117">IPM root folder</span></span>  <br/> |<span data-ttu-id="965dc-118">**PR_IPM_SUBTREE_ENTRYID** ([PidTagIpmSubtreeEntryId](pidtagipmsubtreeentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="965dc-118">**PR_IPM_SUBTREE_ENTRYID** ([PidTagIpmSubtreeEntryId](pidtagipmsubtreeentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="965dc-119">Pasta raiz de resultados de pesquisa</span><span class="sxs-lookup"><span data-stu-id="965dc-119">Search-results root folder</span></span>  <br/> |<span data-ttu-id="965dc-120">**PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="965dc-120">**PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="965dc-121">Pasta raiz de modos de exibição comuns</span><span class="sxs-lookup"><span data-stu-id="965dc-121">Common views root folder</span></span>  <br/> |<span data-ttu-id="965dc-122">**PR_COMMON_VIEWS_ENTRYID** ([PidTagCommonViewsEntryId](pidtagcommonviewsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="965dc-122">**PR_COMMON_VIEWS_ENTRYID** ([PidTagCommonViewsEntryId](pidtagcommonviewsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="965dc-123">Pasta raiz de exibições pessoais</span><span class="sxs-lookup"><span data-stu-id="965dc-123">Personal views root folder</span></span>  <br/> |<span data-ttu-id="965dc-124">**PR_VIEWS_ENTRYID** ([PidTagViewsEntryId](pidtagviewsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="965dc-124">**PR_VIEWS_ENTRYID** ([PidTagViewsEntryId](pidtagviewsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="965dc-125">Pasta raiz de contatos</span><span class="sxs-lookup"><span data-stu-id="965dc-125">Contacts root folder</span></span>  <br/> |<span data-ttu-id="965dc-126">**PR_IPM_CONTACT_ENTRYID** ([PidTagIpmContactEntryId](pidtagipmcontactentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="965dc-126">**PR_IPM_CONTACT_ENTRYID** ([PidTagIpmContactEntryId](pidtagipmcontactentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="965dc-127">Pasta raiz de rascunhos</span><span class="sxs-lookup"><span data-stu-id="965dc-127">Drafts root folder</span></span>  <br/> |<span data-ttu-id="965dc-128">**PR_IPM_DRAFTS_ENTRYID** ([PidTagIpmDraftsEntryId](pidtagipmdraftsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="965dc-128">**PR_IPM_DRAFTS_ENTRYID** ([PidTagIpmDraftsEntryId](pidtagipmdraftsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="965dc-129">Pasta raiz de diário</span><span class="sxs-lookup"><span data-stu-id="965dc-129">Journal root folder</span></span>  <br/> |<span data-ttu-id="965dc-130">**PR_IPM_JOURNAL_ENTRYID** ([PidTagIpmJournalEntryId](pidtagipmjournalentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="965dc-130">**PR_IPM_JOURNAL_ENTRYID** ([PidTagIpmJournalEntryId](pidtagipmjournalentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="965dc-131">Pasta raiz de calendário</span><span class="sxs-lookup"><span data-stu-id="965dc-131">Calendar root folder</span></span>  <br/> |<span data-ttu-id="965dc-132">**PR_IPM_APPOINTMENT_ENTRYID** ([PidTagIpmAppointmentEntryId](pidtagipmappointmententryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="965dc-132">**PR_IPM_APPOINTMENT_ENTRYID** ([PidTagIpmAppointmentEntryId](pidtagipmappointmententryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="965dc-133">Pasta raiz de anotações</span><span class="sxs-lookup"><span data-stu-id="965dc-133">Notes root folder</span></span>  <br/> |<span data-ttu-id="965dc-134">**PR_IPM_NOTE_ENTRYID** ([PidTagIpmNoteEntryId](pidtagipmnoteentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="965dc-134">**PR_IPM_NOTE_ENTRYID** ([PidTagIpmNoteEntryId](pidtagipmnoteentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="965dc-135">Pasta raiz de tarefas</span><span class="sxs-lookup"><span data-stu-id="965dc-135">Tasks root folder</span></span>  <br/> |<span data-ttu-id="965dc-136">**PR_IPM_TASK_ENTRYID** ([PidTagIpmTaskEntryId](pidtagipmtaskentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="965dc-136">**PR_IPM_TASK_ENTRYID** ([PidTagIpmTaskEntryId](pidtagipmtaskentryid-canonical-property.md))</span></span>  <br/> |
   
<span data-ttu-id="965dc-137">Antes de tentar recuperar um desses identificadores de entrada especial, recuperar o **PR\_VALID_FOLDER_MASK** propriedade ([PidTagValidFolderMask](pidtagvalidfoldermask-canonical-property.md)) o armazenamento de mensagens.</span><span class="sxs-lookup"><span data-stu-id="965dc-137">Before you try to retrieve one of these special entry identifiers, retrieve the **PR\_VALID_FOLDER_MASK** ([PidTagValidFolderMask](pidtagvalidfoldermask-canonical-property.md)) property of the message store.</span></span> <span data-ttu-id="965dc-138">**PR\_VALID_FOLDER_MASK** é uma bitmask que identifica quais da entrada especial identificadores existirem.</span><span class="sxs-lookup"><span data-stu-id="965dc-138">**PR\_VALID_FOLDER_MASK** is a bitmask that identifies which of the special entry identifiers exist.</span></span> <span data-ttu-id="965dc-139">Não há um bit para cada uma das pastas especiais.</span><span class="sxs-lookup"><span data-stu-id="965dc-139">There is one bit for each of the special folders.</span></span> <span data-ttu-id="965dc-140">Se o bit for definido, ele indica que a pasta correspondente é suportada e tem um identificador de entrada válida.</span><span class="sxs-lookup"><span data-stu-id="965dc-140">If the bit is set, it indicates that the corresponding folder is supported and has a valid entry identifier.</span></span> <span data-ttu-id="965dc-141">Por exemplo, se a pasta Itens excluídos existe e tem um identificador de entrada válida, na pasta\_IPM_WASTEBASKET_VALID bit será definido em **PR_VALID_FOLDER_MASK**.</span><span class="sxs-lookup"><span data-stu-id="965dc-141">For example, if the Deleted Items folder exists and has a valid entry identifier, the FOLDER\_IPM_WASTEBASKET_VALID bit will be set in **PR_VALID_FOLDER_MASK**.</span></span> 
  
## <a name="open-the-folder-where-all-incoming-messages-of-a-particular-class-are-placed"></a><span data-ttu-id="965dc-142">Abra a pasta onde todas as mensagens recebidas de uma determinada classe são colocadas</span><span class="sxs-lookup"><span data-stu-id="965dc-142">Open the folder where all incoming messages of a particular class are placed</span></span>
  
1. <span data-ttu-id="965dc-143">Chame [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md) para recuperar seu identificador de entrada, definindo o parâmetro _lpszMessageClass_ para apontar para uma cadeia de caracteres que identifica a classe de mensagem.</span><span class="sxs-lookup"><span data-stu-id="965dc-143">Call [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md) to retrieve its entry identifier, setting the  _lpszMessageClass_ parameter to point to a character string identifying the message class.</span></span> <span data-ttu-id="965dc-144">Por exemplo, se você deseja abrir a caixa de entrada para sua subárvore IPM, aponte _lpszMessageClass_ IPM.</span><span class="sxs-lookup"><span data-stu-id="965dc-144">For example, if you want to open the Inbox for your IPM subtree, point  _lpszMessageClass_ to IPM.</span></span> <span data-ttu-id="965dc-145">Se você deseja abrir a pasta de recebimento de mensagens de CPI, defina-lo para apontar para CPI.</span><span class="sxs-lookup"><span data-stu-id="965dc-145">If you want to open the receive folder for IPC messages, set it to point to IPC.</span></span> 

   <span data-ttu-id="965dc-146">Se não houver nenhuma pasta de recebimento registrados para a classe de mensagem, **GetReceiveFolder** escolhe passados a pasta de recebimento cujo classe de mensagem associada corresponde ao prefixo possível mais longa da classe de mensagem.</span><span class="sxs-lookup"><span data-stu-id="965dc-146">If there is no registered receive folder for the message class, **GetReceiveFolder** chooses the receive folder whose associated message class matches the longest possible prefix of the message class passed in.</span></span> <span data-ttu-id="965dc-147">Para obter mais informações, consulte [Pastas de recebimento de MAPI](mapi-receive-folders.md).</span><span class="sxs-lookup"><span data-stu-id="965dc-147">For more information, see [MAPI Receive Folders](mapi-receive-folders.md).</span></span> 
   
   <span data-ttu-id="965dc-148">Observe que a propriedade **PR_IPM_OUTBOX_ENTRYID** é usada para abrir a pasta caixa de saída apenas para mensagens IPM.</span><span class="sxs-lookup"><span data-stu-id="965dc-148">Note that the **PR_IPM_OUTBOX_ENTRYID** property is used to open the Outbox folder only for IPM messages.</span></span> <span data-ttu-id="965dc-149">Se você estiver abrindo a caixa de saída para mensagens de CPI, em vez disso, use o identificador de entrada para sua pasta de recebimento.</span><span class="sxs-lookup"><span data-stu-id="965dc-149">If you are opening the Outbox for IPC messages, use instead the entry identifier for its receive folder.</span></span> <span data-ttu-id="965dc-150">Mensagens de CPI de entrada e saídas são colocadas na pasta de recebimento.</span><span class="sxs-lookup"><span data-stu-id="965dc-150">Both incoming and outgoing IPC messages are placed in the receive folder.</span></span> 
    
2. <span data-ttu-id="965dc-151">Chame um dos quatro métodos **OpenEntry** para abrir a pasta e retornar um ponteiro de interface que você pode usar para acessá-lo.</span><span class="sxs-lookup"><span data-stu-id="965dc-151">Call one of four **OpenEntry** methods to open the folder and return an interface pointer that you can use to access it.</span></span> <span data-ttu-id="965dc-152">Você pode chamar qualquer um dos seguintes métodos para abrir uma pasta:</span><span class="sxs-lookup"><span data-stu-id="965dc-152">You can call any one of the following methods to open a folder:</span></span> 
    
   - [<span data-ttu-id="965dc-153">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="965dc-153">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md)
    
   - [<span data-ttu-id="965dc-154">IMSLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="965dc-154">IMSLogon::OpenEntry</span></span>](imslogon-openentry.md)
    
   - [<span data-ttu-id="965dc-155">IMsgStore::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="965dc-155">IMsgStore::OpenEntry</span></span>](imsgstore-openentry.md)
    
   - [<span data-ttu-id="965dc-156">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="965dc-156">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md)
    
   <span data-ttu-id="965dc-157">O método específico que você escolher depende da pasta a ser aberto e os objetos que estão disponíveis no momento.</span><span class="sxs-lookup"><span data-stu-id="965dc-157">The specific method that you choose depends on the folder to be opened and the objects that are available at the time.</span></span> <span data-ttu-id="965dc-158">Porque o método **IMAPISession** pode abrir qualquer pasta para qualquer armazenamento de mensagens no perfil atual, chame este **OpenEntry** quando você não souber nada sobre a pasta a ser aberto.</span><span class="sxs-lookup"><span data-stu-id="965dc-158">Because the **IMAPISession** method can open any folder for any message store in the current profile, call this **OpenEntry** when you do not know anything about the folder to be opened.</span></span> <span data-ttu-id="965dc-159">Se você sabe qual armazenamento de mensagens possui a pasta e você tiver um ponteiro para o armazenamento de mensagens, chame **IMsgStore::OpenEntry**.</span><span class="sxs-lookup"><span data-stu-id="965dc-159">If you know which message store owns the folder and you have a pointer to the message store, call **IMsgStore::OpenEntry**.</span></span> 
    
   <span data-ttu-id="965dc-160">Por exemplo, use o método **IMsgStore** para abrir uma pasta de recebimento.</span><span class="sxs-lookup"><span data-stu-id="965dc-160">For example, use the **IMsgStore** method to open a receive folder.</span></span> <span data-ttu-id="965dc-161">Se você tiver um ponteiro para o objeto de logon do provedor de repositório a mensagem, chame **IMSLogon::OpenEntry**.</span><span class="sxs-lookup"><span data-stu-id="965dc-161">If you have a pointer to the message store provider's logon object, call **IMSLogon::OpenEntry**.</span></span> <span data-ttu-id="965dc-162">Porque essas chamadas ir diretamente para o provedor de armazenamento de mensagens e não via MAPI, processamento é mais rápido.</span><span class="sxs-lookup"><span data-stu-id="965dc-162">Because these calls go directly to the message store provider rather than through MAPI, processing is faster.</span></span> <span data-ttu-id="965dc-163">Se a pasta que você está abrindo uma subpasta de uma pasta que você já tenha aberto, chame o método de **IMAPIContainer::OpenEntry** de open da pasta.</span><span class="sxs-lookup"><span data-stu-id="965dc-163">If the folder you are opening is a subfolder of a folder that you already have open, call the open folder's **IMAPIContainer::OpenEntry** method.</span></span> <span data-ttu-id="965dc-164">O método **IMAPIContainer** apenas abre as subpastas de uma pasta aberta no momento e é o único método garantido para trabalhar com identificadores de entrada de curto prazo.</span><span class="sxs-lookup"><span data-stu-id="965dc-164">The **IMAPIContainer** method only opens subfolders of a currently opened folder and is the only method guaranteed to work with short-term entry identifiers.</span></span> 
    
3. <span data-ttu-id="965dc-165">Se você deseja ser capaz de fazer alterações na pasta a ser aberto, especifique um nível de acesso, definindo o MAPI\_recomendadas\_acesso ou MAPI\_modificar sinalizador na chamada **OpenEntry** .</span><span class="sxs-lookup"><span data-stu-id="965dc-165">If you want to be able to make changes to the folder to be opened, specify an access level by setting either the MAPI\_BEST\_ACCESS or MAPI\_MODIFY flag in the **OpenEntry** call.</span></span> <span data-ttu-id="965dc-166">Esses sinalizadores são sugestões para o provedor de armazenamento de mensagem para conceder o nível mais alto de acesso, para MAPI\_recomendadas\_acesso ou acesso de leitura/gravação, para MAPI\_modificar, ao abrir a pasta.</span><span class="sxs-lookup"><span data-stu-id="965dc-166">These flags are suggestions to the message store provider to grant the highest level of access, for MAPI\_BEST\_ACCESS, or read/write access, for MAPI\_MODIFY, when opening the folder.</span></span> 

   <span data-ttu-id="965dc-167">Como esses sinalizadores estão apenas sugestões, a pasta pode ou não poderá ser aberta com o nível de acesso que você espera.</span><span class="sxs-lookup"><span data-stu-id="965dc-167">Because these flags are only suggestions, the folder may or may not be opened with the access level you expect.</span></span> <span data-ttu-id="965dc-168">Recuperando a propriedade **PR_ACCESS** ([PidTagAccess](pidtagaccess-canonical-property.md)), você pode determinar o intervalo de operações que podem ser executadas na pasta aberta.</span><span class="sxs-lookup"><span data-stu-id="965dc-168">By retrieving the **PR_ACCESS** ([PidTagAccess](pidtagaccess-canonical-property.md)) property, you can determine the range of operations that can be performed on the open folder.</span></span> 
    
   <span data-ttu-id="965dc-169">No entanto, como vários provedores de armazenamento de mensagem calcular o valor para essa propriedade em propostas ao invés de suporte-lo como uma propriedade de pasta ou como uma coluna na tabela suas hierarquias, recuperá-los pode ser demorada.</span><span class="sxs-lookup"><span data-stu-id="965dc-169">However, because many message store providers calculate the value for this property on demand rather than supporting it as a folder property or as a column in their hierarchy table, retrieving it can be time-consuming.</span></span> <span data-ttu-id="965dc-170">Uma estratégia alternativa é executar uma tentativa de qualquer operação que você precisa realizar e retornar um erro, se necessário.</span><span class="sxs-lookup"><span data-stu-id="965dc-170">An alternate strategy is to attempt whatever operation you need to perform and return an error if necessary.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="965dc-171">Confira também</span><span class="sxs-lookup"><span data-stu-id="965dc-171">See also</span></span>

- [<span data-ttu-id="965dc-172">Propriedade canônica PidTagEntryId</span><span class="sxs-lookup"><span data-stu-id="965dc-172">PidTagEntryId Canonical Property</span></span>](pidtagentryid-canonical-property.md) 
- [<span data-ttu-id="965dc-173">IMAPIProp::GetProps</span><span class="sxs-lookup"><span data-stu-id="965dc-173">IMAPIProp::GetProps</span></span>](imapiprop-getprops.md)

