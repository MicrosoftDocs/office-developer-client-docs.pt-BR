---
title: Desenvolver um provedor do repositório de mensagens MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 83692674-0b5a-468d-9cd7-a2ac3d140bda
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: 36233d51f47c53d6a69494c0fcd799a7c83add29
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22567871"
---
# <a name="developing-a-mapi-message-store-provider"></a><span data-ttu-id="49c41-103">Desenvolver um provedor do repositório de mensagens MAPI</span><span class="sxs-lookup"><span data-stu-id="49c41-103">Developing a MAPI message store provider</span></span>
  
<span data-ttu-id="49c41-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="49c41-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="49c41-105">Como outros provedores de serviço MAPI, armazenamentos de mensagem são bibliotecas de vínculos dinâmicos (DLLs) que apresentam os serviços de um mecanismo de armazenamento subjacente para aplicativos de cliente MAPI e o spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="49c41-105">Like other MAPI service providers, message stores are dynamic-link libraries (DLLs) that present the services of an underlying storage mechanism to MAPI client applications and the MAPI spooler.</span></span> <span data-ttu-id="49c41-106">O provedor de armazenamento de mensagem apresenta o mecanismo de armazenamento subjacente como um conjunto hierárquico de pastas e mensagens de clientes MAPI e o MAPI spooler podem usar.</span><span class="sxs-lookup"><span data-stu-id="49c41-106">The message store provider presents the underlying storage mechanism as a hierarchical set of folders and messages that MAPI clients and the MAPI spooler can use.</span></span>
  
<span data-ttu-id="49c41-107">A ilustração a seguir mostra a arquitetura básica de repositório de mensagem MAPI.</span><span class="sxs-lookup"><span data-stu-id="49c41-107">The following illustration shows the basic MAPI message store architecture.</span></span>
  
<span data-ttu-id="49c41-108">**Message store architecture**</span><span class="sxs-lookup"><span data-stu-id="49c41-108">**Message store architecture**</span></span>
  
<span data-ttu-id="49c41-109">![Arquitetura de armazenamento de mensagens] (media/storearc.gif "Arquitetura de armazenamento de mensagens")</span><span class="sxs-lookup"><span data-stu-id="49c41-109">![Message store architecture](media/storearc.gif "Message store architecture")</span></span>
  
<span data-ttu-id="49c41-110">Você pode implementar um provedor de armazenamento de mensagem usando qualquer tipo de mecanismo de armazenamento subjacente que você gosta.</span><span class="sxs-lookup"><span data-stu-id="49c41-110">You can implement a message store provider by using any sort of underlying storage mechanism you like.</span></span> <span data-ttu-id="49c41-111">No entanto, você precisa estar ciente questões de desempenho.</span><span class="sxs-lookup"><span data-stu-id="49c41-111">However, you need to be aware of performance concerns.</span></span> <span data-ttu-id="49c41-112">Além disso, o mecanismo de armazenamento subjacente deve ser apresentado como um conjunto hierárquico de objetos MAPI.</span><span class="sxs-lookup"><span data-stu-id="49c41-112">In addition, the underlying storage mechanism must be presented as a hierarchical collection of MAPI objects.</span></span> <span data-ttu-id="49c41-113">Esses requisitos média repositórios de mensagem são geralmente implementados por meio de um produto de banco de dados existente que suporta o armazenamento hierárquico de objetos no banco de dados e que tem uma interface de programação ou a estrutura de arquivo bem definida.</span><span class="sxs-lookup"><span data-stu-id="49c41-113">These requirements mean that message stores are typically implemented by using an existing database product that supports hierarchical storage of objects in the database and that has a programming interface or well-defined file structure.</span></span> <span data-ttu-id="49c41-114">Por exemplo, os bancos de dados do Microsoft Office Access, SQL e Oracle podem ser usados como o mecanismo de armazenamento subjacente.</span><span class="sxs-lookup"><span data-stu-id="49c41-114">For example, Microsoft Office Access, SQL, and Oracle databases can be used as the underlying storage mechanism.</span></span> <span data-ttu-id="49c41-115">Alguns produtos de banco de dados tem conjuntos de recursos que tornam mais fácil implementar os recursos MAPI, portanto sua escolha de produto do banco de dados pode ser afetada pelos recursos que seu provedor de armazenamento de mensagem precisa suportar.</span><span class="sxs-lookup"><span data-stu-id="49c41-115">Some database products have feature sets that make it easier to implement MAPI features, so your choice of database product may be affected by the features that your message store provider needs to support.</span></span>
  
<span data-ttu-id="49c41-116">Usando um banco de dados existente como o subjacente salva do mecanismo de armazenamento que você trabalha porque é geralmente mais fácil presente objetos de banco de dados aos clientes MAPI como objetos MAPI que ao implementar seu próprio mecanismo de armazenamento hierárquico.</span><span class="sxs-lookup"><span data-stu-id="49c41-116">Using an existing database as the underlying storage mechanism saves you work because it is usually easier to present database objects to MAPI clients as MAPI objects than to implement your own hierarchical storage mechanism.</span></span> <span data-ttu-id="49c41-117">Isso permite tratar operações MAPI em um nível superior que se você implementar seu próprio mecanismo de armazenamento hierárquico.</span><span class="sxs-lookup"><span data-stu-id="49c41-117">Doing this enables you to treat MAPI operations at a higher level than if you implement your own hierarchical storage mechanism.</span></span> <span data-ttu-id="49c41-118">Por exemplo, procurando por uma mensagem com uma linha de assunto específico se torna uma questão razoavelmente simple de Construindo e enviar uma consulta de banco de dados apropriado, ao invés de implementar as rotinas complexas para pesquisar seu mecanismo de armazenamento hierárquico.</span><span class="sxs-lookup"><span data-stu-id="49c41-118">For example, searching for a message with a particular subject line becomes a fairly simple matter of constructing and submitting an appropriate database query, rather than implementing complex routines to search your hierarchical storage mechanism.</span></span>
  
<span data-ttu-id="49c41-119">Provedores de armazenamento de mensagem se comunicar com clientes MAPI e o spooler MAPI para executar operações em pastas e objetos.</span><span class="sxs-lookup"><span data-stu-id="49c41-119">Message store providers communicate with MAPI clients and the MAPI spooler to perform operations on folders and objects.</span></span> <span data-ttu-id="49c41-120">O provedor de armazenamento de mensagem converte essas operações em operações de nível inferiores no mecanismo de armazenamento subjacente.</span><span class="sxs-lookup"><span data-stu-id="49c41-120">The message store provider translates those operations into lower level operations on the underlying storage mechanism.</span></span> <span data-ttu-id="49c41-121">O spooler MAPI normalmente se comunica com o provedor de armazenamento de mensagem durante o envio e recebimento de mensagens.</span><span class="sxs-lookup"><span data-stu-id="49c41-121">The MAPI spooler typically communicates with the message store provider while sending and receiving messages.</span></span> <span data-ttu-id="49c41-122">Clientes MAPI normalmente se comuniquem com provedores de repositório de mensagem para manipular a hierarquia de pasta e para ler, editar, excluir e enviar mensagens.</span><span class="sxs-lookup"><span data-stu-id="49c41-122">MAPI clients typically communicate with message store providers to manipulate the folder hierarchy and to read, edit, delete, and send messages.</span></span>
  
<span data-ttu-id="49c41-123">O spooler MAPI e clientes MAPI se comunicar com o provedor de armazenamento de mensagem para criar novas mensagens.</span><span class="sxs-lookup"><span data-stu-id="49c41-123">Both the MAPI spooler and MAPI clients communicate with the message store provider to create new messages.</span></span> <span data-ttu-id="49c41-124">Aplicativos cliente fazem isso quando os usuários redigir uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="49c41-124">Client applications do this when users compose a message.</span></span> <span data-ttu-id="49c41-125">O MAPI spooler faz isso quando ele recebe uma mensagem de entrada.</span><span class="sxs-lookup"><span data-stu-id="49c41-125">The MAPI spooler does this when it receives an incoming message.</span></span> <span data-ttu-id="49c41-126">Em ambos os casos, a nova mensagem geralmente é criada na pasta caixa de entrada do armazenamento de mensagens, se houver uma.</span><span class="sxs-lookup"><span data-stu-id="49c41-126">In either case, the new message is usually created in the Inbox folder of the message store, if there is one.</span></span>
  
<span data-ttu-id="49c41-127">Provedores de armazenamento de mensagem fazer uso intenso de tabelas, pastas, mensagens e propriedades MAPI.</span><span class="sxs-lookup"><span data-stu-id="49c41-127">Message store providers make heavy use of MAPI tables, folders, messages, and properties.</span></span> <span data-ttu-id="49c41-128">Os detalhes da implementação para esses objetos são documentados no [MAPI tabelas](mapi-tables.md), [Pastas MAPI](mapi-folders.md), [Mensagens MAPI](mapi-messages.md)e [Visão geral da propriedade de MAPI](mapi-property-overview.md).</span><span class="sxs-lookup"><span data-stu-id="49c41-128">The implementation details for those objects are documented in [MAPI Tables](mapi-tables.md), [MAPI Folders](mapi-folders.md), [MAPI Messages](mapi-messages.md), and [MAPI Property Overview](mapi-property-overview.md).</span></span> <span data-ttu-id="49c41-129">Você deve familiarizar com esse material antes de tentar implementar um provedor de armazenamento de mensagem.</span><span class="sxs-lookup"><span data-stu-id="49c41-129">You should familiarize yourself with that material before attempting to implement a message store provider.</span></span>
  
<span data-ttu-id="49c41-130">Existem dois tipos importantes de provedores de armazenamento de mensagem: aqueles que podem agir como o padrão de um usuário de mensagens repositório e aqueles que não é possível.</span><span class="sxs-lookup"><span data-stu-id="49c41-130">There are two important types of message store providers: those that can act as a user's default message store and those that cannot.</span></span> <span data-ttu-id="49c41-131">Um armazenamento de mensagens padrão é um no qual cliente aplicativos e o MAPI spooler podem executar qualquer tarefa de mensagens, como o recebimento de mensagens ou a criação de pastas.</span><span class="sxs-lookup"><span data-stu-id="49c41-131">A default message store is one in which client applications and the MAPI spooler can perform any messaging task, such as receiving messages or creating folders.</span></span> <span data-ttu-id="49c41-132">Um provedor de armazenamento de mensagem padrão deve oferecer suporte a vários recursos mais que o número mínimo necessário para todos os provedores de armazenamento de mensagem.</span><span class="sxs-lookup"><span data-stu-id="49c41-132">A default message store provider must support several more features than the minimum number required for all message store providers.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="49c41-133">Confira também</span><span class="sxs-lookup"><span data-stu-id="49c41-133">See also</span></span>

- [<span data-ttu-id="49c41-134">Conceitos MAPI</span><span class="sxs-lookup"><span data-stu-id="49c41-134">MAPI concepts</span></span>](mapi-concepts.md)

