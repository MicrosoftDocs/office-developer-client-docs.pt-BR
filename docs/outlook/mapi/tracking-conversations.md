---
title: Acompanhar conversas
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
api_type:
- COM
ms.assetid: 0500dee8-a39d-45ce-87b1-c515e92e083d
description: 'Última modificação: 23 de julho de 2011'
localization_priority: Priority
ms.openlocfilehash: 3a59a7a15b4647832634adc4757544876b8841b1
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32349543"
---
# <a name="tracking-conversations"></a><span data-ttu-id="79098-103">Acompanhar conversas</span><span class="sxs-lookup"><span data-stu-id="79098-103">Tracking Conversations</span></span>

  
  
<span data-ttu-id="79098-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="79098-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="79098-105">Controle de conversa é coletar respostas a uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="79098-105">Conversation tracking is collecting responses to a message.</span></span> <span data-ttu-id="79098-106">Clientes devem configurar duas propriedades que auxiliam no controle conversas:</span><span class="sxs-lookup"><span data-stu-id="79098-106">Clients should set two properties that aid in tracking conversations:</span></span>
  
- <span data-ttu-id="79098-107">**PR_CONVERSATION_TOPIC** ([PidTagConversationTopic](pidtagconversationtopic-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="79098-107">**PR_CONVERSATION_TOPIC** ([PidTagConversationTopic](pidtagconversationtopic-canonical-property.md))</span></span>
    
    <span data-ttu-id="79098-108">**PR_CONVERSATION_TOPIC** é o assunto normalizado da mensagem, o assunto sem as cadeias de caracteres de prefixo.</span><span class="sxs-lookup"><span data-stu-id="79098-108">**PR_CONVERSATION_TOPIC** is the normalized subject of the message, the subject without the prefix strings.</span></span> <span data-ttu-id="79098-109">Definir esta propriedade para o valor da mensagem **PR_NORMALIZED_SUBJECT** ([PidTagNormalizedSubject](pidtagnormalizedsubject-canonical-property.md)) propriedade.</span><span class="sxs-lookup"><span data-stu-id="79098-109">Set this property to the value of the message's **PR_NORMALIZED_SUBJECT** ([PidTagNormalizedSubject](pidtagnormalizedsubject-canonical-property.md)) property.</span></span> 
    
- <span data-ttu-id="79098-110">**PR_CONVERSATION_INDEX** ([PidTagConversationIndex](pidtagconversationindex-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="79098-110">**PR_CONVERSATION_INDEX** ([PidTagConversationIndex](pidtagconversationindex-canonical-property.md))</span></span>
    
    <span data-ttu-id="79098-111">**PR_CONVERSATION_INDEX** indica a posição de mensagem na conversa específica.</span><span class="sxs-lookup"><span data-stu-id="79098-111">**PR_CONVERSATION_INDEX** indicates the position of the message within a particular conversation.</span></span> <span data-ttu-id="79098-112">É reponsabilidade do cliente configurar **PR_CONVERSATION_INDEX** para cada mensagem de saída seja uma nova mensagem, uma mensagem encaminhada ou uma resposta.</span><span class="sxs-lookup"><span data-stu-id="79098-112">It is a client's reponsibility to set **PR_CONVERSATION_INDEX** for each outgoing message, whether it is a new message, a forwarded message, or a reply.</span></span> <span data-ttu-id="79098-113">Clientes podem defini-la manualmente ou chamar [ScCreateConversationIndex](sccreateconversationindex.md), uma função utilitária fornecida pelo MAPI.</span><span class="sxs-lookup"><span data-stu-id="79098-113">Clients can set this property manually or call [ScCreateConversationIndex](sccreateconversationindex.md), a utility function provided by MAPI.</span></span> 
    
 <span data-ttu-id="79098-114">**ScCreateConversationIndex** gera o valor de um índice da conversa de mensagens de saída.</span><span class="sxs-lookup"><span data-stu-id="79098-114">**ScCreateConversationIndex** generates the value of a conversation index for any outgoing message.</span></span> <span data-ttu-id="79098-115">**ScCreateConversationIndex** implementa o índice como um bloqueio de cabeçalho que tem 22 bytes de comprimento, seguido por zero ou mais bloqueio de criança para cada 5 bytes de comprimento.</span><span class="sxs-lookup"><span data-stu-id="79098-115">**ScCreateConversationIndex** implements the index as a header block that is 22 bytes in length, followed by zero or more child blocks each 5 bytes in length.</span></span> 
  
<span data-ttu-id="79098-116">O bloco de cabeçalho é composto por 22 bytes, divididos em três partes:</span><span class="sxs-lookup"><span data-stu-id="79098-116">The header block is composed of 22 bytes, divided into three parts:</span></span>
  
- <span data-ttu-id="79098-117">Um byte reservado.</span><span class="sxs-lookup"><span data-stu-id="79098-117">One reserved byte.</span></span> <span data-ttu-id="79098-118">Esse valor é 1.</span><span class="sxs-lookup"><span data-stu-id="79098-118">Its value is 1.</span></span>
    
- <span data-ttu-id="79098-119">Convertidos em cinco bytes para a hora do sistema atual o formato de estrutura [FILETIME](filetime.md).</span><span class="sxs-lookup"><span data-stu-id="79098-119">Five bytes for the current system time converted to the [FILETIME](filetime.md) structure format.</span></span> 
    
- <span data-ttu-id="79098-120">Dezesseis bytes segurando um [GUID](guid.md), ou identificador global exclusivo.</span><span class="sxs-lookup"><span data-stu-id="79098-120">Sixteen bytes holding a [GUID](guid.md), or globally unique identifier.</span></span>
    
<span data-ttu-id="79098-121">Cada bloqueio de criança é composto por 5 bytes divididos da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="79098-121">Each child block is composed of 5 bytes, divided as follows:</span></span>
  
- <span data-ttu-id="79098-122">Um pouco com um código que representa a diferença entre o horário atual quanto tempo armazenados no bloco de cabeçalho.</span><span class="sxs-lookup"><span data-stu-id="79098-122">One bit containing a code representing the difference between the current time and the time stored in the header block.</span></span> <span data-ttu-id="79098-123">Este bit será 0 se a diferença é menor do que .02 segundo e maior que dois anos, 1 se a diferença é menor do que um segundo e maior 56 anos.</span><span class="sxs-lookup"><span data-stu-id="79098-123">This bit will be 0 if the difference is less than .02 second and greater than two years and 1 if the difference is less than one second and greater than 56 years.</span></span>
    
- <span data-ttu-id="79098-124">Trinta e um bits que contém a diferença entre o horário atual e o horário no bloco de cabeçalho expressado nas unidades **FILETIME**. Essa parte do bloco de criança é produzida com uma das duas estratégias, dependendo do valor de bits primeiro.</span><span class="sxs-lookup"><span data-stu-id="79098-124">Thirty one bits containing the difference between the current time and the time in the header block expressed in **FILETIME** units.This part of the child block is produced using one of two strategies, depending on the value of the first bit.</span></span> <span data-ttu-id="79098-125">Se esse bits for zero, **ScCreateConversationIndex** descarte os 15 bits mais altos e os 18 bits mais baixos.</span><span class="sxs-lookup"><span data-stu-id="79098-125">If this bit is zero, **ScCreateConversationIndex** discards the high 15 bits and the low 18 bits.</span></span> <span data-ttu-id="79098-126">Se este bit é um, a função descartará bits os 10 bits mais alto e os 23 mais baixos.</span><span class="sxs-lookup"><span data-stu-id="79098-126">If this bit is one, the function discards the high 10 bits and the low 23 bits.</span></span> 
    
- <span data-ttu-id="79098-127">Quatro bits que contém um número aleatório gerado pela função Win32 [ObterContagemMarcaEscala](https://msdn.microsoft.com/library/ms724408%28VS.85%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="79098-127">Four bits containing a random number generated by calling the Win32 function [GetTickCount](https://msdn.microsoft.com/library/ms724408%28VS.85%29.aspx).</span></span>
    
- <span data-ttu-id="79098-128">Quatro bits com uma contagem de sequência, obtida a partir de um número aleatório.</span><span class="sxs-lookup"><span data-stu-id="79098-128">Four bits containing a sequence count that is taken from part of the random number.</span></span>
    
<span data-ttu-id="79098-129">Se você optar por configurar manualmente os índices de conversa de mensagens, considere as seguintes sugestões:</span><span class="sxs-lookup"><span data-stu-id="79098-129">If you choose to set the conversation indexes of messages manually, consider the following suggestions:</span></span>
  
1. <span data-ttu-id="79098-130">Manter diferenças em fusos horários dos respondentes transparente; Use UTC vezes em vez de horário local.</span><span class="sxs-lookup"><span data-stu-id="79098-130">Keep differences in the respondents' time zones transparent; use UTC times rather than local time.</span></span>
    
2. <span data-ttu-id="79098-131">Recue cada grupo de conversa no mesmo valor.</span><span class="sxs-lookup"><span data-stu-id="79098-131">Indent each conversation group by the same amount.</span></span>
    
3. <span data-ttu-id="79098-132">Classifique respostas na mesma data de mensagem.</span><span class="sxs-lookup"><span data-stu-id="79098-132">Sort responses to the same message date.</span></span>
    
4. <span data-ttu-id="79098-133">Usar threads separados em momentos diferentes que compartilham o mesmo assunto.</span><span class="sxs-lookup"><span data-stu-id="79098-133">Separate threads started at different times that happen to share the same topic.</span></span> 
    
5. <span data-ttu-id="79098-134">Para implementar uma classificação categorizada para que as mensagens sejam agrupadas por tópico, classifique por **PR_CONVERSATION_TOPIC** primeiro e, em seguida, pelo **PR_CONVERSATION_INDEX**.</span><span class="sxs-lookup"><span data-stu-id="79098-134">To implement a categorized sort so that messages are grouped by topic, sort by **PR_CONVERSATION_TOPIC** first and then by **PR_CONVERSATION_INDEX**.</span></span> <span data-ttu-id="79098-135">Para apresentar os resultados de classificação, configurar a **PR_DEPTH** ([PidTagDepth](pidtagdepth-canonical-property.md)) propriedade 0 por mensagens com um índice da conversa é 22 bytes de comprimento.</span><span class="sxs-lookup"><span data-stu-id="79098-135">To present the results of the sort, set the **PR_DEPTH** ([PidTagDepth](pidtagdepth-canonical-property.md)) property to 0 for messages with a conversation index that is 22 bytes in length.</span></span> <span data-ttu-id="79098-136">Em seguida, para cada 5 byte de incremento no tamanho, aumente o valor da propriedade **PR_DEPTH** em um número.</span><span class="sxs-lookup"><span data-stu-id="79098-136">Then, for every 5-byte increment in the length, increment the value of the **PR_DEPTH** property by one.</span></span> 
    
<span data-ttu-id="79098-137">O grupo PR_ORIGINAL das propriedades também pode ser usado para o controle de conversa.</span><span class="sxs-lookup"><span data-stu-id="79098-137">The PR_ORIGINAL group of properties can also be used for conversation tracking.</span></span> <span data-ttu-id="79098-138">Defina essas propriedades para vincular mensagens encaminhadas ou responder a mensagem original.</span><span class="sxs-lookup"><span data-stu-id="79098-138">Set these properties to link reply or forwarded messages to the original message.</span></span> <span data-ttu-id="79098-139">Todas as propriedades PR_ORIGINAL são opcionais.</span><span class="sxs-lookup"><span data-stu-id="79098-139">All of the PR_ORIGINAL properties are optional.</span></span> <span data-ttu-id="79098-140">Se você não definir explicitamente, por exemplo, **PR_ORIGINAL_AUTHOR_ENTRYID** ([PidTagOriginalAuthorEntryId](pidtagoriginalauthorentryid-canonical-property.md)), o provedor de armazenamento de mensagem pode usar o valor padrão ou o valor da propriedade **PR_ SENDER_ENTRYID** ([PidTagSenderEntryId](pidtagsenderentryid-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="79098-140">If you do not explicitly set, for example, **PR_ORIGINAL_AUTHOR_ENTRYID** ([PidTagOriginalAuthorEntryId](pidtagoriginalauthorentryid-canonical-property.md)), the message store provider can use the default value, or the value of the **PR_SENDER_ENTRYID** ([PidTagSenderEntryId](pidtagsenderentryid-canonical-property.md)) property.</span></span> <span data-ttu-id="79098-141">Da mesma forma, se você não definir **PR_ORIGINAL_AUTHOR_NAME** ou **PR_ORIGINAL_SUBMIT_TIME** ([PidTagOriginalSubmitTime](pidtagoriginalsubmittime-canonical-property.md)), essas propriedades podem ser padrão para os valores a **PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md)) e **PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md)) propriedades, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="79098-141">Likewise, if you do not set **PR_ORIGINAL_AUTHOR_NAME** or **PR_ORIGINAL_SUBMIT_TIME** ([PidTagOriginalSubmitTime](pidtagoriginalsubmittime-canonical-property.md)), these properties can default to the values of the **PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md)) and **PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md)) properties, respectively.</span></span> 
  

