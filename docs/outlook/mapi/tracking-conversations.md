---
title: Acompanhar conversas
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 0500dee8-a39d-45ce-87b1-c515e92e083d
description: '�ltima altera��o: s�bado, 23 de julho de 2011'
ms.openlocfilehash: 7f1dd7a23bbd643b496b7634b6ad0230c806585f
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/04/2018
ms.locfileid: "25398602"
---
# <a name="tracking-conversations"></a><span data-ttu-id="3842b-103">Acompanhar conversas</span><span class="sxs-lookup"><span data-stu-id="3842b-103">Tracking Conversations</span></span>

  
  
<span data-ttu-id="3842b-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="3842b-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="3842b-105">Acompanhamento de conversa está coletando respostas a uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="3842b-105">Conversation tracking is collecting responses to a message.</span></span> <span data-ttu-id="3842b-106">Os clientes devem definir duas propriedades que auxiliam em conversas de acompanhamento:</span><span class="sxs-lookup"><span data-stu-id="3842b-106">Clients should set two properties that aid in tracking conversations:</span></span>
  
- <span data-ttu-id="3842b-107">**PR_CONVERSATION_TOPIC** ([Mapipidtagconversationtopic](pidtagconversationtopic-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="3842b-107">**PR_CONVERSATION_TOPIC** ([PidTagConversationTopic](pidtagconversationtopic-canonical-property.md))</span></span>
    
    <span data-ttu-id="3842b-108">**PR_CONVERSATION_TOPIC** é normalizado assunto da mensagem, o assunto sem as cadeias de caracteres de prefixo.</span><span class="sxs-lookup"><span data-stu-id="3842b-108">**PR_CONVERSATION_TOPIC** is the normalized subject of the message, the subject without the prefix strings.</span></span> <span data-ttu-id="3842b-109">Defina essa propriedade como o valor da propriedade de **PR_NORMALIZED_SUBJECT** ([PidTagNormalizedSubject](pidtagnormalizedsubject-canonical-property.md)) da mensagem.</span><span class="sxs-lookup"><span data-stu-id="3842b-109">Set this property to the value of the message's **PR_NORMALIZED_SUBJECT** ([PidTagNormalizedSubject](pidtagnormalizedsubject-canonical-property.md)) property.</span></span> 
    
- <span data-ttu-id="3842b-110">**PR_CONVERSATION_INDEX** ([PidTagConversationIndex](pidtagconversationindex-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="3842b-110">**PR_CONVERSATION_INDEX** ([PidTagConversationIndex](pidtagconversationindex-canonical-property.md))</span></span>
    
    <span data-ttu-id="3842b-111">**PR_CONVERSATION_INDEX** indica a posição da mensagem em uma conversa em particular.</span><span class="sxs-lookup"><span data-stu-id="3842b-111">**PR_CONVERSATION_INDEX** indicates the position of the message within a particular conversation.</span></span> <span data-ttu-id="3842b-112">É reponsibility do cliente para definir **PR_CONVERSATION_INDEX** para cada mensagem de saída, seja ela uma nova mensagem, uma mensagem encaminhada ou uma resposta.</span><span class="sxs-lookup"><span data-stu-id="3842b-112">It is a client's reponsibility to set **PR_CONVERSATION_INDEX** for each outgoing message, whether it is a new message, a forwarded message, or a reply.</span></span> <span data-ttu-id="3842b-113">Os clientes podem definir essa propriedade manualmente ou chamada [ScCreateConversationIndex](sccreateconversationindex.md), a função de um utilitário fornecido pelo MAPI.</span><span class="sxs-lookup"><span data-stu-id="3842b-113">Clients can set this property manually or call [ScCreateConversationIndex](sccreateconversationindex.md), a utility function provided by MAPI.</span></span> 
    
 <span data-ttu-id="3842b-114">**ScCreateConversationIndex** gera o valor de um índice de conversa de qualquer mensagem de saída.</span><span class="sxs-lookup"><span data-stu-id="3842b-114">**ScCreateConversationIndex** generates the value of a conversation index for any outgoing message.</span></span> <span data-ttu-id="3842b-115">**ScCreateConversationIndex** implementa o índice como um bloco de cabeçalho 22 bytes de comprimento, seguido por zero ou mais filhos bloqueia a cada 5 bytes de comprimento.</span><span class="sxs-lookup"><span data-stu-id="3842b-115">**ScCreateConversationIndex** implements the index as a header block that is 22 bytes in length, followed by zero or more child blocks each 5 bytes in length.</span></span> 
  
<span data-ttu-id="3842b-116">O bloco de cabeçalho é composto de 22 bytes, divididos em três partes:</span><span class="sxs-lookup"><span data-stu-id="3842b-116">The header block is composed of 22 bytes, divided into three parts:</span></span>
  
- <span data-ttu-id="3842b-117">Um byte reservado.</span><span class="sxs-lookup"><span data-stu-id="3842b-117">One reserved byte.</span></span> <span data-ttu-id="3842b-118">Seu valor é 1.</span><span class="sxs-lookup"><span data-stu-id="3842b-118">Its value is 1.</span></span>
    
- <span data-ttu-id="3842b-119">O formato de estrutura [FILETIME](filetime.md) convertidas cinco bytes para a hora atual do sistema.</span><span class="sxs-lookup"><span data-stu-id="3842b-119">Five bytes for the current system time converted to the [FILETIME](filetime.md) structure format.</span></span> 
    
- <span data-ttu-id="3842b-120">Bytes de dezesseis segurando um [GUID](guid.md), ou um identificador globalmente exclusivo.</span><span class="sxs-lookup"><span data-stu-id="3842b-120">Sixteen bytes holding a [GUID](guid.md), or globally unique identifier.</span></span>
    
<span data-ttu-id="3842b-121">Cada bloco filho é composto de 5 bytes, divididos como segue:</span><span class="sxs-lookup"><span data-stu-id="3842b-121">Each child block is composed of 5 bytes, divided as follows:</span></span>
  
- <span data-ttu-id="3842b-122">Um bit que contém um código que representa a diferença entre a hora atual e a hora armazenados no bloco de cabeçalho.</span><span class="sxs-lookup"><span data-stu-id="3842b-122">One bit containing a code representing the difference between the current time and the time stored in the header block.</span></span> <span data-ttu-id="3842b-123">Esse bit será 0 se a diferença for menor do que:,02 segundo e maior que dois anos e 1 se a diferença for menor do que um segundo e maior 56 anos.</span><span class="sxs-lookup"><span data-stu-id="3842b-123">This bit will be 0 if the difference is less than .02 second and greater than two years and 1 if the difference is less than one second and greater than 56 years.</span></span>
    
- <span data-ttu-id="3842b-124">Bits de trinta um contendo a diferença entre a hora atual e a hora no bloco de cabeçalho expressado em unidades de **FILETIME** . Esta parte do bloco filho é produzida usando uma das duas estratégias, dependendo do valor da primeiro estará definido o bit.</span><span class="sxs-lookup"><span data-stu-id="3842b-124">Thirty one bits containing the difference between the current time and the time in the header block expressed in **FILETIME** units.This part of the child block is produced using one of two strategies, depending on the value of the first bit.</span></span> <span data-ttu-id="3842b-125">Se esse bit for zero, **ScCreateConversationIndex** descarta os bits de 15 altos e 18 bits baixos.</span><span class="sxs-lookup"><span data-stu-id="3842b-125">If this bit is zero, **ScCreateConversationIndex** discards the high 15 bits and the low 18 bits.</span></span> <span data-ttu-id="3842b-126">Se esse bit é aquele, a função descarta os 10 bits altos e os bits de 23 baixos.</span><span class="sxs-lookup"><span data-stu-id="3842b-126">If this bit is one, the function discards the high 10 bits and the low 23 bits.</span></span> 
    
- <span data-ttu-id="3842b-127">Quatro bits contendo um número aleatório gerado da função Win32 [GetTickCount](https://msdn.microsoft.com/library/ms724408%28VS.85%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="3842b-127">Four bits containing a random number generated by calling the Win32 function [GetTickCount](https://msdn.microsoft.com/library/ms724408%28VS.85%29.aspx).</span></span>
    
- <span data-ttu-id="3842b-128">Quatro bits contendo uma contagem de sequência é obtida a parte do número aleatório.</span><span class="sxs-lookup"><span data-stu-id="3842b-128">Four bits containing a sequence count that is taken from part of the random number.</span></span>
    
<span data-ttu-id="3842b-129">Se você optar por definir manualmente os índices de conversa de mensagens, considere as seguintes sugestões:</span><span class="sxs-lookup"><span data-stu-id="3842b-129">If you choose to set the conversation indexes of messages manually, consider the following suggestions:</span></span>
  
1. <span data-ttu-id="3842b-130">Mantenha as diferenças em fusos horários dos entrevistados transparente; Use os tempos de UTC em vez da hora local.</span><span class="sxs-lookup"><span data-stu-id="3842b-130">Keep differences in the respondents' time zones transparent; use UTC times rather than local time.</span></span>
    
2. <span data-ttu-id="3842b-131">Recuo de cada grupo de conversação no mesmo valor.</span><span class="sxs-lookup"><span data-stu-id="3842b-131">Indent each conversation group by the same amount.</span></span>
    
3. <span data-ttu-id="3842b-132">Respostas de classificação para a mesma data da mensagem.</span><span class="sxs-lookup"><span data-stu-id="3842b-132">Sort responses to the same message date.</span></span>
    
4. <span data-ttu-id="3842b-133">Segmentos separados iniciado em momentos diferentes que ocorrem compartilhar o mesmo tópico.</span><span class="sxs-lookup"><span data-stu-id="3842b-133">Separate threads started at different times that happen to share the same topic.</span></span> 
    
5. <span data-ttu-id="3842b-134">Para implementar uma classificação categorizada para que as mensagens são agrupadas por tópico, classificar por **PR_CONVERSATION_TOPIC** primeiro e depois por **PR_CONVERSATION_INDEX**.</span><span class="sxs-lookup"><span data-stu-id="3842b-134">To implement a categorized sort so that messages are grouped by topic, sort by **PR_CONVERSATION_TOPIC** first and then by **PR_CONVERSATION_INDEX**.</span></span> <span data-ttu-id="3842b-135">Para apresentar os resultados da classificação, defina a propriedade **PR_DEPTH** ([PidTagDepth](pidtagdepth-canonical-property.md)) como 0 para mensagens com um índice de conversa é 22 bytes de comprimento.</span><span class="sxs-lookup"><span data-stu-id="3842b-135">To present the results of the sort, set the **PR_DEPTH** ([PidTagDepth](pidtagdepth-canonical-property.md)) property to 0 for messages with a conversation index that is 22 bytes in length.</span></span> <span data-ttu-id="3842b-136">Em seguida, para cada incremento de 5 bytes no comprimento, incremente o valor da propriedade **PR_DEPTH** por um.</span><span class="sxs-lookup"><span data-stu-id="3842b-136">Then, for every 5-byte increment in the length, increment the value of the **PR_DEPTH** property by one.</span></span> 
    
<span data-ttu-id="3842b-137">O grupo PR_ORIGINAL das propriedades também pode ser usado para acompanhamento de conversa.</span><span class="sxs-lookup"><span data-stu-id="3842b-137">The PR_ORIGINAL group of properties can also be used for conversation tracking.</span></span> <span data-ttu-id="3842b-138">Defina essas propriedades para vincular a responder ou mensagens encaminhadas à mensagem original.</span><span class="sxs-lookup"><span data-stu-id="3842b-138">Set these properties to link reply or forwarded messages to the original message.</span></span> <span data-ttu-id="3842b-139">Todas as propriedades PR_ORIGINAL são opcionais.</span><span class="sxs-lookup"><span data-stu-id="3842b-139">All of the PR_ORIGINAL properties are optional.</span></span> <span data-ttu-id="3842b-140">Se você não definir explicitamente, por exemplo, **PR_ORIGINAL_AUTHOR_ENTRYID** ([PidTagOriginalAuthorEntryId](pidtagoriginalauthorentryid-canonical-property.md)), o provedor de armazenamento de mensagens pode usar o valor padrão, ou o valor de **PR_SENDER_ENTRYID** ([PidTagSenderEntryId](pidtagsenderentryid-canonical-property.md)) propriedade.</span><span class="sxs-lookup"><span data-stu-id="3842b-140">If you do not explicitly set, for example, **PR_ORIGINAL_AUTHOR_ENTRYID** ([PidTagOriginalAuthorEntryId](pidtagoriginalauthorentryid-canonical-property.md)), the message store provider can use the default value, or the value of the **PR_SENDER_ENTRYID** ([PidTagSenderEntryId](pidtagsenderentryid-canonical-property.md)) property.</span></span> <span data-ttu-id="3842b-141">Da mesma forma, se você não definir **PR_ORIGINAL_AUTHOR_NAME** ou **PR_ORIGINAL_SUBMIT_TIME** ([PidTagOriginalSubmitTime](pidtagoriginalsubmittime-canonical-property.md)), essas propriedades podem padrão para os valores dos **PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md)) e **PR_ CLIENT_SUBMIT_TIME** propriedades ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md)), respectivamente.</span><span class="sxs-lookup"><span data-stu-id="3842b-141">Likewise, if you do not set **PR_ORIGINAL_AUTHOR_NAME** or **PR_ORIGINAL_SUBMIT_TIME** ([PidTagOriginalSubmitTime](pidtagoriginalsubmittime-canonical-property.md)), these properties can default to the values of the **PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md)) and **PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md)) properties, respectively.</span></span> 
  

