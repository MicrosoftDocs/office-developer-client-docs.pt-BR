---
title: Perfis e serviços de mensagens
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: df0db1e4-69c8-44ec-bb2a-d31fc8a564b9
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: 78a13bacf13b019bbf9436830ad66db7fdfaf425
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33415464"
---
# <a name="message-services-and-profiles"></a><span data-ttu-id="4c491-103">Perfis e serviços de mensagens</span><span class="sxs-lookup"><span data-stu-id="4c491-103">Message services and profiles</span></span>
  
<span data-ttu-id="4c491-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="4c491-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="4c491-105">Alguns usuários exigem os serviços de vários sistemas de mensagens, cada um com um ou mais provedores de serviços.</span><span class="sxs-lookup"><span data-stu-id="4c491-105">Some users require the services of several messaging systems, each with one or more service providers.</span></span> <span data-ttu-id="4c491-106">Como é complicado instalar e configurar cada um desses provedores de serviços individualmente e como um servidor de mensagens geralmente exige um grupo de provedores relacionados para expor toda a sua funcionalidade, o MAPI inclui o conceito de um serviço de mensagens.</span><span class="sxs-lookup"><span data-stu-id="4c491-106">Because it is cumbersome to install and configure each of these service providers individually, and because a messaging server usually requires a group of related providers to expose all its functionality, MAPI includes the concept of a message service.</span></span> <span data-ttu-id="4c491-107">Os serviços de mensagens ajudam os usuários a instalar e configurar seus provedores de serviços.</span><span class="sxs-lookup"><span data-stu-id="4c491-107">Message services help users install and configure their service providers.</span></span>
  
<span data-ttu-id="4c491-108">Para criar um serviço de mensagens, um desenvolvedor grava um programa de ponto de entrada de serviço de mensagem para lidar com a configuração de cada provedor no serviço e um programa de instalação para fazer o seguinte:</span><span class="sxs-lookup"><span data-stu-id="4c491-108">To create a message service, a developer writes a message-service entry point program to handle the configuration of each provider in the service and a setup program to do the following:</span></span>
  
- <span data-ttu-id="4c491-109">Instale cada provedor no serviço.</span><span class="sxs-lookup"><span data-stu-id="4c491-109">Install each provider in the service.</span></span>
    
- <span data-ttu-id="4c491-110">Crie entradas de arquivo de registro e inicialização.</span><span class="sxs-lookup"><span data-stu-id="4c491-110">Create registry and initialization file entries.</span></span>
    
- <span data-ttu-id="4c491-111">Crie entradas no arquivo de configuração MAPI, Mapisvc.inf.</span><span class="sxs-lookup"><span data-stu-id="4c491-111">Create entries in the MAPI configuration file, Mapisvc.inf.</span></span>
    
<span data-ttu-id="4c491-112">O arquivo Mapisvc.inf contém informações relacionadas à configuração de todos os serviços de mensagem e provedores de serviços instalados no computador.</span><span class="sxs-lookup"><span data-stu-id="4c491-112">The Mapisvc.inf file contains information that relates to the configuration of all message services and service providers installed on the computer.</span></span> <span data-ttu-id="4c491-113">Ele é organizado em seções hierárquicas, com cada nível vinculado ao próximo.</span><span class="sxs-lookup"><span data-stu-id="4c491-113">It is organized in hierarchical sections, with each level linked to the next.</span></span> <span data-ttu-id="4c491-114">Na parte superior, há três seções que contêm o seguinte:</span><span class="sxs-lookup"><span data-stu-id="4c491-114">At the top are three sections that contain the following:</span></span> 
  
- <span data-ttu-id="4c491-115">Uma lista de arquivos de Ajuda do serviço de mensagens.</span><span class="sxs-lookup"><span data-stu-id="4c491-115">A list of message service Help files.</span></span>
    
- <span data-ttu-id="4c491-116">Uma lista dos serviços de mensagem mais importantes ou padrão.</span><span class="sxs-lookup"><span data-stu-id="4c491-116">A list of the most important, or default, message services.</span></span>
    
- <span data-ttu-id="4c491-117">Uma lista de todos os serviços no computador.</span><span class="sxs-lookup"><span data-stu-id="4c491-117">A list of all the services on the computer.</span></span>
    
<span data-ttu-id="4c491-118">O próximo nível contém seções para cada serviço de mensagens e o último nível contém seções para cada provedor de serviços em um serviço.</span><span class="sxs-lookup"><span data-stu-id="4c491-118">The next level contains sections for each message service, and the last level contains sections for each service provider in a service.</span></span> <span data-ttu-id="4c491-119">MAPI requires that developers of service providers and message services add certain entries to Mapisvc.inf; os desenvolvedores podem adicionar outras entradas a seu próprio critério.</span><span class="sxs-lookup"><span data-stu-id="4c491-119">MAPI requires that developers of service providers and message services add certain entries to Mapisvc.inf; developers can add other entries at their own discretion.</span></span> <span data-ttu-id="4c491-120">A maioria das informações em Mapisvc.inf termina em um ou mais perfis, um conjunto de informações de configuração para o conjunto preferencial de serviços de mensagens de um usuário.</span><span class="sxs-lookup"><span data-stu-id="4c491-120">Most of the information in Mapisvc.inf ends up in one or more profiles, a collection of configuration information for a user's preferred set of message services.</span></span> <span data-ttu-id="4c491-121">Como um computador pode ter vários usuários e um único usuário pode ter vários conjuntos de preferências, muitos perfis podem existir em um computador.</span><span class="sxs-lookup"><span data-stu-id="4c491-121">Because a computer can have multiple users and a single user can have multiple sets of preferences, many profiles can exist on a computer.</span></span> <span data-ttu-id="4c491-122">Cada perfil descreve um conjunto diferente de serviços de mensagens.</span><span class="sxs-lookup"><span data-stu-id="4c491-122">Each profile describes a different set of message services.</span></span> <span data-ttu-id="4c491-123">Ter vários perfis permite que um usuário trabalhe, por exemplo, em casa com um conjunto de serviços de mensagens e no escritório com um conjunto diferente.</span><span class="sxs-lookup"><span data-stu-id="4c491-123">Having multiple profiles enables a user to work, for example, at home with one set of message services and at the office with a different set.</span></span>
  
<span data-ttu-id="4c491-124">Os perfis são criados no momento da instalação ou no horário de logon do serviço de mensagens por um aplicativo cliente que fornece suporte à configuração.</span><span class="sxs-lookup"><span data-stu-id="4c491-124">Profiles are created at message service installation or logon time by a client application that provides configuration support.</span></span> <span data-ttu-id="4c491-125">MAPI provides two such client applications: a Control Panel item and the Profile Wizard.</span><span class="sxs-lookup"><span data-stu-id="4c491-125">MAPI provides two such client applications: a Control Panel item and the Profile Wizard.</span></span> <span data-ttu-id="4c491-126">O item painel de controle é um aplicativo de configuração de serviço completo com o qual os usuários podem criar, excluir, editar e copiar perfis, bem como fazer modificações nas entradas em um perfil.</span><span class="sxs-lookup"><span data-stu-id="4c491-126">The Control Panel item is a full-service configuration application with which users can create, delete, edit, and copy profiles, as well as make modifications to the entries in a profile.</span></span> <span data-ttu-id="4c491-127">O Assistente de Perfil é um aplicativo simples projetado para facilitar ao máximo a adição de um serviço de mensagens a um perfil.</span><span class="sxs-lookup"><span data-stu-id="4c491-127">The Profile Wizard is a simple application designed to make adding a message service to a profile as easy as possible.</span></span> <span data-ttu-id="4c491-128">O Assistente de Perfil consiste em uma série de caixas de diálogo, chamadas de páginas de propriedades, que solicitam ao usuário o processo de instalação e configuração de um serviço.</span><span class="sxs-lookup"><span data-stu-id="4c491-128">The Profile Wizard consists of a series of dialog boxes, called property pages, that prompt the user through the process of installing and configuring a service.</span></span> <span data-ttu-id="4c491-129">O usuário é solicitado apenas pelos valores das configurações mais críticas; todas as outras configurações herdam valores padrão.</span><span class="sxs-lookup"><span data-stu-id="4c491-129">The user is prompted only for values for the most critical settings; all other settings inherit default values.</span></span> <span data-ttu-id="4c491-130">Depois que o perfil tiver sido criado, os usuários não poderão fazer alterações.</span><span class="sxs-lookup"><span data-stu-id="4c491-130">Once the profile has been created, users are not allowed to make changes.</span></span> 
  
<span data-ttu-id="4c491-131">Enquanto o item do Painel de Controle é sempre invocado por meio do Painel de Controle, há uma variedade de cenários que podem fazer com que o Assistente de Perfil seja chamado.</span><span class="sxs-lookup"><span data-stu-id="4c491-131">Whereas the Control Panel item is always invoked through the Control Panel, there are a variety of scenarios that can cause the Profile Wizard to be called.</span></span> <span data-ttu-id="4c491-132">Os aplicativos cliente podem chamar o Assistente de Perfil para criar um perfil padrão no momento do logon quando um ainda não foi criado.</span><span class="sxs-lookup"><span data-stu-id="4c491-132">Client applications can call the Profile Wizard to create a default profile at logon time when one has not yet been created.</span></span> <span data-ttu-id="4c491-133">Em vez de reimplante o código para adicionar um perfil, o item do Painel de Controle ou outro aplicativo cliente pode depender da funcionalidade que já está no Assistente de Perfil.</span><span class="sxs-lookup"><span data-stu-id="4c491-133">Rather than reimplementing code to add a profile, the Control Panel item or another client application can rely on the functionality already in the Profile Wizard.</span></span> <span data-ttu-id="4c491-134">Um serviço de mensagens, em sua função de ponto de entrada, pode chamar o Assistente de Perfil quando o serviço precisar ser adicionado ao perfil padrão.</span><span class="sxs-lookup"><span data-stu-id="4c491-134">A message service, in its entry point function, can call the Profile Wizard when the service needs to be added to the default profile.</span></span> <span data-ttu-id="4c491-135">Os serviços de mensagem que usam o Assistente de Perfil devem escrever uma função de ponto de entrada extra e um procedimento de caixa de diálogo padrão do Windows.</span><span class="sxs-lookup"><span data-stu-id="4c491-135">Message services that use the Profile Wizard must write an extra entry point function and a standard Windows dialog box procedure.</span></span> <span data-ttu-id="4c491-136">O Assistente de Perfil chama a função de ponto de entrada para recuperar a caixa de diálogo de configuração do serviço enquanto o procedimento da caixa de diálogo trata as mensagens geradas quando essa caixa de diálogo está em uso.</span><span class="sxs-lookup"><span data-stu-id="4c491-136">The Profile Wizard calls the entry point function to retrieve the service's configuration dialog box while the dialog box procedure handles the messages that are generated when this dialog box is in use.</span></span> 
  
<span data-ttu-id="4c491-137">Os perfis são organizados de maneira semelhante ao arquivo Mapisvc.inf.</span><span class="sxs-lookup"><span data-stu-id="4c491-137">Profiles are organized in a similar way to the Mapisvc.inf file.</span></span> <span data-ttu-id="4c491-138">Perfis têm seções hierárquicas vinculadas; os provedores de serviços têm seções no nível mais baixo, os serviços de mensagens têm seções no nível intermediário e o MAPI possui seções no nível mais alto.</span><span class="sxs-lookup"><span data-stu-id="4c491-138">Profiles have linked hierarchical sections; service providers own sections in the lowest level, message services own sections in the middle level, and MAPI owns sections in the highest level.</span></span> <span data-ttu-id="4c491-139">Cada seção é identificada com um identificador exclusivo conhecido como [MAPIUID.](mapiuid.md)</span><span class="sxs-lookup"><span data-stu-id="4c491-139">Each section is identified with a unique identifier known as a [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="4c491-140">As seções MAPI contêm informações internas para MAPI, como os identificadores de todas as seções de perfil de serviço de mensagens e links para cada uma das outras seções.</span><span class="sxs-lookup"><span data-stu-id="4c491-140">The MAPI sections contain information internal to MAPI, such as the identifiers of all of the message service profile sections and links to each of the other sections.</span></span> <span data-ttu-id="4c491-141">Cada seção de serviço de mensagens armazena links para suas seções de provedor, e cada seção do provedor armazena um link para sua seção de serviço.</span><span class="sxs-lookup"><span data-stu-id="4c491-141">Each message service section stores links to its provider sections, and each provider section stores a link to its service section.</span></span> 
  
<span data-ttu-id="4c491-142">A ilustração a seguir mostra o conteúdo de dois perfis típicos.</span><span class="sxs-lookup"><span data-stu-id="4c491-142">The following illustration shows the contents of two typical profiles.</span></span> <span data-ttu-id="4c491-143">Sam tem dois perfis em seu computador, um para uso em casa e outro para uso no escritório.</span><span class="sxs-lookup"><span data-stu-id="4c491-143">Sam has two profiles on his computer, one for home use and one for office use.</span></span> <span data-ttu-id="4c491-144">O perfil home contém três serviços de mensagem.</span><span class="sxs-lookup"><span data-stu-id="4c491-144">The home profile contains three message services.</span></span> <span data-ttu-id="4c491-145">O Serviço de Mensagens X é um serviço de provedor único para gerenciamento de livro de endereços.</span><span class="sxs-lookup"><span data-stu-id="4c491-145">Message Service X is a single provider service for address book management.</span></span> <span data-ttu-id="4c491-146">Os Serviços de Mensagens Y e Z têm três provedores: um provedor de agendas, um provedor de armazenamento de mensagens e um provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="4c491-146">Message Services Y and Z have three providers — an address book provider, a message store provider, and a transport provider.</span></span> <span data-ttu-id="4c491-147">O Perfil de Trabalho do Sam contém dois serviços de mensagem diferentes, cada um deles tem um provedor de agenda, um provedor de armazenamento de mensagens e um provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="4c491-147">Sam's Work Profile contains two different message services, each of which has an address book provider, a message store provider, and a transport provider.</span></span> 
  
<span data-ttu-id="4c491-148">**Profile example**</span><span class="sxs-lookup"><span data-stu-id="4c491-148">**Profile example**</span></span>
  
<span data-ttu-id="4c491-149">![Exemplo de perfil de](media/amapi_56.gif "exemplo de perfil")</span><span class="sxs-lookup"><span data-stu-id="4c491-149">![Profile example](media/amapi_56.gif "Profile example")</span></span>
  
<span data-ttu-id="4c491-150">A ilustração a seguir mostra um perfil que inclui dois serviços de mensagem.</span><span class="sxs-lookup"><span data-stu-id="4c491-150">The following illustration shows a profile that includes two message services.</span></span> <span data-ttu-id="4c491-151">O código para instalar e configurar os provedores de serviços que pertencem ao serviço de mensagens reside na mesma DLL que o código para os provedores.</span><span class="sxs-lookup"><span data-stu-id="4c491-151">The code for installing and configuring the service providers that belong to the message service resides in the same DLL as the code for the providers.</span></span> <span data-ttu-id="4c491-152">Este código lê informações do perfil no momento do logon para configurar os provedores de serviços e solicita ao usuário, se possível e necessário, informações ausentes.</span><span class="sxs-lookup"><span data-stu-id="4c491-152">This code reads information from the profile at logon time to configure the service providers, and it prompts the user, if possible and necessary, for missing information.</span></span> <span data-ttu-id="4c491-153">As solicitações de um cliente para exibir ou alterar as definições de configuração de qualquer um dos provedores também são tratadas por esse código comum.</span><span class="sxs-lookup"><span data-stu-id="4c491-153">Requests from a client to view or change configuration settings for any of the providers are also handled by this common code.</span></span>
  
<span data-ttu-id="4c491-154">**Installing and configuring service providers**</span><span class="sxs-lookup"><span data-stu-id="4c491-154">**Installing and configuring service providers**</span></span>
  
<span data-ttu-id="4c491-155">![Instalando e configurando provedores de serviços](media/amapi_55.gif "instalando e configurando provedores de serviços")</span><span class="sxs-lookup"><span data-stu-id="4c491-155">![Installing and configuring service providers](media/amapi_55.gif "Installing and configuring service providers")</span></span>
  
## <a name="see-also"></a><span data-ttu-id="4c491-156">Confira também</span><span class="sxs-lookup"><span data-stu-id="4c491-156">See also</span></span>

- [<span data-ttu-id="4c491-157">MAPIUID</span><span class="sxs-lookup"><span data-stu-id="4c491-157">MAPIUID</span></span>](mapiuid.md)
- [<span data-ttu-id="4c491-158">Visão geral da programação MAPI</span><span class="sxs-lookup"><span data-stu-id="4c491-158">MAPI Programming Overview</span></span>](mapi-programming-overview.md)

