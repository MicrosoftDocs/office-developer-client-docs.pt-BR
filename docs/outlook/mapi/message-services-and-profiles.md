---
title: Perfis e serviços de mensagem
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: df0db1e4-69c8-44ec-bb2a-d31fc8a564b9
description: '�ltima altera��o: s�bado, 23 de julho de 2011'
ms.openlocfilehash: 0f55d4cda013810884177a0f47e861e3693defd7
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19768142"
---
# <a name="message-services-and-profiles"></a><span data-ttu-id="c2dc2-103">Perfis e serviços de mensagem</span><span class="sxs-lookup"><span data-stu-id="c2dc2-103">Message services and profiles</span></span>
  
<span data-ttu-id="c2dc2-104">**Aplica-se a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="c2dc2-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="c2dc2-105">Alguns usuários necessitam dos serviços de diversos sistemas de mensagens, cada um com um ou mais provedores de serviço.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-105">Some users require the services of several messaging systems, each with one or more service providers.</span></span> <span data-ttu-id="c2dc2-106">Porque ele é complicado para instalar e configurar cada um desses provedores de serviço individualmente e como um servidor de mensagens normalmente exige um grupo de provedores relacionados expor toda sua funcionalidade, MAPI inclui o conceito de um serviço de mensagem.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-106">Because it is cumbersome to install and configure each of these service providers individually, and because a messaging server usually requires a group of related providers to expose all its functionality, MAPI includes the concept of a message service.</span></span> <span data-ttu-id="c2dc2-107">Serviços de mensagens ajudam os usuários a instalar e configurar seus provedores de serviço.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-107">Message services help users install and configure their service providers.</span></span>
  
<span data-ttu-id="c2dc2-108">Para criar um serviço de mensagem, um desenvolvedor grava um programa de ponto de entrada de serviço de mensagem para lidar com a configuração de cada provedor de serviço e um programa de instalação para fazer o seguinte:</span><span class="sxs-lookup"><span data-stu-id="c2dc2-108">To create a message service, a developer writes a message-service entry point program to handle the configuration of each provider in the service and a setup program to do the following:</span></span>
  
- <span data-ttu-id="c2dc2-109">Instale cada provedor no serviço.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-109">Install each provider in the service.</span></span>
    
- <span data-ttu-id="c2dc2-110">Crie registro e inicialização entradas do arquivo.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-110">Create registry and initialization file entries.</span></span>
    
- <span data-ttu-id="c2dc2-111">Crie entradas no arquivo de configuração MAPI Mapisvc.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-111">Create entries in the MAPI configuration file, Mapisvc.inf.</span></span>
    
<span data-ttu-id="c2dc2-112">O arquivo Mapisvc contém informações relacionadas à configuração de todos os serviços de mensagem e provedores de serviços instalados no computador.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-112">The Mapisvc.inf file contains information that relates to the configuration of all message services and service providers installed on the computer.</span></span> <span data-ttu-id="c2dc2-113">Ele é organizado nas seções hierárquicas, com cada nível vinculada para a próxima.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-113">It is organized in hierarchical sections, with each level linked to the next.</span></span> <span data-ttu-id="c2dc2-114">Na parte superior são três seções que contêm o seguinte:</span><span class="sxs-lookup"><span data-stu-id="c2dc2-114">At the top are three sections that contain the following:</span></span> 
  
- <span data-ttu-id="c2dc2-115">Uma lista de arquivos de Ajuda do serviço de mensagem.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-115">A list of message service Help files.</span></span>
    
- <span data-ttu-id="c2dc2-116">Uma lista dos mais importantes ou padrão, serviços de mensagem.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-116">A list of the most important, or default, message services.</span></span>
    
- <span data-ttu-id="c2dc2-117">Uma lista de todos os serviços no computador.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-117">A list of all the services on the computer.</span></span>
    
<span data-ttu-id="c2dc2-118">O próximo nível contém seções para cada serviço de mensagem e o último nível contém seções para cada provedor de serviços em um serviço.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-118">The next level contains sections for each message service, and the last level contains sections for each service provider in a service.</span></span> <span data-ttu-id="c2dc2-119">MAPI exige que o desenvolvedores de provedores de serviço e serviços de mensagem adicionem certas entradas para Mapisvc; os desenvolvedores podem adicionar outras entradas suas próprias critério.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-119">MAPI requires that developers of service providers and message services add certain entries to Mapisvc.inf; developers can add other entries at their own discretion.</span></span> <span data-ttu-id="c2dc2-120">Maioria das informações em MAPISVC termina em um ou mais perfis, uma coleção de informações de configuração de um usuário preferencial conjunto de serviços de mensagem.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-120">Most of the information in Mapisvc.inf ends up in one or more profiles, a collection of configuration information for a user's preferred set of message services.</span></span> <span data-ttu-id="c2dc2-121">Porque um computador pode ter vários usuários e um único usuário pode ter vários conjuntos de preferências, muitos perfis podem existir em um computador.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-121">Because a computer can have multiple users and a single user can have multiple sets of preferences, many profiles can exist on a computer.</span></span> <span data-ttu-id="c2dc2-122">Cada perfil descreve um conjunto diferente de serviços de mensagem.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-122">Each profile describes a different set of message services.</span></span> <span data-ttu-id="c2dc2-123">Ter vários perfis permite que um usuário trabalhe, por exemplo, em casa, com um conjunto de serviços de mensagem e no escritório com um conjunto diferente.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-123">Having multiple profiles enables a user to work, for example, at home with one set of message services and at the office with a different set.</span></span>
  
<span data-ttu-id="c2dc2-124">Perfis são criados no tempo de logon ou de instalação do serviço de mensagem por um aplicativo cliente que oferece suporte a configuração.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-124">Profiles are created at message service installation or logon time by a client application that provides configuration support.</span></span> <span data-ttu-id="c2dc2-125">MAPI fornece dois tal cliente aplicativos: um item do painel de controle e o Assistente de perfil.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-125">MAPI provides two such client applications: a Control Panel item and the Profile Wizard.</span></span> <span data-ttu-id="c2dc2-126">O item do painel de controle é um aplicativo de serviço completo de configuração com a qual os usuários podem criar, excluir, editar e copiar perfis, bem como fazer modificações as entradas em um perfil.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-126">The Control Panel item is a full-service configuration application with which users can create, delete, edit, and copy profiles, as well as make modifications to the entries in a profile.</span></span> <span data-ttu-id="c2dc2-127">O Assistente de perfil é um aplicativo simples projetado para facilitar a adição de um serviço de mensagem a um perfil tão fácil quanto possível.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-127">The Profile Wizard is a simple application designed to make adding a message service to a profile as easy as possible.</span></span> <span data-ttu-id="c2dc2-128">O Assistente de perfil consiste em uma série de caixas de diálogo, chamado páginas de propriedades, que solicita ao usuário durante o processo de instalação e configuração de um serviço.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-128">The Profile Wizard consists of a series of dialog boxes, called property pages, that prompt the user through the process of installing and configuring a service.</span></span> <span data-ttu-id="c2dc2-129">O usuário será solicitado apenas para os valores para as configurações mais importantes; todas as outras configurações herdarem valores padrão.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-129">The user is prompted only for values for the most critical settings; all other settings inherit default values.</span></span> <span data-ttu-id="c2dc2-130">Depois que o perfil tiver sido criado, os usuários não poderão fazer alterações.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-130">Once the profile has been created, users are not allowed to make changes.</span></span> 
  
<span data-ttu-id="c2dc2-131">Enquanto o item do painel de controle sempre é invocado por meio do painel de controle, há uma variedade de cenários que podem causar o Assistente de perfil a ser chamado.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-131">Whereas the Control Panel item is always invoked through the Control Panel, there are a variety of scenarios that can cause the Profile Wizard to be called.</span></span> <span data-ttu-id="c2dc2-132">Aplicativos cliente podem chamar o Assistente de perfil para criar um perfil padrão no momento do logon quando um ainda não tiver sido criado.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-132">Client applications can call the Profile Wizard to create a default profile at logon time when one has not yet been created.</span></span> <span data-ttu-id="c2dc2-133">Em vez de reimplementação código para adicionar um perfil, o item do painel de controle ou outro aplicativo cliente pode depender a funcionalidade já no Assistente de perfil.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-133">Rather than reimplementing code to add a profile, the Control Panel item or another client application can rely on the functionality already in the Profile Wizard.</span></span> <span data-ttu-id="c2dc2-134">Um serviço de mensagem, na sua função de ponto de entrada, é possível chamar o Assistente de perfil quando o serviço precisa ser adicionada ao perfil padrão.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-134">A message service, in its entry point function, can call the Profile Wizard when the service needs to be added to the default profile.</span></span> <span data-ttu-id="c2dc2-135">Serviços de mensagem que usam o Assistente de perfil devem escrever uma função de ponto de entrada extra e um procedimento de caixa de diálogo padrão do Windows.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-135">Message services that use the Profile Wizard must write an extra entry point function and a standard Windows dialog box procedure.</span></span> <span data-ttu-id="c2dc2-136">O Assistente de perfil chama a função do ponto de entrada para recuperar a caixa de diálogo de configuração do serviço enquanto o procedimento da caixa de diálogo trata as mensagens que são geradas quando esta caixa de diálogo está em uso.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-136">The Profile Wizard calls the entry point function to retrieve the service's configuration dialog box while the dialog box procedure handles the messages that are generated when this dialog box is in use.</span></span> 
  
<span data-ttu-id="c2dc2-137">Os perfis são organizados de forma semelhante ao arquivo Mapisvc.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-137">Profiles are organized in a similar way to the Mapisvc.inf file.</span></span> <span data-ttu-id="c2dc2-138">Perfis vinculou seções hierárquicas; seções próprio de provedores de serviço no nível mais baixo, serviços de mensagem proprietário seções do nível intermediário e MAPI possui seções o nível mais alto.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-138">Profiles have linked hierarchical sections; service providers own sections in the lowest level, message services own sections in the middle level, and MAPI owns sections in the highest level.</span></span> <span data-ttu-id="c2dc2-139">Cada seção é identificada com um identificador exclusivo, conhecido como um [MAPIUID](mapiuid.md).</span><span class="sxs-lookup"><span data-stu-id="c2dc2-139">Each section is identified with a unique identifier known as a [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="c2dc2-140">As seções MAPI contêm informações internas para MAPI, como os identificadores de todas as seções de perfil de serviço de mensagem e links para cada uma das outras seções.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-140">The MAPI sections contain information internal to MAPI, such as the identifiers of all of the message service profile sections and links to each of the other sections.</span></span> <span data-ttu-id="c2dc2-141">Cada seção do serviço de mensagem armazena links para seu provedor de seções e cada seção de provedor armazena um link para a seção seu serviço.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-141">Each message service section stores links to its provider sections, and each provider section stores a link to its service section.</span></span> 
  
<span data-ttu-id="c2dc2-142">A ilustração a seguir mostra o conteúdo de dois perfis típicos.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-142">The following illustration shows the contents of two typical profiles.</span></span> <span data-ttu-id="c2dc2-143">SAM tem dois perfis no seu computador, um para uso doméstico e outro para uso do office.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-143">Sam has two profiles on his computer, one for home use and one for office use.</span></span> <span data-ttu-id="c2dc2-144">O perfil residencial contém três serviços de mensagem.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-144">The home profile contains three message services.</span></span> <span data-ttu-id="c2dc2-145">X do serviço de mensagem é um serviço único provedor para gerenciamento de catálogo de endereços.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-145">Message Service X is a single provider service for address book management.</span></span> <span data-ttu-id="c2dc2-146">Mensagem serviços Y e Z tem três provedores — um fornecedor de catálogo de endereços, um provedor de armazenamento de mensagens e um provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-146">Message Services Y and Z have three providers — an address book provider, a message store provider, and a transport provider.</span></span> <span data-ttu-id="c2dc2-147">Perfil de trabalho de SAM contém dois serviços de mensagens diferentes, cada um deles tem um fornecedor de catálogo de endereços, um provedor de armazenamento de mensagens e um provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-147">Sam's Work Profile contains two different message services, each of which has an address book provider, a message store provider, and a transport provider.</span></span> 
  
<span data-ttu-id="c2dc2-148">**Profile example**</span><span class="sxs-lookup"><span data-stu-id="c2dc2-148">**Profile example**</span></span>
  
<span data-ttu-id="c2dc2-149">![Exemplo de perfil] (media/amapi_56.gif "Exemplo de perfil")</span><span class="sxs-lookup"><span data-stu-id="c2dc2-149">![Profile example](media/amapi_56.gif "Profile example")</span></span>
  
<span data-ttu-id="c2dc2-150">A ilustração a seguir mostra um perfil que inclui dois serviços de mensagem.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-150">The following illustration shows a profile that includes two message services.</span></span> <span data-ttu-id="c2dc2-151">O código para instalar e configurar os provedores de serviços que pertencem ao serviço de mensagem reside na mesma DLL como o código para os provedores.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-151">The code for installing and configuring the service providers that belong to the message service resides in the same DLL as the code for the providers.</span></span> <span data-ttu-id="c2dc2-152">Este código lê as informações do perfil na hora do logon para configurar os provedores de serviço e solicita que o necessário, para obter informações ausentes e usuário, se possível.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-152">This code reads information from the profile at logon time to configure the service providers, and it prompts the user, if possible and necessary, for missing information.</span></span> <span data-ttu-id="c2dc2-153">Solicitações de um cliente para visualizar ou alterar as definições de configuração de qualquer um dos provedores também são manipuladas por este código comuns.</span><span class="sxs-lookup"><span data-stu-id="c2dc2-153">Requests from a client to view or change configuration settings for any of the providers are also handled by this common code.</span></span>
  
<span data-ttu-id="c2dc2-154">**Installing and configuring service providers**</span><span class="sxs-lookup"><span data-stu-id="c2dc2-154">**Installing and configuring service providers**</span></span>
  
<span data-ttu-id="c2dc2-155">![Instalando e configurando provedores de serviço] (media/amapi_55.gif "Instalando e configurando provedores de serviço")</span><span class="sxs-lookup"><span data-stu-id="c2dc2-155">![Installing and configuring service providers](media/amapi_55.gif "Installing and configuring service providers")</span></span>
  
## <a name="see-also"></a><span data-ttu-id="c2dc2-156">Confira também</span><span class="sxs-lookup"><span data-stu-id="c2dc2-156">See also</span></span>

- [<span data-ttu-id="c2dc2-157">MAPIUID</span><span class="sxs-lookup"><span data-stu-id="c2dc2-157">MAPIUID</span></span>](mapiuid.md)
- [<span data-ttu-id="c2dc2-158">Vis�o geral da programa��o MAPI</span><span class="sxs-lookup"><span data-stu-id="c2dc2-158">MAPI Programming Overview</span></span>](mapi-programming-overview.md)

