---
title: Visão geral do desligamento rápido
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a7830d73-427c-4f8b-86f4-51e040c142c3
description: 'Modificado pela última vez: 26 de junho de 2012'
ms.openlocfilehash: 8b8335fb2722e193f0eab1288b8ffdb2aa62df8b
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22577783"
---
# <a name="fast-shutdown-overview"></a><span data-ttu-id="c9be9-103">Visão geral do desligamento rápido</span><span class="sxs-lookup"><span data-stu-id="c9be9-103">Fast Shutdown Overview</span></span>

<span data-ttu-id="c9be9-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="c9be9-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="c9be9-105">Desligamento rápido é um mecanismo para um cliente MAPI iniciar um desligamento rápido do processo do cliente, informando todos os provedores com o qual o cliente tem uma sessão MAPI ativa para salvar os dados e configurações antes do processo de cliente for encerrado.</span><span class="sxs-lookup"><span data-stu-id="c9be9-105">Fast shutdown is a mechanism for a MAPI client to initiate a quick shutdown of the client process, notifying all providers with which the client has an active MAPI session to save data and settings before the client process exits.</span></span> <span data-ttu-id="c9be9-106">Este tópico descreve o mecanismo básico de desligamento rápido.</span><span class="sxs-lookup"><span data-stu-id="c9be9-106">This topic describes the basic mechanism of fast shutdown.</span></span> 

<span data-ttu-id="c9be9-107">Iniciando no Microsoft Outlook 2010 e agora, incluindo Microsoft Outlook 2013, o subsistema de MAPI fornece o [IMAPIClientShutdown: IUnknown](imapiclientshutdowniunknown.md) interface.</span><span class="sxs-lookup"><span data-stu-id="c9be9-107">Starting in Microsoft Outlook 2010 and now including Microsoft Outlook 2013, the MAPI subsystem provides the [IMAPIClientShutdown : IUnknown](imapiclientshutdowniunknown.md) interface.</span></span> <span data-ttu-id="c9be9-108">Outlook e outros clientes MAPI podem adotar o desligamento rápido como o mecanismo de padrão para sair do processo de cliente.</span><span class="sxs-lookup"><span data-stu-id="c9be9-108">Outlook and other MAPI clients can adopt fast shutdown as the default mechanism to exit the client process.</span></span> <span data-ttu-id="c9be9-109">Uma configuração de nível de usuário no registro do Windows do computador cliente controla a adoção de desligamento rápido para todos os clientes MAPI para o usuário no computador.</span><span class="sxs-lookup"><span data-stu-id="c9be9-109">A user-level setting in the Windows registry of the client computer controls the adoption of fast shutdown for all MAPI clients for that user on that computer.</span></span> <span data-ttu-id="c9be9-110">Para obter detalhes sobre as configurações do registro, consulte [Opções de usuário de desligamento Fast](fast-shutdown-user-options.md).</span><span class="sxs-lookup"><span data-stu-id="c9be9-110">For details about the registry settings, see [Fast Shutdown User Options](fast-shutdown-user-options.md).</span></span>
  
<span data-ttu-id="c9be9-111">Se um cliente MAPI precisa adotar o desligamento rápido, ela deve usar o **IMAPIClientShutdown: IUnknown** interface.</span><span class="sxs-lookup"><span data-stu-id="c9be9-111">If a MAPI client needs to adopt fast shutdown, it must use the **IMAPIClientShutdown : IUnknown** interface.</span></span> <span data-ttu-id="c9be9-112">Este é o curso típico de eventos quando o cliente tenta desligar:</span><span class="sxs-lookup"><span data-stu-id="c9be9-112">The following is the typical course of events when the client attempts to shut down:</span></span> 
  
1. <span data-ttu-id="c9be9-113">O cliente MAPI inicia o desligamento chamando o método [IMAPIClientShutdown::QueryFastShutdown](imapiclientshutdown-queryfastshutdown.md) para determinar se o subsistema de MAPI suporta desligamento rápido.</span><span class="sxs-lookup"><span data-stu-id="c9be9-113">The MAPI client initiates the shutdown by calling the [IMAPIClientShutdown::QueryFastShutdown](imapiclientshutdown-queryfastshutdown.md) method to determine whether the MAPI subsystem supports fast shutdown.</span></span> 
    
2. <span data-ttu-id="c9be9-114">O subsistema de MAPI responde com o suporte de desligamento rápido disponível a chamada de **IMAPIClientShutdown::QueryFastShutdown** do cliente usando o procedimento a seguir:</span><span class="sxs-lookup"><span data-stu-id="c9be9-114">The MAPI subsystem responds with the available fast shutdown support to the client's **IMAPIClientShutdown::QueryFastShutdown** call by using the following procedure:</span></span> 
    
    1. <span data-ttu-id="c9be9-115">O subsistema de MAPI chama o método de [IMAPIProviderShutdown::QueryFastShutdown](imapiprovidershutdown-queryfastshutdown.md) para cada provedor MAPI com o qual o processo de cliente MAPI tem uma sessão MAPI ativa, se o provedor tiver implementado o [IMAPIProviderShutdown: IUnknown](imapiprovidershutdowniunknown.md) interface.</span><span class="sxs-lookup"><span data-stu-id="c9be9-115">The MAPI subsystem calls the [IMAPIProviderShutdown::QueryFastShutdown](imapiprovidershutdown-queryfastshutdown.md) method for each MAPI provider with which the MAPI client process has an active MAPI session, if the provider has implemented the [IMAPIProviderShutdown : IUnknown](imapiprovidershutdowniunknown.md) interface.</span></span> 
        
       > [!NOTE]
       >  <span data-ttu-id="c9be9-116">O subsistema de MAPI sempre consultas e notifica provedores MAPI por meio do **IMAPIProviderShutdown: IUnknown** interface dentro de cada sessão MAPI na seguinte ordem:</span><span class="sxs-lookup"><span data-stu-id="c9be9-116">The MAPI subsystem always queries and notifies MAPI providers through the **IMAPIProviderShutdown : IUnknown** interface within each MAPI session in the following order:</span></span>
       > 1. <span data-ttu-id="c9be9-117">Provedores de transporte</span><span class="sxs-lookup"><span data-stu-id="c9be9-117">Transport providers</span></span>
       > 2. <span data-ttu-id="c9be9-118">Provedores de catálogo de endereços</span><span class="sxs-lookup"><span data-stu-id="c9be9-118">Address book providers</span></span>
       > 3. <span data-ttu-id="c9be9-119">Provedores de armazenamento</span><span class="sxs-lookup"><span data-stu-id="c9be9-119">Store providers</span></span> 
    
    2. <span data-ttu-id="c9be9-120">Dependendo da configuração do registro de desligamento rápido para o usuário no computador cliente, o subsistema de MAPI Especifica que o código de retorno apropriado para **IMAPIClientShutdown::QueryFastShutdown**.</span><span class="sxs-lookup"><span data-stu-id="c9be9-120">Depending on the fast shutdown registry setting for that user on the client computer, the MAPI subsystem specifies the appropriate return code to **IMAPIClientShutdown::QueryFastShutdown**.</span></span> <span data-ttu-id="c9be9-121">O código de retorno é S_OK ou MAPI_E_NO_SUPPORT.</span><span class="sxs-lookup"><span data-stu-id="c9be9-121">The return code is either S_OK or MAPI_E_NO_SUPPORT.</span></span>
        
    3. <span data-ttu-id="c9be9-122">O cliente MAPI chama o método de [IMAPIClientShutdown::NotifyProcessShutdown](imapiclientshutdown-notifyprocessshutdown.md) para indicar ao subsistema de MAPI a intenção para serem desligados.</span><span class="sxs-lookup"><span data-stu-id="c9be9-122">The MAPI client calls the [IMAPIClientShutdown::NotifyProcessShutdown](imapiclientshutdown-notifyprocessshutdown.md) method to indicate to the MAPI subsystem the intention to shut down.</span></span> 
        
    4. <span data-ttu-id="c9be9-123">O subsistema de MAPI indica cada provedor MAPI carregado que desligará o cliente MAPI.</span><span class="sxs-lookup"><span data-stu-id="c9be9-123">The MAPI subsystem indicates to each loaded MAPI provider that the MAPI client will shut down.</span></span> <span data-ttu-id="c9be9-124">Para os provedores que tenham implementado o **IMAPIProviderShutdown: IUnknown** interface, o subsistema de MAPI chama o método [IMAPIProviderShutdown::NotifyProcessShutdown](imapiprovidershutdown-notifyprocessshutdown.md) correspondente.</span><span class="sxs-lookup"><span data-stu-id="c9be9-124">For those providers that have implemented the **IMAPIProviderShutdown : IUnknown** interface, the MAPI subsystem calls the corresponding [IMAPIProviderShutdown::NotifyProcessShutdown](imapiprovidershutdown-notifyprocessshutdown.md) method.</span></span> 
        
    5. <span data-ttu-id="c9be9-125">O cliente MAPI chama o método de [IMAPIClientShutdown::DoFastShutdown](imapiclientshutdown-dofastshutdown.md) para indicar ao subsistema de MAPI que o processo de cliente está deixando imediatamente.</span><span class="sxs-lookup"><span data-stu-id="c9be9-125">The MAPI client calls the [IMAPIClientShutdown::DoFastShutdown](imapiclientshutdown-dofastshutdown.md) method to indicate to the MAPI subsystem that the client process is exiting immediately.</span></span> 
        
    6. <span data-ttu-id="c9be9-126">O subsistema de MAPI indica cada provedor MAPI carregado saindo do processo do cliente MAPI.</span><span class="sxs-lookup"><span data-stu-id="c9be9-126">The MAPI subsystem indicates to each loaded MAPI provider that the MAPI client process is exiting.</span></span> <span data-ttu-id="c9be9-127">Para os provedores que tenham implementado o **IMAPIProviderShutdown: IUnknown** interface, o subsistema de MAPI chama o método [IMAPIProviderShutdown::DoFastShutdown](imapiprovidershutdown-dofastshutdown.md) correspondente.</span><span class="sxs-lookup"><span data-stu-id="c9be9-127">For those providers that have implemented the **IMAPIProviderShutdown : IUnknown** interface, the MAPI subsystem calls the corresponding [IMAPIProviderShutdown::DoFastShutdown](imapiprovidershutdown-dofastshutdown.md) method.</span></span> <span data-ttu-id="c9be9-128">Neste ponto, esses provedores MAPI devem verificar se todas as ações necessárias, como a salvando dados e configurações, forem concluídas em preparação para o cliente MAPI imediatamente desconectar todas as referências e sair.</span><span class="sxs-lookup"><span data-stu-id="c9be9-128">At this point, these MAPI providers should verify that all necessary actions, such as saving data and settings, are complete in preparation for the MAPI client to immediately disconnect all references and exit.</span></span> 
    
## <a name="see-also"></a><span data-ttu-id="c9be9-129">Confira também</span><span class="sxs-lookup"><span data-stu-id="c9be9-129">See also</span></span>

- [<span data-ttu-id="c9be9-130">Desligamento do cliente em MAPI</span><span class="sxs-lookup"><span data-stu-id="c9be9-130">Client Shutdown in MAPI</span></span>](client-shutdown-in-mapi.md)
- [<span data-ttu-id="c9be9-131">Opções de usuário do desligamento rápido</span><span class="sxs-lookup"><span data-stu-id="c9be9-131">Fast Shutdown User Options</span></span>](fast-shutdown-user-options.md)
- [<span data-ttu-id="c9be9-132">Práticas recomendadas para o desligamento rápido</span><span class="sxs-lookup"><span data-stu-id="c9be9-132">Best Practices for Fast Shutdown</span></span>](best-practices-for-fast-shutdown.md)

