---
title: Implementar a resolução de nomes
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a4c71b08-c47a-4421-8603-d5356d32dca9
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: 15c1d502947865c02973f4950b6b6fa8109b8e78
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32310077"
---
# <a name="implementing-name-resolution"></a><span data-ttu-id="c4c74-103">Implementar a resolução de nomes</span><span class="sxs-lookup"><span data-stu-id="c4c74-103">Implementing Name Resolution</span></span>

  
  
<span data-ttu-id="c4c74-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="c4c74-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="c4c74-105">Os provedores de catálogos de endereços são responsáveis por suportar a resolução de nomes: o processo de associação de um identificador de entrada com um nome de exibição.</span><span class="sxs-lookup"><span data-stu-id="c4c74-105">Address book providers are responsible for supporting name resolution — the process of associating an entry identifier with a display name.</span></span> <span data-ttu-id="c4c74-106">Os clientes iniciam a resolução de nome quando chamam [IAddrBook:: ResolveName](iaddrbook-resolvename.md) para garantir que cada membro de uma lista de destinatários da mensagem de saída corresponde a um endereço válido.</span><span class="sxs-lookup"><span data-stu-id="c4c74-106">Clients initiate name resolution when they call [IAddrBook::ResolveName](iaddrbook-resolvename.md) to ensure that each member of an outgoing message's recipient list corresponds to a valid address.</span></span> 
  
<span data-ttu-id="c4c74-107">O provedor pode dar suporte à resolução de nomes:</span><span class="sxs-lookup"><span data-stu-id="c4c74-107">Your provider can support name resolution by:</span></span>
  
- <span data-ttu-id="c4c74-108">Suporte à restrição de propriedade **PR_ANR** ([PidTagAnr](pidtaganr-canonical-property.md)), um requisito para todos os contêineres do catálogo de endereços.</span><span class="sxs-lookup"><span data-stu-id="c4c74-108">Supporting the **PR_ANR** ([PidTagAnr](pidtaganr-canonical-property.md)) property restriction, a requirement for all address book containers.</span></span>
    
- <span data-ttu-id="c4c74-109">Implementar o método [IABContainer:: ResolveNames](iabcontainer-resolvenames.md) , uma opção para todos os contêineres do catálogo de endereços.</span><span class="sxs-lookup"><span data-stu-id="c4c74-109">Implementing the [IABContainer::ResolveNames](iabcontainer-resolvenames.md) method, an option for all address book containers.</span></span> 
    
<span data-ttu-id="c4c74-110">Se você optar por oferecer suporte a **IABContainer:: ResolveNames**, tentar localizar uma correspondência exata para cada nome de exibição não resolvido na estrutura [das ADRLIST](adrlist.md) passada com o parâmetro _lpAdrList_ .</span><span class="sxs-lookup"><span data-stu-id="c4c74-110">If you choose to support **IABContainer::ResolveNames**, attempt to locate an exact match for each unresolved display name in the [ADRLIST](adrlist.md) structure passed in with the  _lpAdrList_ parameter.</span></span> <span data-ttu-id="c4c74-111">Você pode identificá-lo como um nome de exibição não resolvido porque falta a propriedade **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) na matriz de valor da propriedade em seu membro **aEntries** da estrutura **das ADRLIST** .</span><span class="sxs-lookup"><span data-stu-id="c4c74-111">You can identifiy an unresolved display name because it is missing the **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) property in the property value array in its **aEntries** member of the **ADRLIST** structure.</span></span> <span data-ttu-id="c4c74-112">Ignorar qualquer entrada que tenha zero propriedades associadas.</span><span class="sxs-lookup"><span data-stu-id="c4c74-112">Ignore any entries that have zero properties associated with them.</span></span> 
  
<span data-ttu-id="c4c74-113">Informe o resultado da tentativa de resolução no parâmetro _lpFlagList_ , uma matriz de sinalizadores que corresponde à matriz de nomes para exibição no _lpAdrList_.</span><span class="sxs-lookup"><span data-stu-id="c4c74-113">Report the result of your attempt at resolution in the  _lpFlagList_ parameter, an array of flags that corresponds to the array of display names in  _lpAdrList_.</span></span> <span data-ttu-id="c4c74-114">Os sinalizadores são posicionais de forma que o primeiro sinalizador corresponda ao primeiro membro **aEntries** na estrutura **das ADRLIST** , o segundo sinalizador corresponde ao segundo membro do **aEntries** e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="c4c74-114">The flags are positional such that the first flag corresponds to the first **aEntries** member in the **ADRLIST** structure, the second flag corresponds to the second **aEntries** member, and so on.</span></span> 
  
<span data-ttu-id="c4c74-115">Há três resultados possíveis para cada entrada não resolvida:</span><span class="sxs-lookup"><span data-stu-id="c4c74-115">There are three possible results for each unresolved entry:</span></span>
  
- <span data-ttu-id="c4c74-116">Nenhuma correspondência foi encontrada, o que significa que nenhuma das entradas em suas entradas de contêiner corresponde à entrada na estrutura **das ADRLIST** .</span><span class="sxs-lookup"><span data-stu-id="c4c74-116">No match was found, meaning that none of the entries in your container entries match the entry in the **ADRLIST** structure.</span></span> <span data-ttu-id="c4c74-117">Defina a entrada correspondente no parâmetro _lpFlagList_ como MAPI_UNRESOLVED.</span><span class="sxs-lookup"><span data-stu-id="c4c74-117">Set the corresponding entry in the  _lpFlagList_ parameter to MAPI_UNRESOLVED.</span></span> 
    
- <span data-ttu-id="c4c74-118">Várias correspondências podem ser encontradas, o que significa que há várias entradas de contêiner que correspondem à entrada na estrutura **das ADRLIST** .</span><span class="sxs-lookup"><span data-stu-id="c4c74-118">Several matches can be found, meaning that there are multiple container entries that match the entry in the **ADRLIST** structure.</span></span> <span data-ttu-id="c4c74-119">Defina a entrada correspondente no parâmetro _lpFlagList_ como MAPI_AMBIGUOUS.</span><span class="sxs-lookup"><span data-stu-id="c4c74-119">Set the corresponding entry in the  _lpFlagList_ parameter to MAPI_AMBIGUOUS.</span></span> <span data-ttu-id="c4c74-120">Não altere o número de entradas na estrutura **das ADRLIST** .</span><span class="sxs-lookup"><span data-stu-id="c4c74-120">Do not change the number of entries in the **ADRLIST** structure.</span></span> 
    
- <span data-ttu-id="c4c74-121">Uma correspondência exata pode ser encontrada, o que significa que há apenas uma entrada de contêiner que corresponde à entrada na estrutura **das ADRLIST** .</span><span class="sxs-lookup"><span data-stu-id="c4c74-121">An exact match can be found, meaning that there is only one container entry that matches the entry in the **ADRLIST** structure.</span></span> <span data-ttu-id="c4c74-122">Defina o membro correspondente no parâmetro _lpFlagList_ como MAPI_RESOLVED e adicione o identificador de entrada à matriz de propriedades associadas à entrada **das ADRLIST** .</span><span class="sxs-lookup"><span data-stu-id="c4c74-122">Set the corresponding member in the  _lpFlagList_ parameter to MAPI_RESOLVED and add the entry identifier to the array of properties associated with the **ADRLIST** entry.</span></span> 
    
<span data-ttu-id="c4c74-123">Se você optar por não oferecer suporte a **IABContainer:: ResolveNames**, retornar MAPI_E_NO_SUPPORT da sua implementação.</span><span class="sxs-lookup"><span data-stu-id="c4c74-123">If you choose not to support **IABContainer::ResolveNames**, return MAPI_E_NO_SUPPORT from your implementation.</span></span>
  
<span data-ttu-id="c4c74-124">Todos os provedores de catálogo de endereços são necessários para dar suporte à resolução de nomes ambíguos, a restrição de propriedade **PR_ANR** , em suas tabelas de conteúdo de contêineres.</span><span class="sxs-lookup"><span data-stu-id="c4c74-124">All address book providers are required to support ambiguous name resolution — the **PR_ANR** property restriction — on their containers' contents tables.</span></span> <span data-ttu-id="c4c74-125">Para fornecer esse suporte, manipule a restrição PR_ANR em sua implementação de [IMAPITable:: Restrict](imapitable-restrict.md) executando um tipo de pesquisa "melhor palpite", correspondendo a uma ou mais propriedades específicas que fazem sentido para seu provedor.</span><span class="sxs-lookup"><span data-stu-id="c4c74-125">To provide this support, handle the PR_ANR restriction in your implementation of [IMAPITable::Restrict](imapitable-restrict.md) by performing a "best guess" type of search, matching against one or more particular properties that make sense for your provider.</span></span> <span data-ttu-id="c4c74-126">Você pode optar por usar a mesma propriedade ou propriedades a cada vez, como **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) ou **PR_ACCOUNT** ([PidTagAccount](pidtagaccount-canonical-property.md)) ou permitir que um administrador escolha em uma lista de propriedades aceitáveis.</span><span class="sxs-lookup"><span data-stu-id="c4c74-126">You can choose to use the same property or properties every time, such as **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) or **PR_ACCOUNT** ([PidTagAccount](pidtagaccount-canonical-property.md)), or allow an administrator to choose from a list of acceptable properties.</span></span> 
  
<span data-ttu-id="c4c74-127">Embora a maioria dos provedores forneça sua própria implementação de tabela de conteúdo, você pode personalizar a implementação fornecida [](createtable.md) pelo MAPI através da função CreateTable.</span><span class="sxs-lookup"><span data-stu-id="c4c74-127">Although most providers supply their own contents table implementation, you can customize the implementation supplied by MAPI through the [CreateTable](createtable.md) function.</span></span> <span data-ttu-id="c4c74-128">No enTanto, como a implementação MAPI não dá suporte a restrições de qualquer tipo, você deve criar um objeto wrapper para incluir uma \*\*\*\* versão personalizada do restrict que intercepta a chamada.</span><span class="sxs-lookup"><span data-stu-id="c4c74-128">However, because the MAPI implementation does not support restrictions of any kind, you must create a wrapper object to include a customized version of **Restrict** that intercepts the call.</span></span> 
  

