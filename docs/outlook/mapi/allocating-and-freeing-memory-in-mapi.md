---
title: Alocando e liberando memória no MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e238f6bc-e9f6-4ea4-a2e4-ff5da2a04bd5
description: 'Última modificação: 9 de março de 2015'
ms.openlocfilehash: 68250c5cbeaa366ed4555bb469c4e68d62302f28
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32281582"
---
# <a name="allocating-and-freeing-memory-in-mapi"></a><span data-ttu-id="dc2a9-103">Alocando e liberando memória no MAPI</span><span class="sxs-lookup"><span data-stu-id="dc2a9-103">Allocating and Freeing Memory in MAPI</span></span>

  
  
<span data-ttu-id="dc2a9-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="dc2a9-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="dc2a9-105">Além de especificar como alocar e liberar memória, o MAPI define um modelo para saber quando a memória passada entre o método de interface pública e as chamadas de função da API deve ser liberada.</span><span class="sxs-lookup"><span data-stu-id="dc2a9-105">In addition to specifying how to allocate and free memory, MAPI defines a model for knowing when memory passed between public interface method and API function calls should be freed.</span></span> <span data-ttu-id="dc2a9-106">O modelo se aplica somente a memória alocada para parâmetros que não são ponteiros para interfaces, como cadeias de caracteres e ponteiros para estruturas.</span><span class="sxs-lookup"><span data-stu-id="dc2a9-106">The model applies only to memory allocated for parameters that are not pointers to interfaces, such as strings and pointers to structures.</span></span> <span data-ttu-id="dc2a9-107">Ponteiros de interface usam o mecanismo de contagem de referência implementado por **IUnknown**.</span><span class="sxs-lookup"><span data-stu-id="dc2a9-107">Interface pointers use the reference counting mechanism implemented through **IUnknown**.</span></span> <span data-ttu-id="dc2a9-108">Ao alocar e liberar uma memória relacionada não MAPI internamente dentro de um aplicativo cliente ou provedor de serviços, use qualquer mecanismo que faça sentido.</span><span class="sxs-lookup"><span data-stu-id="dc2a9-108">When allocating and freeing non-MAPI related memory internally within a client application or service provider, use whatever mechanism makes sense.</span></span> 
  
<span data-ttu-id="dc2a9-109">O modelo define parâmetros como um dos três tipos.</span><span class="sxs-lookup"><span data-stu-id="dc2a9-109">The model defines parameters as one of three types.</span></span> <span data-ttu-id="dc2a9-110">Eles podem ser parâmetros de entrada, definidos pelo chamador com as informações a serem usadas pelo método ou função chamado, parâmetros de saída, definidos pelo método ou função chamado e retornados para o chamador ou parâmetros de saída de entrada, uma combinação dos dois tipos.</span><span class="sxs-lookup"><span data-stu-id="dc2a9-110">They can be input parameters, set by the caller with information to be used by the called function or method, output parameters, set by the called function or method and returned to the caller, or input-output parameters, a combination of the two types.</span></span> <span data-ttu-id="dc2a9-111">Os parâmetros de saída são apontados freqüentemente para dados ou ponteiros para ponteiros de dados.</span><span class="sxs-lookup"><span data-stu-id="dc2a9-111">Output parameters are frequently pointers to data or pointers to pointers to data.</span></span> <span data-ttu-id="dc2a9-112">Embora a função chamada seja responsável por alocar os dados para parâmetros de saída, o chamador aloca a memória para o ponteiro.</span><span class="sxs-lookup"><span data-stu-id="dc2a9-112">Although the called function is responsible for allocating the data for output parameters, the caller allocates the memory for the pointer.</span></span> 
  
<span data-ttu-id="dc2a9-113">As regras para alocar e liberar memória para esses tipos de parâmetros são explicadas na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="dc2a9-113">The rules for allocating and releasing memory for these types of parameters are explained in the following table.</span></span>
  
|<span data-ttu-id="dc2a9-114">**Tipo**</span><span class="sxs-lookup"><span data-stu-id="dc2a9-114">**Type**</span></span>|<span data-ttu-id="dc2a9-115">**Alocação de memória**</span><span class="sxs-lookup"><span data-stu-id="dc2a9-115">**Memory allocation**</span></span>|<span data-ttu-id="dc2a9-116">**Versão de memória**</span><span class="sxs-lookup"><span data-stu-id="dc2a9-116">**Memory release**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="dc2a9-117">Input</span><span class="sxs-lookup"><span data-stu-id="dc2a9-117">Input</span></span>  <br/> |<span data-ttu-id="dc2a9-118">O chamador é responsável e pode usar qualquer mecanismo.</span><span class="sxs-lookup"><span data-stu-id="dc2a9-118">Caller is responsible and can use any mechanism.</span></span>  <br/> |<span data-ttu-id="dc2a9-119">O chamador é responsável e pode usar qualquer mecanismo.</span><span class="sxs-lookup"><span data-stu-id="dc2a9-119">Caller is responsible and can use any mechanism.</span></span>  <br/> |
|<span data-ttu-id="dc2a9-120">Saída</span><span class="sxs-lookup"><span data-stu-id="dc2a9-120">Output</span></span>  <br/> |<span data-ttu-id="dc2a9-121">Chamada função é responsável e deve usar **MAPIAllocateBuffer**.</span><span class="sxs-lookup"><span data-stu-id="dc2a9-121">Called function is responsible and must use **MAPIAllocateBuffer**.</span></span> <span data-ttu-id="dc2a9-122">Para obter mais informações, consulte [MAPIAllocateBuffer](mapiallocatebuffer.md).</span><span class="sxs-lookup"><span data-stu-id="dc2a9-122">For more information, see [MAPIAllocateBuffer](mapiallocatebuffer.md).</span></span>  <br/> |<span data-ttu-id="dc2a9-123">O chamador é responsável e deve usar **MAPIFreeBuffer**.</span><span class="sxs-lookup"><span data-stu-id="dc2a9-123">Caller is responsible and must use **MAPIFreeBuffer**.</span></span> <span data-ttu-id="dc2a9-124">Para obter mais informações, consulte [MAPIFreeBuffer](mapifreebuffer.md).</span><span class="sxs-lookup"><span data-stu-id="dc2a9-124">For more information, see [MAPIFreeBuffer](mapifreebuffer.md).</span></span>  <br/> |
|<span data-ttu-id="dc2a9-125">Entrada-saída</span><span class="sxs-lookup"><span data-stu-id="dc2a9-125">Input-output</span></span>  <br/> |<span data-ttu-id="dc2a9-126">O chamador é responsável pela alocação inicial e a função chamada pode realocar, se necessário, usando o **MAPIAllocateBuffer**.</span><span class="sxs-lookup"><span data-stu-id="dc2a9-126">Caller is responsible for the initial allocation and called function can reallocate if necessary using **MAPIAllocateBuffer**.</span></span>  <br/> |<span data-ttu-id="dc2a9-127">A função chamada é responsável pela liberação inicial se a realocação for necessária.</span><span class="sxs-lookup"><span data-stu-id="dc2a9-127">Called function is responsible for initial freeing if reallocation is necessary.</span></span> <span data-ttu-id="dc2a9-128">O chamador deve liberar o valor de retorno final.</span><span class="sxs-lookup"><span data-stu-id="dc2a9-128">Caller must free the final return value.</span></span>  <br/> |
   
<span data-ttu-id="dc2a9-129">Durante as condições de falha, os implementadores de métodos de interface precisam prestar atenção à saída e aos parâmetros de saída de entrada, pois o chamador geralmente não tem como limpá-los.</span><span class="sxs-lookup"><span data-stu-id="dc2a9-129">During failure conditions, implementers of interface methods need to pay attention to output and input-output parameters because the caller generally has no way to clean them up.</span></span> <span data-ttu-id="dc2a9-130">Se um erro for retornado, cada parâmetro de saída ou de entrada deverá ser deixado no valor inicializado pelo chamador ou definido como um valor que pode ser limpo sem qualquer ação na parte do chamador.</span><span class="sxs-lookup"><span data-stu-id="dc2a9-130">If an error is returned, then each output or input-output parameter must either be left at the value initialized by the caller or set to a value that can be cleaned up without any action on the part of the caller.</span></span> <span data-ttu-id="dc2a9-131">Por exemplo, um parâmetro Pointer de `void ** ppv` saída deve ser deixado como estava na entrada ou pode ser definido como NULL ( `*ppv = NULL`).</span><span class="sxs-lookup"><span data-stu-id="dc2a9-131">For example, an output pointer-parameter of  `void ** ppv` must be left as it was on input or can be set to NULL (  `*ppv = NULL`).</span></span>
  

