---
title: Suporte a anexos de renderização de texto formatado
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 68abe85b-5dc0-40d0-8917-30ea002aa816
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: 5f03530f994fd13e7dc4c7eaa4124900c28e613b
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32350698"
---
# <a name="supporting-formatted-text-rendering-attachments"></a><span data-ttu-id="a180d-103">Suporte a texto formatado: anexos de renderização</span><span class="sxs-lookup"><span data-stu-id="a180d-103">Supporting Formatted Text: Rendering Attachments</span></span>

  
  
<span data-ttu-id="a180d-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a180d-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="a180d-105">Um aplicativo cliente que se preocupa com o local em que seus anexos são processados define a propriedade **PR_RENDERING_POSITION** ([PidTagRenderingPosition](pidtagrenderingposition-canonical-property.md)) desses anexos durante a composição da mensagem.</span><span class="sxs-lookup"><span data-stu-id="a180d-105">A client application that cares about where in a message its attachments are rendered sets the **PR_RENDERING_POSITION** ([PidTagRenderingPosition](pidtagrenderingposition-canonical-property.md)) property for these attachments during message composition.</span></span> <span data-ttu-id="a180d-106">Um cliente que não se preocupa com o posicionamento de renderização deixa essa propriedade desdefinida.</span><span class="sxs-lookup"><span data-stu-id="a180d-106">A client that does not care about rendering placement leaves this property unset.</span></span>
  
<span data-ttu-id="a180d-107">Quando um cliente abre uma mensagem com anexos, ele tenta recuperar a propriedade **PR_RENDERING_POSITION** de cada anexo para determinar onde no texto da mensagem o anexo deve ser renderizado.</span><span class="sxs-lookup"><span data-stu-id="a180d-107">When a client opens a message with attachments, it attempts to retrieve each attachment's **PR_RENDERING_POSITION** property to determine where in the message text the attachment should be rendered.</span></span> <span data-ttu-id="a180d-108">Um cliente pode usar um dos seguintes métodos para recuperar o **PR_RENDERING_POSITION**:</span><span class="sxs-lookup"><span data-stu-id="a180d-108">A client can use one of the following methods to retrieve **PR_RENDERING_POSITION**:</span></span>
  
- <span data-ttu-id="a180d-109">[IMAPIProp::](imapiprop-getprops.md) GetProps no anexo aberto para recuperar a propriedade **PR_RENDERING_POSITION** .</span><span class="sxs-lookup"><span data-stu-id="a180d-109">[IMAPIProp::GetProps](imapiprop-getprops.md) on the open attachment to retrieve the **PR_RENDERING_POSITION** property.</span></span> 
    
- <span data-ttu-id="a180d-110">[IMessage::](imessage-getattachmenttable.md) GetAttachmentTable na mensagem aberta para recuperar sua tabela de anexos.</span><span class="sxs-lookup"><span data-stu-id="a180d-110">[IMessage::GetAttachmentTable](imessage-getattachmenttable.md) on the open message to retrieve its attachment table.</span></span> <span data-ttu-id="a180d-111">**PR_RENDERING_POSITION** é uma coluna obrigatória em todas as tabelas de anexo.</span><span class="sxs-lookup"><span data-stu-id="a180d-111">**PR_RENDERING_POSITION** is a required column in all attachment tables.</span></span> <span data-ttu-id="a180d-112">Esse é o método preferencial porque resulta em um melhor desempenho.</span><span class="sxs-lookup"><span data-stu-id="a180d-112">This is the preferred method because it results in better performance.</span></span> 
    
<span data-ttu-id="a180d-113">Os repositórios de mensagens com reconhecimento de RTF podem escolher se desejam retornar um valor exato ou aproximado para **PR_RENDERING_POSITION**.</span><span class="sxs-lookup"><span data-stu-id="a180d-113">RTF-aware message stores can choose whether to return an accurate or approximate value for **PR_RENDERING_POSITION**.</span></span> <span data-ttu-id="a180d-114">Como os repositórios de mensagens recalculam o valor do **PR_RENDERING_POSITION** de um anexo quando é solicitado pela propriedade **PR_BODY** da mensagem, alguns repositórios de mensagens com reconhecimento de RTF só garantem a precisão das posições de renderização quando um cliente solicita primeiro para **PR_BODY**.</span><span class="sxs-lookup"><span data-stu-id="a180d-114">Because message stores recalculate an attachment's **PR_RENDERING_POSITION** value when asked for the message's **PR_BODY** property, some RTF-aware message stores only guarantee the accuracy of rendering positions when a client asks first for **PR_BODY**.</span></span> <span data-ttu-id="a180d-115">Os repositórios de mensagens com reconhecimento de RTF têm permissão para fornecer aos clientes valores de posição de renderização aproximados para melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="a180d-115">RTF-aware message stores are allowed to provide clients with approximate rendering position values to enhance performance.</span></span> <span data-ttu-id="a180d-116">Fornecer uma posição de renderização aproximada e exata poupa tempo e é suficiente para a maioria das situações.</span><span class="sxs-lookup"><span data-stu-id="a180d-116">Providing an approximate rather than an accurate rendering position saves time and is sufficient for most situations.</span></span> 
  
<span data-ttu-id="a180d-117">Os repositórios de mensagens com reconhecimento de RTF devem basear sua aproximação no valor especificado pelo cliente responsável pela criação do anexo.</span><span class="sxs-lookup"><span data-stu-id="a180d-117">RTF-aware message stores should base their approximation on the value specified by the client responsible for creating the attachment.</span></span> <span data-ttu-id="a180d-118">Embora todos os clientes devam definir o **PR_RENDERING_POSITION**, os provedores de repositórios de mensagens devem estar preparados para lidar com a possibilidade de sua ausência.</span><span class="sxs-lookup"><span data-stu-id="a180d-118">Although all clients should set **PR_RENDERING_POSITION**, message store providers should be prepared to deal with the possibility of its absence.</span></span> <span data-ttu-id="a180d-119">Quando o cliente não define **PR_RENDERING_POSITION**, um repositório de mensagens pode defini-lo como-1 para indicar que a posição de renderização não está dentro do texto da mensagem.</span><span class="sxs-lookup"><span data-stu-id="a180d-119">When the client does not set **PR_RENDERING_POSITION**, a message store can set it to -1 to indicate that the rendering position is not within the message text.</span></span> <span data-ttu-id="a180d-120">Anexos com uma posição de renderização de-1 podem ser exibidos em qualquer lugar dentro da mensagem, dependendo do cliente.</span><span class="sxs-lookup"><span data-stu-id="a180d-120">Attachments with a rendering position of -1 can be displayed at any place within the message depending on the client.</span></span> <span data-ttu-id="a180d-121">Muitos clientes posicionam esses tipos de anexos na parte superior da mensagem.</span><span class="sxs-lookup"><span data-stu-id="a180d-121">Many clients position these types of attachments at the top of the message.</span></span>
  
<span data-ttu-id="a180d-122">O grau de precisão para uma propriedade **PR_RENDERING_POSITION** depende se um repositório de mensagens salvará ou não as propriedades de uma mensagem de **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) e **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) ou somente **PR_RTF_COMPRESSED**.</span><span class="sxs-lookup"><span data-stu-id="a180d-122">The degree of accuracy for a **PR_RENDERING_POSITION** property depends on whether or not a message store saves both a message's **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) and **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) properties or only **PR_RTF_COMPRESSED**.</span></span> <span data-ttu-id="a180d-123">Se o cliente gerar **PR_BODY** e o repositório de mensagens salvá-lo junto com o texto formatado, as posições de renderização serão precisas.</span><span class="sxs-lookup"><span data-stu-id="a180d-123">If the client generates **PR_BODY** and the message store saves it along with the formatted text, the rendering positions will be accurate.</span></span> <span data-ttu-id="a180d-124">No enTanto, se o repositório de mensagens deve gerar sua própria versão do **PR_BODY** porque ele só salva **PR_RTF_COMPRESSED**, é provável que as posições de renderização sejam um pouco imprecisas.</span><span class="sxs-lookup"><span data-stu-id="a180d-124">However, if the message store must generate its own version of **PR_BODY** because it only saves **PR_RTF_COMPRESSED**, it is probable that the rendering positions will be somewhat inaccurate.</span></span> <span data-ttu-id="a180d-125">Isso ocorre devido às diferenças no modo como os clientes e os provedores de repositórios de mensagens geram a propriedade **PR_BODY** .</span><span class="sxs-lookup"><span data-stu-id="a180d-125">This is because of the differences in the way that clients and message store providers generate the **PR_BODY** property.</span></span> 
  
<span data-ttu-id="a180d-126">Para calcular um valor **PR_RENDERING_POSITION** preciso, um repositório com reconhecimento de RTF usa uma marca incorporada no texto formatado.</span><span class="sxs-lookup"><span data-stu-id="a180d-126">To calculate an accurate **PR_RENDERING_POSITION** value, an RTF-aware store uses a tag embedded in the formatted text.</span></span> <span data-ttu-id="a180d-127">A função de utilitário **RTFSync** pode ser chamada para executar esse cálculo e atualizar a posição de renderização de um anexo.</span><span class="sxs-lookup"><span data-stu-id="a180d-127">The utility function **RTFSync** can be called to perform this calculation and update an attachment's rendering position.</span></span> <span data-ttu-id="a180d-128">Dependendo da quantidade de informações de estado disponíveis, o repositório de mensagens pode passar RTF_SYNC_BODY_CHANGED, RTF_SYNC_RTF_CHANGED ou ambos os valores para [RTFSync](rtfsync.md).</span><span class="sxs-lookup"><span data-stu-id="a180d-128">Depending on the amount of state information available, the message store can pass either RTF_SYNC_BODY_CHANGED, RTF_SYNC_RTF_CHANGED, or both values to [RTFSync](rtfsync.md).</span></span>
  

