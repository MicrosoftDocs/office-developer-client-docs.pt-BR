---
title: Texto formatado anexos de renderização de suporte
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 68abe85b-5dc0-40d0-8917-30ea002aa816
description: '�ltima altera��o: s�bado, 23 de julho de 2011'
ms.openlocfilehash: 1b6339d768ac476c24ce988ba761270a50d47464
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22580310"
---
# <a name="supporting-formatted-text-rendering-attachments"></a><span data-ttu-id="8814b-103">Suporte a texto formatado: anexos de renderização</span><span class="sxs-lookup"><span data-stu-id="8814b-103">Supporting Formatted Text: Rendering Attachments</span></span>

  
  
<span data-ttu-id="8814b-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="8814b-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="8814b-105">Um aplicativo cliente que se importa onde em uma mensagem em seus respectivos anexos são renderizados define a propriedade de **PR_RENDERING_POSITION** ([PidTagRenderingPosition](pidtagrenderingposition-canonical-property.md)) para esses anexos durante composição de mensagem.</span><span class="sxs-lookup"><span data-stu-id="8814b-105">A client application that cares about where in a message its attachments are rendered sets the **PR_RENDERING_POSITION** ([PidTagRenderingPosition](pidtagrenderingposition-canonical-property.md)) property for these attachments during message composition.</span></span> <span data-ttu-id="8814b-106">Um cliente que não está preocupado posicionamento de renderização deixa essa propriedade não definidas.</span><span class="sxs-lookup"><span data-stu-id="8814b-106">A client that does not care about rendering placement leaves this property unset.</span></span>
  
<span data-ttu-id="8814b-107">Quando um cliente abre uma mensagem com anexos, ele tenta recuperar a propriedade **PR_RENDERING_POSITION** de cada anexo para determinar onde no texto da mensagem o anexo deve ser renderizado.</span><span class="sxs-lookup"><span data-stu-id="8814b-107">When a client opens a message with attachments, it attempts to retrieve each attachment's **PR_RENDERING_POSITION** property to determine where in the message text the attachment should be rendered.</span></span> <span data-ttu-id="8814b-108">Um cliente pode usar um dos métodos a seguir para recuperar **PR_RENDERING_POSITION**:</span><span class="sxs-lookup"><span data-stu-id="8814b-108">A client can use one of the following methods to retrieve **PR_RENDERING_POSITION**:</span></span>
  
- <span data-ttu-id="8814b-109">[IMAPIProp::GetProps](imapiprop-getprops.md) no anexo abrir para recuperar a propriedade **PR_RENDERING_POSITION** .</span><span class="sxs-lookup"><span data-stu-id="8814b-109">[IMAPIProp::GetProps](imapiprop-getprops.md) on the open attachment to retrieve the **PR_RENDERING_POSITION** property.</span></span> 
    
- <span data-ttu-id="8814b-110">[IMessage::GetAttachmentTable](imessage-getattachmenttable.md) na mensagem de abrir para recuperar sua tabela de anexo.</span><span class="sxs-lookup"><span data-stu-id="8814b-110">[IMessage::GetAttachmentTable](imessage-getattachmenttable.md) on the open message to retrieve its attachment table.</span></span> <span data-ttu-id="8814b-111">**PR_RENDERING_POSITION** é uma coluna necessária em todas as tabelas de anexo.</span><span class="sxs-lookup"><span data-stu-id="8814b-111">**PR_RENDERING_POSITION** is a required column in all attachment tables.</span></span> <span data-ttu-id="8814b-112">Este é o método preferencial porque ele implica em um melhor desempenho.</span><span class="sxs-lookup"><span data-stu-id="8814b-112">This is the preferred method because it results in better performance.</span></span> 
    
<span data-ttu-id="8814b-113">Repositórios de mensagem RTF reconhecimento podem escolher se deve retornar um valor preciso ou aproximado para **PR_RENDERING_POSITION**.</span><span class="sxs-lookup"><span data-stu-id="8814b-113">RTF-aware message stores can choose whether to return an accurate or approximate value for **PR_RENDERING_POSITION**.</span></span> <span data-ttu-id="8814b-114">Porque a mensagem repositórios recalcular o valor de **PR_RENDERING_POSITION** um anexo quando for solicitado para a propriedade **PR_BODY** da mensagem, alguns mensagem RTF reconhecimento armazena garantia apenas a precisão dos posições de renderização quando um cliente solicita primeiro **PR_BODY**.</span><span class="sxs-lookup"><span data-stu-id="8814b-114">Because message stores recalculate an attachment's **PR_RENDERING_POSITION** value when asked for the message's **PR_BODY** property, some RTF-aware message stores only guarantee the accuracy of rendering positions when a client asks first for **PR_BODY**.</span></span> <span data-ttu-id="8814b-115">Repositórios de mensagem RTF reconhecimento têm permissão para fornecer a clientes com valores de posição de renderização aproximado para aprimorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="8814b-115">RTF-aware message stores are allowed to provide clients with approximate rendering position values to enhance performance.</span></span> <span data-ttu-id="8814b-116">Fornecer uma aproximado em vez de uma posição de renderização precisas economiza tempo e é suficiente para a maioria das situações.</span><span class="sxs-lookup"><span data-stu-id="8814b-116">Providing an approximate rather than an accurate rendering position saves time and is sufficient for most situations.</span></span> 
  
<span data-ttu-id="8814b-117">Repositórios de mensagem RTF reconhecimento devem basear seu aproximação no valor especificado pelo cliente responsável por criar o anexo.</span><span class="sxs-lookup"><span data-stu-id="8814b-117">RTF-aware message stores should base their approximation on the value specified by the client responsible for creating the attachment.</span></span> <span data-ttu-id="8814b-118">Embora todos os clientes devem definir **PR_RENDERING_POSITION**, provedores de armazenamento de mensagem devem estar preparados para lidar com a possibilidade de sua ausência.</span><span class="sxs-lookup"><span data-stu-id="8814b-118">Although all clients should set **PR_RENDERING_POSITION**, message store providers should be prepared to deal with the possibility of its absence.</span></span> <span data-ttu-id="8814b-119">Quando o cliente não definida **PR_RENDERING_POSITION**, um armazenamento de mensagens poderá defini-la como -1 para indicar que a posição de renderização não está dentro do texto da mensagem.</span><span class="sxs-lookup"><span data-stu-id="8814b-119">When the client does not set **PR_RENDERING_POSITION**, a message store can set it to -1 to indicate that the rendering position is not within the message text.</span></span> <span data-ttu-id="8814b-120">Anexos com uma posição de renderização de -1 podem ser exibidos em qualquer lugar dentro da mensagem, dependendo do cliente.</span><span class="sxs-lookup"><span data-stu-id="8814b-120">Attachments with a rendering position of -1 can be displayed at any place within the message depending on the client.</span></span> <span data-ttu-id="8814b-121">Muitos clientes posicionar esses tipos de anexos na parte superior da mensagem.</span><span class="sxs-lookup"><span data-stu-id="8814b-121">Many clients position these types of attachments at the top of the message.</span></span>
  
<span data-ttu-id="8814b-122">O grau de precisão para uma propriedade **PR_RENDERING_POSITION** depende se ou não um armazenamento de mensagens salva **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) uma mensagem e as propriedades de **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) ou somente **PR_RTF_COMPRESSED**.</span><span class="sxs-lookup"><span data-stu-id="8814b-122">The degree of accuracy for a **PR_RENDERING_POSITION** property depends on whether or not a message store saves both a message's **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) and **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) properties or only **PR_RTF_COMPRESSED**.</span></span> <span data-ttu-id="8814b-123">Se o cliente gera **PR_BODY** e o armazenamento de mensagens salva juntamente com o texto formatado, as posições de renderização será precisas.</span><span class="sxs-lookup"><span data-stu-id="8814b-123">If the client generates **PR_BODY** and the message store saves it along with the formatted text, the rendering positions will be accurate.</span></span> <span data-ttu-id="8814b-124">No entanto, se o armazenamento de mensagens deve gerar sua própria versão do **PR_BODY** porque ele salva somente **PR_RTF_COMPRESSED**, é provável que seja relativamente imprecisas as posições de renderização.</span><span class="sxs-lookup"><span data-stu-id="8814b-124">However, if the message store must generate its own version of **PR_BODY** because it only saves **PR_RTF_COMPRESSED**, it is probable that the rendering positions will be somewhat inaccurate.</span></span> <span data-ttu-id="8814b-125">Isso é devido às diferenças da maneira que os clientes e os provedores de armazenamento de mensagem geram a propriedade **PR_BODY** .</span><span class="sxs-lookup"><span data-stu-id="8814b-125">This is because of the differences in the way that clients and message store providers generate the **PR_BODY** property.</span></span> 
  
<span data-ttu-id="8814b-126">Para calcular um valor exato da **PR_RENDERING_POSITION** , um armazenamento de reconhecimento de RTF usa uma marca incorporada o texto formatado.</span><span class="sxs-lookup"><span data-stu-id="8814b-126">To calculate an accurate **PR_RENDERING_POSITION** value, an RTF-aware store uses a tag embedded in the formatted text.</span></span> <span data-ttu-id="8814b-127">A função do utilitário **RTFSync** pode ser chamada para realizar esse cálculo e atualizar posição de renderização de um anexo.</span><span class="sxs-lookup"><span data-stu-id="8814b-127">The utility function **RTFSync** can be called to perform this calculation and update an attachment's rendering position.</span></span> <span data-ttu-id="8814b-128">Dependendo da quantidade de informações de estado disponíveis, o armazenamento de mensagens pode passar RTF_SYNC_BODY_CHANGED, RTF_SYNC_RTF_CHANGED ou ambos os valores para [RTFSync](rtfsync.md).</span><span class="sxs-lookup"><span data-stu-id="8814b-128">Depending on the amount of state information available, the message store can pass either RTF_SYNC_BODY_CHANGED, RTF_SYNC_RTF_CHANGED, or both values to [RTFSync](rtfsync.md).</span></span>
  

