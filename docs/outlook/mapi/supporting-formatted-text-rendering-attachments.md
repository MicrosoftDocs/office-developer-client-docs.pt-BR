---
title: Suporte a anexos de renderização de texto formatado
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 68abe85b-5dc0-40d0-8917-30ea002aa816
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: 5f03530f994fd13e7dc4c7eaa4124900c28e613b
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33405293"
---
# <a name="supporting-formatted-text-rendering-attachments"></a><span data-ttu-id="a36f9-103">Suporte a texto formatado: renderização de anexos</span><span class="sxs-lookup"><span data-stu-id="a36f9-103">Supporting Formatted Text: Rendering Attachments</span></span>

  
  
<span data-ttu-id="a36f9-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a36f9-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="a36f9-105">Um aplicativo cliente que sabe onde em uma mensagem seus anexos são renderizados define a propriedade **PR_RENDERING_POSITION** ([PidTagRenderingPosition](pidtagrenderingposition-canonical-property.md)) para esses anexos durante a composição da mensagem.</span><span class="sxs-lookup"><span data-stu-id="a36f9-105">A client application that cares about where in a message its attachments are rendered sets the **PR_RENDERING_POSITION** ([PidTagRenderingPosition](pidtagrenderingposition-canonical-property.md)) property for these attachments during message composition.</span></span> <span data-ttu-id="a36f9-106">Um cliente que não se importa com o posicionamento da renderização deixa essa propriedade sem colocação.</span><span class="sxs-lookup"><span data-stu-id="a36f9-106">A client that does not care about rendering placement leaves this property unset.</span></span>
  
<span data-ttu-id="a36f9-107">Quando um cliente abre uma mensagem com anexos,  ele tenta recuperar a propriedade PR_RENDERING_POSITION de cada anexo para determinar onde, no texto da mensagem, o anexo deve ser renderizado.</span><span class="sxs-lookup"><span data-stu-id="a36f9-107">When a client opens a message with attachments, it attempts to retrieve each attachment's **PR_RENDERING_POSITION** property to determine where in the message text the attachment should be rendered.</span></span> <span data-ttu-id="a36f9-108">Um cliente pode usar um dos seguintes métodos para **recuperar** PR_RENDERING_POSITION:</span><span class="sxs-lookup"><span data-stu-id="a36f9-108">A client can use one of the following methods to retrieve **PR_RENDERING_POSITION**:</span></span>
  
- <span data-ttu-id="a36f9-109">[IMAPIProp::GetProps](imapiprop-getprops.md) no anexo aberto para recuperar a **PR_RENDERING_POSITION** propriedade.</span><span class="sxs-lookup"><span data-stu-id="a36f9-109">[IMAPIProp::GetProps](imapiprop-getprops.md) on the open attachment to retrieve the **PR_RENDERING_POSITION** property.</span></span> 
    
- <span data-ttu-id="a36f9-110">[IMessage::GetAttachmentTable](imessage-getattachmenttable.md) na mensagem aberta para recuperar sua tabela de anexos.</span><span class="sxs-lookup"><span data-stu-id="a36f9-110">[IMessage::GetAttachmentTable](imessage-getattachmenttable.md) on the open message to retrieve its attachment table.</span></span> <span data-ttu-id="a36f9-111">**PR_RENDERING_POSITION** é uma coluna necessária em todas as tabelas de anexos.</span><span class="sxs-lookup"><span data-stu-id="a36f9-111">**PR_RENDERING_POSITION** is a required column in all attachment tables.</span></span> <span data-ttu-id="a36f9-112">Esse é o método preferencial porque resulta em um melhor desempenho.</span><span class="sxs-lookup"><span data-stu-id="a36f9-112">This is the preferred method because it results in better performance.</span></span> 
    
<span data-ttu-id="a36f9-113">Os armazenamentos de mensagens com conhecimento RTF podem optar por retornar um valor preciso ou aproximado **para PR_RENDERING_POSITION**.</span><span class="sxs-lookup"><span data-stu-id="a36f9-113">RTF-aware message stores can choose whether to return an accurate or approximate value for **PR_RENDERING_POSITION**.</span></span> <span data-ttu-id="a36f9-114">Como os armazenamentos de mensagens recalculam o valor de PR_RENDERING_POSITION de um anexo quando solicitado a propriedade **PR_BODY da** mensagem, alguns armazenamentos de mensagens com conhecimento RTF garantem apenas **a** precisão das posições de renderização quando um cliente solicita primeiro PR_BODY **.**</span><span class="sxs-lookup"><span data-stu-id="a36f9-114">Because message stores recalculate an attachment's **PR_RENDERING_POSITION** value when asked for the message's **PR_BODY** property, some RTF-aware message stores only guarantee the accuracy of rendering positions when a client asks first for **PR_BODY**.</span></span> <span data-ttu-id="a36f9-115">Os armazenamentos de mensagens com suporte a RTF têm permissão para fornecer aos clientes valores aproximados de posição de renderização para melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="a36f9-115">RTF-aware message stores are allowed to provide clients with approximate rendering position values to enhance performance.</span></span> <span data-ttu-id="a36f9-116">Fornecer uma posição aproximada em vez de uma posição de renderização precisa economiza tempo e é suficiente para a maioria das situações.</span><span class="sxs-lookup"><span data-stu-id="a36f9-116">Providing an approximate rather than an accurate rendering position saves time and is sufficient for most situations.</span></span> 
  
<span data-ttu-id="a36f9-117">Os armazenamentos de mensagens com conhecimento RTF devem basear sua aproximação no valor especificado pelo cliente responsável pela criação do anexo.</span><span class="sxs-lookup"><span data-stu-id="a36f9-117">RTF-aware message stores should base their approximation on the value specified by the client responsible for creating the attachment.</span></span> <span data-ttu-id="a36f9-118">Embora todos os clientes devam **PR_RENDERING_POSITION**, os provedores do armazenamento de mensagens devem estar preparados para lidar com a possibilidade de sua ausência.</span><span class="sxs-lookup"><span data-stu-id="a36f9-118">Although all clients should set **PR_RENDERING_POSITION**, message store providers should be prepared to deal with the possibility of its absence.</span></span> <span data-ttu-id="a36f9-119">Quando o cliente não PR_RENDERING_POSITION **,** um armazenamento de mensagens pode defini-lo como -1 para indicar que a posição de renderização não está dentro do texto da mensagem.</span><span class="sxs-lookup"><span data-stu-id="a36f9-119">When the client does not set **PR_RENDERING_POSITION**, a message store can set it to -1 to indicate that the rendering position is not within the message text.</span></span> <span data-ttu-id="a36f9-120">Anexos com uma posição de renderização de -1 podem ser exibidos em qualquer lugar dentro da mensagem, dependendo do cliente.</span><span class="sxs-lookup"><span data-stu-id="a36f9-120">Attachments with a rendering position of -1 can be displayed at any place within the message depending on the client.</span></span> <span data-ttu-id="a36f9-121">Muitos clientes posicionam esses tipos de anexos na parte superior da mensagem.</span><span class="sxs-lookup"><span data-stu-id="a36f9-121">Many clients position these types of attachments at the top of the message.</span></span>
  
<span data-ttu-id="a36f9-122">O grau de precisão de uma propriedade **PR_RENDERING_POSITION** depende de um armazenamento de mensagens salvar ou não as propriedades **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) e **PR_RTF_COMPRESSED** ([PidTagRtfCompressed)](pidtagrtfcompressed-canonical-property.md)de uma mensagem ou apenas **PR_RTF_COMPRESSED**.</span><span class="sxs-lookup"><span data-stu-id="a36f9-122">The degree of accuracy for a **PR_RENDERING_POSITION** property depends on whether or not a message store saves both a message's **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) and **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) properties or only **PR_RTF_COMPRESSED**.</span></span> <span data-ttu-id="a36f9-123">Se o cliente gerar **PR_BODY** e o armazenamento de mensagens salvá-lo junto com o texto formatado, as posições de renderização serão precisas.</span><span class="sxs-lookup"><span data-stu-id="a36f9-123">If the client generates **PR_BODY** and the message store saves it along with the formatted text, the rendering positions will be accurate.</span></span> <span data-ttu-id="a36f9-124">No entanto, se o armazenamento de mensagens deve gerar sua própria versão do **PR_BODY** porque ele só salva **PR_RTF_COMPRESSED**, é provável que as posições de renderização sejam um pouco imprecisas.</span><span class="sxs-lookup"><span data-stu-id="a36f9-124">However, if the message store must generate its own version of **PR_BODY** because it only saves **PR_RTF_COMPRESSED**, it is probable that the rendering positions will be somewhat inaccurate.</span></span> <span data-ttu-id="a36f9-125">Isso se deve às diferenças na maneira como os clientes e provedores de armazenamento de mensagens geram a **PR_BODY** propriedade.</span><span class="sxs-lookup"><span data-stu-id="a36f9-125">This is because of the differences in the way that clients and message store providers generate the **PR_BODY** property.</span></span> 
  
<span data-ttu-id="a36f9-126">Para calcular um valor **PR_RENDERING_POSITION,** um armazenamento com conhecimento RTF usa uma marca inserida no texto formatado.</span><span class="sxs-lookup"><span data-stu-id="a36f9-126">To calculate an accurate **PR_RENDERING_POSITION** value, an RTF-aware store uses a tag embedded in the formatted text.</span></span> <span data-ttu-id="a36f9-127">A função utilitário **RTFSync** pode ser chamada para executar esse cálculo e atualizar a posição de renderização de um anexo.</span><span class="sxs-lookup"><span data-stu-id="a36f9-127">The utility function **RTFSync** can be called to perform this calculation and update an attachment's rendering position.</span></span> <span data-ttu-id="a36f9-128">Dependendo da quantidade de informações de estado disponíveis, o armazenamento de mensagens pode passar RTF_SYNC_BODY_CHANGED, RTF_SYNC_RTF_CHANGED ou ambos os valores para [RTFSync](rtfsync.md).</span><span class="sxs-lookup"><span data-stu-id="a36f9-128">Depending on the amount of state information available, the message store can pass either RTF_SYNC_BODY_CHANGED, RTF_SYNC_RTF_CHANGED, or both values to [RTFSync](rtfsync.md).</span></span>
  

