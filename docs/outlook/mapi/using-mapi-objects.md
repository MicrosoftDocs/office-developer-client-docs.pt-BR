---
title: Como usar objetos MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e342c1bd-8bee-4b02-a93f-e3941f4716c1
description: '�ltima altera��o: s�bado, 23 de julho de 2011'
ms.openlocfilehash: d732efe5276f4756f43b4aca46e1c33d6f103844
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/04/2018
ms.locfileid: "25392841"
---
# <a name="using-mapi-objects"></a><span data-ttu-id="35737-103">Como usar objetos MAPI</span><span class="sxs-lookup"><span data-stu-id="35737-103">Using MAPI objects</span></span>

<span data-ttu-id="35737-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="35737-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="35737-105">Clientes e provedores de serviço usam objetos MAPI chamando os métodos em suas implementações de interface.</span><span class="sxs-lookup"><span data-stu-id="35737-105">Clients and service providers use MAPI objects by calling the methods in their interface implementations.</span></span> <span data-ttu-id="35737-106">Isso é a única maneira que os objetos MAPI podem ser usados; métodos que são implementados por um objeto fora de uma interface MAPI não são acessíveis publicamente.</span><span class="sxs-lookup"><span data-stu-id="35737-106">This is the only way that MAPI objects can be used; methods that are implemented by an object outside of a MAPI interface are not publicly accessible.</span></span> <span data-ttu-id="35737-107">Como todas as interfaces de um objeto estão relacionadas por meio de herança, o usuário de um objeto pode chamar métodos na interface base ou uma das interfaces herdadas conforme se eles pertencem a mesma interface.</span><span class="sxs-lookup"><span data-stu-id="35737-107">Because all of an object's interfaces are related through inheritance, an object's user can call methods in either the base interface or one of the inherited interfaces as if they belong to the same interface.</span></span> 
  
<span data-ttu-id="35737-108">Quando o usuário de um objeto deseja fazer uma chamada para um método e esse objeto implementa várias interfaces relacionadas por meio de herança, o usuário não precisa saber ao qual interface o método pertence.</span><span class="sxs-lookup"><span data-stu-id="35737-108">When an object's user wants to make a call to a method and that object implements several interfaces related through inheritance, the user need not know to which interface the method belongs.</span></span> <span data-ttu-id="35737-109">O usuário pode chamar qualquer um dos métodos em qualquer uma das interfaces com um único ponteiro para o objeto.</span><span class="sxs-lookup"><span data-stu-id="35737-109">The user can call any of the methods on any of the interfaces with a single pointer to the object.</span></span> <span data-ttu-id="35737-110">Por exemplo, a ilustração a seguir mostra como um aplicativo cliente usa um objeto folder.</span><span class="sxs-lookup"><span data-stu-id="35737-110">For example, the following illustration shows how a client application uses a folder object.</span></span> <span data-ttu-id="35737-111">Objetos de pasta implementar o [IMAPIFolder: IMAPIContainer](imapifolderimapicontainer.md) interface, que herda de [IUnknown](https://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx) indiretamente até [IMAPIProp: IUnknown](imapipropiunknown.md) e [IMAPIContainer: IMAPIProp](imapicontainerimapiprop.md).</span><span class="sxs-lookup"><span data-stu-id="35737-111">Folder objects implement the [IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md) interface, which inherits from [IUnknown](https://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx) indirectly through [IMAPIProp : IUnknown](imapipropiunknown.md) and [IMAPIContainer : IMAPIProp](imapicontainerimapiprop.md).</span></span> <span data-ttu-id="35737-112">Um cliente pode chamar um dos métodos **IMAPIProp** , como [IMAPIProp::GetProps](imapiprop-getprops.md)e uma do [IMAPIFolder: IMAPIContainer](imapifolderimapicontainer.md) métodos, como [IMAPIFolder::CreateMessage](imapifolder-createmessage.md), da mesma maneira com o mesmo ponteiro de objeto.</span><span class="sxs-lookup"><span data-stu-id="35737-112">A client can call one of the **IMAPIProp** methods, such as [IMAPIProp::GetProps](imapiprop-getprops.md), and one of the [IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md) methods, such as [IMAPIFolder::CreateMessage](imapifolder-createmessage.md), in the same way with the same object pointer.</span></span> <span data-ttu-id="35737-113">Um cliente não está ciente ou afetados pelo fato de que essas chamadas pertencem a interfaces diferentes.</span><span class="sxs-lookup"><span data-stu-id="35737-113">A client is not aware of or affected by the fact that these calls belong to different interfaces.</span></span>
  
<span data-ttu-id="35737-114">**Client use of a folder object**</span><span class="sxs-lookup"><span data-stu-id="35737-114">**Client use of a folder object**</span></span>
  
<span data-ttu-id="35737-115">![Usar o cliente de um objeto folder] (media/amapi_40.gif "Usar o cliente de um objeto folder")</span><span class="sxs-lookup"><span data-stu-id="35737-115">![Client use of a folder object](media/amapi_40.gif "Client use of a folder object")</span></span>
  
<span data-ttu-id="35737-116">Essas chamadas traduzem em código de forma diferente, dependendo se o cliente fazendo as chamadas é gravado em C ou C++.</span><span class="sxs-lookup"><span data-stu-id="35737-116">These calls translate into code differently depending on whether the client making the calls is written in C or C++.</span></span> <span data-ttu-id="35737-117">Antes de qualquer chamada para um método pode ser feita, um ponteiro para a implementação de interface deve ser recuperado.</span><span class="sxs-lookup"><span data-stu-id="35737-117">Before any call to a method can be made, a pointer to the interface implementation must be retrieved.</span></span> <span data-ttu-id="35737-118">Ponteiros de interface podem ser obtidos das seguintes maneiras:</span><span class="sxs-lookup"><span data-stu-id="35737-118">Interface pointers can be obtained in the following ways:</span></span>
  
- <span data-ttu-id="35737-119">Chamar um método em um objeto diferente.</span><span class="sxs-lookup"><span data-stu-id="35737-119">Calling a method on a different object.</span></span>
    
- <span data-ttu-id="35737-120">Chamar uma função API.</span><span class="sxs-lookup"><span data-stu-id="35737-120">Calling an API function.</span></span>
    
- <span data-ttu-id="35737-121">Chamar o método de [IUnknown:: QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx) no objeto de destino.</span><span class="sxs-lookup"><span data-stu-id="35737-121">Calling the [IUnknown::QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx) method on the target object.</span></span> 
    
<span data-ttu-id="35737-122">MAPI fornece vários métodos e funções da API que retornam ponteiros para implementações de interface.</span><span class="sxs-lookup"><span data-stu-id="35737-122">MAPI provides several methods and API functions that return pointers to interface implementations.</span></span> <span data-ttu-id="35737-123">Por exemplo, os clientes podem chamar o método [IMAPISession::GetMsgStoresTable](imapisession-getmsgstorestable.md) para recuperar um ponteiro para um objeto table que fornece acesso às informações do provedor de repositório de mensagens por meio do [IMAPITable: IUnknown](imapitableiunknown.md) interface.</span><span class="sxs-lookup"><span data-stu-id="35737-123">For example, clients can call the [IMAPISession::GetMsgStoresTable](imapisession-getmsgstorestable.md) method to retrieve a pointer to a table object that provides access to message store provider information through the [IMAPITable : IUnknown](imapitableiunknown.md) interface.</span></span> <span data-ttu-id="35737-124">Provedores de serviços podem chamar a função de API [CreateTable](createtable.md) para recuperar um ponteiro para um objeto de dados de tabela.</span><span class="sxs-lookup"><span data-stu-id="35737-124">Service providers can call the API function [CreateTable](createtable.md) to retrieve a pointer to a table data object.</span></span> <span data-ttu-id="35737-125">Quando não há nenhuma função ou o método disponível e clientes ou provedores de serviço já tem um ponteiro para um objeto, eles podem chamar o método do objeto **QueryInterface** para recuperar um ponteiro para outro de implementações de interface do objeto.</span><span class="sxs-lookup"><span data-stu-id="35737-125">When there is no function or method available and clients or service providers already have a pointer to an object, they can call the object's **QueryInterface** method to retrieve a pointer to another of the object's interface implementations.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="35737-126">Confira também</span><span class="sxs-lookup"><span data-stu-id="35737-126">See also</span></span>

- [<span data-ttu-id="35737-127">Objeto MAPI e visão geral da Interface</span><span class="sxs-lookup"><span data-stu-id="35737-127">MAPI Object and Interface Overview</span></span>](mapi-object-and-interface-overview.md)

