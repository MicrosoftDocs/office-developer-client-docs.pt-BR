---
title: Gravar um código de servidor de formulário
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ff33badc-ceed-4364-b99c-8af3af83ceb6
description: 'Última modificação: 9 de março de 2015'
ms.openlocfilehash: 860b0150fd1ec66fa8fee387d8d4a96e8bb79761
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19770724"
---
# <a name="writing-form-server-code"></a><span data-ttu-id="8db63-103">Gravar um código de servidor de formulário</span><span class="sxs-lookup"><span data-stu-id="8db63-103">Writing Form Server Code</span></span>

  
  
<span data-ttu-id="8db63-104">**Aplica-se a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="8db63-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="8db63-105">Você pode pensar em um servidor de formulário como o seguinte:</span><span class="sxs-lookup"><span data-stu-id="8db63-105">You can think of a form server as the following:</span></span> 
  
- <span data-ttu-id="8db63-106">Um programa Win32 que exibe uma interface e trata as mensagens windows por meio de mecanismos de bomba de mensagem padrão do Windows.</span><span class="sxs-lookup"><span data-stu-id="8db63-106">A Win32 program that displays an interface and handles windows messages by way of the standard Windows message pump mechanisms.</span></span>
    
- <span data-ttu-id="8db63-107">Um objeto que registra o respectivo alocador de classe com OLE e está ativado por meio de métodos de automação OLE.</span><span class="sxs-lookup"><span data-stu-id="8db63-107">An object that registers its class factory with OLE and is activated by OLE automation methods.</span></span>
    
- <span data-ttu-id="8db63-108">Um objeto MAPI que segue as regras de MAPI para interações com outros componentes MAPI.</span><span class="sxs-lookup"><span data-stu-id="8db63-108">A MAPI object that follows the MAPI rules for interactions with other MAPI components.</span></span>
    
 <span data-ttu-id="8db63-109">Seu código deve lidar com todos os três esses requisitos amplos simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="8db63-109">Your code has to handle all three of those broad requirements simultaneously.</span></span> 
  
<span data-ttu-id="8db63-110">Consulte a seção Serviços de objetos ActiveX e COM no SDK do Windows para obter detalhes sobre como registrar o alocador de classe do seu servidor de formulário.</span><span class="sxs-lookup"><span data-stu-id="8db63-110">See the COM and ActiveX Object Services section in the Windows SDK for details about registering your form server's class factory.</span></span> <span data-ttu-id="8db63-111">Manipulação de mensagens do windows e exibindo uma interface são standard técnicas de programação de Windows que não tenham requisitos especiais com relação a formulários MAPI.</span><span class="sxs-lookup"><span data-stu-id="8db63-111">Handling windows messages and displaying an interface are standard Windows programming techniques that do not have any special requirements with respect to MAPI forms.</span></span> <span data-ttu-id="8db63-112">Novamente, o SDK do Windows mostra detalhes sobre a programação do Windows.</span><span class="sxs-lookup"><span data-stu-id="8db63-112">Again, the Windows SDK has details about Windows programming.</span></span> <span data-ttu-id="8db63-113">Este documento contém o que você precisa saber para implementar as interfaces de formulário MAPI obrigatórios e opcionais de modo que eles seguem as regras MAPI para interações com outros componentes MAPI — principalmente MAPI formar manager e aplicativos cliente de mensagens.</span><span class="sxs-lookup"><span data-stu-id="8db63-113">This document contains what you need to know to implement the required and optional MAPI form interfaces so that they follow the MAPI rules for interactions with other MAPI components — primarily the MAPI form manager and messaging client applications.</span></span>
  
<span data-ttu-id="8db63-114">Todas as interfaces que podem ser usados quando você implementa servidores de formulário são derivadas — direta ou indiretamente — da OLE [IUnknown](http://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx)de classe de base.</span><span class="sxs-lookup"><span data-stu-id="8db63-114">All of the interfaces that you can use when you implement form servers are derived — either directly or indirectly — from the OLE base class [IUnknown](http://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx).</span></span> <span data-ttu-id="8db63-115">Isso significa que todas as suas implementações dessas interfaces precisará ter os métodos de **QueryInterface**, **AddRef**e **Release** .</span><span class="sxs-lookup"><span data-stu-id="8db63-115">This means that all your implementations of these interfaces will need to have **QueryInterface**, **AddRef**, and **Release** methods.</span></span> <span data-ttu-id="8db63-116">Você pode economizar muito trabalho se você usar vários herança para implementar todas as interfaces necessárias em uma nova classe de sua preferência, para que todas as interfaces que você use podem compartilhar uma única implementação dos métodos **IUnknown** necessários.</span><span class="sxs-lookup"><span data-stu-id="8db63-116">You can save yourself a lot of work if you use multiple inheritance to implement all of the required interfaces in one new class of your own, so that all the interfaces you use can share a single implementation of the required **IUnknown** methods.</span></span> <span data-ttu-id="8db63-117">Para obter mais informações, consulte os métodos [IUnknown:: QueryInterface](http://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx), [AddRef](http://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx)e [IUnknown:: Release](http://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="8db63-117">For more information, see the [IUnknown::AddRef](http://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx), [IUnknown::QueryInterface](http://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx), and [IUnknown::Release](http://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) methods.</span></span> <span data-ttu-id="8db63-118">Não há nenhuma consideração especial em relação aos servidores de formulário MAPI para esses métodos.</span><span class="sxs-lookup"><span data-stu-id="8db63-118">There are no special considerations with respect to MAPI form servers for these methods.</span></span> 
  
<span data-ttu-id="8db63-119">Enquanto não todas as interfaces de formulário MAPI são obrigatórias para todos os servidores de formulário, os métodos em uma determinada interface são obrigatórios.</span><span class="sxs-lookup"><span data-stu-id="8db63-119">While not all of the MAPI form interfaces are mandatory for all form servers, the methods in any given interface are mandatory.</span></span> <span data-ttu-id="8db63-120">Ou seja, se você optar por implementar uma interface particular, você deve implementar todos os métodos na interface do.</span><span class="sxs-lookup"><span data-stu-id="8db63-120">That is, if you choose to implement a particular interface, you must implement all of the methods in the interface.</span></span> <span data-ttu-id="8db63-121">Isso é diferente da situação com alguns outros componentes MAPI, como transportes de mensagem.</span><span class="sxs-lookup"><span data-stu-id="8db63-121">This is different from the situation with some other MAPI components, such as message transports.</span></span> <span data-ttu-id="8db63-122">Felizmente, os métodos as interfaces de formulário MAPI são relativamente simples, portanto implementar todos eles não coloca uma grande carga nos desenvolvedores.</span><span class="sxs-lookup"><span data-stu-id="8db63-122">Fortunately, the methods in the MAPI form interfaces are relatively straightforward, so implementing all of them does not put a great burden on developers.</span></span>
  
<span data-ttu-id="8db63-123">As interfaces de formulário MAPI são independentes do tipo da ferramenta de desenvolvimento usada para criar um servidor de formulário.</span><span class="sxs-lookup"><span data-stu-id="8db63-123">The MAPI form interfaces are independent of the type of development tool used to create a form server.</span></span> <span data-ttu-id="8db63-124">Isso permite que os formulários a ser criado usando as ferramentas de desenvolvimento diferentes.</span><span class="sxs-lookup"><span data-stu-id="8db63-124">This allows forms to be created by using different development tools.</span></span> <span data-ttu-id="8db63-125">O único requisito é que todos os servidores do formulário devem suportar as interfaces de formulário MAPI necessárias.</span><span class="sxs-lookup"><span data-stu-id="8db63-125">The only requirement is that all form servers must support the required MAPI form interfaces.</span></span>
  
<span data-ttu-id="8db63-126">Nem todas as interfaces MAPI que se relacionam com formulários são necessárias por todos os servidores do formulário.</span><span class="sxs-lookup"><span data-stu-id="8db63-126">Not all of the MAPI interfaces that relate to forms are required by all form servers.</span></span> <span data-ttu-id="8db63-127">As interfaces opcionais permitem que você implemente algumas funções avançadas de formulário que não são necessárias para a maioria dos servidores de formulário.</span><span class="sxs-lookup"><span data-stu-id="8db63-127">The optional interfaces allow you to implement some advanced form functions that are not needed by most form servers.</span></span> <span data-ttu-id="8db63-128">A tabela a seguir lista as interfaces, o que são e se você deve implementá-las.</span><span class="sxs-lookup"><span data-stu-id="8db63-128">The following table lists the interfaces, what they are for, and whether you must implement them.</span></span>
  
|<span data-ttu-id="8db63-129">**Interface**</span><span class="sxs-lookup"><span data-stu-id="8db63-129">**Interface**</span></span>|<span data-ttu-id="8db63-130">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="8db63-130">**Description**</span></span>|<span data-ttu-id="8db63-131">**Status**</span><span class="sxs-lookup"><span data-stu-id="8db63-131">**Status**</span></span>|
|:-----|:-----|:-----|
|[<span data-ttu-id="8db63-132">IMAPIForm : IUnknown</span><span class="sxs-lookup"><span data-stu-id="8db63-132">IMAPIForm : IUnknown</span></span>](imapiformiunknown.md) <br/> |<span data-ttu-id="8db63-133">A interface principal que são usadas pelos clientes para carregar os servidores do formulário, execute os verbos de formulário e desligar servidores do formulário.</span><span class="sxs-lookup"><span data-stu-id="8db63-133">The primary interface that clients use to load form servers, execute form verbs, and shut down form servers.</span></span> <span data-ttu-id="8db63-134">Isso também é a interface derivada do OLE **IUnknown** que é usado para informar aos outros componentes do OLE sobre quais interfaces implementa um objeto form.</span><span class="sxs-lookup"><span data-stu-id="8db63-134">This is also the interface derived from the OLE **IUnknown** that is used to inform other OLE components regarding what interfaces a form object implements.</span></span>  <br/> |<span data-ttu-id="8db63-135">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="8db63-135">Required</span></span>  <br/> |
|[<span data-ttu-id="8db63-136">IPersistMessage : IUnknown</span><span class="sxs-lookup"><span data-stu-id="8db63-136">IPersistMessage : IUnknown</span></span>](ipersistmessageiunknown.md) <br/> |<span data-ttu-id="8db63-137">Usado quando o carregamento de mensagens em e poupa mensagens de objetos de formulário.</span><span class="sxs-lookup"><span data-stu-id="8db63-137">Used when loading messages into and saving messages from form objects.</span></span>  <br/> |<span data-ttu-id="8db63-138">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="8db63-138">Required</span></span>  <br/> |
|[<span data-ttu-id="8db63-139">IMAPIFormAdviseSink : IUnknown</span><span class="sxs-lookup"><span data-stu-id="8db63-139">IMAPIFormAdviseSink : IUnknown</span></span>](imapiformadvisesinkiunknown.md) <br/> |<span data-ttu-id="8db63-140">Usado pelos objetos de formulário para manter o controle de status do cliente de mensagens e para descobrir se o objeto de formulário é capaz de exibir a mensagem anterior ou seguinte em uma pasta.</span><span class="sxs-lookup"><span data-stu-id="8db63-140">Used by form objects to keep track of messaging client status and to find out whether the form object is capable of displaying the next or previous message in a folder.</span></span>  <br/> |<span data-ttu-id="8db63-141">Opcional</span><span class="sxs-lookup"><span data-stu-id="8db63-141">Optional</span></span>  <br/> |
|[<span data-ttu-id="8db63-142">IClassFactory</span><span class="sxs-lookup"><span data-stu-id="8db63-142">IClassFactory</span></span>](http://msdn.microsoft.com/library/f624f833-2b69-43bc-92cd-c4ecbe6051c5%28Office.15%29.aspx) <br/> |<span data-ttu-id="8db63-143">A interface de fábrica de classe OLE utilizada pelos objetos de formulário para fins de conformidade com o mecanismo de fábrica de classe OLE.</span><span class="sxs-lookup"><span data-stu-id="8db63-143">The OLE class factory interface used by form objects for compliance with the OLE class factory mechanism.</span></span>  <br/> |<span data-ttu-id="8db63-144">Obrigatório</span><span class="sxs-lookup"><span data-stu-id="8db63-144">Required</span></span>  <br/> |
|[<span data-ttu-id="8db63-145">IMAPIFormFactory : IUnknown</span><span class="sxs-lookup"><span data-stu-id="8db63-145">IMAPIFormFactory : IUnknown</span></span>](imapiformfactoryiunknown.md) <br/> |<span data-ttu-id="8db63-146">Usado se o seu servidor de formulário oferece suporte a mais de um tipo de formulário.</span><span class="sxs-lookup"><span data-stu-id="8db63-146">Used if your form server supports more than one type of form.</span></span> <span data-ttu-id="8db63-147">Nesse caso, a interface de **IMAPIFormFactory** permite que os aplicativos clientes para acessar as várias interfaces **IClassFactory** (um por tipo de formulário que ofereça suporte a seu servidor de formulário) que seu servidor de formulário também deve implementar.</span><span class="sxs-lookup"><span data-stu-id="8db63-147">In this case, the **IMAPIFormFactory** interface allows client applications to access the multiple **IClassFactory** interfaces (one per type of form that your form server supports) that your form server must also implement.</span></span>  <br/> |<span data-ttu-id="8db63-148">Opcional</span><span class="sxs-lookup"><span data-stu-id="8db63-148">Optional</span></span>  <br/> |
   
## <a name="see-also"></a><span data-ttu-id="8db63-149">Confira também</span><span class="sxs-lookup"><span data-stu-id="8db63-149">See also</span></span>



[<span data-ttu-id="8db63-150">Desenvolver servidores de formulário MAPI</span><span class="sxs-lookup"><span data-stu-id="8db63-150">Developing MAPI Form Servers</span></span>](developing-mapi-form-servers.md)

