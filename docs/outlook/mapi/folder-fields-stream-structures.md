---
title: Estruturas de fluxo de campos de pasta
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: edbc9e6c-008c-4c13-9a0c-cb47ac0f3686
description: 'Última modificação: 9 de março de 2015'
ms.openlocfilehash: 96051bd2b62fd7c0e908a1018aac0225e44986be
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32336887"
---
# <a name="folder-fields-stream-structures"></a><span data-ttu-id="3a04b-103">Estruturas de fluxo de campos de pasta</span><span class="sxs-lookup"><span data-stu-id="3a04b-103">Folder Fields Stream Structures</span></span>

<span data-ttu-id="3a04b-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="3a04b-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="3a04b-105">A propriedade [PidTagUserFields](pidtaguserfields-canonical-property.md) de uma mensagem contém um fluxo binário, FolderUserFields, que contém as definições de campo definidas pelo usuário da pasta.</span><span class="sxs-lookup"><span data-stu-id="3a04b-105">A message's [PidTagUserFields](pidtaguserfields-canonical-property.md) property contains a binary stream, FolderUserFields, which contains the folder user-defined field definitions.</span></span> <span data-ttu-id="3a04b-106">Este tópico descreve as estruturas de fluxo para as definições de campo definidas pelo usuário da pasta.</span><span class="sxs-lookup"><span data-stu-id="3a04b-106">This topic describes the stream structures for folder user-defined field definitions.</span></span> 

<span data-ttu-id="3a04b-107">Uma estrutura de fluxo FolderUserFields consiste em uma estrutura FolderUserFieldsA ou uma estrutura FolderUserFieldsA seguida de uma estrutura FolderUserFieldsW.</span><span class="sxs-lookup"><span data-stu-id="3a04b-107">A FolderUserFields stream structure consists of either a FolderUserFieldsA structure or a FolderUserFieldsA structure followed by a FolderUserFieldsW structure.</span></span>
  
<span data-ttu-id="3a04b-108">Os elementos de dados neste fluxo são armazenados imediatamente após um ao outro na seguinte ordem especificada:</span><span class="sxs-lookup"><span data-stu-id="3a04b-108">Data elements in this stream are stored immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="3a04b-109">**FolderUserFieldsAnsi**: uma estrutura de fluxo de FolderUserFieldsA.</span><span class="sxs-lookup"><span data-stu-id="3a04b-109">**FolderUserFieldsAnsi**: A FolderUserFieldsA stream structure.</span></span>
    
- <span data-ttu-id="3a04b-110">**FolderUserFieldsUnicode** (opcional): uma estrutura de fluxo do FolderUserFieldsW.</span><span class="sxs-lookup"><span data-stu-id="3a04b-110">**FolderUserFieldsUnicode** (optional): A FolderUserFieldsW stream structure.</span></span>
    
<span data-ttu-id="3a04b-111">A presença de FolderUserFieldsUnicode é detectada pelo tamanho total do FolderUserFields que é maior do que o comprimento de FolderUserFieldsAnsi.</span><span class="sxs-lookup"><span data-stu-id="3a04b-111">The presence of FolderUserFieldsUnicode is detected by the total length of the FolderUserFields being greater than the length of FolderUserFieldsAnsi.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="3a04b-112">FolderUserFieldsAnsi é usado para compatibilidade com versões mais antigas, não-Unicode, de clientes MAPI, portanto, se FolderUserFieldsUnicode estiver presente, o conteúdo de FolderUserFieldsAnsi será ignorado.</span><span class="sxs-lookup"><span data-stu-id="3a04b-112">FolderUserFieldsAnsi is used for compatibility with older, non-Unicode, versions of MAPI clients, therefore if FolderUserFieldsUnicode is present, the contents of FolderUserFieldsAnsi is ignored.</span></span> <span data-ttu-id="3a04b-113">Para evitar a possível perda de dados na conversão ANSI, ao criar um fluxo de FolderUserFields sempre inclua a parte FolderUserFieldsW.</span><span class="sxs-lookup"><span data-stu-id="3a04b-113">To avoid possible data loss in ANSI conversion, when creating a FolderUserFields stream always include the FolderUserFieldsW part.</span></span> 
  
## <a name="folderuserfieldsa-stream-structure"></a><span data-ttu-id="3a04b-114">Estrutura de fluxo FolderUserFieldsA</span><span class="sxs-lookup"><span data-stu-id="3a04b-114">FolderUserFieldsA Stream Structure</span></span>

<span data-ttu-id="3a04b-115">Uma estrutura de fluxo FolderUserFieldsA é uma matriz de estruturas de fluxo do FolderFieldDefinitionA que contêm definições para todos os campos definidos pelo usuário em uma pasta do Outlook, a menos que seja substituída pela parte FolderUserFieldsW da estrutura FolderUserFields.</span><span class="sxs-lookup"><span data-stu-id="3a04b-115">A FolderUserFieldsA stream structure is an array of FolderFieldDefinitionA stream structures that contain definitions for all user-defined fields in an Outlook folder, unless overridden by the FolderUserFieldsW part of the FolderUserFields structure.</span></span>
  
<span data-ttu-id="3a04b-116">Os elementos de dados neste fluxo são armazenados em uma ordem de byte little-endian, imediatamente após o outro na seguinte ordem especificada:</span><span class="sxs-lookup"><span data-stu-id="3a04b-116">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="3a04b-117">**FieldDefinitionCount**: DWORD (4 bytes), o número de definições de campo neste fluxo.</span><span class="sxs-lookup"><span data-stu-id="3a04b-117">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="3a04b-118">Esta é a contagem dos elementos na matriz **FieldDefinitions** .</span><span class="sxs-lookup"><span data-stu-id="3a04b-118">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="3a04b-119">**FieldDefinitions**: uma matriz de estruturas de fluxo do FolderFieldDefinitionA.</span><span class="sxs-lookup"><span data-stu-id="3a04b-119">**FieldDefinitions**: An array of FolderFieldDefinitionA stream structures.</span></span> <span data-ttu-id="3a04b-120">A contagem dessa matriz é igual ao elemento de dados **FieldDefinitionCount** .</span><span class="sxs-lookup"><span data-stu-id="3a04b-120">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="3a04b-121">A menos que esse FolderUserFieldsA seja substituído pela parte FolderUserFieldsW da estrutura FolderUserFields, a matriz **FieldDefinitions** deve ser "terminada em nulo", tendo o campo Common. FieldType do último elemento FolderFieldDefinitionA igual a para o ftNull.</span><span class="sxs-lookup"><span data-stu-id="3a04b-121">Unless this FolderUserFieldsA is overridden by the FolderUserFieldsW part of the FolderUserFields structure, the **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionA element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderuserfieldsw-stream-structure"></a><span data-ttu-id="3a04b-122">Estrutura de fluxo FolderUserFieldsW</span><span class="sxs-lookup"><span data-stu-id="3a04b-122">FolderUserFieldsW Stream Structure</span></span>

<span data-ttu-id="3a04b-123">Uma estrutura de fluxo do FolderUserFieldsW é uma matriz de estruturas de fluxo do FolderFieldDefinitionW que contêm definições para todos os campos definidos pelo usuário em uma pasta do Outlook.</span><span class="sxs-lookup"><span data-stu-id="3a04b-123">A FolderUserFieldsW stream structure is an array of FolderFieldDefinitionW stream structures that contain definitions for all user-defined fields in an Outlook folder.</span></span>
  
<span data-ttu-id="3a04b-124">Os elementos de dados neste fluxo são armazenados em uma ordem de byte little-endian, imediatamente após o outro na seguinte ordem especificada:</span><span class="sxs-lookup"><span data-stu-id="3a04b-124">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="3a04b-125">**FieldDefinitionCount**: DWORD (4 bytes), o número de definições de campo neste fluxo.</span><span class="sxs-lookup"><span data-stu-id="3a04b-125">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="3a04b-126">Esta é a contagem dos elementos na matriz **FieldDefinitions** .</span><span class="sxs-lookup"><span data-stu-id="3a04b-126">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="3a04b-127">**FieldDefinitions**: uma matriz de estruturas de fluxo do FolderFieldDefinitionW.</span><span class="sxs-lookup"><span data-stu-id="3a04b-127">**FieldDefinitions**: An array of FolderFieldDefinitionW stream structures.</span></span> <span data-ttu-id="3a04b-128">A contagem dessa matriz é igual ao elemento de dados **FieldDefinitionCount** .</span><span class="sxs-lookup"><span data-stu-id="3a04b-128">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="3a04b-129">A matriz **FieldDefinitions** deve ser "terminada em nulo" com o último campo. FieldType do elemento FolderFieldDefinitionW igual a ftNull.</span><span class="sxs-lookup"><span data-stu-id="3a04b-129">The **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionW element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderfielddefinitiona-stream-structure"></a><span data-ttu-id="3a04b-130">Estrutura de fluxo FolderFieldDefinitionA</span><span class="sxs-lookup"><span data-stu-id="3a04b-130">FolderFieldDefinitionA Stream Structure</span></span>

<span data-ttu-id="3a04b-131">Uma estrutura de fluxo FolderFieldDefinitionA contém uma definição de um campo definido pelo usuário com o nome do campo armazenado em ANSI.</span><span class="sxs-lookup"><span data-stu-id="3a04b-131">A FolderFieldDefinitionA stream structure contains a definition of a user-defined field with the field name stored in ANSI.</span></span>
  
<span data-ttu-id="3a04b-132">Os elementos de dados neste fluxo são armazenados em uma ordem de byte little-endian, imediatamente após o outro na seguinte ordem especificada:</span><span class="sxs-lookup"><span data-stu-id="3a04b-132">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="3a04b-133">**FieldType**: FldType (4 bytes), o tipo desse campo.</span><span class="sxs-lookup"><span data-stu-id="3a04b-133">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="3a04b-134">**FieldNameLength**: Word (2 bytes), o número de elementos na matriz **FieldName** .</span><span class="sxs-lookup"><span data-stu-id="3a04b-134">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="3a04b-135">**FieldName**: uma matriz de Char.</span><span class="sxs-lookup"><span data-stu-id="3a04b-135">**FieldName**: An array of CHAR.</span></span> <span data-ttu-id="3a04b-136">Esta é a representação de página de código ANSI CP_ACP do nome do campo.</span><span class="sxs-lookup"><span data-stu-id="3a04b-136">This is the ANSI CP_ACP codepage representation of the field name.</span></span> <span data-ttu-id="3a04b-137">A contagem dessa matriz é igual a **FieldNameLength**.</span><span class="sxs-lookup"><span data-stu-id="3a04b-137">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="3a04b-138">O nome do campo deve satisfazer as restrições no parâmetro Name conforme especificado no método [UserProperties. Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) .</span><span class="sxs-lookup"><span data-stu-id="3a04b-138">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="3a04b-139">Por motivos de compatibilidade herdada, o Outlook pode ser capaz de lidar com alguns valores de **FieldName** que não satisfaçam essas restrições, mas esses casos não são cobertos por este tópico.</span><span class="sxs-lookup"><span data-stu-id="3a04b-139">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="3a04b-140">**Comum**: uma estrutura de fluxo do FolderFieldDefinitionCommon.</span><span class="sxs-lookup"><span data-stu-id="3a04b-140">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="folderfielddefinitionw-stream-structure"></a><span data-ttu-id="3a04b-141">Estrutura de fluxo FolderFieldDefinitionW</span><span class="sxs-lookup"><span data-stu-id="3a04b-141">FolderFieldDefinitionW Stream Structure</span></span>

<span data-ttu-id="3a04b-142">Uma estrutura de fluxo FolderFieldDefinitionW contém uma definição de um campo definido pelo usuário com o nome do campo armazenado em Unicode.</span><span class="sxs-lookup"><span data-stu-id="3a04b-142">A FolderFieldDefinitionW stream structure contains a definition of a user-defined field with the field name stored in Unicode.</span></span>
  
<span data-ttu-id="3a04b-143">Os elementos de dados neste fluxo são armazenados em uma ordem de byte little-endian, imediatamente após o outro na seguinte ordem especificada:</span><span class="sxs-lookup"><span data-stu-id="3a04b-143">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="3a04b-144">**FieldType**: FldType (4 bytes), o tipo desse campo.</span><span class="sxs-lookup"><span data-stu-id="3a04b-144">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="3a04b-145">**FieldNameLength**: Word (2 bytes), o número de elementos na matriz **FieldName** .</span><span class="sxs-lookup"><span data-stu-id="3a04b-145">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="3a04b-146">**FieldName**: uma matriz de WCHAR.</span><span class="sxs-lookup"><span data-stu-id="3a04b-146">**FieldName**: An array of WCHAR.</span></span> <span data-ttu-id="3a04b-147">Esta é a representação Unicode (UTF-16) do nome do campo.</span><span class="sxs-lookup"><span data-stu-id="3a04b-147">This is the Unicode (UTF-16) representation of the field name.</span></span> <span data-ttu-id="3a04b-148">A contagem dessa matriz é igual a **FieldNameLength**.</span><span class="sxs-lookup"><span data-stu-id="3a04b-148">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="3a04b-149">O nome do campo deve satisfazer as restrições no parâmetro Name conforme especificado no método [UserProperties. Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) .</span><span class="sxs-lookup"><span data-stu-id="3a04b-149">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="3a04b-150">Por motivos de compatibilidade herdada, o Outlook pode ser capaz de lidar com alguns valores de **FieldName** que não satisfaçam essas restrições, mas esses casos não são cobertos por este tópico.</span><span class="sxs-lookup"><span data-stu-id="3a04b-150">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, but such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="3a04b-151">**Comum**: uma estrutura de fluxo do FolderFieldDefinitionCommon.</span><span class="sxs-lookup"><span data-stu-id="3a04b-151">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="fldtype-enumeration"></a><span data-ttu-id="3a04b-152">Enumeração FldType</span><span class="sxs-lookup"><span data-stu-id="3a04b-152">FldType Enumeration</span></span>

<span data-ttu-id="3a04b-153">Os valores de enumeração **FldType** estão listados na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="3a04b-153">**FldType** enumeration values are listed in the following table.</span></span> 
  
|<span data-ttu-id="3a04b-154">Nome</span><span class="sxs-lookup"><span data-stu-id="3a04b-154">Name</span></span>|<span data-ttu-id="3a04b-155">Valor</span><span class="sxs-lookup"><span data-stu-id="3a04b-155">Value</span></span>|<span data-ttu-id="3a04b-156">Significado</span><span class="sxs-lookup"><span data-stu-id="3a04b-156">Meaning</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="3a04b-157">ftNull</span><span class="sxs-lookup"><span data-stu-id="3a04b-157">ftNull</span></span>  <br/> |<span data-ttu-id="3a04b-158">0x0</span><span class="sxs-lookup"><span data-stu-id="3a04b-158">0x0</span></span>  <br/> |<span data-ttu-id="3a04b-159">Este tipo de campo é usado para anular uma matriz de definições de campos.</span><span class="sxs-lookup"><span data-stu-id="3a04b-159">This field type is used to null-terminate an array of field definitions.</span></span>  <br/> |
|<span data-ttu-id="3a04b-160">ftString</span><span class="sxs-lookup"><span data-stu-id="3a04b-160">ftString</span></span>  <br/> |<span data-ttu-id="3a04b-161">0x1</span><span class="sxs-lookup"><span data-stu-id="3a04b-161">0x1</span></span>  <br/> |<span data-ttu-id="3a04b-162">Texto</span><span class="sxs-lookup"><span data-stu-id="3a04b-162">Text</span></span>  <br/> |
|<span data-ttu-id="3a04b-163">ftInteger</span><span class="sxs-lookup"><span data-stu-id="3a04b-163">ftInteger</span></span>  <br/> |<span data-ttu-id="3a04b-164">0x3</span><span class="sxs-lookup"><span data-stu-id="3a04b-164">0x3</span></span>  <br/> |<span data-ttu-id="3a04b-165">Inteiro</span><span class="sxs-lookup"><span data-stu-id="3a04b-165">Integer</span></span>  <br/> |
|<span data-ttu-id="3a04b-166">ftTime</span><span class="sxs-lookup"><span data-stu-id="3a04b-166">ftTime</span></span>  <br/> |<span data-ttu-id="3a04b-167">0x5</span><span class="sxs-lookup"><span data-stu-id="3a04b-167">0x5</span></span>  <br/> |<span data-ttu-id="3a04b-168">Data/Hora</span><span class="sxs-lookup"><span data-stu-id="3a04b-168">Date/Time</span></span>  <br/> |
|<span data-ttu-id="3a04b-169">ftBoolean</span><span class="sxs-lookup"><span data-stu-id="3a04b-169">ftBoolean</span></span>  <br/> |<span data-ttu-id="3a04b-170">0x6</span><span class="sxs-lookup"><span data-stu-id="3a04b-170">0x6</span></span>  <br/> |<span data-ttu-id="3a04b-171">Sim/Não</span><span class="sxs-lookup"><span data-stu-id="3a04b-171">Yes/No</span></span>  <br/> |
|<span data-ttu-id="3a04b-172">ftDuration</span><span class="sxs-lookup"><span data-stu-id="3a04b-172">ftDuration</span></span>  <br/> |<span data-ttu-id="3a04b-173">0x7</span><span class="sxs-lookup"><span data-stu-id="3a04b-173">0x7</span></span>  <br/> |<span data-ttu-id="3a04b-174">Duração</span><span class="sxs-lookup"><span data-stu-id="3a04b-174">Duration</span></span>  <br/> |
|<span data-ttu-id="3a04b-175">ftMultiString</span><span class="sxs-lookup"><span data-stu-id="3a04b-175">ftMultiString</span></span>  <br/> |<span data-ttu-id="3a04b-176">0xB</span><span class="sxs-lookup"><span data-stu-id="3a04b-176">0xB</span></span>  <br/> |<span data-ttu-id="3a04b-177">Palavras-chave</span><span class="sxs-lookup"><span data-stu-id="3a04b-177">Keywords</span></span>  <br/> |
|<span data-ttu-id="3a04b-178">ftFloat</span><span class="sxs-lookup"><span data-stu-id="3a04b-178">ftFloat</span></span>  <br/> |<span data-ttu-id="3a04b-179">0xC</span><span class="sxs-lookup"><span data-stu-id="3a04b-179">0xC</span></span>  <br/> |<span data-ttu-id="3a04b-180">Número ou porcentagem</span><span class="sxs-lookup"><span data-stu-id="3a04b-180">Number or Percent</span></span>  <br/> |
|<span data-ttu-id="3a04b-181">ftCurrency</span><span class="sxs-lookup"><span data-stu-id="3a04b-181">ftCurrency</span></span>  <br/> |<span data-ttu-id="3a04b-182">0xE</span><span class="sxs-lookup"><span data-stu-id="3a04b-182">0xE</span></span>  <br/> |<span data-ttu-id="3a04b-183">Moeda</span><span class="sxs-lookup"><span data-stu-id="3a04b-183">Currency</span></span>  <br/> |
|<span data-ttu-id="3a04b-184">ftCalc</span><span class="sxs-lookup"><span data-stu-id="3a04b-184">ftCalc</span></span>  <br/> |<span data-ttu-id="3a04b-185">0x12</span><span class="sxs-lookup"><span data-stu-id="3a04b-185">0x12</span></span>  <br/> |<span data-ttu-id="3a04b-186">Fórmula</span><span class="sxs-lookup"><span data-stu-id="3a04b-186">Formula</span></span>  <br/> |
|<span data-ttu-id="3a04b-187">ftSwitch</span><span class="sxs-lookup"><span data-stu-id="3a04b-187">ftSwitch</span></span>  <br/> |<span data-ttu-id="3a04b-188">0x13</span><span class="sxs-lookup"><span data-stu-id="3a04b-188">0x13</span></span>  <br/> |<span data-ttu-id="3a04b-189">Combinação de tipo mostrando apenas o primeiro campo não vazio, ignorando os itens subsequentes.</span><span class="sxs-lookup"><span data-stu-id="3a04b-189">Combination of type showing only the first non-empty field - ignoring subsequent ones.</span></span>  <br/> |
|<span data-ttu-id="3a04b-190">ftConcat</span><span class="sxs-lookup"><span data-stu-id="3a04b-190">ftConcat</span></span>  <br/> |<span data-ttu-id="3a04b-191">0x17</span><span class="sxs-lookup"><span data-stu-id="3a04b-191">0x17</span></span>  <br/> |<span data-ttu-id="3a04b-192">Combinação do tipo associando campos e qualquer fragmento de texto.</span><span class="sxs-lookup"><span data-stu-id="3a04b-192">Combination of type joining fields and any text fragments to each other.</span></span>  <br/> |
   
## <a name="folderfielddefinitioncommon-stream-structure"></a><span data-ttu-id="3a04b-193">Estrutura de fluxo FolderFieldDefinitionCommon</span><span class="sxs-lookup"><span data-stu-id="3a04b-193">FolderFieldDefinitionCommon Stream Structure</span></span>

<span data-ttu-id="3a04b-194">Uma estrutura de fluxo FolderFieldDefinitionCommon contém os dados de uma definição de campo definido pelo usuário que é comum para um FolderFieldDefinitionA e um FolderFieldDefinitionW.</span><span class="sxs-lookup"><span data-stu-id="3a04b-194">A FolderFieldDefinitionCommon stream structure contains the data of a user-defined field definition that is common to both a FolderFieldDefinitionA and a FolderFieldDefinitionW.</span></span>
  
<span data-ttu-id="3a04b-195">Os elementos de dados neste fluxo são armazenados em uma ordem de byte little-endian, imediatamente após o outro na seguinte ordem especificada:</span><span class="sxs-lookup"><span data-stu-id="3a04b-195">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="3a04b-196">**PropSetGuid**: GUID (16 bytes), o GUID do conjunto de propriedades do nome da propriedade MAPI correspondente do campo de pasta.</span><span class="sxs-lookup"><span data-stu-id="3a04b-196">**PropSetGuid**: GUID (16 bytes), the property set GUID of the folder field's corresponding MAPI property name.</span></span> <span data-ttu-id="3a04b-197">O valor deste campo deve ser igual a PS_PUBLIC_STRINGS, a menos que o tipo de campo seja **ftNone** nesse caso, o valor deste campo deve ser igual a GUID_NULL.</span><span class="sxs-lookup"><span data-stu-id="3a04b-197">This field's value must be equal to PS_PUBLIC_STRINGS, unless the field type is **ftNone** in which case this field's value must be equal to GUID_NULL.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="3a04b-198">Por motivos de compatibilidade herdada, o Outlook pode ser capaz de lidar com alguns valores de **PropSetGuid** que não satisfaçam essa restrição, mas esses casos não são cobertos por este tópico.</span><span class="sxs-lookup"><span data-stu-id="3a04b-198">For reasons of legacy compatibility, Outlook may be able to handle some **PropSetGuid** values not satisfying this restriction, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="3a04b-199">**fcapm**: DWORD (4 bytes), uma combinação de zero ou mais sinalizadores os valores dos quais e significados estão listados na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="3a04b-199">**fcapm**: DWORD (4 bytes), a combination of zero or more flags the values of which and meanings are listed in the following table.</span></span> <span data-ttu-id="3a04b-200">Sinalizadores com o mesmo valor têm significados dependentes do tipo do campo, ou seja, o valor de FldType.</span><span class="sxs-lookup"><span data-stu-id="3a04b-200">Flags with the same value have meanings dependent on the field's type, that is, FldType value.</span></span>
    
    |<span data-ttu-id="3a04b-201">Nome do sinalizador</span><span class="sxs-lookup"><span data-stu-id="3a04b-201">Flag name</span></span>|<span data-ttu-id="3a04b-202">Valor</span><span class="sxs-lookup"><span data-stu-id="3a04b-202">Value</span></span>|<span data-ttu-id="3a04b-203">Significado</span><span class="sxs-lookup"><span data-stu-id="3a04b-203">Meaning</span></span>|
    |:-----|:-----|:-----|
    |<span data-ttu-id="3a04b-204">FCAPM_CAN_EDIT</span><span class="sxs-lookup"><span data-stu-id="3a04b-204">FCAPM_CAN_EDIT</span></span>  <br/> |<span data-ttu-id="3a04b-205">0x00000001</span><span class="sxs-lookup"><span data-stu-id="3a04b-205">0x00000001</span></span>  <br/> |<span data-ttu-id="3a04b-206">O campo é editável.</span><span class="sxs-lookup"><span data-stu-id="3a04b-206">The field is editable.</span></span>  <br/> |
    |<span data-ttu-id="3a04b-207">FCAPM_CAN_SORT</span><span class="sxs-lookup"><span data-stu-id="3a04b-207">FCAPM_CAN_SORT</span></span>  <br/> |<span data-ttu-id="3a04b-208">0x00000002</span><span class="sxs-lookup"><span data-stu-id="3a04b-208">0x00000002</span></span>  <br/> |<span data-ttu-id="3a04b-209">O campo é classificável.</span><span class="sxs-lookup"><span data-stu-id="3a04b-209">The field is sortable.</span></span>  <br/> |
    |<span data-ttu-id="3a04b-210">FCAPM_CAN_GROUP</span><span class="sxs-lookup"><span data-stu-id="3a04b-210">FCAPM_CAN_GROUP</span></span>  <br/> |<span data-ttu-id="3a04b-211">0x00000004</span><span class="sxs-lookup"><span data-stu-id="3a04b-211">0x00000004</span></span>  <br/> |<span data-ttu-id="3a04b-212">O campo é agrupável.</span><span class="sxs-lookup"><span data-stu-id="3a04b-212">The field is groupable.</span></span>  <br/> |
    |<span data-ttu-id="3a04b-213">FCAPM_MULTILINE_TEXT</span><span class="sxs-lookup"><span data-stu-id="3a04b-213">FCAPM_MULTILINE_TEXT</span></span>  <br/> |<span data-ttu-id="3a04b-214">0x00000100</span><span class="sxs-lookup"><span data-stu-id="3a04b-214">0x00000100</span></span>  <br/> |<span data-ttu-id="3a04b-215">O campo pode conter várias linhas de texto.</span><span class="sxs-lookup"><span data-stu-id="3a04b-215">The field can hold multiple lines of text.</span></span>  <br/> |
    |<span data-ttu-id="3a04b-216">FCAPM_PERCENT</span><span class="sxs-lookup"><span data-stu-id="3a04b-216">FCAPM_PERCENT</span></span>  <br/> |<span data-ttu-id="3a04b-217">0x01000000</span><span class="sxs-lookup"><span data-stu-id="3a04b-217">0x01000000</span></span>  <br/> |<span data-ttu-id="3a04b-218">Este campo do tipo ftFloat é um campo de porcentagem.</span><span class="sxs-lookup"><span data-stu-id="3a04b-218">This field of the type ftFloat is a percentage field.</span></span>  <br/> |
    |<span data-ttu-id="3a04b-219">FCAPM_DATEONLY</span><span class="sxs-lookup"><span data-stu-id="3a04b-219">FCAPM_DATEONLY</span></span>  <br/> |<span data-ttu-id="3a04b-220">0x01000000</span><span class="sxs-lookup"><span data-stu-id="3a04b-220">0x01000000</span></span>  <br/> |<span data-ttu-id="3a04b-221">Este campo do tipo ftTime é um campo de hora somente data.</span><span class="sxs-lookup"><span data-stu-id="3a04b-221">This field of the type ftTime is a date-only time field.</span></span>  <br/> |
    |<span data-ttu-id="3a04b-222">FCAPM_UNITLESS</span><span class="sxs-lookup"><span data-stu-id="3a04b-222">FCAPM_UNITLESS</span></span>  <br/> |<span data-ttu-id="3a04b-223">0x01000000</span><span class="sxs-lookup"><span data-stu-id="3a04b-223">0x01000000</span></span>  <br/> |<span data-ttu-id="3a04b-224">Para este campo do tipo ftInteger, nenhuma unidade é permitida no formato de exibição; por exemplo, tais formatos como "computador-640 K..." Não são permitidas.</span><span class="sxs-lookup"><span data-stu-id="3a04b-224">For this field of the type ftInteger, no unit is allowed in display format; for example such formats as "Computer - 640 K…" are not allowed.</span></span>  <br/> |
    |<span data-ttu-id="3a04b-225">FCAPM_CAN_EDIT_IN_ITEM</span><span class="sxs-lookup"><span data-stu-id="3a04b-225">FCAPM_CAN_EDIT_IN_ITEM</span></span>  <br/> |<span data-ttu-id="3a04b-226">0x80000000</span><span class="sxs-lookup"><span data-stu-id="3a04b-226">0x80000000</span></span>  <br/> |<span data-ttu-id="3a04b-227">O campo pode ser editado no item: especificamente para formulários personalizados.</span><span class="sxs-lookup"><span data-stu-id="3a04b-227">The field can be edited in the item: This is specifically for custom forms.</span></span>  <br/> |
   
- <span data-ttu-id="3a04b-228">**dwString**: DWORD (4 bytes).</span><span class="sxs-lookup"><span data-stu-id="3a04b-228">**dwString**: DWORD (4 bytes).</span></span> <span data-ttu-id="3a04b-229">Consulte a primeira anotação a seguir.</span><span class="sxs-lookup"><span data-stu-id="3a04b-229">See the first following Note.</span></span>
    
- <span data-ttu-id="3a04b-230">**dwBitmap**: DWORD (4 bytes).</span><span class="sxs-lookup"><span data-stu-id="3a04b-230">**dwBitmap**: DWORD (4 bytes).</span></span> <span data-ttu-id="3a04b-231">Consulte a primeira anotação a seguir.</span><span class="sxs-lookup"><span data-stu-id="3a04b-231">See the first following Note.</span></span>
    
- <span data-ttu-id="3a04b-232">**dwDisplay**: DWORD (4 bytes).</span><span class="sxs-lookup"><span data-stu-id="3a04b-232">**dwDisplay**: DWORD (4 bytes).</span></span> <span data-ttu-id="3a04b-233">Consulte a primeira anotação a seguir.</span><span class="sxs-lookup"><span data-stu-id="3a04b-233">See the first following Note.</span></span>
    
- <span data-ttu-id="3a04b-234">**iFmt**: int (4 bytes).</span><span class="sxs-lookup"><span data-stu-id="3a04b-234">**iFmt**: INT (4 bytes).</span></span> <span data-ttu-id="3a04b-235">Para os tipos de campo que têm a caixa de combinação "formato:" nas caixas de diálogo "novo campo", "editar campo" e "Propriedades do campo", o índice com base em 0 do formato selecionado na caixa de combinação.</span><span class="sxs-lookup"><span data-stu-id="3a04b-235">For the field types that have the "Format:" combo box in the "New Field", "Edit Field", and "Field Properties" dialogs, the 0-based index of the format selected in that combo box.</span></span> <span data-ttu-id="3a04b-236">Para os tipos de campo sem essa caixa de combinação, deve ser 0.</span><span class="sxs-lookup"><span data-stu-id="3a04b-236">For the field types without that combo box, this must be 0.</span></span> <span data-ttu-id="3a04b-237">O valor do campo junto com o tipo de campo determina exclusivamente os valores dos campos **dwString**, **dwBitmap**e **DwDisplay** , consulte a primeira nota a seguir.</span><span class="sxs-lookup"><span data-stu-id="3a04b-237">The field's value together with the field type uniquely determine the values of the **dwString**, **dwBitmap**, and **dwDisplay** fields, see the first following Note.</span></span>
    
- <span data-ttu-id="3a04b-238">**wszFormulaLength**: Word (2 bytes), o número de elementos na matriz **wszFormulaLength** .</span><span class="sxs-lookup"><span data-stu-id="3a04b-238">**wszFormulaLength**: WORD (2 bytes), the number of elements in the **wszFormulaLength** array.</span></span>
    
- <span data-ttu-id="3a04b-239">**wszFormulaLength**: uma matriz de WCHAR.</span><span class="sxs-lookup"><span data-stu-id="3a04b-239">**wszFormulaLength**: An array of WCHAR.</span></span> <span data-ttu-id="3a04b-240">Esta é a representação Unicode (UTF-16) da cadeia de caracteres de fórmula do campo em seu formato padrão.</span><span class="sxs-lookup"><span data-stu-id="3a04b-240">This is the Unicode (UTF-16) representation of the field's formula string in its standard format.</span></span> <span data-ttu-id="3a04b-241">Consulte a segunda nota para obter a descrição dos formatos padrão e de interface do usuário da fórmula de um campo.</span><span class="sxs-lookup"><span data-stu-id="3a04b-241">See the second following Note for the description of the standard and UI formats of a field's formula.</span></span> <span data-ttu-id="3a04b-242">A contagem dessa matriz é igual a **wszFormulaLength**.</span><span class="sxs-lookup"><span data-stu-id="3a04b-242">The count of this array is equal to **wszFormulaLength**.</span></span> <span data-ttu-id="3a04b-243">A cadeia de caracteres de fórmula deve ser uma cadeia de caracteres vazia, a menos que o tipo de campo seja **ftCalc**, **ftSwitch** ou **ftConcat**.</span><span class="sxs-lookup"><span data-stu-id="3a04b-243">The formula string must be an empty string unless the field type is **ftCalc**, **ftSwitch** or **ftConcat**.</span></span>
    
> [!NOTE]
> <span data-ttu-id="3a04b-244">Embora os valores de **dwString**, **dwBitmap**e **dwDisplay** sejam determinados exclusivamente com base no valor de **FldType** e no valor de **iFmt** , que são redundantes, seus valores corretos ainda são necessários para o correto processamento da definição de campo pelo Outlook.</span><span class="sxs-lookup"><span data-stu-id="3a04b-244">Although the values of **dwString**, **dwBitmap**, and **dwDisplay** are uniquely determined based on the **FldType** value and the **iFmt** value, which are redundant, their correct values are still necessary for correct processing of the field definition by Outlook.</span></span> <span data-ttu-id="3a04b-245">Não há uma descrição simples do algoritmo que realiza essa determinação.</span><span class="sxs-lookup"><span data-stu-id="3a04b-245">There is no simple description of the algorithm that performs this determination.</span></span> 
> 
> <span data-ttu-id="3a04b-246">Portanto, para descobrir quais valores de **dwString**, **dwBitmap**e **dwDisplay** correspondem a um determinado valor **FldType** e **iFmt** , execute um teste criando um campo definido pelo usuário desse tipo e com esse formato selecionado na caixa de combinação **Formatar** , supondo sua aplicabilidade, inspecione o fluxo **FolderUserFields** resultante que o Outlook cria para esse campo definido pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="3a04b-246">Therefore, to find out which **dwString**, **dwBitmap**, and **dwDisplay** values correspond to a given **FldType** value and **iFmt** value, perform a test by creating a user-defined field of that type, and with that format selected in the **Format** combo box, assuming its applicability, inspect the resulting **FolderUserFields** stream that Outlook creates for that user-defined field.</span></span> 
  
<span data-ttu-id="3a04b-247">A fórmula do campo em seu formato de interface do usuário é editada na caixa de texto **fórmula** das caixas de diálogo **novo**campo, **Editar campo**e **Propriedades de campo** para o campo definido pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="3a04b-247">The field's formula in its UI format is edited in the **Formula** text box of the **New Field**, **Edit Field**, and **Field Properties** dialogs for the user-defined field.</span></span> <span data-ttu-id="3a04b-248">O algoritmo para converter uma fórmula do formato de interface do usuário para o formato padrão depende do tipo de campo, conforme descrito no seguinte:</span><span class="sxs-lookup"><span data-stu-id="3a04b-248">The algorithm to convert a formula from the UI format to the standard format depends on the field type as described in the following:</span></span> 
- <span data-ttu-id="3a04b-249">Para campos dos tipos **ftCalc** e **ftSwitch**, o formato padrão para campos internos, quais propriedades MAPI correspondentes não são propriedades nomeadas da cadeia de caracteres de\_tipo MNID, são obtidas pela substituição de fragmentos de nome `[<field_name>]` de campo, ou seja, com fragmentos `[_<field_dispid_decimal>]`.</span><span class="sxs-lookup"><span data-stu-id="3a04b-249">For fields of types **ftCalc** and **ftSwitch**, the standard format for built-in fields, which corresponding MAPI properties are not named properties of the kind MNID\_STRING, is obtained by replacing field name fragments, that is `[<field_name>]` with fragments `[_<field_dispid_decimal>]`.</span></span> 

  <span data-ttu-id="3a04b-250">Por exemplo, se o formato de interface do usuário de uma fórmula para um campo da **fórmula**de tipo, que é **ftCalc**, com o idioma da interface do usuário `[Business Phone] & [My custom field]`do Office `My custom field` em inglês, é, onde é o nome de um campo definido pelo usuário, o formato padrão de tal fórmula seria `[_14856] & [My custom field]`.</span><span class="sxs-lookup"><span data-stu-id="3a04b-250">For example, if the UI format of a formula for a field of the type **Formula**, that is **ftCalc**, with the Office UI language being US English, is `[Business Phone] & [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format of such a formula would be `[_14856] & [My custom field]`.</span></span>

- <span data-ttu-id="3a04b-251">Para campos do tipo **ftConcat**, o formato padrão é obtido executando o seguinte:</span><span class="sxs-lookup"><span data-stu-id="3a04b-251">For fields of the type **ftConcat**, the standard format is obtained by performing the following:</span></span>

  1. <span data-ttu-id="3a04b-252">Truncar espaços em branco à esquerda e à direita.</span><span class="sxs-lookup"><span data-stu-id="3a04b-252">Truncate leading and trailing whitespace.</span></span> 
  2. <span data-ttu-id="3a04b-253">Analise a fórmula em uma sequência de fragmentos dos dois tipos a seguir:</span><span class="sxs-lookup"><span data-stu-id="3a04b-253">Parse the formula into a sequence of fragments of the following two kinds:</span></span> 
     - <span data-ttu-id="3a04b-254">Um nome de campo em colchetes, ou seja, `[<field_name>]`.</span><span class="sxs-lookup"><span data-stu-id="3a04b-254">A field name in square brackets, that is, `[<field_name>]`.</span></span> 
     - <span data-ttu-id="3a04b-255">Uma subcadeia de caracteres que não contém colchetes.</span><span class="sxs-lookup"><span data-stu-id="3a04b-255">A substring not containing any square brackets.</span></span>   
      <span data-ttu-id="3a04b-256">Certifique-se de que não há dois fragmentos do segundo tipo adjacentes na sequência.</span><span class="sxs-lookup"><span data-stu-id="3a04b-256">Assure that no two fragments of the second kind are adjacent in the sequence.</span></span> <span data-ttu-id="3a04b-257">Se a fórmula não pode ser analisada dessa forma, ela é considerada inválida.</span><span class="sxs-lookup"><span data-stu-id="3a04b-257">If the formula cannot be parsed this way, it is considered invalid.</span></span> 
  3. <span data-ttu-id="3a04b-258">Execute a mesma substituição de fragmentos do primeiro tipo para os campos **ftCalc** e **ftSwitch** .</span><span class="sxs-lookup"><span data-stu-id="3a04b-258">Perform the same replacement for fragments of the first kind as for the **ftCalc** and **ftSwitch** fields.</span></span> 
  4. <span data-ttu-id="3a04b-259">Para cada fragmento do segundo tipo, escape todos os caracteres de aspas duplas ("" "), se houver, com dois caracteres consecutivos de aspas duplas e coloque-o entre aspas duplas.</span><span class="sxs-lookup"><span data-stu-id="3a04b-259">For each fragment of the second kind, escape all double-quote (""") characters, if any, with two consecutive double-quote characters, and enclose it in double quotes.</span></span> 
  5. <span data-ttu-id="3a04b-260">Inserir uma cadeia de caracteres`&`de e comercial () entre cada par de fragmentos adjacentes.</span><span class="sxs-lookup"><span data-stu-id="3a04b-260">Insert an ampersand string (`&`) between each pair of adjacent fragments.</span></span>
 
  <span data-ttu-id="3a04b-261">Por exemplo, usando o idioma da interface do usuário do Office inglês dos EUA, se o formato da interface do usuário de uma fórmula `text1 [Business Phone] "text2" [My custom field]`para um `My custom field` campo do tipo **ftConcat** for, onde é o nome de um campo definido pelo usuário, o formato `""text1" & [_14856] & """text2""" & [My custom field]"`padrão para tal fórmula seria.</span><span class="sxs-lookup"><span data-stu-id="3a04b-261">For example, using the Office UI language US English, if the UI format of a formula for a field of the type **ftConcat** is `text1 [Business Phone] "text2" [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format for such a formula would be `""text1" & [_14856] & """text2""" & [My custom field]"`.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="3a04b-262">Confira também</span><span class="sxs-lookup"><span data-stu-id="3a04b-262">See also</span></span>

- [<span data-ttu-id="3a04b-263">Exemplo de fluxo FolderUserFields</span><span class="sxs-lookup"><span data-stu-id="3a04b-263">FolderUserFields Stream Sample</span></span>](folderuserfields-stream-sample.md)
- [<span data-ttu-id="3a04b-264">Adicionar uma definição para um novo campo definido pelo usuário</span><span class="sxs-lookup"><span data-stu-id="3a04b-264">Add a Definition for a New User-Defined Field</span></span>](how-to-add-a-definition-for-a-new-user-defined-field.md)

