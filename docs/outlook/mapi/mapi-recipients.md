---
title: Destinatários MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 88a4360d-6ab8-466e-8ebd-af80227ee00a
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: 6af54b773b875531437a275f14c961a06ef799ff
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22569516"
---
# <a name="mapi-recipients"></a><span data-ttu-id="2a3f0-103">Destinatários MAPI</span><span class="sxs-lookup"><span data-stu-id="2a3f0-103">MAPI Recipients</span></span>

  
  
<span data-ttu-id="2a3f0-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="2a3f0-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="2a3f0-105">Todas as mensagens sejam transmitidas tem um ou mais destinatários, ou um conjunto de propriedades que descrevem a qual a mensagem deve ser entregue.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-105">Every message to be transmitted has one or more recipients, or a set of properties that describe where the message is to be delivered.</span></span> <span data-ttu-id="2a3f0-106">Como os destinatários são usados apenas no contexto de uma mensagem, eles são considerados subobjetos de uma mensagem em vez de objetos separados de MAPI.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-106">Because recipients are used only in the context of a message, they are considered subobjects of a message instead of separate MAPI objects.</span></span> <span data-ttu-id="2a3f0-107">Clientes e provedores trabalham com destinatários usando a interface **IMessage** .</span><span class="sxs-lookup"><span data-stu-id="2a3f0-107">Clients and providers work with recipients using the **IMessage** interface.</span></span> <span data-ttu-id="2a3f0-108">Para obter mais informações, consulte [IMessage: IMAPIProp](imessageimapiprop.md).</span><span class="sxs-lookup"><span data-stu-id="2a3f0-108">For more information, see [IMessage : IMAPIProp](imessageimapiprop.md).</span></span>
  
<span data-ttu-id="2a3f0-109">Os clientes acessam os destinatários da mensagem por meio de sua tabela de destinatário.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-109">Clients access a message's recipients through its recipient table.</span></span> <span data-ttu-id="2a3f0-110">Cada mensagem tem uma tabela de destinatários que contém informações de resumo sobre cada um dos seus destinatários.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-110">Every message has a recipient table that contains summary information about each of its recipients.</span></span> <span data-ttu-id="2a3f0-111">As colunas incluídas na tabela dependem do estado da mensagem.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-111">The columns included in the table depend on the state of the message.</span></span> <span data-ttu-id="2a3f0-112">Quando uma mensagem está sob composição, seus destinatários podem ter apenas três colunas na tabela:</span><span class="sxs-lookup"><span data-stu-id="2a3f0-112">When a message is under composition, its recipients might have only three columns in the table:</span></span>
  
- <span data-ttu-id="2a3f0-113">Nome para exibição ou **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2a3f0-113">Display name, or **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>
    
- <span data-ttu-id="2a3f0-114">Tipo de destinatário ou **PR_RECIPIENT_TYPE** ([PidTagRecipientType](pidtagrecipienttype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2a3f0-114">Recipient type, or **PR_RECIPIENT_TYPE** ([PidTagRecipientType](pidtagrecipienttype-canonical-property.md))</span></span>
    
- <span data-ttu-id="2a3f0-115">Identificador de linha, ou **PR_ROWID** ([PidTagRowid](pidtagrowid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2a3f0-115">Row identifier, or **PR_ROWID** ([PidTagRowid](pidtagrowid-canonical-property.md))</span></span>
    
<span data-ttu-id="2a3f0-116">Depois que a mensagem passou o processo de resolução de nomes, cada destinatário também terão um identificador de entrada ou coluna **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="2a3f0-116">After the message has undergone the name resolution process, each recipient will also have an entry identifier, or **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) column.</span></span> <span data-ttu-id="2a3f0-117">E quando a mensagem foi enviada, as linhas na tabela de destinatário adicionará duas ou mais colunas:</span><span class="sxs-lookup"><span data-stu-id="2a3f0-117">And when the message has been submitted, the rows in the recipient table will add two more columns:</span></span>
  
- <span data-ttu-id="2a3f0-118">Tipo de endereço ou **PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2a3f0-118">Address type, or **PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))</span></span>
    
- <span data-ttu-id="2a3f0-119">Responsabilidade de transporte ou **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="2a3f0-119">Transport responsibility, or **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md))</span></span>
    
<span data-ttu-id="2a3f0-120">Os clientes podem recuperar a tabela de destinatário da mensagem chamando seu método **IMessage::GetRecipientTable** ou seu método de **IMAPIProp::OpenProperty** .</span><span class="sxs-lookup"><span data-stu-id="2a3f0-120">Clients can retrieve a message's recipient table by calling its **IMessage::GetRecipientTable** method or its **IMAPIProp::OpenProperty** method.</span></span> <span data-ttu-id="2a3f0-121">Para obter mais informações, consulte [IMessage::GetRecipientTable](imessage-getrecipienttable.md) e [IMAPIProp::OpenProperty](imapiprop-openproperty.md).</span><span class="sxs-lookup"><span data-stu-id="2a3f0-121">For more information, see [IMessage::GetRecipientTable](imessage-getrecipienttable.md) and [IMAPIProp::OpenProperty](imapiprop-openproperty.md).</span></span> <span data-ttu-id="2a3f0-122">Provedores de armazenamento de mensagem esperados para dar suporte a essas duas abordagens.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-122">Message store providers are expected to support both of these approaches.</span></span> <span data-ttu-id="2a3f0-123">A abordagem de **OpenProperty** requer que o cliente especifica IID_IMAPITable como o identificador de interface e **PR_MESSAGE_RECIPIENTS** como a marca de propriedade.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-123">The **OpenProperty** approach requires that the client specify IID_IMAPITable as the interface identifier and **PR_MESSAGE_RECIPIENTS** as the property tag.</span></span> <span data-ttu-id="2a3f0-124">**PR_MESSAGE_RECIPIENTS** ([PidTagMessageRecipients](pidtagmessagerecipients-canonical-property.md)) é uma propriedade de objeto de tabela que representa a tabela de destinatário da mensagem.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-124">**PR_MESSAGE_RECIPIENTS** ([PidTagMessageRecipients](pidtagmessagerecipients-canonical-property.md)) is a table object property that represents a message's recipient table.</span></span> <span data-ttu-id="2a3f0-125">Provedores de armazenamento de mensagem são necessárias para definir **PR_MESSAGE_RECIPIENTS** para cada mensagem e incluí-lo na matriz de marcas de propriedade retornado pelo método **IMAPIProp::GetPropList** .</span><span class="sxs-lookup"><span data-stu-id="2a3f0-125">Message store providers are required to set **PR_MESSAGE_RECIPIENTS** for each message and include it in the array of property tags returned from the **IMAPIProp::GetPropList** method.</span></span> <span data-ttu-id="2a3f0-126">Para obter mais informações, consulte [IMAPIProp::GetPropList](imapiprop-getproplist.md).</span><span class="sxs-lookup"><span data-stu-id="2a3f0-126">For more information, see [IMAPIProp::GetPropList](imapiprop-getproplist.md).</span></span>
  
<span data-ttu-id="2a3f0-127">Para obter mais informações sobre como trabalhar com uma tabela de destinatário, consulte [As tabelas de destinatário](recipient-tables.md).</span><span class="sxs-lookup"><span data-stu-id="2a3f0-127">For more information about how to work with a recipient table, see [Recipient Tables](recipient-tables.md).</span></span>
  
<span data-ttu-id="2a3f0-128">Além do que está sendo usado para acessar uma tabela de destinatário, **PR_MESSAGE_RECIPIENTS** podem ser usados:</span><span class="sxs-lookup"><span data-stu-id="2a3f0-128">In addition to being used to access a recipient table, **PR_MESSAGE_RECIPIENTS** can be used:</span></span> 
  
- <span data-ttu-id="2a3f0-129">Com **IMAPIProp::CopyTo** ou **IMAPIProp::CopyProps** para excluir ou incluir destinatários ao copiar.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-129">With **IMAPIProp::CopyTo** or **IMAPIProp::CopyProps** to exclude or include recipients when copying.</span></span> <span data-ttu-id="2a3f0-130">Para mais informações, consulte [IMAPIProp::CopyTo](imapiprop-copyto.md) e [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span><span class="sxs-lookup"><span data-stu-id="2a3f0-130">For more information see, [IMAPIProp::CopyTo](imapiprop-copyto.md) and [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span>
    
- <span data-ttu-id="2a3f0-131">Uma restrição subobjeto para indicar que a restrição de filho deve ser aplicadas aos destinatários.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-131">In a subobject restriction to indicate that the child restiction should apply to recipients.</span></span>
    
<span data-ttu-id="2a3f0-132">Os clientes podem adicionar destinatários a uma mensagem Copiando entradas do catálogo de endereços MAPI ou pela criação de novas entradas.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-132">Clients can add recipients to a message by copying entries from the MAPI address book or by creating new entries.</span></span> <span data-ttu-id="2a3f0-133">Essas novas entradas, chamadas algo isolado, podem existir temporariamente ou salvas permanentemente em um contêiner pode ser modificado.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-133">These new entries, called one-offs, can exist temporarily or be saved permanently in a modifiable container.</span></span> <span data-ttu-id="2a3f0-134">Enquanto os destinatários que serão executados do catálogo de endereços têm identificadores de entrada associados ao seu provedor de catálogo de endereços, destinatários únicos têm identificadores de entrada formatados pelo MAPI.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-134">Whereas recipients that are taken from the address book have entry identifiers associated with their address book provider, one-off recipients have entry identifiers that are formatted by MAPI.</span></span> <span data-ttu-id="2a3f0-135">Identificadores de entrada únicos associe de clientes com vários tipos de endereços e provedores de transporte.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-135">Transport providers and clients associate one-off entry identifiers with various types of addresses.</span></span> 
  
<span data-ttu-id="2a3f0-136">**IMAPISupport::CreateOneOff** para criar um identificador de entrada únicos para um endereço em uma saída de chamada de provedores de transporte de mensagem quando:</span><span class="sxs-lookup"><span data-stu-id="2a3f0-136">Transport providers call **IMAPISupport::CreateOneOff** to create a one-off entry identifier for an address on an outgoing message when:</span></span> 
  
- <span data-ttu-id="2a3f0-137">O endereço pertence a um gateway.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-137">The address belongs to a gateway.</span></span>
    
- <span data-ttu-id="2a3f0-138">O endereço não pode ser manipulado por um fornecedor de catálogo de endereços no perfil atual.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-138">The address cannot be handled by an address book provider in the current profile.</span></span>
    
<span data-ttu-id="2a3f0-139">Para obter mais informações, consulte [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md).</span><span class="sxs-lookup"><span data-stu-id="2a3f0-139">For more information, see [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md).</span></span>
  
<span data-ttu-id="2a3f0-140">Clientes chamar **IAddrBook::CreateOneOff** para criar um identificador de entrada únicos para um endereço em uma entrada de mensagem quando:</span><span class="sxs-lookup"><span data-stu-id="2a3f0-140">Clients call **IAddrBook::CreateOneOff** to create a one-off entry identifier for an address on an incoming message when:</span></span> 
  
- <span data-ttu-id="2a3f0-141">O endereço é formatado como um endereço one-off.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-141">The address is formatted as a one-off address.</span></span>
    
- <span data-ttu-id="2a3f0-142">O endereço é formatado como um endereço de Internet.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-142">The address is formatted as an Internet address.</span></span>
    
<span data-ttu-id="2a3f0-143">Para obter mais informações, consulte [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md).</span><span class="sxs-lookup"><span data-stu-id="2a3f0-143">For more information, see [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md).</span></span>
  
<span data-ttu-id="2a3f0-144">Para obter mais informações sobre identificadores de entrada únicos e endereços, consulte [Identificadores de entrada únicos](one-off-entry-identifiers.md) e [Endereços únicos](one-off-addresses.md).</span><span class="sxs-lookup"><span data-stu-id="2a3f0-144">For more information about one-off entry identifiers and addresses, see [One-Off Entry Identifiers](one-off-entry-identifiers.md) and [One-Off Addresses](one-off-addresses.md).</span></span>
  
<span data-ttu-id="2a3f0-145">As propriedades de um destinatário são uma combinação de propriedades do catálogo de endereços e destinatários propriedades específicas.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-145">The properties of a recipient are a combination of address book properties and properties specific to recipients.</span></span> <span data-ttu-id="2a3f0-146">Todos os destinatários tem as propriedades de um endereço base, atribuídas por provedores de catálogo de endereços.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-146">All recipients have the base address properties, assigned by address book providers.</span></span> <span data-ttu-id="2a3f0-147">Quando uma entrada é usada como um destinatário de uma mensagem de saída, as propriedades de um endereço base são copiadas para a estrutura **ADRLIST** que contém as propriedades de todos os destinatários da mensagem.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-147">When an entry is used as a recipient for an outgoing message, the base address properties are copied to the **ADRLIST** structure that holds the properties for all of a message's recipients.</span></span> 
  
<span data-ttu-id="2a3f0-148">Duas propriedades que são definidas especificamente para os destinatários são **PR_RECIPIENT_TYPE** e **PR_RESPONSIBILITY**.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-148">Two properties that are set specifically for recipients are **PR_RECIPIENT_TYPE** and **PR_RESPONSIBILITY**.</span></span> <span data-ttu-id="2a3f0-149">**PR_RECIPIENT_TYPE** indica se um destinatário é primário, cópia carbono, cópia oculta ou um destinatário de reenvio.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-149">**PR_RECIPIENT_TYPE** indicates whether a recipient is a primary, carbon copy, blind carbon copy, or a resend recipient.</span></span> <span data-ttu-id="2a3f0-150">Os três primeiros tipos são atribuídos a destinatários em mensagens que estão sendo enviadas pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-150">The first three types are assigned to recipients on messages that are being sent for the first time.</span></span> 
  
<span data-ttu-id="2a3f0-151">Se um destinatário não receber a mensagem e é feita uma tentativa de enviá-lo novamente, o destinatário é copiado e seu tipo está definido para MAPI_P1 para indicar que se trata de um destinatário de reenvio.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-151">If a recipient does not receive the message and an attempt is made to resend it, the recipient is copied and its type is set to MAPI_P1 to indicate that it is a resend recipient.</span></span> <span data-ttu-id="2a3f0-152">Se apenas alguns dos destinatários recebem uma mensagem, suas propriedades **PR_RECIPIENT_TYPE** são marcadas com a adição do sinalizador MAPI_SUBMITTED quando a mensagem é enviada novamente.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-152">If only some of the recipients receive a message, their **PR_RECIPIENT_TYPE** properties are marked with the addition of the MAPI_SUBMITTED flag when the message is resent.</span></span> <span data-ttu-id="2a3f0-153">Os clientes são necessários para lidar com destinatários principais ou destinatários com seus **PR_RECIPIENT_TYPE** definido como MAPI_TO.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-153">Clients are required to handle primary recipients, or recipients with their **PR_RECIPIENT_TYPE** set to MAPI_TO.</span></span> <span data-ttu-id="2a3f0-154">Todos os outros tipos são opcionais.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-154">All other types are optional.</span></span> 
  
 <span data-ttu-id="2a3f0-155">**PR_RESPONSIBILITY** é definida para indicar ao provedor de transporte se ou não deve lidar enviando ao destinatário.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-155">**PR_RESPONSIBILITY** is set to indicate to the transport provider whether or not it should handle sending to the recipient.</span></span> <span data-ttu-id="2a3f0-156">Quando uma mensagem de saída é enviada pela primeira vez, todos os destinatários defina **PR_RESPONSIBILITY** como FALSE.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-156">When an outgoing message is first sent, all of the recipients set **PR_RESPONSIBILITY** to FALSE.</span></span> <span data-ttu-id="2a3f0-157">Como um provedor de transporte de responsabilidade para enviar a um ou mais dos destinatários de declarações, suas propriedades **PR_RESPONSIBILITY** estiverem definidas como TRUE.</span><span class="sxs-lookup"><span data-stu-id="2a3f0-157">As a transport provider claims responsibility for sending to one or more of the recipients, their **PR_RESPONSIBILITY** properties are set to TRUE.</span></span> 
  

