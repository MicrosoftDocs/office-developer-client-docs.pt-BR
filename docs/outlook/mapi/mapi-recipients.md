---
title: Destinatários MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 88a4360d-6ab8-466e-8ebd-af80227ee00a
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: ebdaf47b4f20763574ffac73bddeb3eb4eeb95df
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33423689"
---
# <a name="mapi-recipients"></a><span data-ttu-id="eb3f8-103">Destinatários MAPI</span><span class="sxs-lookup"><span data-stu-id="eb3f8-103">MAPI Recipients</span></span>

  
  
<span data-ttu-id="eb3f8-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="eb3f8-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="eb3f8-105">Cada mensagem a ser transmitida tem um ou mais destinatários ou um conjunto de propriedades que descrevem onde a mensagem deve ser entregue.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-105">Every message to be transmitted has one or more recipients, or a set of properties that describe where the message is to be delivered.</span></span> <span data-ttu-id="eb3f8-106">Como os destinatários são usados apenas no contexto de uma mensagem, eles são considerados subobjetos de uma mensagem em vez de objetos MAPI separados.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-106">Because recipients are used only in the context of a message, they are considered subobjects of a message instead of separate MAPI objects.</span></span> <span data-ttu-id="eb3f8-107">Clientes e provedores trabalham com destinatários usando a interface **IMessage.**</span><span class="sxs-lookup"><span data-stu-id="eb3f8-107">Clients and providers work with recipients using the **IMessage** interface.</span></span> <span data-ttu-id="eb3f8-108">Para obter mais informações, consulte [IMessage : IMAPIProp](imessageimapiprop.md).</span><span class="sxs-lookup"><span data-stu-id="eb3f8-108">For more information, see [IMessage : IMAPIProp](imessageimapiprop.md).</span></span>
  
<span data-ttu-id="eb3f8-109">Os clientes acessam os destinatários de uma mensagem por meio de sua tabela de destinatários.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-109">Clients access a message's recipients through its recipient table.</span></span> <span data-ttu-id="eb3f8-110">Cada mensagem tem uma tabela de destinatários que contém informações resumidas sobre cada um de seus destinatários.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-110">Every message has a recipient table that contains summary information about each of its recipients.</span></span> <span data-ttu-id="eb3f8-111">As colunas incluídas na tabela dependem do estado da mensagem.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-111">The columns included in the table depend on the state of the message.</span></span> <span data-ttu-id="eb3f8-112">Quando uma mensagem está em composição, seus destinatários podem ter apenas três colunas na tabela:</span><span class="sxs-lookup"><span data-stu-id="eb3f8-112">When a message is under composition, its recipients might have only three columns in the table:</span></span>
  
- <span data-ttu-id="eb3f8-113">Nome para exibição **ou PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="eb3f8-113">Display name, or **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>
    
- <span data-ttu-id="eb3f8-114">Tipo de destinatário ou **PR_RECIPIENT_TYPE** ([PidTagRecipientType](pidtagrecipienttype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="eb3f8-114">Recipient type, or **PR_RECIPIENT_TYPE** ([PidTagRecipientType](pidtagrecipienttype-canonical-property.md))</span></span>
    
- <span data-ttu-id="eb3f8-115">Identificador de linha ou **PR_ROWID** ([PidTagRowid](pidtagrowid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="eb3f8-115">Row identifier, or **PR_ROWID** ([PidTagRowid](pidtagrowid-canonical-property.md))</span></span>
    
<span data-ttu-id="eb3f8-116">Depois que a mensagem passar pelo processo de resolução de nomes, cada destinatário também terá um identificador de entrada ou uma PR_ENTRYID **(** [PidTagEntryId](pidtagentryid-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="eb3f8-116">After the message has undergone the name resolution process, each recipient will also have an entry identifier, or **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) column.</span></span> <span data-ttu-id="eb3f8-117">E quando a mensagem for enviada, as linhas na tabela de destinatários adicionarão mais duas colunas:</span><span class="sxs-lookup"><span data-stu-id="eb3f8-117">And when the message has been submitted, the rows in the recipient table will add two more columns:</span></span>
  
- <span data-ttu-id="eb3f8-118">Tipo de endereço ou **PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="eb3f8-118">Address type, or **PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))</span></span>
    
- <span data-ttu-id="eb3f8-119">Responsabilidade de transporte **ou PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="eb3f8-119">Transport responsibility, or **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md))</span></span>
    
<span data-ttu-id="eb3f8-120">Os clientes podem recuperar a tabela de destinatários de uma mensagem chamando seu método **IMessage::GetRecipientTable** ou seu método **IMAPIProp::OpenProperty.**</span><span class="sxs-lookup"><span data-stu-id="eb3f8-120">Clients can retrieve a message's recipient table by calling its **IMessage::GetRecipientTable** method or its **IMAPIProp::OpenProperty** method.</span></span> <span data-ttu-id="eb3f8-121">Para obter mais informações, consulte [IMessage::GetRecipientTable](imessage-getrecipienttable.md) e [IMAPIProp::OpenProperty](imapiprop-openproperty.md).</span><span class="sxs-lookup"><span data-stu-id="eb3f8-121">For more information, see [IMessage::GetRecipientTable](imessage-getrecipienttable.md) and [IMAPIProp::OpenProperty](imapiprop-openproperty.md).</span></span> <span data-ttu-id="eb3f8-122">Espera-se que os provedores de armazenamento de mensagens deem suporte a essas duas abordagens.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-122">Message store providers are expected to support both of these approaches.</span></span> <span data-ttu-id="eb3f8-123">A **abordagem OpenProperty** exige que o cliente especifique IID_IMAPITable como o identificador da interface e **PR_MESSAGE_RECIPIENTS** como a marca de propriedade.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-123">The **OpenProperty** approach requires that the client specify IID_IMAPITable as the interface identifier and **PR_MESSAGE_RECIPIENTS** as the property tag.</span></span> <span data-ttu-id="eb3f8-124">**PR_MESSAGE_RECIPIENTS** ([PidTagMessageRecipients](pidtagmessagerecipients-canonical-property.md)) é uma propriedade de objeto de tabela que representa a tabela de destinatários de uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-124">**PR_MESSAGE_RECIPIENTS** ([PidTagMessageRecipients](pidtagmessagerecipients-canonical-property.md)) is a table object property that represents a message's recipient table.</span></span> <span data-ttu-id="eb3f8-125">Os provedores de armazenamento  de mensagens são necessários para definir PR_MESSAGE_RECIPIENTS para cada mensagem e incluí-la na matriz de marcas de propriedade retornadas do método **IMAPIProp::GetPropList.**</span><span class="sxs-lookup"><span data-stu-id="eb3f8-125">Message store providers are required to set **PR_MESSAGE_RECIPIENTS** for each message and include it in the array of property tags returned from the **IMAPIProp::GetPropList** method.</span></span> <span data-ttu-id="eb3f8-126">Para obter mais informações, [consulte IMAPIProp::GetPropList](imapiprop-getproplist.md).</span><span class="sxs-lookup"><span data-stu-id="eb3f8-126">For more information, see [IMAPIProp::GetPropList](imapiprop-getproplist.md).</span></span>
  
<span data-ttu-id="eb3f8-127">Para obter mais informações sobre como trabalhar com uma tabela de destinatários, consulte [Tabelas de Destinatários.](recipient-tables.md)</span><span class="sxs-lookup"><span data-stu-id="eb3f8-127">For more information about how to work with a recipient table, see [Recipient Tables](recipient-tables.md).</span></span>
  
<span data-ttu-id="eb3f8-128">Além de ser usado para acessar uma tabela de destinatários, **PR_MESSAGE_RECIPIENTS** pode ser usado:</span><span class="sxs-lookup"><span data-stu-id="eb3f8-128">In addition to being used to access a recipient table, **PR_MESSAGE_RECIPIENTS** can be used:</span></span> 
  
- <span data-ttu-id="eb3f8-129">Com **IMAPIProp::CopyTo** ou **IMAPIProp::CopyProps** para excluir ou incluir destinatários ao copiar.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-129">With **IMAPIProp::CopyTo** or **IMAPIProp::CopyProps** to exclude or include recipients when copying.</span></span> <span data-ttu-id="eb3f8-130">Para obter mais informações, [consulte IMAPIProp::CopyTo](imapiprop-copyto.md) e [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span><span class="sxs-lookup"><span data-stu-id="eb3f8-130">For more information see, [IMAPIProp::CopyTo](imapiprop-copyto.md) and [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span>
    
- <span data-ttu-id="eb3f8-131">Em uma restrição de subobjeto para indicar que a resticção filha deve se aplicar aos destinatários.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-131">In a subobject restriction to indicate that the child restiction should apply to recipients.</span></span>
    
<span data-ttu-id="eb3f8-132">Os clientes podem adicionar destinatários a uma mensagem copiando entradas do livro de endereços MAPI ou criando novas entradas.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-132">Clients can add recipients to a message by copying entries from the MAPI address book or by creating new entries.</span></span> <span data-ttu-id="eb3f8-133">Essas novas entradas, chamadas de one-offs, podem existir temporariamente ou ser salvas permanentemente em um contêiner modificável.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-133">These new entries, called one-offs, can exist temporarily or be saved permanently in a modifiable container.</span></span> <span data-ttu-id="eb3f8-134">Enquanto os destinatários que são retirados do livro de endereços têm identificadores de entrada associados ao seu provedor de agendas, os destinatários one-off têm identificadores de entrada formatados por MAPI.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-134">Whereas recipients that are taken from the address book have entry identifiers associated with their address book provider, one-off recipients have entry identifiers that are formatted by MAPI.</span></span> <span data-ttu-id="eb3f8-135">Provedores de transporte e clientes associam identificadores de entrada único a vários tipos de endereços.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-135">Transport providers and clients associate one-off entry identifiers with various types of addresses.</span></span> 
  
<span data-ttu-id="eb3f8-136">Os provedores de transporte chamam **IMAPISupport::CreateOneOff** para criar um identificador de entrada único para um endereço em uma mensagem de saída quando:</span><span class="sxs-lookup"><span data-stu-id="eb3f8-136">Transport providers call **IMAPISupport::CreateOneOff** to create a one-off entry identifier for an address on an outgoing message when:</span></span> 
  
- <span data-ttu-id="eb3f8-137">O endereço pertence a um gateway.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-137">The address belongs to a gateway.</span></span>
    
- <span data-ttu-id="eb3f8-138">O endereço não pode ser manipulado por um provedor de agendas no perfil atual.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-138">The address cannot be handled by an address book provider in the current profile.</span></span>
    
<span data-ttu-id="eb3f8-139">Para obter mais informações, [consulte IMAPISupport::CreateOneOff](imapisupport-createoneoff.md).</span><span class="sxs-lookup"><span data-stu-id="eb3f8-139">For more information, see [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md).</span></span>
  
<span data-ttu-id="eb3f8-140">Os clientes **chamam IAddrBook::CreateOneOff** para criar um identificador de entrada único para um endereço em uma mensagem de entrada quando:</span><span class="sxs-lookup"><span data-stu-id="eb3f8-140">Clients call **IAddrBook::CreateOneOff** to create a one-off entry identifier for an address on an incoming message when:</span></span> 
  
- <span data-ttu-id="eb3f8-141">O endereço é formatado como um endereço único.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-141">The address is formatted as a one-off address.</span></span>
    
- <span data-ttu-id="eb3f8-142">O endereço é formatado como um endereço da Internet.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-142">The address is formatted as an Internet address.</span></span>
    
<span data-ttu-id="eb3f8-143">Para obter mais informações, consulte [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md).</span><span class="sxs-lookup"><span data-stu-id="eb3f8-143">For more information, see [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md).</span></span>
  
<span data-ttu-id="eb3f8-144">Para obter mais informações sobre endereços e identificadores de entrada único, consulte [One-Off Entry Identifiers](one-off-entry-identifiers.md) and [One-Off Addresses](one-off-addresses.md).</span><span class="sxs-lookup"><span data-stu-id="eb3f8-144">For more information about one-off entry identifiers and addresses, see [One-Off Entry Identifiers](one-off-entry-identifiers.md) and [One-Off Addresses](one-off-addresses.md).</span></span>
  
<span data-ttu-id="eb3f8-145">As propriedades de um destinatário são uma combinação de propriedades do livro de endereços e propriedades específicas para destinatários.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-145">The properties of a recipient are a combination of address book properties and properties specific to recipients.</span></span> <span data-ttu-id="eb3f8-146">Todos os destinatários têm as propriedades de endereço base, atribuídas por provedores de livro de endereços.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-146">All recipients have the base address properties, assigned by address book providers.</span></span> <span data-ttu-id="eb3f8-147">Quando uma entrada é usada como destinatário de uma mensagem de saída, as propriedades de endereço base são copiadas para a estrutura **ADRLIST** que contém as propriedades de todos os destinatários de uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-147">When an entry is used as a recipient for an outgoing message, the base address properties are copied to the **ADRLIST** structure that holds the properties for all of a message's recipients.</span></span> 
  
<span data-ttu-id="eb3f8-148">Duas propriedades que são definidas especificamente para destinatários são **PR_RECIPIENT_TYPE** e **PR_RESPONSIBILITY**.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-148">Two properties that are set specifically for recipients are **PR_RECIPIENT_TYPE** and **PR_RESPONSIBILITY**.</span></span> <span data-ttu-id="eb3f8-149">**PR_RECIPIENT_TYPE** indica se um destinatário é primário, com cópia carbono, com cópia carbono ou um destinatário reend.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-149">**PR_RECIPIENT_TYPE** indicates whether a recipient is a primary, carbon copy, blind carbon copy, or a resend recipient.</span></span> <span data-ttu-id="eb3f8-150">Os três primeiros tipos são atribuídos a destinatários em mensagens que estão sendo enviadas pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-150">The first three types are assigned to recipients on messages that are being sent for the first time.</span></span> 
  
<span data-ttu-id="eb3f8-151">Se um destinatário não receber a mensagem e for feita uma tentativa de reendá-la, o destinatário será copiado e seu tipo será definido como MAPI_P1 para indicar que é um destinatário de reend.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-151">If a recipient does not receive the message and an attempt is made to resend it, the recipient is copied and its type is set to MAPI_P1 to indicate that it is a resend recipient.</span></span> <span data-ttu-id="eb3f8-152">Se apenas alguns dos destinatários receberem uma mensagem, suas PR_RECIPIENT_TYPE propriedades serão marcadas com a adição do sinalizador de MAPI_SUBMITTED quando a mensagem for reente. </span><span class="sxs-lookup"><span data-stu-id="eb3f8-152">If only some of the recipients receive a message, their **PR_RECIPIENT_TYPE** properties are marked with the addition of the MAPI_SUBMITTED flag when the message is resent.</span></span> <span data-ttu-id="eb3f8-153">Os clientes são obrigados a lidar com destinatários primários ou destinatários com seus **PR_RECIPIENT_TYPE** definidos como MAPI_TO.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-153">Clients are required to handle primary recipients, or recipients with their **PR_RECIPIENT_TYPE** set to MAPI_TO.</span></span> <span data-ttu-id="eb3f8-154">Todos os outros tipos são opcionais.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-154">All other types are optional.</span></span> 
  
 <span data-ttu-id="eb3f8-155">**PR_RESPONSIBILITY** é definido para indicar ao provedor de transporte se ele deve ou não lidar com o envio ao destinatário.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-155">**PR_RESPONSIBILITY** is set to indicate to the transport provider whether or not it should handle sending to the recipient.</span></span> <span data-ttu-id="eb3f8-156">Quando uma mensagem de saída é enviada pela primeira vez, todos os destinatários PR_RESPONSIBILITY **como** FALSO.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-156">When an outgoing message is first sent, all of the recipients set **PR_RESPONSIBILITY** to FALSE.</span></span> <span data-ttu-id="eb3f8-157">Como um provedor de transporte declara a responsabilidade pelo envio a um ou mais dos destinatários, suas PR_RESPONSIBILITY **propriedades** são definidas como TRUE.</span><span class="sxs-lookup"><span data-stu-id="eb3f8-157">As a transport provider claims responsibility for sending to one or more of the recipients, their **PR_RESPONSIBILITY** properties are set to TRUE.</span></span> 
  

