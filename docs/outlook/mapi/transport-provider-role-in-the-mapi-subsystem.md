---
title: Função do provedor de transporte no subsistema MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7659369a-0952-4f5a-a86b-91958c4c1a3f
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: 7cadb57706e3feec7ed98dd5e4e8d75967036fef
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33424053"
---
# <a name="transport-provider-role-in-the-mapi-subsystem"></a><span data-ttu-id="6e5e5-103">Função do provedor de transporte no subsistema MAPI</span><span class="sxs-lookup"><span data-stu-id="6e5e5-103">Transport provider role in the MAPI subsystem</span></span>
  
<span data-ttu-id="6e5e5-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="6e5e5-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="6e5e5-105">As bibliotecas de vínculo dinâmico (DLLs) do provedor de transporte fornecem a interface entre o spooler do MAPI e a parte de um sistema de mensagens responsável pelo envio e recebimento de mensagens.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-105">Transport provider dynamic-link libraries (DLLs) provide the interface between the MAPI spooler and the part of a messaging system responsible for message sending and receiving.</span></span> <span data-ttu-id="6e5e5-106">O spooler MAPI e o provedor de transporte trabalham juntos para lidar com as responsabilidades de envio de uma mensagem ou de recebimento de uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-106">The MAPI spooler and the transport provider work together to handle the responsibilities of sending a message or receiving a message.</span></span> <span data-ttu-id="6e5e5-107">O spooler MAPI carrega a DLL do provedor de transporte quando é usado pela primeira vez e a libera quando não é mais necessário.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-107">The MAPI spooler loads the transport provider DLL when it is first used and releases it when it is no longer needed.</span></span> <span data-ttu-id="6e5e5-108">Vários provedores de transporte podem ser instalados no mesmo sistema, mas o MAPI fornece o único spooler necessário.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-108">Multiple transport providers can be installed on the same system, but MAPI supplies the one spooler required.</span></span>
  
<span data-ttu-id="6e5e5-109">Os aplicativos clientes normalmente não se comunicam diretamente com o provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-109">Client applications do not typically communicate directly with the transport provider.</span></span> <span data-ttu-id="6e5e5-110">Em vez disso, os clientes enviam mensagens por meio de um provedor de armazenamento e o spooler MAPI envia mensagens de saída para o provedor de transporte apropriado e entrega mensagens de entrada para o repositório de mensagens apropriado.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-110">Rather, clients submit messages through a store provider and the MAPI spooler sends outgoing messages to the appropriate transport provider and delivers incoming messages to the appropriate message store.</span></span> <span data-ttu-id="6e5e5-111">O MAPI spooler funciona e faz suas chamadas para provedores de transporte quando os aplicativos de primeiro plano estiverem ociosos.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-111">The MAPI spooler does its work and makes its calls to transport providers when foreground applications are idle.</span></span> <span data-ttu-id="6e5e5-112">Depois de exibir opcionalmente caixas de diálogo quando o provedor de transporte é conectado pela primeira vez, os provedores de transporte operam em segundo plano, a menos que o cliente tenha sido chamado pelo cliente para liberar filas de envio e recebimento.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-112">After optionally displaying dialog boxes when the transport provider is first logged on, transport providers operate in the background unless called by the client to flush send and receive queues.</span></span> 
  
<span data-ttu-id="6e5e5-113">Os provedores de transporte têm as seguintes responsabilidades em um sistema de mensagens MAPI:</span><span class="sxs-lookup"><span data-stu-id="6e5e5-113">Transport providers have the following responsibilities in a MAPI messaging system:</span></span>
  
- <span data-ttu-id="6e5e5-114">Registre os tipos de endereço que eles podem aceitar com o spooler MAPI, para que o spooler MAPI possa enviar mensagens ao provedor de transporte apropriado, dependendo do endereço de destino das mensagens.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-114">Register the address types they can accept with the MAPI spooler so the MAPI spooler can submit messages to the appropriate transport provider depending on the destination address of the messages.</span></span> <span data-ttu-id="6e5e5-115">Um provedor de transporte pode registrar mais de um tipo de endereço.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-115">One transport provider can register more than one address type.</span></span> <span data-ttu-id="6e5e5-116">Os provedores de transporte também podem registrar endereços de destinatários específicos com o spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-116">Transport providers can also register specific recipients' addresses with the MAPI spooler.</span></span> <span data-ttu-id="6e5e5-117">As mensagens endereçadas a um desses endereços serão enviadas ao provedor de transporte que registrou o endereço com o spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-117">Messages addressed to one of these addresses will be submitted to the transport provider that registered the address with the MAPI spooler.</span></span> <span data-ttu-id="6e5e5-118">Para obter mais informações, consulte [Transport Provider and MAPI spooler operaTing Model](transport-provider-and-mapi-spooler-operational-model.md).</span><span class="sxs-lookup"><span data-stu-id="6e5e5-118">For more information, see [Transport Provider and MAPI Spooler Operational Model](transport-provider-and-mapi-spooler-operational-model.md).</span></span>
    
- <span data-ttu-id="6e5e5-119">Entregar mensagens de entrada para o spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-119">Deliver incoming messages to the MAPI spooler.</span></span> <span data-ttu-id="6e5e5-120">Dependendo da natureza do sistema de mensagens, um provedor de transporte pode notificar diretamente o spooler MAPI quando uma nova mensagem chega ou pode solicitar que o spooler MAPI sondar o provedor de transporte periodicamente para verificar se há novas mensagens.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-120">Depending on the nature of the messaging system, a transport provider can either directly notify the MAPI spooler when a new message arrives, or it can request that the MAPI spooler poll the transport provider periodically to check for new messages.</span></span>
    
- <span data-ttu-id="6e5e5-121">Converter Propriedades de mensagens MAPI de e para propriedades de mensagens nativas para o sistema de mensagens.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-121">Convert MAPI message properties to and from message properties native to the messaging system.</span></span> <span data-ttu-id="6e5e5-122">Por exemplo, o provedor de transporte pode ter que converter os endereços do remetente e do destinatário em uma mensagem de saída para um formato que seja aceitável para o sistema de mensagens.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-122">For example, the transport provider might have to convert the sender's and recipient's addresses in an outgoing message to a form that is acceptable to the messaging system.</span></span> <span data-ttu-id="6e5e5-123">Alguns sistemas de mensagens não dão suporte a todas as propriedades de mensagens MAPI.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-123">Some messaging systems do not support all of the MAPI message properties.</span></span> <span data-ttu-id="6e5e5-124">Para obter mais informações sobre como preservar as propriedades de mensagens MAPI ao entregar mensagens a um sistema de mensagens, consulte [Developing a TNEF-Enabled Transport Provider](developing-a-tnef-enabled-transport-provider.md).</span><span class="sxs-lookup"><span data-stu-id="6e5e5-124">For more information about preserving MAPI message properties when delivering messages to a messaging system, see [Developing a TNEF-Enabled Transport Provider](developing-a-tnef-enabled-transport-provider.md).</span></span>
    
- <span data-ttu-id="6e5e5-125">Registre as opções de mensagem e destinatário específicas para o provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-125">Register message and recipient options specific to the transport provider.</span></span>
    
- <span data-ttu-id="6e5e5-126">Execute qualquer verificação de credenciais exigidas pelo sistema de mensagens.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-126">Perform any verification of credentials required by the messaging system.</span></span>
    
- <span data-ttu-id="6e5e5-127">Acessar mensagens de saída usando o objeto Message passado para ele pelo spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-127">Access outbound messages using the message object passed to it by the MAPI spooler.</span></span>
    
- <span data-ttu-id="6e5e5-128">Traduza o formato de mensagem conforme exigido pelo sistema de mensagens subjacente.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-128">Translate message format as required by the underlying messaging system.</span></span>
    
- <span data-ttu-id="6e5e5-129">Notificar o MAPI spooler de que os destinatários de uma mensagem de saída o provedor de transporte aceitou a responsabilidade de tratamento, definindo a propriedade **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) para esses destinatários.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-129">Notify the MAPI spooler which recipients of an outgoing message the transport provider has accepted responsibility for handling by setting the **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) property for those recipients.</span></span>
    
- <span data-ttu-id="6e5e5-130">Informe o spooler MAPI quando uma mensagem de entrada precisa ser manipulada.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-130">Inform the MAPI spooler when an incoming message needs to be handled.</span></span>
    
- <span data-ttu-id="6e5e5-131">Transmitir dados de mensagem de entrada para o spooler MAPI usando objetos Message.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-131">Pass incoming message data to the MAPI spooler by using message objects.</span></span>
    
- <span data-ttu-id="6e5e5-132">Atribua valores a todas as propriedades de mensagem MAPI necessárias em mensagens de entrada.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-132">Assign values to all required MAPI message properties on incoming messages.</span></span>
    
- <span data-ttu-id="6e5e5-133">Exclua a mensagem do sistema de mensagens subjacente após a entrega, se necessário.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-133">Delete the message from the underlying messaging system after delivery, if necessary.</span></span>
    
- <span data-ttu-id="6e5e5-134">Fornecer informações de status para o spooler MAPI e aplicativos cliente.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-134">Provide status information for the MAPI spooler and client applications.</span></span>
    
<span data-ttu-id="6e5e5-135">A ilustração a seguir mostra a função de um provedor de transporte com relação aos outros componentes da arquitetura MAPI.</span><span class="sxs-lookup"><span data-stu-id="6e5e5-135">The following illustration shows a transport provider's role with respect to the other components of the MAPI architecture.</span></span>
  
<span data-ttu-id="6e5e5-136">**Transport provider role in a messaging system**</span><span class="sxs-lookup"><span data-stu-id="6e5e5-136">**Transport provider role in a messaging system**</span></span>
  
<span data-ttu-id="6e5e5-137">![Função do provedor de transporte em um sistema de mensagens] (media/xp01.gif "Função do provedor de transporte em um sistema de mensagens")</span><span class="sxs-lookup"><span data-stu-id="6e5e5-137">![Transport provider role in a messaging system](media/xp01.gif "Transport provider role in a messaging system")</span></span>
  

