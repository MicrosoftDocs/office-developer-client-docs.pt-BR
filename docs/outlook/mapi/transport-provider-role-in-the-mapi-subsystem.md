---
title: Função do provedor de transporte no subsistema de MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7659369a-0952-4f5a-a86b-91958c4c1a3f
description: '�ltima altera��o: s�bado, 23 de julho de 2011'
ms.openlocfilehash: 263370590a35f19482cc5ad7e56c65f6df0087fa
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22581297"
---
# <a name="transport-provider-role-in-the-mapi-subsystem"></a><span data-ttu-id="3ecf4-103">Função do provedor de transporte no subsistema de MAPI</span><span class="sxs-lookup"><span data-stu-id="3ecf4-103">Transport provider role in the MAPI subsystem</span></span>
  
<span data-ttu-id="3ecf4-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="3ecf4-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="3ecf4-105">Bibliotecas de vínculo dinâmico de provedor de transporte (DLLs) fornecem a interface entre o spooler MAPI e a parte de um sistema de mensagens responsável pelo envio e recebimento de mensagens.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-105">Transport provider dynamic-link libraries (DLLs) provide the interface between the MAPI spooler and the part of a messaging system responsible for message sending and receiving.</span></span> <span data-ttu-id="3ecf4-106">O spooler MAPI e o provedor de transporte funcionam em conjunto para lidar com as responsabilidades de enviar uma mensagem ou receber uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-106">The MAPI spooler and the transport provider work together to handle the responsibilities of sending a message or receiving a message.</span></span> <span data-ttu-id="3ecf4-107">O MAPI spooler carrega o provedor de transporte DLL quando ele é usado inicialmente e libera-lo quando ele não é mais necessária.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-107">The MAPI spooler loads the transport provider DLL when it is first used and releases it when it is no longer needed.</span></span> <span data-ttu-id="3ecf4-108">Vários provedores de transporte que podem ser instalados no mesmo sistema, mas MAPI fornece o spooler de um necessários.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-108">Multiple transport providers can be installed on the same system, but MAPI supplies the one spooler required.</span></span>
  
<span data-ttu-id="3ecf4-109">Aplicativos cliente não normalmente se comunicam diretamente com o provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-109">Client applications do not typically communicate directly with the transport provider.</span></span> <span data-ttu-id="3ecf4-110">Em vez disso, clientes enviar mensagens por meio de um provedor de armazenamento e o MAPI spooler envia mensagens de saída para o provedor de transporte apropriadas e entrega de mensagens de entrada para o repositório de mensagem apropriada.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-110">Rather, clients submit messages through a store provider and the MAPI spooler sends outgoing messages to the appropriate transport provider and delivers incoming messages to the appropriate message store.</span></span> <span data-ttu-id="3ecf4-111">O MAPI spooler faz o seu trabalho e faz suas chamadas para provedores de transporte quando os aplicativos de primeiro plano ociosos.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-111">The MAPI spooler does its work and makes its calls to transport providers when foreground applications are idle.</span></span> <span data-ttu-id="3ecf4-112">Depois, opcionalmente, exibindo caixas de diálogo quando o provedor de transporte é primeiro logon, provedores de transporte operam em segundo plano, a menos que chamado pelo cliente flush enviem e recebam filas.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-112">After optionally displaying dialog boxes when the transport provider is first logged on, transport providers operate in the background unless called by the client to flush send and receive queues.</span></span> 
  
<span data-ttu-id="3ecf4-113">Provedores de transporte tem as seguintes responsabilidades em um sistema de mensagens de MAPI:</span><span class="sxs-lookup"><span data-stu-id="3ecf4-113">Transport providers have the following responsibilities in a MAPI messaging system:</span></span>
  
- <span data-ttu-id="3ecf4-114">Registre os tipos de endereço que eles podem aceitar o MAPI spooler portanto o MAPI spooler pode enviar mensagens para o provedor de transporte apropriadas dependendo das mensagens, o endereço de destino.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-114">Register the address types they can accept with the MAPI spooler so the MAPI spooler can submit messages to the appropriate transport provider depending on the destination address of the messages.</span></span> <span data-ttu-id="3ecf4-115">Um provedor de transporte pode registrar mais de um tipo de endereço.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-115">One transport provider can register more than one address type.</span></span> <span data-ttu-id="3ecf4-116">Provedores de transporte também podem registrar os endereços de destinatários específicos com o spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-116">Transport providers can also register specific recipients' addresses with the MAPI spooler.</span></span> <span data-ttu-id="3ecf4-117">As mensagens endereçadas a um desses endereços serão enviadas para o provedor de transporte que registrou o endereço com o spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-117">Messages addressed to one of these addresses will be submitted to the transport provider that registered the address with the MAPI spooler.</span></span> <span data-ttu-id="3ecf4-118">Para obter mais informações, consulte o [provedor de transporte e o modelo operacional do Spooler de MAPI](transport-provider-and-mapi-spooler-operational-model.md).</span><span class="sxs-lookup"><span data-stu-id="3ecf4-118">For more information, see [Transport Provider and MAPI Spooler Operational Model](transport-provider-and-mapi-spooler-operational-model.md).</span></span>
    
- <span data-ttu-id="3ecf4-119">Entrega mensagens de entrada para o spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-119">Deliver incoming messages to the MAPI spooler.</span></span> <span data-ttu-id="3ecf4-120">Dependendo da natureza do sistema de mensagens, um provedor de transporte pode seja diretamente notificar o MAPI spooler quando uma nova mensagem chega ou ele pode solicitar que o MAPI spooler sondar o provedor de transporte periodicamente para verificar se há novas mensagens.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-120">Depending on the nature of the messaging system, a transport provider can either directly notify the MAPI spooler when a new message arrives, or it can request that the MAPI spooler poll the transport provider periodically to check for new messages.</span></span>
    
- <span data-ttu-id="3ecf4-121">Converta propriedades de mensagem MAPI para e de propriedades de mensagem nativas do sistema de mensagens.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-121">Convert MAPI message properties to and from message properties native to the messaging system.</span></span> <span data-ttu-id="3ecf4-122">Por exemplo, o provedor de transporte pode precisar converter endereços do remetente e do destinatário em uma mensagem de saída em um formulário que é aceitável para o sistema de mensagens.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-122">For example, the transport provider might have to convert the sender's and recipient's addresses in an outgoing message to a form that is acceptable to the messaging system.</span></span> <span data-ttu-id="3ecf4-123">Alguns sistemas de mensagens não suportam todas as propriedades de mensagem MAPI.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-123">Some messaging systems do not support all of the MAPI message properties.</span></span> <span data-ttu-id="3ecf4-124">Para obter mais informações sobre como preservar as propriedades de mensagem MAPI quando a entrega de mensagens para um sistema de mensagens, consulte [desenvolvendo um provedor de transporte TNEF-Enabled](developing-a-tnef-enabled-transport-provider.md).</span><span class="sxs-lookup"><span data-stu-id="3ecf4-124">For more information about preserving MAPI message properties when delivering messages to a messaging system, see [Developing a TNEF-Enabled Transport Provider](developing-a-tnef-enabled-transport-provider.md).</span></span>
    
- <span data-ttu-id="3ecf4-125">Registre as opções de mensagem e destinatário específicas do provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-125">Register message and recipient options specific to the transport provider.</span></span>
    
- <span data-ttu-id="3ecf4-126">Execute qualquer verificação de credenciais exigidos pelo sistema de mensagens.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-126">Perform any verification of credentials required by the messaging system.</span></span>
    
- <span data-ttu-id="3ecf4-127">Mensagens de saída do Access usando o objeto de mensagem passadas pelo spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-127">Access outbound messages using the message object passed to it by the MAPI spooler.</span></span>
    
- <span data-ttu-id="3ecf4-128">Traduza o formato da mensagem conforme exigido pelo sistema de mensagens subjacente.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-128">Translate message format as required by the underlying messaging system.</span></span>
    
- <span data-ttu-id="3ecf4-129">Notifica o MAPI spooler quais destinatários de uma mensagem de saída que o provedor de transporte aceitou a responsabilidade para tratamento definindo a propriedade **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) para os destinatários.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-129">Notify the MAPI spooler which recipients of an outgoing message the transport provider has accepted responsibility for handling by setting the **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) property for those recipients.</span></span>
    
- <span data-ttu-id="3ecf4-130">Informe o MAPI spooler quando uma mensagem de entrada precisa ser manipulados.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-130">Inform the MAPI spooler when an incoming message needs to be handled.</span></span>
    
- <span data-ttu-id="3ecf4-131">Passe dados de mensagem de entrada para o MAPI spooler usando objetos de mensagem.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-131">Pass incoming message data to the MAPI spooler by using message objects.</span></span>
    
- <span data-ttu-id="3ecf4-132">Atribua valores para todas as propriedades obrigatórias de mensagem MAPI em mensagens de entrada.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-132">Assign values to all required MAPI message properties on incoming messages.</span></span>
    
- <span data-ttu-id="3ecf4-133">Exclua a mensagem do sistema de mensagens subjacente após a entrega, se necessário.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-133">Delete the message from the underlying messaging system after delivery, if necessary.</span></span>
    
- <span data-ttu-id="3ecf4-134">Fornecer informações de status para os aplicativos cliente e o spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-134">Provide status information for the MAPI spooler and client applications.</span></span>
    
<span data-ttu-id="3ecf4-135">A ilustração a seguir mostra a função de um provedor de transporte com relação as outros componentes da arquitetura do MAPI.</span><span class="sxs-lookup"><span data-stu-id="3ecf4-135">The following illustration shows a transport provider's role with respect to the other components of the MAPI architecture.</span></span>
  
<span data-ttu-id="3ecf4-136">**Transport provider role in a messaging system**</span><span class="sxs-lookup"><span data-stu-id="3ecf4-136">**Transport provider role in a messaging system**</span></span>
  
<span data-ttu-id="3ecf4-137">![Função do provedor de transporte em um sistema de mensagens] (media/xp01.gif "Função do provedor de transporte em um sistema de mensagens")</span><span class="sxs-lookup"><span data-stu-id="3ecf4-137">![Transport provider role in a messaging system](media/xp01.gif "Transport provider role in a messaging system")</span></span>
  

