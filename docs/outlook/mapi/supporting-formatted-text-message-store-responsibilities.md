---
title: Responsabilidades do armazenamento de mensagens de texto formatado de suporte
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a97993c2-52e4-4b71-ac03-2c02d82447d8
description: 'Última modificação: 9 de março de 2015'
ms.openlocfilehash: d5f4be5a8593cfc483dfed1cffbb59f596e2e408
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22567647"
---
# <a name="supporting-formatted-text-message-store-responsibilities"></a><span data-ttu-id="a2ba7-103">Suporte a texto formatado: responsabilidades do repositório de mensagens</span><span class="sxs-lookup"><span data-stu-id="a2ba7-103">Supporting Formatted Text: Message Store Responsibilities</span></span>

  
  
<span data-ttu-id="a2ba7-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a2ba7-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="a2ba7-105">Provedores de armazenamento de mensagem usam a propriedade de **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) para publicar se ou não podem lidar com Rich Text Format (RTF), texto HTML e, se ela sabe RTF, se eles armazenam o texto formatado em uma formato compactado ou descompactado.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-105">Message store providers use the **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property to publish whether or not they can handle Rich Text Format (RTF), HTML text and, if they are RTF-aware, whether they store the formatted text in a compressed or uncompressed format.</span></span> <span data-ttu-id="a2ba7-106">Provedores de armazenamento de mensagem indicam que eles estão cientes de RTF definindo o bit STORE_RTF_OK e que armazenam o texto formatado em um formulário descompactado definindo o bit STORE_UNCOMPRESSED_RTF.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-106">Message store providers indicate that they are RTF-aware by setting the STORE_RTF_OK bit and that they store the formatted text in an uncompressed form by setting the STORE_UNCOMPRESSED_RTF bit.</span></span> <span data-ttu-id="a2ba7-107">Provedores de armazenamento de mensagem indicam são reconhecem HTML definindo o bit STORE_HTML_OK.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-107">Message store providers indicate they are HTML-aware by setting the STORE_HTML_OK bit.</span></span>
  
<span data-ttu-id="a2ba7-108">Embora seja importante para um cliente de reconhecimento de RTF verificar se há o STORE_RTF_OK bit para determinar se ou não um armazenamento de mensagens suporta RTF, não é necessário para um cliente se preocupar com o formato de texto formatado de um repositório reconhecimento de RTF.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-108">While it is important for an RTF-aware client to check for the STORE_RTF_OK bit to determine whether or not a message store supports RTF, it is not necessary for a client to be concerned with the format of an RTF-aware store's formatted text.</span></span> 
  
<span data-ttu-id="a2ba7-109">Todos os repositórios de mensagem devem oferecer suporte a clientes sem reconhecimento de RTF.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-109">All message stores must support non-RTF-aware clients.</span></span> <span data-ttu-id="a2ba7-110">Um armazenamento de mensagens sem reconhecimento de RTF deve excluir a propriedade **PR_RTF_IN_SYNC** ([PidTagRtfInSync](pidtagrtfinsync-canonical-property.md)) durante uma chamada para o método de [IMAPIProp::SaveChanges](imapiprop-savechanges.md) da mensagem se um cliente não tiver alterado **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) sem Atualizando **PR_RTF_IN_SYNC** ou **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="a2ba7-110">A non-RTF-aware message store must delete the **PR_RTF_IN_SYNC** ([PidTagRtfInSync](pidtagrtfinsync-canonical-property.md)) property during a call to the message's [IMAPIProp::SaveChanges](imapiprop-savechanges.md) method if a client has changed **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) without updating either **PR_RTF_IN_SYNC** or **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)).</span></span> <span data-ttu-id="a2ba7-111">Excluir **PR_RTF_IN_SYNC** faz com que a propriedade **PR_RTF_COMPRESSED** sejam recalculados da propriedade **PR_BODY** na próxima vez que um cliente RTF reconhecimento chama [RTFSync](rtfsync.md).</span><span class="sxs-lookup"><span data-stu-id="a2ba7-111">Deleting **PR_RTF_IN_SYNC** causes the **PR_RTF_COMPRESSED** property to be recomputed from the **PR_BODY** property the next time an RTF-aware client calls [RTFSync](rtfsync.md).</span></span> 
  
<span data-ttu-id="a2ba7-112">A maioria dos repositórios de mensagem RTF reconhecimento não terá o texto da mensagem pelos clientes; ele deve ser computado na solicitação.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-112">Most RTF-aware message stores are not given the message text by clients; it must be computed on request.</span></span> <span data-ttu-id="a2ba7-113">Como esse cálculo é caro e demorado, os clientes devem usar **PR_RTF_COMPRESSED** sempre que possível.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-113">Because this computation is time consuming and expensive, clients should use **PR_RTF_COMPRESSED** whenever possible.</span></span> <span data-ttu-id="a2ba7-114">Para calcular a propriedade **PR_BODY** , o provedor de armazenamento de mensagem deve descompacte o conteúdo da propriedade **PR_RTF_COMPRESSED** e remover a formatação rich text.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-114">To compute the **PR_BODY** property, the message store provider must uncompress the contents of the **PR_RTF_COMPRESSED** property and remove the rich text formatting.</span></span> <span data-ttu-id="a2ba7-115">Os clientes que não têm suporte para a propriedade **PR_RTF_COMPRESSED** requerem esse cálculo ocorrer para cada mensagem.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-115">Clients that do not support the **PR_RTF_COMPRESSED** property require this computation to take place for every message.</span></span> 
  
<span data-ttu-id="a2ba7-116">Ao copiar mensagens, a mensagem armazenar os provedores que não usam os métodos **IMAPISupport::DoCopyProps** ou **IMAPISupport::DoCopyTo** , correrá o risco de criação de uma mensagem com nenhum conteúdo se sua implementação exclui o **PR_BODY** propriedade e depende de **PR_RTF_COMPRESSED**.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-116">When copying messages, message store providers that do not use the **IMAPISupport::DoCopyProps** or **IMAPISupport::DoCopyTo** methods run the risk of creating a message with no content if their implementation excludes the **PR_BODY** property and relies on **PR_RTF_COMPRESSED**.</span></span> <span data-ttu-id="a2ba7-117">É possível para os dados na propriedade **PR_RTF_COMPRESSED** corrompido.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-117">It is possible for the data in the **PR_RTF_COMPRESSED** property to be corrupt.</span></span> <span data-ttu-id="a2ba7-118">Antes da exclusão de cada uma dessas propriedades de conteúdo da mensagem na operação de cópia, verifique corrupção da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="a2ba7-118">Before excluding either of these message content properties in the copy operation, check for corruption as follows:</span></span> 
  
1. <span data-ttu-id="a2ba7-119">Se o valor da **PR_RTF_COMPRESSED** não for maior do que o RTF compactado, a propriedade está corrompida.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-119">If the value of **PR_RTF_COMPRESSED** is not larger than the compressed RTF, the property is corrupt.</span></span> 
    
2. <span data-ttu-id="a2ba7-120">Se o valor de mágica no cabeçalho RTF não for _dwMagicCompressedRTF_ ou _dwMagicUncompressedRTF_, a propriedade está corrompido.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-120">If the magic value in the RTF header is not  _dwMagicCompressedRTF_ or  _dwMagicUncompressedRTF_, the property is corrupt.</span></span>
    
<span data-ttu-id="a2ba7-121">Usando o suporte a métodos necessário não se preocupar com a implementação de uma verificação de corrupção **PR_RTF_COMPRESSED** ; de provedores de armazenamento de mensagem MAPI garante que as propriedades adequadas existirem e são válidas.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-121">Message store providers using the support methods need not be concerned with implementing a check for **PR_RTF_COMPRESSED** corruption; MAPI ensures that the appropriate properties exist and are valid.</span></span> 
  
<span data-ttu-id="a2ba7-122">Existem três níveis diferentes de suporte RTF que podem implementar provedores de armazenamento de mensagem; MAPI recomenda que o reconhecimento de RTF provedores de armazenamento de mensagem implementem seu suporte a nível intermediário ou mais alto.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-122">There are three different levels of RTF support that message store providers can implement; MAPI recommends that RTF-aware message store providers implement their support at the middle or highest level.</span></span> <span data-ttu-id="a2ba7-123">Todos os RTF reconhecimento mensagem repositório provedores cuidam da gerando **PR_BODY** a partir dos dados incluídos no **PR_RTF_COMPRESSED** nas mensagens de saída e fazer uma chamada para **RTFSync** para sincronizar o texto e a formatação em mensagens de entrada.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-123">All RTF-aware message store providers take care of generating **PR_BODY** from the data included in **PR_RTF_COMPRESSED** on outgoing messages and make a call to **RTFSync** to synchronize text and formatting on incoming messages.</span></span> 
  
<span data-ttu-id="a2ba7-124">As diferenças entre essas três níveis são descritas na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-124">The differences between these three levels are described in the following table.</span></span> 
  
|<span data-ttu-id="a2ba7-125">**Nível de suporte**</span><span class="sxs-lookup"><span data-stu-id="a2ba7-125">**Level of support**</span></span>|<span data-ttu-id="a2ba7-126">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="a2ba7-126">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="a2ba7-127">Baixa</span><span class="sxs-lookup"><span data-stu-id="a2ba7-127">Low</span></span>  <br/> |<span data-ttu-id="a2ba7-128">Mensagem armazenar provedor chamadas **RTFSync** sempre que as alterações são salvas em uma mensagem e extrai os dados para a propriedade **PR_BODY** do **PR_RTF_COMPRESSED** em vez de exigir clientes para defini-la.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-128">Message store provider calls **RTFSync** whenever changes are saved to a message and extracts the data for the **PR_BODY** property from **PR_RTF_COMPRESSED** rather than requiring clients to set it.</span></span> <span data-ttu-id="a2ba7-129">**PR_BODY** e o **PR_RTF_COMPRESSED** são armazenados.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-129">Both **PR_BODY** and **PR_RTF_COMPRESSED** are stored.</span></span>  <br/> |
|<span data-ttu-id="a2ba7-130">Meio</span><span class="sxs-lookup"><span data-stu-id="a2ba7-130">Middle</span></span>  <br/> |<span data-ttu-id="a2ba7-131">Mensagem armazenar provedor armazena apenas a propriedade **PR_RTF_COMPRESSED** , computação **PR_BODY** quando necessário.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-131">Message store provider stores only the **PR_RTF_COMPRESSED** property, computing **PR_BODY** when necessary.</span></span>  <br/> |
|<span data-ttu-id="a2ba7-132">Alta</span><span class="sxs-lookup"><span data-stu-id="a2ba7-132">High</span></span>  <br/> |<span data-ttu-id="a2ba7-133">Mensagem armazenar repositórios de provedor nem **PR_BODY** ou as propriedades RTF auxiliares.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-133">Message store provider stores neither **PR_BODY** or the auxiliary RTF properties.</span></span> <span data-ttu-id="a2ba7-134">**RTFSync** é chamado quando o texto da mensagem foi alterada e a formatação permanecerá inalterada ou quando uma nova mensagem é baixada por um provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="a2ba7-134">**RTFSync** is called when the message text has changed and the formatting remains unchanged or when a new message is downloaded by a transport provider.</span></span>  <br/> |
   

