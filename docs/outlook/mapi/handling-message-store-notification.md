---
title: Manipular notificações do repositório de mensagens
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3e0cc2f9-a88d-4cec-bef5-b60f2ec80f1c
description: 'Última modificação: 9 de março de 2015'
ms.openlocfilehash: d370603dc7cfc015fe7b2757d1cf0525b3092c5e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33428022"
---
# <a name="handling-message-store-notification"></a><span data-ttu-id="3826f-103">Manipular notificações do repositório de mensagens</span><span class="sxs-lookup"><span data-stu-id="3826f-103">Handling message store notification</span></span>
  
<span data-ttu-id="3826f-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="3826f-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="3826f-105">Para registrar as notificações do repositório de mensagens, chame o método [IMAPISession::Advise](imapisession-advise.md) ou [IMsgStore::Advise](imsgstore-advise.md) e especifique um identificador de entrada de mensagem, pasta ou repositório de mensagens no conteúdo do parâmetro _lpEntryID._</span><span class="sxs-lookup"><span data-stu-id="3826f-105">To register for message store notifications, call either the [IMAPISession::Advise](imapisession-advise.md) or [IMsgStore::Advise](imsgstore-advise.md) method and specify a message store, folder, or message entry identifier in the contents of the  _lpEntryID_ parameter.</span></span> <span data-ttu-id="3826f-106">Provedores de armazenamento de mensagens suportam notificações de objeto e tabela.</span><span class="sxs-lookup"><span data-stu-id="3826f-106">Message store providers support both object and table notifications.</span></span> <span data-ttu-id="3826f-107">Se você se registrar com objetos de armazenamento de mensagens específicos, com a hierarquia de pastas e as tabelas de conteúdo que descrevem esses objetos ou com objetos e tabelas depende das notificações que você espera ver, das chamadas que você faz para executar operações e de como o provedor de armazenamento de mensagens oferece suporte à notificação.</span><span class="sxs-lookup"><span data-stu-id="3826f-107">Whether you register with particular message store objects, with the folder hierarchy and contents tables that describe these objects, or with both objects and tables depends on the notifications you expect to see, the calls you make to perform operations, and how the message store provider supports notification.</span></span> 
  
<span data-ttu-id="3826f-108">Como o MAPI permite flexibilidade na forma como os provedores oferecem suporte a notificações, esteja ciente de que você nem sempre receberá o mesmo tipo de notificação em resposta a um evento específico de todos os provedores de armazenamento de mensagens.</span><span class="sxs-lookup"><span data-stu-id="3826f-108">Because MAPI allows flexibility in how providers support notifications, be aware that you will not always receive the same type of notification in response to a particular event from all message store providers.</span></span> <span data-ttu-id="3826f-109">Alguns provedores de armazenamento de mensagens não suportam notificações.</span><span class="sxs-lookup"><span data-stu-id="3826f-109">Some message store providers do not support notifications at all.</span></span> <span data-ttu-id="3826f-110">Para determinar se o repositório de mensagens que você está usando oferece suporte à notificação, procure o STORE_NOTIFY_OK bit em sua **propriedade PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="3826f-110">To determine if the message store you are using supports notification, look for the STORE_NOTIFY_OK bit in its **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="3826f-111">Em uma extremidade do espectro de provedores de armazenamento de mensagens que suportam a notificação estão os provedores que geram notificações "rica"; esses provedores enviam notificações descritivas para todas as fontes de aviso registradas.</span><span class="sxs-lookup"><span data-stu-id="3826f-111">At one end of the spectrum of message store providers that support notification are the providers that generate "rich" notifications; these providers send descriptive notifications for all registered advise sources.</span></span> <span data-ttu-id="3826f-112">Na outra extremidade estão os provedores de armazenamento de mensagens que suportam notificações limitadas; esses provedores enviam notificações gerais para um número restrito de fontes de aviso.</span><span class="sxs-lookup"><span data-stu-id="3826f-112">At the other end are the message store providers that support limited notifications; these providers send general notifications for a restricted number of advise sources.</span></span> 
  
<span data-ttu-id="3826f-113">Por exemplo, se você copiar uma mensagem para uma pasta com a qual registrou para receber notificações de objeto copiado e movido de objeto, poderá ou não receber a notificação de objeto copiado.</span><span class="sxs-lookup"><span data-stu-id="3826f-113">For example, if you copy a message to a folder with which you have registered to receive both object copied and object moved notifications, you may or may not receive the object copied notification.</span></span> <span data-ttu-id="3826f-114">O recebimento ou não depende de:</span><span class="sxs-lookup"><span data-stu-id="3826f-114">Whether or not you receive it depends on:</span></span>
  
- <span data-ttu-id="3826f-115">O método que você chamou para executar a cópia.</span><span class="sxs-lookup"><span data-stu-id="3826f-115">The method that you called to perform the copy.</span></span> <span data-ttu-id="3826f-116">Pode ser [IMAPIFolder::CopyMessages](imapifolder-copymessages.md), [IMAPIProp::CopyTo](imapiprop-copyto.md)ou [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span><span class="sxs-lookup"><span data-stu-id="3826f-116">This could be [IMAPIFolder::CopyMessages](imapifolder-copymessages.md), [IMAPIProp::CopyTo](imapiprop-copyto.md), or [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span>
    
- <span data-ttu-id="3826f-117">Como o provedor de armazenamento de mensagens implementa o método de cópia.</span><span class="sxs-lookup"><span data-stu-id="3826f-117">How the message store provider implements the copy method.</span></span>
    
- <span data-ttu-id="3826f-118">Se o provedor de armazenamento de mensagens oferece suporte ou não a notificações de objeto copiado em pastas.</span><span class="sxs-lookup"><span data-stu-id="3826f-118">Whether or not the message store provider supports object copied notifications on folders.</span></span>
    
<span data-ttu-id="3826f-119">Como não há diretrizes estritas que descrevem como implementar a notificação de eventos para provedores de armazenamento de mensagens, os clientes não podem esperar um comportamento consistente.</span><span class="sxs-lookup"><span data-stu-id="3826f-119">Because there are no strict guidelines that describe how to implement event notification for message store providers, clients cannot expect consistent behavior.</span></span> <span data-ttu-id="3826f-120">O MAPI faz recomendações sobre como os provedores de armazenamento de mensagens implementam a notificação de eventos e a tabela a seguir descreve essas recomendações.</span><span class="sxs-lookup"><span data-stu-id="3826f-120">MAPI does make recommendations as to how message store providers implement event notification and the following table outlines these recommendations.</span></span> <span data-ttu-id="3826f-121">Leia a tabela da seguinte forma: depois de executar a operação na primeira coluna, espere receber uma notificação do tipo listado na segunda coluna se você tiver registrado para esse tipo com o objeto listado na terceira coluna.</span><span class="sxs-lookup"><span data-stu-id="3826f-121">Read the table as follows: after you perform the operation in the first column, expect to receive a notification of the type listed in the second column if you have registered for that type with the object listed in the third column.</span></span> <span data-ttu-id="3826f-122">Por exemplo, depois de criar uma pasta, você receberá uma notificação  _fnevObjectCreated_ somente se tiver registrado notificações  _fnevObjectCreated_ com o armazenamento de mensagens.</span><span class="sxs-lookup"><span data-stu-id="3826f-122">For example, after you have created a folder, you will receive an  _fnevObjectCreated_ notification only if you have registered for  _fnevObjectCreated_ notifications with the message store.</span></span> 
  
|<span data-ttu-id="3826f-123">**Operação**</span><span class="sxs-lookup"><span data-stu-id="3826f-123">**Operation**</span></span>|<span data-ttu-id="3826f-124">**Tipo de evento**</span><span class="sxs-lookup"><span data-stu-id="3826f-124">**Event type**</span></span>|<span data-ttu-id="3826f-125">**Fonte de consultoria**</span><span class="sxs-lookup"><span data-stu-id="3826f-125">**Advise source**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="3826f-126">Criar uma pasta</span><span class="sxs-lookup"><span data-stu-id="3826f-126">Create a folder</span></span>  <br/> | <span data-ttu-id="3826f-127">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="3826f-127">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="3826f-128">Armazenamento de mensagens</span><span class="sxs-lookup"><span data-stu-id="3826f-128">Message store</span></span>  <br/> |
|<span data-ttu-id="3826f-129">Excluir uma pasta</span><span class="sxs-lookup"><span data-stu-id="3826f-129">Delete a folder</span></span>  <br/> | <span data-ttu-id="3826f-130">_fnevObjectDeleted_</span><span class="sxs-lookup"><span data-stu-id="3826f-130">_fnevObjectDeleted_</span></span> <br/> |<span data-ttu-id="3826f-131">Pasta Excluída do armazenamento de mensagens</span><span class="sxs-lookup"><span data-stu-id="3826f-131">Message store Deleted folder</span></span>  <br/> |
|<span data-ttu-id="3826f-132">Mover uma pasta de uma pasta para outra</span><span class="sxs-lookup"><span data-stu-id="3826f-132">Move a folder from one folder to another</span></span>  <br/> | <span data-ttu-id="3826f-133">_fnevObjectMoved_</span><span class="sxs-lookup"><span data-stu-id="3826f-133">_fnevObjectMoved_</span></span> <br/> |<span data-ttu-id="3826f-134">Pasta De movimentada do armazenamento de mensagens</span><span class="sxs-lookup"><span data-stu-id="3826f-134">Message store Moved folder</span></span>  <br/> |
|<span data-ttu-id="3826f-135">Copiar uma pasta de uma pasta para outra</span><span class="sxs-lookup"><span data-stu-id="3826f-135">Copy a folder from one folder to another</span></span>  <br/> | <span data-ttu-id="3826f-136">_fnevObjectCopied_</span><span class="sxs-lookup"><span data-stu-id="3826f-136">_fnevObjectCopied_</span></span> <br/> |<span data-ttu-id="3826f-137">Armazenamento de mensagens e pasta copiada (nenhuma  _notificação fnevObjectCreated_ enviada para a nova cópia da pasta)</span><span class="sxs-lookup"><span data-stu-id="3826f-137">Message store and copied folder (no  _fnevObjectCreated_ notification sent for the new copy of the folder)</span></span>  <br/> |
|<span data-ttu-id="3826f-138">Alterar em uma propriedade de pasta computada (**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md)), **PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md)), **PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="3826f-138">Change in a computed folder property (**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md)), **PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md)), **PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span></span>  <br/> | <span data-ttu-id="3826f-139">_fnevObjectModified_</span><span class="sxs-lookup"><span data-stu-id="3826f-139">_fnevObjectModified_</span></span> <br/> |<span data-ttu-id="3826f-140">Pasta De alterações do armazenamento de mensagens (sem notificação para a pasta pai)</span><span class="sxs-lookup"><span data-stu-id="3826f-140">Message store Changed folder (No notification to parent folder)</span></span>  <br/> |
|<span data-ttu-id="3826f-141">Criar uma mensagem</span><span class="sxs-lookup"><span data-stu-id="3826f-141">Create a message</span></span>  <br/> | <span data-ttu-id="3826f-142">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="3826f-142">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="3826f-143">Armazenamento de mensagens</span><span class="sxs-lookup"><span data-stu-id="3826f-143">Message store</span></span>  <br/> |
|<span data-ttu-id="3826f-144">Excluir uma mensagem, causando uma alteração na propriedade PR_CONTENT_COUNT **pasta** pai</span><span class="sxs-lookup"><span data-stu-id="3826f-144">Delete a message, causing a change in the parent folder's **PR_CONTENT_COUNT** property</span></span>  <br/> | <span data-ttu-id="3826f-145">_fnevObjectDeleted_</span><span class="sxs-lookup"><span data-stu-id="3826f-145">_fnevObjectDeleted_</span></span> <br/> |<span data-ttu-id="3826f-146">Mensagem excluída do armazenamento de mensagens</span><span class="sxs-lookup"><span data-stu-id="3826f-146">Message store Deleted message</span></span>  <br/> |
|<span data-ttu-id="3826f-147">Mover uma mensagem de uma pasta para outra</span><span class="sxs-lookup"><span data-stu-id="3826f-147">Move a message from one folder to another</span></span>  <br/> | <span data-ttu-id="3826f-148">_fnevObjectMoved_</span><span class="sxs-lookup"><span data-stu-id="3826f-148">_fnevObjectMoved_</span></span> <br/> |<span data-ttu-id="3826f-149">Mensagem movida do armazenamento de mensagens</span><span class="sxs-lookup"><span data-stu-id="3826f-149">Message store Moved message</span></span>  <br/> |
|<span data-ttu-id="3826f-150">Copiar uma mensagem de uma pasta para outra</span><span class="sxs-lookup"><span data-stu-id="3826f-150">Copy a message from one folder to another</span></span>  <br/> | <span data-ttu-id="3826f-151">_fnevObjectCopied_</span><span class="sxs-lookup"><span data-stu-id="3826f-151">_fnevObjectCopied_</span></span> <br/> |<span data-ttu-id="3826f-152">Mensagem copiada do armazenamento de mensagens (nenhuma  _notificação fnevObjectCreated_ para nova cópia da mensagem)</span><span class="sxs-lookup"><span data-stu-id="3826f-152">Message store Copied message (No  _fnevObjectCreated_ notification for new copy of the message)</span></span>  <br/> |
|<span data-ttu-id="3826f-153">Salvar uma mensagem, causando uma alteração na propriedade PR_CONTENT_COUNT **pasta** pai</span><span class="sxs-lookup"><span data-stu-id="3826f-153">Save a message, causing a change in the parent folder's **PR_CONTENT_COUNT** property</span></span>  <br/> | <span data-ttu-id="3826f-154">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="3826f-154">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="3826f-155">Armazenamento de mensagens no primeiro salvar somente</span><span class="sxs-lookup"><span data-stu-id="3826f-155">Message store on first save only</span></span>  <br/> |
|<span data-ttu-id="3826f-156">Salvar uma mensagem</span><span class="sxs-lookup"><span data-stu-id="3826f-156">Save a message</span></span>  <br/> | <span data-ttu-id="3826f-157">_fnevObjectModified_</span><span class="sxs-lookup"><span data-stu-id="3826f-157">_fnevObjectModified_</span></span> <br/> |<span data-ttu-id="3826f-158">Armazenamento de mensagens ao salvar após a primeira mensagem de salvar Alterado (nenhuma notificação para a pasta pai)</span><span class="sxs-lookup"><span data-stu-id="3826f-158">Message store on saves after the first save Changed message (No notification to parent folder)</span></span>  <br/> |
|<span data-ttu-id="3826f-159">Concluir uma operação de pesquisa</span><span class="sxs-lookup"><span data-stu-id="3826f-159">Complete a search operation</span></span>  <br/> | <span data-ttu-id="3826f-160">_fnevSearchComplete_</span><span class="sxs-lookup"><span data-stu-id="3826f-160">_fnevSearchComplete_</span></span> <br/> |<span data-ttu-id="3826f-161">Pasta de Pesquisa do armazenamento de mensagens</span><span class="sxs-lookup"><span data-stu-id="3826f-161">Message store Search folder</span></span>  <br/> |
|<span data-ttu-id="3826f-162">Nova mensagem</span><span class="sxs-lookup"><span data-stu-id="3826f-162">New message</span></span>  <br/> | <span data-ttu-id="3826f-163">_fnevNewMail_</span><span class="sxs-lookup"><span data-stu-id="3826f-163">_fnevNewMail_</span></span> <br/> |<span data-ttu-id="3826f-164">Armazenamento de mensagens</span><span class="sxs-lookup"><span data-stu-id="3826f-164">Message store</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="3826f-165">Quando você receber uma notificação de modificação de objeto, lembre-se de que a parte da matriz de marca de propriedade da estrutura [OBJECT_NOTIFICATION](object_notification.md) apontada pelo parâmetro  _lpNotifications_ na chamada **OnNotify** pode ou não ser NULL.</span><span class="sxs-lookup"><span data-stu-id="3826f-165">When you receive an object modified notification, remember that the property tag array portion of the [OBJECT_NOTIFICATION](object_notification.md) structure pointed to by the  _lpNotifications_ parameter in the **OnNotify** call may or may not be NULL.</span></span> <span data-ttu-id="3826f-166">Os provedores de armazenamento de mensagens não são obrigados a inserir informações de propriedade nessa matriz e a maioria não.</span><span class="sxs-lookup"><span data-stu-id="3826f-166">Message store providers are not required to insert property information in this array and most do not.</span></span> <span data-ttu-id="3826f-167">Certifique-se **de que seu método OnNotify** possa lidar com o caso em que o ponteiro  _lpPropTagArray_ é NULL.</span><span class="sxs-lookup"><span data-stu-id="3826f-167">Make sure your **OnNotify** method can handle the case where the  _lpPropTagArray_ pointer is NULL.</span></span> 
  
<span data-ttu-id="3826f-168">Para a maioria, se não todas as notificações de objeto, atualize a exibição da pasta ou pastas afetadas.</span><span class="sxs-lookup"><span data-stu-id="3826f-168">For most, if not all object notifications, update the view of the affected folder or folders.</span></span>
  

