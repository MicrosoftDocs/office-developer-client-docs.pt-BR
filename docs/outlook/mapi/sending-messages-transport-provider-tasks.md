---
title: Enviando mensagens tarefas do provedor de transporte
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: bd722f48-b166-4670-8dba-897ac50caf37
description: '�ltima altera��o: s�bado, 23 de julho de 2011'
ms.openlocfilehash: 4625d9d09b067d064dac7ca67b7c79ebb818bcce
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19770366"
---
# <a name="sending-messages-transport-provider-tasks"></a><span data-ttu-id="d6967-103">Enviar mensagens: tarefas do provedor de transporte</span><span class="sxs-lookup"><span data-stu-id="d6967-103">Sending Messages: Transport Provider Tasks</span></span>

  
  
<span data-ttu-id="d6967-104">**Aplica-se a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="d6967-104">**Applies to**: Outlook</span></span> 
  
 <span data-ttu-id="d6967-105">**Para transmitir uma mensagem, provedores de transporte**</span><span class="sxs-lookup"><span data-stu-id="d6967-105">**To transmit a message, transport providers**</span></span>
  
- <span data-ttu-id="d6967-106">Defina a propriedade de **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) da mensagem como TRUE depois que o provedor de transporte tem o enviou a mensagem ou tentou enviar a mensagem.</span><span class="sxs-lookup"><span data-stu-id="d6967-106">Set the message's **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) property to TRUE after the transport provider has either sent the message or attempted to send the message.</span></span> <span data-ttu-id="d6967-107">Se uma tentativa de enviar uma mensagem falhar, provedores de transporte devem chamar [IMAPISupport::StatusRecips](imapisupport-statusrecips.md) para gerar um relatório de não entrega.</span><span class="sxs-lookup"><span data-stu-id="d6967-107">If an attempt to send a message fails, transport providers should call [IMAPISupport::StatusRecips](imapisupport-statusrecips.md) to generate a nondelivery report.</span></span> <span data-ttu-id="d6967-108">Se a mensagem é enviada com êxito e a propriedade **PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorDeliveryReportRequested](pidtagoriginatordeliveryreportrequested-canonical-property.md)) for definida como TRUE, crie uma estrutura [ADRLIST](adrlist.md) contendo os destinatários bem-sucedida, a configuração da propriedade de **PR_DELIVER_TIME** ([PidTagDeliverTime](pidtagdelivertime-canonical-property.md)) para cada e chamadas **StatusRecips** para gerar um relatório de entrega.</span><span class="sxs-lookup"><span data-stu-id="d6967-108">If the message is sent successfully and the **PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorDeliveryReportRequested](pidtagoriginatordeliveryreportrequested-canonical-property.md)) property is set to TRUE, create an [ADRLIST](adrlist.md) structure containing the successful recipients, setting the **PR_DELIVER_TIME** ([PidTagDeliverTime](pidtagdelivertime-canonical-property.md)) property for each, and call **StatusRecips** to generate a delivery report.</span></span> <span data-ttu-id="d6967-109">Para obter mais informações sobre a criação de relatórios de entrega e de entrega, consulte os seguintes tópicos: [Mensagens de relatório de MAPI](mapi-report-messages.md), [Necessárias propriedades da mensagem de relatório](required-report-message-properties.md), [Optional relatar propriedades da mensagem](optional-report-message-properties.md)e [Sending entrega de mensagens Relatórios](sending-message-delivery-reports.md).</span><span class="sxs-lookup"><span data-stu-id="d6967-109">For more information about creating delivery and non-delivery reports, see the following topics: [MAPI Report Messages](mapi-report-messages.md), [Required Report Message Properties](required-report-message-properties.md), [Optional Report Message Properties](optional-report-message-properties.md), and [Sending Message Delivery Reports](sending-message-delivery-reports.md).</span></span>
    
- <span data-ttu-id="d6967-110">Defina o grupo **PR_SENDER** da mensagem das propriedades para a identidade do usuário que fez logon.</span><span class="sxs-lookup"><span data-stu-id="d6967-110">Set the message's **PR_SENDER** group of properties to the identity of the user that has logged on.</span></span> <span data-ttu-id="d6967-111">Esse grupo inclui: **PR_SENDER_ENTRYID** ([PidTagSenderEntryId](pidtagsenderentryid-canonical-property.md)), **PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md)), **PR_SENDER_SEARCH_KEY** ([PidTagSenderSearchKey](pidtagsendersearchkey-canonical-property.md)), **PR_SENDER_ADDRTYPE** ([ PidTagSenderAddressType](pidtagsenderaddresstype-canonical-property.md)) e **PR_SENDER_EMAIL_ADDRESS** ([PidTagSenderEmailAddress](pidtagsenderemailaddress-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="d6967-111">This group includes: **PR_SENDER_ENTRYID** ([PidTagSenderEntryId](pidtagsenderentryid-canonical-property.md)), **PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md)), **PR_SENDER_SEARCH_KEY** ([PidTagSenderSearchKey](pidtagsendersearchkey-canonical-property.md)), **PR_SENDER_ADDRTYPE** ([PidTagSenderAddressType](pidtagsenderaddresstype-canonical-property.md)), and **PR_SENDER_EMAIL_ADDRESS** ([PidTagSenderEmailAddress](pidtagsenderemailaddress-canonical-property.md)).</span></span>
    
- <span data-ttu-id="d6967-112">Defina as propriedades da mensagem **PR_SENT_REPRESENTING** , se possível, para qualquer um da identidade do usuário que fez logon ou para uma identidade válida de representante.</span><span class="sxs-lookup"><span data-stu-id="d6967-112">Set the message's **PR_SENT_REPRESENTING** properties, if possible, to either the identity of the user that has logged on or to a valid delegate identity.</span></span> <span data-ttu-id="d6967-113">As propriedades **PR_SENT_REPRESENTING** são usadas para implementar o envio de mensagens por um usuário em nome de outro usuário.</span><span class="sxs-lookup"><span data-stu-id="d6967-113">The **PR_SENT_REPRESENTING** properties are used to implement the sending of messages by one user on behalf of another user.</span></span> <span data-ttu-id="d6967-114">Provedores de transporte que não oferecem suporte a essas propriedades devem ignorá-las em mensagens de saída.</span><span class="sxs-lookup"><span data-stu-id="d6967-114">Transport providers that do not support these properties should ignore them on outbound messages.</span></span> 
    
- <span data-ttu-id="d6967-115">Defina a propriedade de **PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md)) da mensagem para indicar quando o cliente chamado [IMessage::SubmitMessage](imessage-submitmessage.md).</span><span class="sxs-lookup"><span data-stu-id="d6967-115">Set the message's **PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md)) property to indicate when the client called [IMessage::SubmitMessage](imessage-submitmessage.md).</span></span>
    
- <span data-ttu-id="d6967-116">Defina a propriedade de **PR_PROVIDER_SUBMIT_TIME** ([PidTagProviderSubmitTime](pidtagprovidersubmittime-canonical-property.md)) da mensagem para indicar a data e hora em que o provedor de armazenamento de mensagem tiver marcado a mensagem como tendo sido enviado.</span><span class="sxs-lookup"><span data-stu-id="d6967-116">Set the message's **PR_PROVIDER_SUBMIT_TIME** ([PidTagProviderSubmitTime](pidtagprovidersubmittime-canonical-property.md)) property to indicate the date and time that the message store provider marked the message as having been sent.</span></span> 
    
<span data-ttu-id="d6967-117">Quando uma mensagem é enviada a uma variedade de destinatários com vários sistemas de mensagens, cada cópia transmitida terá uma identidade do remetente diferentes.</span><span class="sxs-lookup"><span data-stu-id="d6967-117">When a message is sent to a variety of recipients with several messaging systems, each transmitted copy will have a different sender identity.</span></span> 
  
<span data-ttu-id="d6967-118">O provedor de transporte ou o armazenamento de mensagens de ligação estreita e o transporte também é responsável por informações de originador e responder para configuração.</span><span class="sxs-lookup"><span data-stu-id="d6967-118">The transport provider or tightly coupled message store and transport is also responsible for setting originator and reply-to information.</span></span> <span data-ttu-id="d6967-119">As informações do originador são armazenadas nas propriedades do **PR_ORIGINATOR** e responder para informações são armazenadas nas propriedades do PR_REPLY.</span><span class="sxs-lookup"><span data-stu-id="d6967-119">Originator information is stored in the **PR_ORIGINATOR** properties and reply-to information is stored in the PR_REPLY properties.</span></span> <span data-ttu-id="d6967-120">O cliente pode definir essas propriedades; No entanto, o provedor de transporte é permitido para ignorar e substituir as configurações do cliente.</span><span class="sxs-lookup"><span data-stu-id="d6967-120">The client can set these properties; however, the transport provider is allowed to ignore and overwrite the client's settings.</span></span> 
  

