---
title: Usar várias contas do Exchange
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 4e1804bf-4c50-4942-a7ab-9a8caf1be7e5
description: 'Última modificação: 25 de junho de 2012'
ms.openlocfilehash: a5792ebaf78d77924bc3157be63d937b66e9f4b2
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32329649"
---
# <a name="using-multiple-exchange-accounts"></a><span data-ttu-id="4040a-103">Usar várias contas do Exchange</span><span class="sxs-lookup"><span data-stu-id="4040a-103">Using multiple Exchange accounts</span></span>

  
  
<span data-ttu-id="4040a-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="4040a-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="4040a-105">O Microsoft Outlook 2010 e o Microsoft Outlook 2013 incluem o suporte à integração com várias contas de email do Exchange.</span><span class="sxs-lookup"><span data-stu-id="4040a-105">Microsoft Outlook 2010 and Microsoft Outlook 2013 support integration with multiple exchange email accounts.</span></span> <span data-ttu-id="4040a-106">No Outlook 2010 ou no Outlook 2013, um usuário pode adicionar duas contas do Exchange ao mesmo perfil e ainda desfrutar dos recursos avançados do Exchange, como a GAL (lista de endereços global) publicada, a configuração de ausência temporária e o compartilhamento de pastas.</span><span class="sxs-lookup"><span data-stu-id="4040a-106">In Outlook 2010 or Outlook 2013, a user could add two exchange accounts to the same profile and still enjoy rich Exchange features such as the published global address list (GAL), Exchange Out-of-Office configuration, and folder sharing.</span></span>
  
<span data-ttu-id="4040a-107">Aos que já conhecem as seções de perfil MAPI do Microsoft Office Outlook 2007 e anterior, sabem que as configurações do Exchange, como o nome de usuário e o nome do servidor de email, são armazenadas na seção de perfil global fixo do Exchange, \*\* pbGlobalProfileSectionGuid\*\*.</span><span class="sxs-lookup"><span data-stu-id="4040a-107">Those familiar with the MAPI profile sections for Microsoft Office Outlook 2007 and earlier know that Exchange settings, such as the email user name and server name, are stored in the fixed Exchange Global Profile section, **pbGlobalProfileSectionGuid**.</span></span> <span data-ttu-id="4040a-108">No Outlook 2010 e no Outlook 2013, cada conta do Exchange precisa da sua própria seção de perfil para armazenar as configurações, tornando o **pbGlobalProfileSectionGuid** obsoleto.</span><span class="sxs-lookup"><span data-stu-id="4040a-108">In Outlook 2010 and Outlook 2013, each Exchange account needs its own profile section to store settings, making the **pbGlobalProfileSectionGuid** obsolete.</span></span> 
  
<span data-ttu-id="4040a-109">As configurações do Outlook 2010 e do Outlook 2013 do Exchange ainda são armazenadas no perfil, mas um identificador exclusivo para a seção de perfil que contém suas configurações é alocado dinamicamente por perfil.</span><span class="sxs-lookup"><span data-stu-id="4040a-109">Outlook 2010 and Outlook 2013 Exchange settings are still stored in the profile, but a unique identifier for the profile section that contains their settings is dynamically allocated per profile.</span></span> <span data-ttu-id="4040a-110">O local das configurações do Exchange no perfil é armazenado na [propriedade canônica PidTagExchangeProfileSectionId](pidtagexchangeprofilesectionid-canonical-property.md), que pode ser encontrada na seção perfil de serviço de mensagens da conta do Exchange.</span><span class="sxs-lookup"><span data-stu-id="4040a-110">The location of the Exchange settings in the profile is stored in the [PidTagExchangeProfileSectionId Canonical Property](pidtagexchangeprofilesectionid-canonical-property.md), which can be found in the message service profile section of the Exchange account.</span></span> <span data-ttu-id="4040a-111">Essa propriedade também pode ser encontrada na seção de perfil de cada provedor deste serviço de mensagem da conta.</span><span class="sxs-lookup"><span data-stu-id="4040a-111">This property can also be found in the profile section for each provider in this message service of the account.</span></span> <span data-ttu-id="4040a-112">O identificador exclusivo não é armazenado no servidor e será diferente entre os perfis.</span><span class="sxs-lookup"><span data-stu-id="4040a-112">The unique identifier is not stored on the server and will be different across profiles.</span></span>
  
<span data-ttu-id="4040a-113">O Outlook 2010 e o Outlook 2013 usam o **PidTagExchangeProfileSectionId** como um identificador exclusivo para especificar uma conta do Exchange.</span><span class="sxs-lookup"><span data-stu-id="4040a-113">Outlook 2010 and Outlook 2013 use the **PidTagExchangeProfileSectionId** as a unique identifier to specify an Exchange account.</span></span> <span data-ttu-id="4040a-114">Quando usado dessa maneira, esse identificador exclusivo é conhecido como o **emsmdbUID.**</span><span class="sxs-lookup"><span data-stu-id="4040a-114">When used in this manner, this unique identifier is known as the **emsmdbUID**.</span></span> <span data-ttu-id="4040a-115">Para algumas operações MAPI e do Outlook, um **emsmdbUID** pode ser necessário para especificar qual conta do Exchange deve ser usada para a operação.</span><span class="sxs-lookup"><span data-stu-id="4040a-115">For some MAPI and Outlook operations, an **emsmdbUID** might be required to specify which Exchange account should be used for the operation.</span></span> 
  
<span data-ttu-id="4040a-116">Para suportar várias contas do Exchange, você deve usar algumas chamadas para novas funções no código.</span><span class="sxs-lookup"><span data-stu-id="4040a-116">In order to support multiple Exchange accounts, you must use some calls to new functions in your code.</span></span> <span data-ttu-id="4040a-117">Substitua qualquer chamada que use um **entryID** e [IAddrBook::OpenEntry](iaddrbook-openentry.md) ou [IAddrBook::CompareEntryIDs](iaddrbook-compareentryids.md) em [IMailUser : IMAPIProp](imailuserimapiprop.md) e [IDistList : IMAPIContainer](idistlistimapicontainer.md) com uma das funções a seguir.</span><span class="sxs-lookup"><span data-stu-id="4040a-117">Replace any call that uses an **entryID** and either [IAddrBook::OpenEntry](iaddrbook-openentry.md) or [IAddrBook::CompareEntryIDs](iaddrbook-compareentryids.md) on [IMailUser : IMAPIProp](imailuserimapiprop.md) and [IDistList : IMAPIContainer](idistlistimapicontainer.md) with one of the following functions.</span></span> 
  
- [<span data-ttu-id="4040a-118">HrCompareABEntryIDsWithExchangeContext</span><span class="sxs-lookup"><span data-stu-id="4040a-118">HrCompareABEntryIDsWithExchangeContext</span></span>](hrcompareabentryidswithexchangecontext.md)
    
- [<span data-ttu-id="4040a-119">HrDoABDetailsWithExchangeContext</span><span class="sxs-lookup"><span data-stu-id="4040a-119">HrDoABDetailsWithExchangeContext</span></span>](hrdoabdetailswithexchangecontext.md)
    
- [<span data-ttu-id="4040a-120">HrDoABDetailsWithProviderUID</span><span class="sxs-lookup"><span data-stu-id="4040a-120">HrDoABDetailsWithProviderUID</span></span>](hrdoabdetailswithprovideruid.md)
    
- [<span data-ttu-id="4040a-121">HrGetGALFromEmsmdbUID</span><span class="sxs-lookup"><span data-stu-id="4040a-121">HrGetGALFromEmsmdbUID</span></span>](hrgetgalfromemsmdbuid.md)
    
- [<span data-ttu-id="4040a-122">HrOpenABEntryUsingDefaultContext</span><span class="sxs-lookup"><span data-stu-id="4040a-122">HrOpenABEntryUsingDefaultContext</span></span>](hropenabentryusingdefaultcontext.md)
    
- [<span data-ttu-id="4040a-123">HrOpenABEntryWithExchangeContext</span><span class="sxs-lookup"><span data-stu-id="4040a-123">HrOpenABEntryWithExchangeContext</span></span>](hropenabentrywithexchangecontext.md)
    
- [<span data-ttu-id="4040a-124">HrOpenABEntryWithProviderUID</span><span class="sxs-lookup"><span data-stu-id="4040a-124">HrOpenABEntryWithProviderUID</span></span>](hropenabentrywithprovideruid.md)
    
- [<span data-ttu-id="4040a-125">HrOpenABEntryWithProviderUIDSupport</span><span class="sxs-lookup"><span data-stu-id="4040a-125">HrOpenABEntryWithProviderUIDSupport</span></span>](hropenabentrywithprovideruidsupport.md)
    
- [<span data-ttu-id="4040a-126">HrOpenABEntryWithResolvedRow</span><span class="sxs-lookup"><span data-stu-id="4040a-126">HrOpenABEntryWithResolvedRow</span></span>](hropenabentrywithresolvedrow.md)
    
- [<span data-ttu-id="4040a-127">HrOpenABEntryWithSupport</span><span class="sxs-lookup"><span data-stu-id="4040a-127">HrOpenABEntryWithSupport</span></span>](hropenabentrywithsupport.md)
    
## <a name="legacy-support"></a><span data-ttu-id="4040a-128">Suporte herdado</span><span class="sxs-lookup"><span data-stu-id="4040a-128">Legacy support</span></span>

<span data-ttu-id="4040a-129">Todos os clientes MAPI gravados antes da criação desta nova seção **emsmdbUID** ainda tem suporte.</span><span class="sxs-lookup"><span data-stu-id="4040a-129">Any MAPI clients written before the creation of this new **emsmdbUID** section are still supported.</span></span> <span data-ttu-id="4040a-130">Esses clientes continuarão a recuperar a seção global anterior, **pbGlobalProfileSectionGuid**.</span><span class="sxs-lookup"><span data-stu-id="4040a-130">These clients will continue to retrieve the previous global section, **pbGlobalProfileSectionGuid**.</span></span> <span data-ttu-id="4040a-131">As consultas para esta seção de perfil serão redirecionadas para uma conta designada do Exchange que manipula as consultas herdadas.</span><span class="sxs-lookup"><span data-stu-id="4040a-131">Queries for this profile section will be redirected to one designated Exchange account that handles legacy inquiries.</span></span> <span data-ttu-id="4040a-132">A conta que manipula as chamadas herdadas pode ser determinada observando a tabela de serviço de mensagens e adicionando uma coluna para PR_EMSMDB_LEGACY.</span><span class="sxs-lookup"><span data-stu-id="4040a-132">The account that handles the legacy calls can be determined by looking at the message service table and adding a column for PR_EMSMDB_LEGACY.</span></span> <span data-ttu-id="4040a-133">Somente um serviço de mensagem terá essa definição como verdadeira e seu **PidTagExchangeProfileSectionId** será chamado de **emsmdbUID** herdado.</span><span class="sxs-lookup"><span data-stu-id="4040a-133">Only one message service will have this set to true, and its **PidTagExchangeProfileSectionId** is called the legacy **emsmdbUID**.</span></span>
  
> [!NOTE]
> <span data-ttu-id="4040a-134">As definições MAPI configuráveis, como o repositório e a conta padrão, não afetam a conta que manipula as chamadas herdadas.</span><span class="sxs-lookup"><span data-stu-id="4040a-134">Configurable MAPI settings such as the default store and the default account have no effect on which account handles legacy calls.</span></span> <span data-ttu-id="4040a-135">Não é possível configurar a conta que manipula as chamadas herdadas.</span><span class="sxs-lookup"><span data-stu-id="4040a-135">The account that handles the legacy calls cannot be configured.</span></span> 
  
<span data-ttu-id="4040a-136">A **emsmdbUID** da conta herdada será copiada para a seção de perfil global do Outlook.</span><span class="sxs-lookup"><span data-stu-id="4040a-136">The **emsmdbUID** of the legacy account is copied to the Outlook Global Profile Section.</span></span> <span data-ttu-id="4040a-137">Se essa propriedade não existir, consultar a tabela de serviços de mensagem determinará qual conta é o manipulador herdado e definirá o valor na Seção de perfil global do Outlook.</span><span class="sxs-lookup"><span data-stu-id="4040a-137">If this property does not exist, querying for the message services table will determine what account is the legacy handler and set the value in the Outlook Global Profile Section.</span></span> 
  
<span data-ttu-id="4040a-138">Para ser claro, a Seção de perfil global do Outlook é diferente da Seção de perfil global do Exchange, e no Outlook 2010 e no Outlook 2013 a Seção de perfil global do Exchange não é mais realmente global porque você pode ter várias contas do Exchange.</span><span class="sxs-lookup"><span data-stu-id="4040a-138">To be clear, the Outlook Global Profile Section differs from the Exchange Global Profile Section, and in Outlook 2010 and Outlook 2013 the Exchange Global Profile Section is no longer really global because you can have multiple Exchange accounts.</span></span> <span data-ttu-id="4040a-139">A Seção de perfil global do Outlook contém propriedades sobre o Outlook, como o estado da pasta MRU ou o estado da conexão global.</span><span class="sxs-lookup"><span data-stu-id="4040a-139">The Outlook Global Profile section contains properties about Outlook, such as the state of the folder MRU or the state of the global connection.</span></span>
  
## <a name="address-book-account-contexts"></a><span data-ttu-id="4040a-140">Contextos da conta de catálogo de endereços</span><span class="sxs-lookup"><span data-stu-id="4040a-140">Address Book Account Contexts</span></span>

<span data-ttu-id="4040a-141">Para resolver os problemas corretamente com várias contas do Exchange, use as novas funções que usam um contexto de conta para que as chamadas ao catálogo de endereços pesquisem a conta correta do Exchange.</span><span class="sxs-lookup"><span data-stu-id="4040a-141">To resolve addresses correctly with multiple Exchange accounts, use the new functions that take an account context so that calls to the address book search the correct Exchange account.</span></span>
  
<span data-ttu-id="4040a-142">Algumas APIs de catálogo de endereços anteriores foram substituídas porque as APIs não eram totalmente compatíveis com várias contas do Exchange.</span><span class="sxs-lookup"><span data-stu-id="4040a-142">Some previous address book APIs were deprecated because the APIs were not fully multiple Exchange capable.</span></span> <span data-ttu-id="4040a-143">Esse contexto de conta geralmente é uma **emsmdbUID**.</span><span class="sxs-lookup"><span data-stu-id="4040a-143">This account context is usually an **emsmdbUID**.</span></span>
  
<span data-ttu-id="4040a-144">Além da **emsmdbUID**, as várias contas do Exchange também têm uma **emsabpUID**.</span><span class="sxs-lookup"><span data-stu-id="4040a-144">In addition to the **emsmdbUID**, multiple Exchange accounts also have an **emsabpUID**.</span></span>
  
1. <span data-ttu-id="4040a-145">O valor **emsmdbUID** identifica o contexto da conta.</span><span class="sxs-lookup"><span data-stu-id="4040a-145">The **emsmdbUID** value identifies the account context.</span></span> 
    
2. <span data-ttu-id="4040a-146">O valor **emsabpUID** identifica um provedor de catálogo de endereços do Exchange.</span><span class="sxs-lookup"><span data-stu-id="4040a-146">The **emsabpUID** value identifies an Exchange address book provider.</span></span> 
    
<span data-ttu-id="4040a-147">O valor **emsabpUID** geralmente é usado durante a resolução de um destinatário.</span><span class="sxs-lookup"><span data-stu-id="4040a-147">The **emsabpUID** value is typically used when resolving a recipient.</span></span> <span data-ttu-id="4040a-148">Ao resolver um destinatário usando[IAddrBook::ResolveName](iaddrbook-resolvename.md), uma linha de destinatário do Exchange contém a propriedade **PR_AB_PROVIDERS** (0x3D010102), que contém o valor **emsabpUID**.</span><span class="sxs-lookup"><span data-stu-id="4040a-148">When resolving a recipient using [IAddrBook::ResolveName](iaddrbook-resolvename.md), an Exchange recipient row contains the **PR_AB_PROVIDERS** (0x3D010102) property, which contains the **emsabpUID** value.</span></span> <span data-ttu-id="4040a-149">Esse valor **emsabpUID** identifica o provedor de catálogo de endereços do Exchange para o destinatário específico.</span><span class="sxs-lookup"><span data-stu-id="4040a-149">This **emsabpUID** value identifies the Exchange address book provider for the specific recipient.</span></span> 
  
<span data-ttu-id="4040a-150">Se desejar determinar o valor **emsabpUID** de um determinado **emsmdbUID**, abra a seção de perfil do **emsmdbUID** e obtenha a propriedade **PR_EMSABP_ USER_UID** (0x0x3D1A0102).</span><span class="sxs-lookup"><span data-stu-id="4040a-150">If you want to determine the **emsabpUID** value for a particular **emsmdbUID**, open up the profile section for the **emsmdbUID** and get the **PR_EMSABP_USER_UID** (0x0x3D1A0102) property.</span></span> 
  
<span data-ttu-id="4040a-151">Se você estiver chamando [IAddrBook::PrepareRecips](iaddrbook-preparerecips.md), certifique-se de que os destinatários do Exchange na lista transmitida contêm a propriedade **PR_AB_PROVIDERS** que tem o **emsabpUID** que corresponde ao provedor do catálogo de endereços ao qual o destinatário pertence.</span><span class="sxs-lookup"><span data-stu-id="4040a-151">If you are calling [IAddrBook::PrepareRecips](iaddrbook-preparerecips.md), make sure that the Exchange recipients in the list that you pass in contain the **PR_AB_PROVIDERS** property that has the **emsabpUID** that corresponds to the address book provider that the recipient belongs to.</span></span> <span data-ttu-id="4040a-152">Chamando [IAddrBook::PrepareRecips](iaddrbook-preparerecips.md) em uma linha que você obteve de [IAddrBook::ResolveName](iaddrbook-resolvename.md) não requer nenhuma ação adicional, mas algum código chamará [IAddrBook::PrepareRecips](iaddrbook-preparerecips.md) em linhas que contêm apenas a propriedade **PR_ENTRYID**.</span><span class="sxs-lookup"><span data-stu-id="4040a-152">Calling [IAddrBook::PrepareRecips](iaddrbook-preparerecips.md) on a row that you obtained from [IAddrBook::ResolveName](iaddrbook-resolvename.md) requires no additional action, but some code will call [IAddrBook::PrepareRecips](iaddrbook-preparerecips.md) on rows that contain only the **PR_ENTRYID** property.</span></span> <span data-ttu-id="4040a-153">As linhas nesta e em situações similares devem conter **PR_ENTRYID** e **PR_AB_PROVIDERS** com a propriedade **PR_AB_PROVIDERS** definida como a **emsabpUID** correta.</span><span class="sxs-lookup"><span data-stu-id="4040a-153">Rows in this and similar situations should contain both **PR_ENTRYID** and **PR_AB_PROVIDERS** with the **PR_AB_PROVIDERS** property set to the correct **emsabpUID**.</span></span>
  
<span data-ttu-id="4040a-154">Uma descrição simples do processo para resolver várias contas do Exchange é a seguinte:</span><span class="sxs-lookup"><span data-stu-id="4040a-154">A simple description of the process for resolving multiple Exchange accounts is as follows:</span></span>
  
- <span data-ttu-id="4040a-155">Devido ao identificador exclusivo do serviço, seu código procura na tabela do repositório de mensagens da propriedade **PR_SERVICE_UID** que corresponde àquela que você tem.</span><span class="sxs-lookup"><span data-stu-id="4040a-155">Given the service unique identifier, your code looks in the table of the message store of the **PR_SERVICE_UID** property that matches the one that you have.</span></span> <span data-ttu-id="4040a-156">A partir daí, você pode determinar a **PR_MDB_PROVIDER** correta.</span><span class="sxs-lookup"><span data-stu-id="4040a-156">From there, you can determine the correct **PR_MDB_PROVIDER**.</span></span> <span data-ttu-id="4040a-157">Esta linha contém o repositório apropriado.</span><span class="sxs-lookup"><span data-stu-id="4040a-157">This row contains the appropriate store.</span></span>
    
- <span data-ttu-id="4040a-158">Devido a uma **emsmdbUID**, seu código procura na tabela de serviços de mensagem pela linha que expõe a **PidTagExchangeProfileSectionId** que corresponde ao **emsmdbUID**.</span><span class="sxs-lookup"><span data-stu-id="4040a-158">Given an **emsmdbUID**, your code looks in the message services table for the row that exposes the **PidTagExchangeProfileSectionId** that matches the **emsmdbUID**.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="4040a-159">Confira também</span><span class="sxs-lookup"><span data-stu-id="4040a-159">See also</span></span>



[<span data-ttu-id="4040a-160">HrCompareABEntryIDsWithExchangeContext</span><span class="sxs-lookup"><span data-stu-id="4040a-160">HrCompareABEntryIDsWithExchangeContext</span></span>](hrcompareabentryidswithexchangecontext.md)
  
[<span data-ttu-id="4040a-161">HrDoABDetailsWithExchangeContext</span><span class="sxs-lookup"><span data-stu-id="4040a-161">HrDoABDetailsWithExchangeContext</span></span>](hrdoabdetailswithexchangecontext.md)
  
[<span data-ttu-id="4040a-162">HrDoABDetailsWithProviderUID</span><span class="sxs-lookup"><span data-stu-id="4040a-162">HrDoABDetailsWithProviderUID</span></span>](hrdoabdetailswithprovideruid.md)
  
[<span data-ttu-id="4040a-163">HrGetGALFromEmsmdbUID</span><span class="sxs-lookup"><span data-stu-id="4040a-163">HrGetGALFromEmsmdbUID</span></span>](hrgetgalfromemsmdbuid.md)
  
[<span data-ttu-id="4040a-164">HrOpenABEntryUsingDefaultContext</span><span class="sxs-lookup"><span data-stu-id="4040a-164">HrOpenABEntryUsingDefaultContext</span></span>](hropenabentryusingdefaultcontext.md)
  
[<span data-ttu-id="4040a-165">HrOpenABEntryWithExchangeContext</span><span class="sxs-lookup"><span data-stu-id="4040a-165">HrOpenABEntryWithExchangeContext</span></span>](hropenabentrywithexchangecontext.md)
  
[<span data-ttu-id="4040a-166">HrOpenABEntryWithProviderUID</span><span class="sxs-lookup"><span data-stu-id="4040a-166">HrOpenABEntryWithProviderUID</span></span>](hropenabentrywithprovideruid.md)
  
[<span data-ttu-id="4040a-167">HrOpenABEntryWithProviderUIDSupport</span><span class="sxs-lookup"><span data-stu-id="4040a-167">HrOpenABEntryWithProviderUIDSupport</span></span>](hropenabentrywithprovideruidsupport.md)
  
[<span data-ttu-id="4040a-168">HrOpenABEntryWithResolvedRow</span><span class="sxs-lookup"><span data-stu-id="4040a-168">HrOpenABEntryWithResolvedRow</span></span>](hropenabentrywithresolvedrow.md)
  
[<span data-ttu-id="4040a-169">HrOpenABEntryWithSupport</span><span class="sxs-lookup"><span data-stu-id="4040a-169">HrOpenABEntryWithSupport</span></span>](hropenabentrywithsupport.md)
  
[<span data-ttu-id="4040a-170">Propriedade canônica PidTagExchangeProfileSectionId</span><span class="sxs-lookup"><span data-stu-id="4040a-170">PidTagExchangeProfileSectionId Canonical Property</span></span>](pidtagexchangeprofilesectionid-canonical-property.md)


[<span data-ttu-id="4040a-171">Como abrir a seção de perfil global</span><span class="sxs-lookup"><span data-stu-id="4040a-171">How To Open the Global Profile Section</span></span>](https://support.microsoft.com/kb/188482)

