---
title: MAPI recebem pastas
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 2e1287a3-0f15-4d9a-b7ee-738fce9cd51f
description: 'Última modificação: 9 de março de 2015'
ms.openlocfilehash: 619bd2d5e3b40e49da835d774035ba237af06699
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19767916"
---
# <a name="mapi-receive-folders"></a><span data-ttu-id="e93b6-103">MAPI recebem pastas</span><span class="sxs-lookup"><span data-stu-id="e93b6-103">MAPI Receive Folders</span></span>

  
  
<span data-ttu-id="e93b6-104">**Aplica-se a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="e93b6-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="e93b6-105">Uma pasta de recebimento contém mensagens de entrada de uma classe de mensagem específica.</span><span class="sxs-lookup"><span data-stu-id="e93b6-105">A receive folder holds inbound messages of a particular message class.</span></span> <span data-ttu-id="e93b6-106">Associações podem ser estabelecidas pelos clientes, o provedor de armazenamento de mensagem ou MAPI de pasta de recebimento.</span><span class="sxs-lookup"><span data-stu-id="e93b6-106">Receive folder associations can be established by clients, by the message store provider, or by MAPI.</span></span> <span data-ttu-id="e93b6-107">MAPI tem dois padrão recebem pastas: a pasta raiz do armazenamento de mensagens e da pasta de caixa de entrada da subárvore interpessoais mensagens (IPM).</span><span class="sxs-lookup"><span data-stu-id="e93b6-107">MAPI has two default receive folders: the root folder of the message store, and the Inbox folder of the interpersonal message (IPM) subtree.</span></span> <span data-ttu-id="e93b6-108">A pasta raiz do armazenamento de mensagens é o padrão receber a pasta para todas as mensagens de comunicação entre processos (CPI).</span><span class="sxs-lookup"><span data-stu-id="e93b6-108">The root folder of the message store is the default receive folder for all interprocess communication (IPC) messages.</span></span>
  
 <span data-ttu-id="e93b6-109">A pasta de caixa de entrada é criada pelo MAPI para cada novo armazenamento de mensagens e atua como o padrão recebe a pasta para as classes de mensagem a seguir:</span><span class="sxs-lookup"><span data-stu-id="e93b6-109">The Inbox folder is created by MAPI for every new message store and acts as the default receive folder for the following message classes:</span></span> 
  
- <span data-ttu-id="e93b6-110">A classe de mensagem IPM.</span><span class="sxs-lookup"><span data-stu-id="e93b6-110">The IPM message class.</span></span>
    
- <span data-ttu-id="e93b6-111">A classe de mensagem do relatório.</span><span class="sxs-lookup"><span data-stu-id="e93b6-111">The report message class.</span></span>
    
- <span data-ttu-id="e93b6-112">Uma classe vazia ou ausente.</span><span class="sxs-lookup"><span data-stu-id="e93b6-112">An empty, or missing, class.</span></span>
    
<span data-ttu-id="e93b6-113">Todas as mensagens de relatório, mesmo aqueles enviado em resposta a uma mensagem de CPI, são colocadas na pasta caixa de entrada.</span><span class="sxs-lookup"><span data-stu-id="e93b6-113">All report messages, even those sent in response to an IPC message, are placed in the Inbox folder.</span></span> <span data-ttu-id="e93b6-114">Aplicativos de cliente CPI que processar seus próprios relatórios deverá adicionar explicitamente uma pasta de recebimento para a classe específica do relatório.</span><span class="sxs-lookup"><span data-stu-id="e93b6-114">IPC client applications that process their own reports must explicitly add a receive folder for the particular class of report.</span></span> <span data-ttu-id="e93b6-115">Por exemplo, se um cliente espera receber mensagens com a classe CPI. Paper.Order, ele deve chamar o método [IMsgStore::SetReceiveFolder](imsgstore-setreceivefolder.md) para estabelecer uma pasta de recebimento de relatórios com a classe Report.IPC.Paper.Order.</span><span class="sxs-lookup"><span data-stu-id="e93b6-115">For example, if a client expects to receive messages with the class IPC.Paper.Order, it should call the [IMsgStore::SetReceiveFolder](imsgstore-setreceivefolder.md) method to establish a receive folder for reports with the class Report.IPC.Paper.Order.</span></span> 
  
<span data-ttu-id="e93b6-116">Receba a pasta associações baseiam-se na organização hierárquica de classes de mensagem.</span><span class="sxs-lookup"><span data-stu-id="e93b6-116">Receive folder associations are based on the hierarchical organization of message classes.</span></span> <span data-ttu-id="e93b6-117">Os clientes podem estabelecer uma associação entre uma pasta de recebimento e uma classe de mensagem ou usar as pastas de recebimento padrão MAPI explicitamente.</span><span class="sxs-lookup"><span data-stu-id="e93b6-117">Clients can explicitly establish an association between a receive folder and a message class or use the MAPI default receive folders.</span></span> <span data-ttu-id="e93b6-118">Normalmente, os clientes designar uma pasta para receber mensagens para uma classe de base e todas as suas subclasses.</span><span class="sxs-lookup"><span data-stu-id="e93b6-118">Typically, clients designate one folder to receive messages for a base class and all of its subclasses.</span></span> <span data-ttu-id="e93b6-119">Por exemplo, um cliente típico seria estabelecer uma associação para mensagens com a classe **MyClass**.</span><span class="sxs-lookup"><span data-stu-id="e93b6-119">For example, a typical client would establish an association for messages with the class **MyClass**.</span></span> <span data-ttu-id="e93b6-120">Em seguida, se o cliente tiver recebido mensagens com classes **MyClass.Home** ou **MyClass.Home.Kitchen.Computer**, essas mensagens iria para a pasta de recebimento para a classe de base, **MyClass**.</span><span class="sxs-lookup"><span data-stu-id="e93b6-120">Then if the client received messages with classes **MyClass.Home** or **MyClass.Home.Kitchen.Computer**, these messages would go to the receive folder for the base class, **MyClass**.</span></span>
  
<span data-ttu-id="e93b6-121">Há três mensagem métodos repositório que são usadas pelos clientes para trabalhar com pastas de receber:</span><span class="sxs-lookup"><span data-stu-id="e93b6-121">There are three message store methods that clients use to work with receive folders:</span></span>
  
- [<span data-ttu-id="e93b6-122">IMsgStore::GetReceiveFolderTable</span><span class="sxs-lookup"><span data-stu-id="e93b6-122">IMsgStore::GetReceiveFolderTable</span></span>](imsgstore-getreceivefoldertable.md)
    
- [<span data-ttu-id="e93b6-123">IMsgStore::GetReceiveFolder</span><span class="sxs-lookup"><span data-stu-id="e93b6-123">IMsgStore::GetReceiveFolder</span></span>](imsgstore-getreceivefolder.md)
    
- [<span data-ttu-id="e93b6-124">IMsgStore::SetReceiveFolder</span><span class="sxs-lookup"><span data-stu-id="e93b6-124">IMsgStore::SetReceiveFolder</span></span>](imsgstore-setreceivefolder.md)
    
<span data-ttu-id="e93b6-125">A tabela de pasta de recebimento é uma listagem das informações sobre todas as pastas de recebimento estabelecidas para um armazenamento de mensagens.</span><span class="sxs-lookup"><span data-stu-id="e93b6-125">The receive folder table is a listing of information about all of the receive folders established for a message store.</span></span> <span data-ttu-id="e93b6-126">Seu conjunto de coluna necessária inclui a classe de mensagem, chave de registro e o identificador de entrada.</span><span class="sxs-lookup"><span data-stu-id="e93b6-126">Its required column set includes the message class, record key, and entry identifier.</span></span>
  
<span data-ttu-id="e93b6-127">Para recuperar uma pasta de recebimento para uma classe de mensagem específica, clientes passam a cadeia de caracteres de classe de mensagem para o método [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md) .</span><span class="sxs-lookup"><span data-stu-id="e93b6-127">To retrieve a receive folder for a particular message class, clients pass the message class string to the [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md) method.</span></span> <span data-ttu-id="e93b6-128">A mensagem armazene o provedor retorna um identificador de entrada para a pasta correspondente.</span><span class="sxs-lookup"><span data-stu-id="e93b6-128">The message store provider returns an entry identifier for the corresponding folder.</span></span> <span data-ttu-id="e93b6-129">Para implementar **GetReceiveFolder**, um provedor de armazenamento de mensagem deve usar um algoritmo que seleciona a pasta cujo classe de mensagem associada coincide com o prefixo mais longo possível da classe de mensagem especificado.</span><span class="sxs-lookup"><span data-stu-id="e93b6-129">To implement **GetReceiveFolder**, a message store provider should use an algorithm that selects the folder whose associated message class matches the longest possible prefix of the specified message class.</span></span> <span data-ttu-id="e93b6-130">Por exemplo, suponha que o armazenamento de mensagens tem as seguintes associações entre recebem pastas e mensagens classes em sua tabela de pasta de recebimento:</span><span class="sxs-lookup"><span data-stu-id="e93b6-130">For example, assume the message store has the following associations between receive folders and message classes in its receive folder table:</span></span>
  
- <span data-ttu-id="e93b6-131">Mensagens **IPM** são colocadas na pasta caixa de entrada.</span><span class="sxs-lookup"><span data-stu-id="e93b6-131">**IPM** messages are placed in the Inbox folder.</span></span> 
    
- <span data-ttu-id="e93b6-132">**IPM. Note.Sample** mensagens são colocadas na pasta Samples.</span><span class="sxs-lookup"><span data-stu-id="e93b6-132">**IPM.Note.Sample** messages are placed in the Samples folder.</span></span> 
    
<span data-ttu-id="e93b6-133">A tabela a seguir mostra como mensagens com várias classes serão encaminhadas para o apropriado a pasta de recebimento.</span><span class="sxs-lookup"><span data-stu-id="e93b6-133">The following table shows how messages with various classes would be routed to the appropriate receive folder.</span></span>
  
|<span data-ttu-id="e93b6-134">**Classe de mensagem de entrada**</span><span class="sxs-lookup"><span data-stu-id="e93b6-134">**Inbound message class**</span></span>|<span data-ttu-id="e93b6-135">**Pasta de recebimento**</span><span class="sxs-lookup"><span data-stu-id="e93b6-135">**Receive folder**</span></span>|
|:-----|:-----|
|<span data-ttu-id="e93b6-136">**IPM. Note.Sample.Simple**</span><span class="sxs-lookup"><span data-stu-id="e93b6-136">**IPM.Note.Sample.Simple**</span></span> <br/> |<span data-ttu-id="e93b6-137">Pasta de amostras</span><span class="sxs-lookup"><span data-stu-id="e93b6-137">Samples folder</span></span>  <br/> |
|<span data-ttu-id="e93b6-138">**IPM. Observação**</span><span class="sxs-lookup"><span data-stu-id="e93b6-138">**IPM.Note**</span></span> <br/> |<span data-ttu-id="e93b6-139">Pasta caixa de entrada</span><span class="sxs-lookup"><span data-stu-id="e93b6-139">Inbox folder</span></span>  <br/> |
|<span data-ttu-id="e93b6-140">**IPM. Cartão de ponto**</span><span class="sxs-lookup"><span data-stu-id="e93b6-140">**IPM.Timecard**</span></span> <br/> |<span data-ttu-id="e93b6-141">Pasta caixa de entrada</span><span class="sxs-lookup"><span data-stu-id="e93b6-141">Inbox folder</span></span>  <br/> |
|<span data-ttu-id="e93b6-142">**IPM. Note.Sample.Simple.Totally**</span><span class="sxs-lookup"><span data-stu-id="e93b6-142">**IPM.Note.Sample.Simple.Totally**</span></span> <br/> |<span data-ttu-id="e93b6-143">Pasta de amostras</span><span class="sxs-lookup"><span data-stu-id="e93b6-143">Samples folder</span></span>  <br/> |
   
<span data-ttu-id="e93b6-144">Clientes chame o método de **SetReceiveFolder** para fazer uma associação explícita entre uma classe de mensagem específica e a pasta de recebimento.</span><span class="sxs-lookup"><span data-stu-id="e93b6-144">Clients call the **SetReceiveFolder** method to make an explicit association between a particular message class and receive folder.</span></span> <span data-ttu-id="e93b6-145">Quando uma mensagem é entregue a uma classe de mensagem vazia, o MAPI coloca a mensagem na pasta de recebimento que foi definida para um prefixo da classe vazia.</span><span class="sxs-lookup"><span data-stu-id="e93b6-145">When a message is delivered to an empty message class, MAPI places the message in the receive folder that is defined for a prefix of the empty class.</span></span> <span data-ttu-id="e93b6-146">Por exemplo, se seu cliente tiver uma pasta de recebimento estabelecida para mensagens com classes **IPM** e uma mensagem com a classe **IPM. Note. Test** é entregue, esta mensagem será colocada na pasta de recebimento para a classe de mensagem **IPM** .</span><span class="sxs-lookup"><span data-stu-id="e93b6-146">For example, if your client has a receive folder established for messages with class **IPM** and a message with class **IPM.Note.Test** is delivered, this message will be placed in the receive folder for the **IPM** message class.</span></span> 
  
<span data-ttu-id="e93b6-147">Em chamar **SetReceiveFolder**, os clientes normalmente passam uma cadeia de caracteres de classe de mensagem e o identificador de entrada da nova pasta de recebimento.</span><span class="sxs-lookup"><span data-stu-id="e93b6-147">In calling **SetReceiveFolder**, clients typically pass a message class string and the entry identifier of the new receive folder.</span></span> <span data-ttu-id="e93b6-148">No entanto, os clientes podem passar NULL devido a um ou ambos os parâmetros.</span><span class="sxs-lookup"><span data-stu-id="e93b6-148">However, clients can pass in NULL for one or both of these parameters.</span></span> <span data-ttu-id="e93b6-149">A tabela a seguir descreve o comportamento que resulta da especificação NULL para os parâmetros de identificador de classe e entrada de mensagem.</span><span class="sxs-lookup"><span data-stu-id="e93b6-149">The following table describes the behavior that results from specifying NULL for the message class and entry identifier parameters.</span></span> 
  
|<span data-ttu-id="e93b6-150">**Parâmetro _SetReceiveFolder_**</span><span class="sxs-lookup"><span data-stu-id="e93b6-150">**_SetReceiveFolder_ parameter**</span></span>|<span data-ttu-id="e93b6-151">**Comportamento resultante**</span><span class="sxs-lookup"><span data-stu-id="e93b6-151">**Resulting behavior**</span></span>|
|:-----|:-----|
|<span data-ttu-id="e93b6-152">Identificador de entrada definido como NULL</span><span class="sxs-lookup"><span data-stu-id="e93b6-152">Entry identifier set to NULL</span></span>  <br/> |<span data-ttu-id="e93b6-153">O armazenamento de mensagens exclui a associação entre especificado a existente e a classe de pasta de recebimento de mensagem.</span><span class="sxs-lookup"><span data-stu-id="e93b6-153">The message store deletes the association between the specified message class and its existing receive folder.</span></span> <span data-ttu-id="e93b6-154">Receber uma nova pasta não é estabelecida.</span><span class="sxs-lookup"><span data-stu-id="e93b6-154">A new receive folder is not established.</span></span>  <br/> <span data-ttu-id="e93b6-155">As chamadas subsequentes com essa classe de mensagem para **GetReceiveFolder** retornará a pasta de recebimento de um prefixo da classe de mensagem; para repositórios de nova mensagem, **GetReceiveFolder** retornará a caixa de entrada na subárvore IPM.</span><span class="sxs-lookup"><span data-stu-id="e93b6-155">Subsequent calls to **GetReceiveFolder** with this message class will return the receive folder for a prefix of the message class; for new message stores, **GetReceiveFolder** will return the Inbox in the IPM subtree.</span></span>  <br/> |
|<span data-ttu-id="e93b6-156">Classe de mensagem definido como NULL</span><span class="sxs-lookup"><span data-stu-id="e93b6-156">Message class set to NULL</span></span>  <br/> |<span data-ttu-id="e93b6-157">O armazenamento de mensagens altera a associação para a classe de mensagem vazia na pasta indicada.</span><span class="sxs-lookup"><span data-stu-id="e93b6-157">The message store changes the association for the empty message class to the indicated folder.</span></span> <span data-ttu-id="e93b6-158">Mensagens de entrada cujo classe contrário é reconhecido irão para essa pasta.</span><span class="sxs-lookup"><span data-stu-id="e93b6-158">Incoming messages whose class is otherwise unrecognized will go to this folder.</span></span>  <br/> |
|<span data-ttu-id="e93b6-159">O identificador de entrada e a classe de mensagem definido como NULL</span><span class="sxs-lookup"><span data-stu-id="e93b6-159">Entry identifier and message class set to NULL</span></span>  <br/> |<span data-ttu-id="e93b6-160">O armazenamento de mensagens exclui a associação de classe/pasta para a classe de mensagem vazia.</span><span class="sxs-lookup"><span data-stu-id="e93b6-160">The message store deletes the class/folder association for the empty message class.</span></span> <span data-ttu-id="e93b6-161">Você não deve definir ambos os parâmetros como NULL, porque geralmente resulta em mensagens de entrada que está sendo colocadas na pasta raiz do armazenamento de mensagens, uma pasta que é invisível para o cliente.</span><span class="sxs-lookup"><span data-stu-id="e93b6-161">You should not set both parameters to NULL, because it typically results in inbound messages being placed in the root folder of the message store, a folder that is invisible to the client.</span></span>  <br/> |
   
<span data-ttu-id="e93b6-162">Embora a classe da mensagem nunca deve estar vazio, uma classe de mensagem vazia pode ocorrer.</span><span class="sxs-lookup"><span data-stu-id="e93b6-162">Although a message's class should never be empty, an empty message class can occur.</span></span> <span data-ttu-id="e93b6-163">É responsabilidade do armazenamento de mensagens para atribuir a classe de mensagem ao **IPM** para novas mensagens de saída que possuem uma classe vazia; é responsabilidade do provedor de transporte para atribuir **IPM. Observação** como a classe de mensagens de entrada que possuem qualquer classe vazia.</span><span class="sxs-lookup"><span data-stu-id="e93b6-163">It is the message store's responsibility to assign the message class to **IPM** for new outbound messages that have an empty class; it is the transport provider's responsibility to assign **IPM.Note** as the class for inbound messages that have any empty class.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="e93b6-164">Confira também</span><span class="sxs-lookup"><span data-stu-id="e93b6-164">See also</span></span>



[<span data-ttu-id="e93b6-165">Pastas MAPI</span><span class="sxs-lookup"><span data-stu-id="e93b6-165">MAPI Folders</span></span>](mapi-folders.md)

