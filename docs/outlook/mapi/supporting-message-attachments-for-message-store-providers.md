---
title: Suporte a anexos de mensagem para provedores de armazenamento de mensagens
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d5fabc40-71e8-4afa-9846-533da605ce6c
description: '�ltima altera��o: segunda-feira, 7 de dezembro de 2015'
ms.openlocfilehash: 69d1df5bf206cddd0d25698665c9fd87b81e4ea5
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412132"
---
# <a name="supporting-message-attachments-for-message-store-providers"></a><span data-ttu-id="7541a-103">Suporte a anexos de mensagem para provedores de armazenamento de mensagens</span><span class="sxs-lookup"><span data-stu-id="7541a-103">Supporting Message Attachments for Message Store Providers</span></span>

 
  
<span data-ttu-id="7541a-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="7541a-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="7541a-105">Seu provedor de armazenamento de mensagens não precisa dar suporte a anexos de mensagens.</span><span class="sxs-lookup"><span data-stu-id="7541a-105">Your message store provider does not need to support message attachments.</span></span> <span data-ttu-id="7541a-106">No entanto, muitos aplicativos cliente esperam ser capazes de adicionar anexos às mensagens.</span><span class="sxs-lookup"><span data-stu-id="7541a-106">However, many client applications expect to be able to add attachments to messages.</span></span> <span data-ttu-id="7541a-107">Se o armazenamento de mensagens for usado para criar ou armazenar o IPM. Observe as mensagens e, em seguida, você deve dar suporte a anexos de mensagens.</span><span class="sxs-lookup"><span data-stu-id="7541a-107">If your message store will be used to create or store IPM.Note messages, then you should support message attachments.</span></span> <span data-ttu-id="7541a-108">Os provedores de armazenamento de mensagens padrão também devem suportar anexos de mensagens.</span><span class="sxs-lookup"><span data-stu-id="7541a-108">Default message store providers should also support message attachments.</span></span> <span data-ttu-id="7541a-109">Para obter mais informações, [consulte CLASSES de mensagens MAPI](mapi-message-classes.md)e [armazenamentos de mensagens padrão.](default-message-stores.md)</span><span class="sxs-lookup"><span data-stu-id="7541a-109">For more information, see [MAPI Message Classes](mapi-message-classes.md), and [Default Message Stores](default-message-stores.md).</span></span>
  
<span data-ttu-id="7541a-110">Há cinco tipos de anexos aos quais o MAPI oferece suporte: anexos de arquivo, anexos de dados, anexos de mensagem, anexos de objeto OLE e links.</span><span class="sxs-lookup"><span data-stu-id="7541a-110">There are five types of attachments that MAPI supports: file attachments, data attachments, message attachments, OLE object attachments, and links.</span></span> <span data-ttu-id="7541a-111">Os requisitos para dar suporte a cada tipo são diferentes.</span><span class="sxs-lookup"><span data-stu-id="7541a-111">The requirements for supporting each type are different.</span></span> <span data-ttu-id="7541a-112">Os clientes diferenciam entre os dois tipos de anexos por meio da propriedade **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) em objetos anexos.</span><span class="sxs-lookup"><span data-stu-id="7541a-112">Clients differentiate between the two types of attachments by means of the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property on attachment objects.</span></span>
  
<span data-ttu-id="7541a-113">O suporte a anexos significa implementar a interface [IAttach : IMAPIProp.](iattachimapiprop.md)</span><span class="sxs-lookup"><span data-stu-id="7541a-113">Supporting attachments means implementing the [IAttach : IMAPIProp](iattachimapiprop.md) interface.</span></span> <span data-ttu-id="7541a-114">A interface **IAttach** não tem seus próprios métodos; ele tem apenas métodos que são herdados da interface [IMAPIProp.](imapipropiunknown.md)</span><span class="sxs-lookup"><span data-stu-id="7541a-114">The **IAttach** interface has no methods of its own; it has only methods that are inherited from the [IMAPIProp](imapipropiunknown.md) interface.</span></span> <span data-ttu-id="7541a-115">Como seu provedor de armazenamento de mensagens já deve implementar propriedades para objetos de mensagem, isso simplifica bastante a tarefa de suporte a anexos.</span><span class="sxs-lookup"><span data-stu-id="7541a-115">Because your message store provider must already implement properties for message objects, this greatly simplifies the task of supporting attachments.</span></span> <span data-ttu-id="7541a-116">Implementar **IAttach basicamente** significa fornecer uma maneira para os clientes acessarem uma tabela de propriedades para anexos específicos em mensagens.</span><span class="sxs-lookup"><span data-stu-id="7541a-116">Implementing **IAttach** basically means providing a way for clients to access a table of properties for particular attachments on messages.</span></span> 
  
<span data-ttu-id="7541a-117">Os anexos de dados são simplesmente anexos para os quais o conteúdo do anexo é armazenado diretamente na propriedade **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) de um anexo.</span><span class="sxs-lookup"><span data-stu-id="7541a-117">Data attachments are simply attachments for which the contents of the attachment are stored directly in an attachment's **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) property.</span></span> <span data-ttu-id="7541a-118">Os anexos de dados existem principalmente para permitir que os clientes anexem arquivos a uma mensagem quando o remetente e o destinatário da mensagem não têm acesso a um servidor de arquivos comum.</span><span class="sxs-lookup"><span data-stu-id="7541a-118">Data attachments exist primarily to allow clients to attach files to a message when the sender and the recipient of the message do not have access to a common file server.</span></span> <span data-ttu-id="7541a-119">Para obter mais informações, **consulte PR_ATTACH_METHOD** propriedade ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="7541a-119">For more information, see the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="7541a-120">Anexos de mensagem são anexos para os quais o subobjeto do anexo é outro [IMessage: objeto MAPIProp.](imessageimapiprop.md)</span><span class="sxs-lookup"><span data-stu-id="7541a-120">Message attachments are attachments for which the attachment subobject is another [IMessage : MAPIProp](imessageimapiprop.md) object.</span></span> <span data-ttu-id="7541a-121">Como os provedores de armazenamento de mensagens já suportam a interface **IMessage,** o suporte a anexos de mensagens não é difícil.</span><span class="sxs-lookup"><span data-stu-id="7541a-121">Because message store providers already support the **IMessage** interface, supporting message attachments is not difficult.</span></span> 
  
<span data-ttu-id="7541a-122">Oferecer suporte a anexos de objeto OLE significa implementar as interfaces **OLE IStorage**, **IStream** e **IStreamDocfile.**</span><span class="sxs-lookup"><span data-stu-id="7541a-122">Supporting OLE object attachments means implementing the OLE **IStorage**, **IStream**, and **IStreamDocfile** interfaces.</span></span> <span data-ttu-id="7541a-123">Seu provedor de armazenamento de mensagens deve ser capaz de converter dados de objeto OLE armazenados na mensagem em um objeto OLE ativo quando um cliente abre o objeto.</span><span class="sxs-lookup"><span data-stu-id="7541a-123">Your message store provider must be able to convert OLE object data stored in the message into an active OLE object when a client opens the object.</span></span> 
  
<span data-ttu-id="7541a-124">Os links são de dois tipos: links para arquivos e links para outras mensagens.</span><span class="sxs-lookup"><span data-stu-id="7541a-124">Links come in two types: links to files and links to other messages.</span></span> <span data-ttu-id="7541a-125">Links para arquivos usam o valor ATTACH_BY_REF_ONLY para **a** propriedade PR_ATTACH_METHOD juntamente com **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) ou **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) para especificar o local de um arquivo.</span><span class="sxs-lookup"><span data-stu-id="7541a-125">Links to files use the ATTACH_BY_REF_ONLY value for the **PR_ATTACH_METHOD** property along with **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) or **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) to specify the location of a file.</span></span>
  
<span data-ttu-id="7541a-126">Como implementar links para mensagens pode depender de aspectos do sistema de mensagens local e, como tal, não pode ser totalmente documentado aqui.</span><span class="sxs-lookup"><span data-stu-id="7541a-126">How one implements links to messages may depend on aspects of the local messaging system and, as such, cannot be fully documented here.</span></span> <span data-ttu-id="7541a-127">Por exemplo, enviar um link para uma mensagem armazenada em um armazenamento de mensagens baseado em servidor geralmente é apenas uma questão de enviar o identificador de entrada da mensagem vinculada, desde que o remetente e o destinatário tenham acesso a esse servidor.</span><span class="sxs-lookup"><span data-stu-id="7541a-127">For example, sending a link to a message that is stored on a server-based message store is typically just a matter of sending the entry identifier of the linked message, providing that both the sender and recipient have access to that server.</span></span> <span data-ttu-id="7541a-128">Outras configurações do sistema de mensagens apresentam outros requisitos e desafios para implementar links para mensagens.</span><span class="sxs-lookup"><span data-stu-id="7541a-128">Other messaging system configurations present other requirements and challenges for implementing links to messages.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="7541a-129">Confira também</span><span class="sxs-lookup"><span data-stu-id="7541a-129">See also</span></span>



[<span data-ttu-id="7541a-130">Recursos do Armazenamento de Mensagens</span><span class="sxs-lookup"><span data-stu-id="7541a-130">Message Store Features</span></span>](message-store-features.md)

