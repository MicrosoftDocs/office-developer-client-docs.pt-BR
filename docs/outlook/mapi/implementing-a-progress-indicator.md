---
title: Implementando um indicador de progresso
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3a062a88-e87e-4c0c-944e-544a8f080930
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: 6972c960705c336aa6ff96d81b48ccbd490a22ee
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33435093"
---
# <a name="implementing-a-progress-indicator"></a><span data-ttu-id="ec44a-103">Implementando um indicador de progresso</span><span class="sxs-lookup"><span data-stu-id="ec44a-103">Implementing a Progress Indicator</span></span>

  
  
<span data-ttu-id="ec44a-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="ec44a-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="ec44a-105">Muitas das operações iniciadas pelos clientes levam um tempo significativo.</span><span class="sxs-lookup"><span data-stu-id="ec44a-105">Many of the operations initiated by clients take a significant amount of time.</span></span> <span data-ttu-id="ec44a-106">Um dos parâmetros de entrada para essas operações potencialmente longas é um ponteiro para um objeto de progresso — um objeto que implementa a interface [IMAPIProgress : IUnknown.](imapiprogressiunknown.md)</span><span class="sxs-lookup"><span data-stu-id="ec44a-106">One of the input parameters to these potentially lengthy operations is a pointer to a progress object — an object that implements the [IMAPIProgress : IUnknown](imapiprogressiunknown.md) interface.</span></span> <span data-ttu-id="ec44a-107">Os objetos de progresso controlam a aparência e a exibição dos indicadores de progresso e são implementados por clientes e por MAPI.</span><span class="sxs-lookup"><span data-stu-id="ec44a-107">Progress objects control the appearance and display of progress indicators and are implemented by clients and by MAPI.</span></span> <span data-ttu-id="ec44a-108">Você pode escolher se implementará ou não um objeto de progresso.</span><span class="sxs-lookup"><span data-stu-id="ec44a-108">You can choose whether or not to implement a progress object.</span></span> <span data-ttu-id="ec44a-109">A implementação de MAPI está disponível para os provedores de serviços usarem se você optar por não fornecer uma implementação.</span><span class="sxs-lookup"><span data-stu-id="ec44a-109">The MAPI implementation is available for service providers to use if you elect not to supply an implementation.</span></span> 
  
<span data-ttu-id="ec44a-110">Os objetos de progresso funcionam com as seguintes partes de dados:</span><span class="sxs-lookup"><span data-stu-id="ec44a-110">Progress objects work with the following pieces of data:</span></span>
  
- <span data-ttu-id="ec44a-111">Um valor mínimo global que, quando seu método [IMAPIProgress::P ess](imapiprogress-progress.md) é chamado, deve ser menor ou igual ao valor do parâmetro _ulValue._</span><span class="sxs-lookup"><span data-stu-id="ec44a-111">A global minimum value which, when your [IMAPIProgress::Progress](imapiprogress-progress.md) method is called, should be less than or equal to the value of the  _ulValue_ parameter.</span></span> <span data-ttu-id="ec44a-112">No início da operação,  _ulValue_ será igual a esse valor mínimo.</span><span class="sxs-lookup"><span data-stu-id="ec44a-112">At the beginning of the operation,  _ulValue_ will be equal to this minimum value.</span></span> 
    
- <span data-ttu-id="ec44a-113">Um valor máximo global que, quando seu método **IMAPIProgress::P ess** é chamado, deve ser maior ou igual ao parâmetro _ulValue._</span><span class="sxs-lookup"><span data-stu-id="ec44a-113">A global maximum value which, when your **IMAPIProgress::Progress** method is called, should be greater than or equal to the  _ulValue_ parameter.</span></span> <span data-ttu-id="ec44a-114">No final da operação,  _ulValue_ será igual a esse valor máximo.</span><span class="sxs-lookup"><span data-stu-id="ec44a-114">At the end of the operation,  _ulValue_ will be equal to this maximum value.</span></span> 
    
- <span data-ttu-id="ec44a-115">Um valor de sinalizador que indica se o andamento corresponde a um item de nível superior ou inferior.</span><span class="sxs-lookup"><span data-stu-id="ec44a-115">A flags value which indicates whether the progress corresponds to a top or lower level item.</span></span>
    
- <span data-ttu-id="ec44a-116">Um valor que indica o nível atual de progresso da operação.</span><span class="sxs-lookup"><span data-stu-id="ec44a-116">A value that indicates the current level of progress for the operation.</span></span>
    
- <span data-ttu-id="ec44a-117">O número de itens atualmente processados em relação ao total.</span><span class="sxs-lookup"><span data-stu-id="ec44a-117">The number of the currently processed items relative to the total.</span></span>
    
- <span data-ttu-id="ec44a-118">O número total de itens a serem processados durante a operação.</span><span class="sxs-lookup"><span data-stu-id="ec44a-118">The total number of items to be processed during the operation.</span></span>
    
<span data-ttu-id="ec44a-119">Os valores mínimo e máximo representam o início e o fim da operação em formato numérico.</span><span class="sxs-lookup"><span data-stu-id="ec44a-119">The minimum and maximum values represent the beginning and end of the operation in numeric form.</span></span> <span data-ttu-id="ec44a-120">Use 1 para o valor mínimo inicial e 1000 para o valor máximo inicial, passando esses valores para provedores de serviços nos métodos [IMAPIProgress::GetMin](imapiprogress-getmin.md) e [IMAPIProgress::GetMax.](imapiprogress-getmax.md)</span><span class="sxs-lookup"><span data-stu-id="ec44a-120">Use 1 for the initial minimum value and 1000 for the initial maximum value, passing these values to service providers in the [IMAPIProgress::GetMin](imapiprogress-getmin.md) and [IMAPIProgress::GetMax](imapiprogress-getmax.md) methods.</span></span> <span data-ttu-id="ec44a-121">Os provedores de serviços redefinem esses valores quando chamam [IMAPIProgress::SetLimits](imapiprogress-setlimits.md).</span><span class="sxs-lookup"><span data-stu-id="ec44a-121">Service providers reset these values when they call [IMAPIProgress::SetLimits](imapiprogress-setlimits.md).</span></span> 
  
<span data-ttu-id="ec44a-122">O valor de sinalizadores é usado pelos provedores de serviços para determinar como eles devem definir os outros valores.</span><span class="sxs-lookup"><span data-stu-id="ec44a-122">The flags value is used by service providers to determine how they should set the other values.</span></span> <span data-ttu-id="ec44a-123">Inicialize o valor de sinalizadores para MAPI_TOP_LEVEL e retorne esse valor em sua implementação de **GetFlags** até que o provedor de serviços o redefina chamando **SetLimits**.</span><span class="sxs-lookup"><span data-stu-id="ec44a-123">Initialize the flags value to MAPI_TOP_LEVEL and return this value in your implementation of **GetFlags** until the service provider resets it by calling **SetLimits**.</span></span> 
  
<span data-ttu-id="ec44a-124">Em sua implementação do **método SetLimits,** salve cópias locais de cada um dos parâmetros:  _lpulMin_,  _lpulMax_ e  _lpulFlags_.</span><span class="sxs-lookup"><span data-stu-id="ec44a-124">In your implementation of the **SetLimits** method, save local copies of each of the parameters:  _lpulMin_,  _lpulMax_, and  _lpulFlags_.</span></span> <span data-ttu-id="ec44a-125">Esses valores devem estar prontamente disponíveis quando um provedor de serviços chamar seus métodos **GetMin,** **GetMax** ou **GetFlags.**</span><span class="sxs-lookup"><span data-stu-id="ec44a-125">These values should be readily available when a service provider calls your **GetMin**, **GetMax**, or **GetFlags** methods.</span></span> 
  
<span data-ttu-id="ec44a-126">Para atualizar a exibição do indicador de progresso, os provedores de serviços chamam seu **método IMAPIProgress::P ress.**</span><span class="sxs-lookup"><span data-stu-id="ec44a-126">To update the display of the progress indicator, service providers call your **IMAPIProgress::Progress** method.</span></span> <span data-ttu-id="ec44a-127">Há três parâmetros para esse método: um valor, uma contagem e um total.</span><span class="sxs-lookup"><span data-stu-id="ec44a-127">There are three parameters to this method: a value, a count, and a total.</span></span> <span data-ttu-id="ec44a-128">Use o primeiro parâmetro,  _ulValue,_ para exibir o indicador de progresso.</span><span class="sxs-lookup"><span data-stu-id="ec44a-128">Use the first parameter,  _ulValue_, to display the progress indicator.</span></span> <span data-ttu-id="ec44a-129">O  _parâmetro ulValue_ é o indicador de progresso e será igual ao  _ulMin_ global apenas no início da operação e igual a  _ulMax_ global apenas na conclusão da operação.</span><span class="sxs-lookup"><span data-stu-id="ec44a-129">The  _ulValue_ parameter is the progress indicator and will be equal to global  _ulMin_ only at the very beginning of the operation and equal to global  _ulMax_ only at the completion of the operation.</span></span> 
  
<span data-ttu-id="ec44a-130">Use o segundo e o terceiro parâmetros,  _ulCount_ e  _ulTotal,_ se disponíveis, para exibir uma mensagem opcional, como "5 itens concluídos em 10".</span><span class="sxs-lookup"><span data-stu-id="ec44a-130">Use the second and third parameters,  _ulCount_ and  _ulTotal_, if available, to display an optional message such as "5 items completed out of 10."</span></span> <span data-ttu-id="ec44a-131">Se o segundo e o terceiro parâmetros são definidos como 0, você pode escolher se deve ou não alterar visualmente o indicador de progresso.</span><span class="sxs-lookup"><span data-stu-id="ec44a-131">If the second and third parameters are set to 0, you can choose whether or not to visually change the progress indicator.</span></span> <span data-ttu-id="ec44a-132">Alguns provedores de serviços configuram esses parâmetros como zeros para indicar que estão processando um subobjeto cujo progresso é monitorado em relação a um objeto pai.</span><span class="sxs-lookup"><span data-stu-id="ec44a-132">Some service providers set these parameters to zeroes to indicate that they are processing a subobject whose progress is monitored relative to a parent object.</span></span> <span data-ttu-id="ec44a-133">Nessa situação, faz sentido alterar a exibição somente quando o objeto pai relata progresso.</span><span class="sxs-lookup"><span data-stu-id="ec44a-133">In this situation, it makes sense to change the display only when the parent object reports progress.</span></span> <span data-ttu-id="ec44a-134">Alguns provedores de serviços sempre passam zeros para esses parâmetros.</span><span class="sxs-lookup"><span data-stu-id="ec44a-134">Some service providers pass zeroes for these parameters every time.</span></span> 
  

