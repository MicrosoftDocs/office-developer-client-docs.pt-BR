---
title: Implementando um indicador de progresso
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3a062a88-e87e-4c0c-944e-544a8f080930
description: '�ltima altera��o: s�bado, 23 de julho de 2011'
ms.openlocfilehash: 767b8723d9a544a31ee5c4bbc1d6186a15387b44
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19767407"
---
# <a name="implementing-a-progress-indicator"></a><span data-ttu-id="68877-103">Implementando um indicador de progresso</span><span class="sxs-lookup"><span data-stu-id="68877-103">Implementing a Progress Indicator</span></span>

  
  
<span data-ttu-id="68877-104">**Aplica-se a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="68877-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="68877-105">Muitas das operações iniciadas pelos clientes levar um período de tempo significativo.</span><span class="sxs-lookup"><span data-stu-id="68877-105">Many of the operations initiated by clients take a significant amount of time.</span></span> <span data-ttu-id="68877-106">Um dos parâmetros de entrada para essas operações potencialmente demoradas é um ponteiro para um objeto de progresso — um objeto que implementa o [IMAPIProgress: IUnknown](imapiprogressiunknown.md) interface.</span><span class="sxs-lookup"><span data-stu-id="68877-106">One of the input parameters to these potentially lengthy operations is a pointer to a progress object — an object that implements the [IMAPIProgress : IUnknown](imapiprogressiunknown.md) interface.</span></span> <span data-ttu-id="68877-107">Os objetos de progresso controlam a aparência e a exibição de indicadores de progresso e são implementados pelos clientes e por MAPI.</span><span class="sxs-lookup"><span data-stu-id="68877-107">Progress objects control the appearance and display of progress indicators and are implemented by clients and by MAPI.</span></span> <span data-ttu-id="68877-108">Você pode escolher se deseja ou não implementar um objeto de andamento.</span><span class="sxs-lookup"><span data-stu-id="68877-108">You can choose whether or not to implement a progress object.</span></span> <span data-ttu-id="68877-109">A implementação do MAPI está disponível para provedores de serviço a ser usado se você optar por não fornecer uma implementação.</span><span class="sxs-lookup"><span data-stu-id="68877-109">The MAPI implementation is available for service providers to use if you elect not to supply an implementation.</span></span> 
  
<span data-ttu-id="68877-110">Objetos de progresso trabalham com as seguintes partes dos dados:</span><span class="sxs-lookup"><span data-stu-id="68877-110">Progress objects work with the following pieces of data:</span></span>
  
- <span data-ttu-id="68877-111">Um valor mínimo global que, quando o método [IMAPIProgress::Progress](imapiprogress-progress.md) é chamado, deve ser menor ou igual ao valor do parâmetro _ulValue_ .</span><span class="sxs-lookup"><span data-stu-id="68877-111">A global minimum value which, when your [IMAPIProgress::Progress](imapiprogress-progress.md) method is called, should be less than or equal to the value of the  _ulValue_ parameter.</span></span> <span data-ttu-id="68877-112">No início da operação, _ulValue_ será igual a este valor mínimo.</span><span class="sxs-lookup"><span data-stu-id="68877-112">At the beginning of the operation,  _ulValue_ will be equal to this minimum value.</span></span> 
    
- <span data-ttu-id="68877-113">Um valor máximo global que, quando o método **IMAPIProgress::Progress** é chamado, deve ser maior ou igual ao parâmetro _ulValue_ .</span><span class="sxs-lookup"><span data-stu-id="68877-113">A global maximum value which, when your **IMAPIProgress::Progress** method is called, should be greater than or equal to the  _ulValue_ parameter.</span></span> <span data-ttu-id="68877-114">No final da operação, _ulValue_ será igual a esse valor máximo.</span><span class="sxs-lookup"><span data-stu-id="68877-114">At the end of the operation,  _ulValue_ will be equal to this maximum value.</span></span> 
    
- <span data-ttu-id="68877-115">Sinalizadores de um valor que indica se o progresso corresponde a um parte superior ou diminuir nível de item.</span><span class="sxs-lookup"><span data-stu-id="68877-115">A flags value which indicates whether the progress corresponds to a top or lower level item.</span></span>
    
- <span data-ttu-id="68877-116">Um valor que indica o nível de progresso da operação atual.</span><span class="sxs-lookup"><span data-stu-id="68877-116">A value that indicates the current level of progress for the operation.</span></span>
    
- <span data-ttu-id="68877-117">O número de itens atualmente processados em relação ao total.</span><span class="sxs-lookup"><span data-stu-id="68877-117">The number of the currently processed items relative to the total.</span></span>
    
- <span data-ttu-id="68877-118">O número total de itens a serem processados durante a operação.</span><span class="sxs-lookup"><span data-stu-id="68877-118">The total number of items to be processed during the operation.</span></span>
    
<span data-ttu-id="68877-119">Os valores máximo e mínimo representam o início e término da operação no formulário numérico.</span><span class="sxs-lookup"><span data-stu-id="68877-119">The minimum and maximum values represent the beginning and end of the operation in numeric form.</span></span> <span data-ttu-id="68877-120">Use 1 para o valor mínimo inicial e 1000 para o valor máximo inicial, passando esses valores com provedores de serviços nos métodos [IMAPIProgress::GetMin](imapiprogress-getmin.md) e [IMAPIProgress::GetMax](imapiprogress-getmax.md) .</span><span class="sxs-lookup"><span data-stu-id="68877-120">Use 1 for the initial minimum value and 1000 for the initial maximum value, passing these values to service providers in the [IMAPIProgress::GetMin](imapiprogress-getmin.md) and [IMAPIProgress::GetMax](imapiprogress-getmax.md) methods.</span></span> <span data-ttu-id="68877-121">Provedores de serviços redefinir esses valores quando ele liga [IMAPIProgress::SetLimits](imapiprogress-setlimits.md).</span><span class="sxs-lookup"><span data-stu-id="68877-121">Service providers reset these values when they call [IMAPIProgress::SetLimits](imapiprogress-setlimits.md).</span></span> 
  
<span data-ttu-id="68877-122">O valor flags é usado pelos provedores de serviços para determinar como eles devem definir os outros valores.</span><span class="sxs-lookup"><span data-stu-id="68877-122">The flags value is used by service providers to determine how they should set the other values.</span></span> <span data-ttu-id="68877-123">Inicializar o valor de sinalizadores para MAPI_TOP_LEVEL e retornar esse valor na sua implementação de **GetFlags** até que o provedor de serviços redefine chamando **SetLimits**.</span><span class="sxs-lookup"><span data-stu-id="68877-123">Initialize the flags value to MAPI_TOP_LEVEL and return this value in your implementation of **GetFlags** until the service provider resets it by calling **SetLimits**.</span></span> 
  
<span data-ttu-id="68877-124">Em sua implementação do método **SetLimits** , salvar cópias locais de cada um dos parâmetros: _lpulMin_, _lpulMax_e _lpulFlags_.</span><span class="sxs-lookup"><span data-stu-id="68877-124">In your implementation of the **SetLimits** method, save local copies of each of the parameters:  _lpulMin_,  _lpulMax_, and  _lpulFlags_.</span></span> <span data-ttu-id="68877-125">Esses valores devem ser prontamente disponíveis quando um provedor de serviço chama seus métodos **GetMin**, **GetMax**ou **GetFlags** .</span><span class="sxs-lookup"><span data-stu-id="68877-125">These values should be readily available when a service provider calls your **GetMin**, **GetMax**, or **GetFlags** methods.</span></span> 
  
<span data-ttu-id="68877-126">Para atualizar a exibição do indicador de progresso, provedores de serviços chamarem seu método de **IMAPIProgress::Progress** .</span><span class="sxs-lookup"><span data-stu-id="68877-126">To update the display of the progress indicator, service providers call your **IMAPIProgress::Progress** method.</span></span> <span data-ttu-id="68877-127">Há três parâmetros para esse método: um valor, uma contagem e um total.</span><span class="sxs-lookup"><span data-stu-id="68877-127">There are three parameters to this method: a value, a count, and a total.</span></span> <span data-ttu-id="68877-128">Use o primeiro parâmetro, _ulValue_, para exibir o indicador de progresso.</span><span class="sxs-lookup"><span data-stu-id="68877-128">Use the first parameter,  _ulValue_, to display the progress indicator.</span></span> <span data-ttu-id="68877-129">O parâmetro _ulValue_ é o indicador de progresso e será igual a global _ulMin_ somente no início da operação e igual a global _ulMax_ apenas na conclusão da operação.</span><span class="sxs-lookup"><span data-stu-id="68877-129">The  _ulValue_ parameter is the progress indicator and will be equal to global  _ulMin_ only at the very beginning of the operation and equal to global  _ulMax_ only at the completion of the operation.</span></span> 
  
<span data-ttu-id="68877-130">Use o segundo e terceiro parâmetros, _ulCount_ e _ulTotal_, se disponível, para exibir uma mensagem opcional, como "5 itens concluída fora de 10."</span><span class="sxs-lookup"><span data-stu-id="68877-130">Use the second and third parameters,  _ulCount_ and  _ulTotal_, if available, to display an optional message such as "5 items completed out of 10."</span></span> <span data-ttu-id="68877-131">Se o segundo e terceiro parâmetros forem definido como 0, você poderá escolher se deseja ou não alterar visualmente o indicador de progresso.</span><span class="sxs-lookup"><span data-stu-id="68877-131">If the second and third parameters are set to 0, you can choose whether or not to visually change the progress indicator.</span></span> <span data-ttu-id="68877-132">Alguns provedores de serviços definido esses parâmetros como zeros para indicar que eles são processando um Subobjeto cujo andamento é monitorado em relação um objeto pai.</span><span class="sxs-lookup"><span data-stu-id="68877-132">Some service providers set these parameters to zeroes to indicate that they are processing a subobject whose progress is monitored relative to a parent object.</span></span> <span data-ttu-id="68877-133">Nessa situação, faz sentido para alterar a exibição somente quando o objeto pai relata o progresso.</span><span class="sxs-lookup"><span data-stu-id="68877-133">In this situation, it makes sense to change the display only when the parent object reports progress.</span></span> <span data-ttu-id="68877-134">Alguns provedores de serviços passam zeros para esses parâmetros de cada vez.</span><span class="sxs-lookup"><span data-stu-id="68877-134">Some service providers pass zeroes for these parameters every time.</span></span> 
  

