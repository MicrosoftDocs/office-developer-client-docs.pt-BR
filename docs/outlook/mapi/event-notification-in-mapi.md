---
title: Notificações de eventos no MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7b3b625b-6dea-4b12-99a9-152935bdfe39
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: 30d4ad5e0fc1ecdc4c8eb06f75d39e38dd481269
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32321390"
---
# <a name="event-notification-in-mapi"></a><span data-ttu-id="e30c7-103">Notificações de eventos no MAPI</span><span class="sxs-lookup"><span data-stu-id="e30c7-103">Event notification in MAPI</span></span>

<span data-ttu-id="e30c7-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="e30c7-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="e30c7-105">A notificação de eventos é a comunicação de informações entre dois objetos MAPI.</span><span class="sxs-lookup"><span data-stu-id="e30c7-105">Event notification is the communication of information between two MAPI objects.</span></span> <span data-ttu-id="e30c7-106">Por meio de um dos objetos, um cliente ou provedor de serviços registra para notificação de uma alteração ou erro, chamada de evento, que pode ocorrer no outro objeto.</span><span class="sxs-lookup"><span data-stu-id="e30c7-106">Through one of the objects, a client or service provider registers for notification of a change or error, called an event, which may take place in the other object.</span></span> <span data-ttu-id="e30c7-107">Após o evento ocorrer, o primeiro objeto é notificado da alteração ou erro.</span><span class="sxs-lookup"><span data-stu-id="e30c7-107">After the event occurs, the first object is notified of the change or error.</span></span> <span data-ttu-id="e30c7-108">O objeto que recebe a notificação é chamado de coletor de aviso; o objeto responsável pela notificação é chamado de fonte de aviso.</span><span class="sxs-lookup"><span data-stu-id="e30c7-108">The object receiving the notification is called the advise sink; the object responsible for the notification is called the advise source.</span></span>
  
<span data-ttu-id="e30c7-109">Há três tipos de objetos de coletor de aviso (todos os tipos são objetos MAPI padrão):</span><span class="sxs-lookup"><span data-stu-id="e30c7-109">There are three types of advise sink objects (all types are standard MAPI objects):</span></span>
  
- <span data-ttu-id="e30c7-110">Avisar objetos de coletor.</span><span class="sxs-lookup"><span data-stu-id="e30c7-110">Advise sink objects.</span></span>   
- <span data-ttu-id="e30c7-111">Objetos do coletor de aviso de formulário.</span><span class="sxs-lookup"><span data-stu-id="e30c7-111">Form advise sink objects.</span></span>  
- <span data-ttu-id="e30c7-112">Exibir objetos do coletor de aviso.</span><span class="sxs-lookup"><span data-stu-id="e30c7-112">View advise sink objects.</span></span>
    
<span data-ttu-id="e30c7-113">Os objetos de coletor de aviso são o tipo mais comum.</span><span class="sxs-lookup"><span data-stu-id="e30c7-113">Advise sink objects are the most common type.</span></span> <span data-ttu-id="e30c7-114">Os coletores de aviso geralmente são implementados por aplicativos cliente para receber notificações de catálogo de endereços e repositório de mensagens e dão suporte à interface [IMAPIAdviseSink: IUnknown](imapiadvisesinkiunknown.md) .</span><span class="sxs-lookup"><span data-stu-id="e30c7-114">Advise sinks are typically implemented by client applications to receive address book and message store notifications and support the [IMAPIAdviseSink : IUnknown](imapiadvisesinkiunknown.md) interface.</span></span> <span data-ttu-id="e30c7-115">**IMAPIAdviseSink** contém um único método, [IMAPIAdviseSink:: OnNotify](imapiadvisesink-onnotify.md).</span><span class="sxs-lookup"><span data-stu-id="e30c7-115">**IMAPIAdviseSink** contains a single method, [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md).</span></span> <span data-ttu-id="e30c7-116">Os coletores de aviso de formulário e de exibição são menos comuns; Eles são implementados para receber notificações sobre alterações em formulários personalizados.</span><span class="sxs-lookup"><span data-stu-id="e30c7-116">Form and view advise sinks are less common; they are implemented to receive notifications about changes to custom forms.</span></span> <span data-ttu-id="e30c7-117">Coletores de aviso de formulário suportam a interface [IMAPIFormAdviseSink: IUnknown](imapiformadvisesinkiunknown.md) e os coletores de aviso de exibição dão suporte à interface [IMAPIViewAdviseSink: IUnknown](imapiviewadvisesinkiunknown.md) .</span><span class="sxs-lookup"><span data-stu-id="e30c7-117">Form advise sinks support the [IMAPIFormAdviseSink : IUnknown](imapiformadvisesinkiunknown.md) interface and view advise sinks support the [IMAPIViewAdviseSink : IUnknown](imapiviewadvisesinkiunknown.md) interface.</span></span> <span data-ttu-id="e30c7-118">Como a maioria dos clientes implementam objetos de coletor de aviso padrão, considere que as discussões de notificações se relacionam às notificações de catálogo de endereços e de mensagens, em vez de notificações de formulários.</span><span class="sxs-lookup"><span data-stu-id="e30c7-118">Because most clients implement standard advise sink objects, assume that discussions of notifications relate to address book and message store notifications rather than forms notifications.</span></span> <span data-ttu-id="e30c7-119">Para obter mais informações sobre notificações de formulários, consulte [MAPI Forms Notifications](mapi-forms-notifications.md) e [Writing Form Server Code](writing-form-server-code.md).</span><span class="sxs-lookup"><span data-stu-id="e30c7-119">For more information about forms notifications, see [MAPI Forms Notifications](mapi-forms-notifications.md) and [Writing Form Server Code](writing-form-server-code.md).</span></span>
  
<span data-ttu-id="e30c7-120">Os objetos de origem de aviso são implementados por provedores de serviço e por MAPI.</span><span class="sxs-lookup"><span data-stu-id="e30c7-120">Advise source objects are implemented by service providers and by MAPI.</span></span> <span data-ttu-id="e30c7-121">Nem todos os provedores de serviços dão suporte à notificação de eventos; é opcional, mas é altamente recomendável.</span><span class="sxs-lookup"><span data-stu-id="e30c7-121">Not all service providers support event notification; it is optional, but strongly recommended.</span></span> <span data-ttu-id="e30c7-122">O repositório de mensagens e os provedores de catálogo de endereços geralmente dão suporte a notificações de objeto em vários de seus objetos e notificações de tabela em suas tabelas de conteúdo e hierarquia.</span><span class="sxs-lookup"><span data-stu-id="e30c7-122">Message store and address book providers usually support object notifications on several of their objects and table notifications on their contents and hierarchy tables.</span></span> <span data-ttu-id="e30c7-123">Os provedores de transporte não dão suporte a notificações diretamente; Eles dependem de métodos alternativos de comunicação com clientes.</span><span class="sxs-lookup"><span data-stu-id="e30c7-123">Transport providers do not support notifications directly; they rely on alternative methods of communication with clients.</span></span>
  
<span data-ttu-id="e30c7-124">Ao contrário dos coletores de aviso, os objetos de origem de aviso não são um tipo exclusivo de objeto MAPI.</span><span class="sxs-lookup"><span data-stu-id="e30c7-124">Unlike advise sinks, advise source objects are not a unique type of MAPI object.</span></span> <span data-ttu-id="e30c7-125">Muitos objetos MAPI, como repositórios de mensagens e tabelas, podem assumir a função da fonte de aviso.</span><span class="sxs-lookup"><span data-stu-id="e30c7-125">Many MAPI objects, such as message stores and tables, can take on the role of advise source.</span></span> <span data-ttu-id="e30c7-126">Uma fonte de aviso é qualquer objeto MAPI que faz o seguinte:</span><span class="sxs-lookup"><span data-stu-id="e30c7-126">An advise source is any MAPI object that does the following:</span></span>
  
- <span data-ttu-id="e30c7-127">Implementa um método **Advise** para receber registros de notificação.</span><span class="sxs-lookup"><span data-stu-id="e30c7-127">Implements an **Advise** method to receive notification registrations.</span></span> 
    
- <span data-ttu-id="e30c7-128">Implementa um método **Unadvise** para receber cancelamentos de notificação.</span><span class="sxs-lookup"><span data-stu-id="e30c7-128">Implements an **Unadvise** method to receive notification cancellations.</span></span> 
    
- <span data-ttu-id="e30c7-129">Gera notificações do tipo apropriado para os objetos de coletor de aviso apropriados que foram registrados chamando seus métodos **IMAPIAdviseSink:: OnNotify** .</span><span class="sxs-lookup"><span data-stu-id="e30c7-129">Generates notifications of the appropriate type to the appropriate advise sink objects that have registered by calling their **IMAPIAdviseSink::OnNotify** methods.</span></span> 
    
<span data-ttu-id="e30c7-130">Os clientes que implementam os objetos \*\*\*\* de coletor de aviso de chamada avisam quando querem se registrar em uma notificação, na maioria dos casos, passando o identificador de entrada do objeto com o qual o registro deve ocorrer e **Unadvise** quando deseja cancelar o registro.</span><span class="sxs-lookup"><span data-stu-id="e30c7-130">Clients that implement advise sink objects call **Advise** when they want to register for a notification, in most cases passing in the entry identifier of the object with which registration should occur, and **Unadvise** when they want to cancel the registration.</span></span> <span data-ttu-id="e30c7-131">Os clientes passam um parâmetro para **avisar** que indica quais dos vários tipos de eventos que desejam monitorar.</span><span class="sxs-lookup"><span data-stu-id="e30c7-131">Clients pass a parameter to **Advise** that indicates which of the several types of events they want to monitor.</span></span> <span data-ttu-id="e30c7-132">**Advise** retorna um número diferente de zero que representa uma conexão bem-sucedida entre o coletor de aviso e a fonte de aviso.</span><span class="sxs-lookup"><span data-stu-id="e30c7-132">**Advise** returns a nonzero number that represents a successful connection between the advise sink and advise source.</span></span> 
  
<span data-ttu-id="e30c7-133">Antes de chamar **avisar**, os clientes podem determinar se um provedor de repositório de mensagens oferece suporte à notificação verificando se o sinalizador STORE_NOTIFY_OK está definido na **PR_STORE_SUPPORT_MASK** do repositório de mensagens ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) Propriedades.</span><span class="sxs-lookup"><span data-stu-id="e30c7-133">Before calling **Advise**, clients can determine whether a message store provider supports notification by checking that the STORE_NOTIFY_OK flag is set in the message store's **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property.</span></span> <span data-ttu-id="e30c7-134">Não há uma maneira de os clientes determinarem com antecedência se um provedor de catálogo de endereços oferece ou não suporte a notificações.</span><span class="sxs-lookup"><span data-stu-id="e30c7-134">There is no way for clients to determine ahead of time whether or not an address book provider supports notifications.</span></span> <span data-ttu-id="e30c7-135">Os clientes devem tentar registrar e, se a tentativa falhar, eles podem supor que as notificações não são suportadas.</span><span class="sxs-lookup"><span data-stu-id="e30c7-135">Clients must attempt to register and if the attempt fails, they can assume notifications are unsupported.</span></span>
  
<span data-ttu-id="e30c7-136">Quando um evento para o qual um cliente registrou ocorre, a fonte de aviso notifica o coletor de aviso chamando o método [IMAPIAdviseSink:: OnNotify](imapiadvisesink-onnotify.md) com uma estrutura de dados de notificação que contém informações sobre o evento.</span><span class="sxs-lookup"><span data-stu-id="e30c7-136">When an event for which a client has registered occurs, the advise source notifies the advise sink by calling its [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) method with a notification data structure that contains information about the event.</span></span> <span data-ttu-id="e30c7-137">Uma implementação do onNotify do \*\*\*\* coletor de avisos pode executar tarefas em resposta à notificação, como atualizar dados na memória ou atualizar uma exibição de tela.</span><span class="sxs-lookup"><span data-stu-id="e30c7-137">An advise sink's implementation of **OnNotify** can perform tasks in response to the notification, such as updating data in memory or refreshing a screen display.</span></span> 
  
<span data-ttu-id="e30c7-138">Os provedores de serviços podem implementar o suporte para notificações manualmente ou aproveitar a ajuda fornecida em três métodos do **IMAPISupport** : [IMAPISupport:: Subscribe](imapisupport-subscribe.md), [IMAPISupport:: unsubscribe](imapisupport-unsubscribe.md)e [IMAPISupport:: Notify ](imapisupport-notify.md).</span><span class="sxs-lookup"><span data-stu-id="e30c7-138">Service providers can implement support for notifications manually or take advantage of the help provided in three **IMAPISupport** methods: [IMAPISupport::Subscribe](imapisupport-subscribe.md), [IMAPISupport::Unsubscribe](imapisupport-unsubscribe.md), and [IMAPISupport::Notify](imapisupport-notify.md).</span></span> <span data-ttu-id="e30c7-139">Os métodos de **assinatura** e cancelamento de **assinatura** cuidam do registro e cancelamento de registro de notificações para provedores o método **Notify** trata de enviar notificações quando apropriado.</span><span class="sxs-lookup"><span data-stu-id="e30c7-139">The **Subscribe** and **Unsubscribe** methods handle notification registration and deregistration for providers; the **Notify** method handles sending notifications when appropriate.</span></span> 
  
<span data-ttu-id="e30c7-140">Para usar os métodos de objeto de suporte para registro de notificação, os provedores de serviços chamam [IMAPISupport:: inscrever-se](imapisupport-subscribe.md) em seus métodos de **aviso** e passar para **inscrever** o ponteiro do coletor de aviso que os clientes passam para **avisar**.</span><span class="sxs-lookup"><span data-stu-id="e30c7-140">To use the support object methods for notification registration, service providers call [IMAPISupport::Subscribe](imapisupport-subscribe.md) in their **Advise** methods and pass to **Subscribe** the advise sink pointer that clients pass to **Advise**.</span></span> <span data-ttu-id="e30c7-141">Se um identificador de entrada for passado como um parâmetro de entrada para especificar uma fonte de aviso, os provedores de serviços o converterão em uma chave binária.</span><span class="sxs-lookup"><span data-stu-id="e30c7-141">If an entry identifier is passed as an input parameter to specify an advise source, service providers convert it to a binary key.</span></span> <span data-ttu-id="e30c7-142">**Subscribe** cria um número de conexão exclusivo e é esse número que os provedores de serviço retornam aos clientes.</span><span class="sxs-lookup"><span data-stu-id="e30c7-142">**Subscribe** creates a unique connection number and it is this number that service providers return to clients.</span></span> <span data-ttu-id="e30c7-143">Os provedores de serviços podem liberar o ponteiro do objeto do coletor de aviso do cliente a qualquer momento depois que a chamada de **aviso** tiver sido concluída.</span><span class="sxs-lookup"><span data-stu-id="e30c7-143">Service providers can release the client's advise sink object pointer at any time after the **Advise** call has completed.</span></span> 
  
<span data-ttu-id="e30c7-144">Quando os clientes chamam o **aviso** para cancelar um registro, os provedores de serviços decrementam a contagem de referência no ponteiro de coletor de aviso do cliente ou solicitam o cancelamento da **assinatura** para fazer o mesmo.</span><span class="sxs-lookup"><span data-stu-id="e30c7-144">When clients call **Unadvise** to cancel a registration, service providers either decrement the reference count on the client's advise sink pointer or call **Unsubscribe** to do the same.</span></span> 
  
<span data-ttu-id="e30c7-145">Quando é hora de gerar uma notificação, os provedores de serviços realizam qualquer processamento interno relacionado à notificação e Inicializa uma estrutura de [notificação](notification.md) definindo todos os membros não usados como zero.</span><span class="sxs-lookup"><span data-stu-id="e30c7-145">When it is time to generate a notification, service providers perform any internal processing that relates to the notification and initializes a [NOTIFICATION](notification.md) structure by setting all of its unused members to zero.</span></span> <span data-ttu-id="e30c7-146">Essa técnica de inicialização da estrutura de **notificação** pode ajudar os clientes a criar implementações de OnNotify, \*\*\*\* menores, mais rápidas e menos sujeitas a erros.</span><span class="sxs-lookup"><span data-stu-id="e30c7-146">This technique for initializing the **NOTIFICATION** structure can help clients create smaller, faster, and less error-prone **OnNotify** implementations.</span></span> 
  
<span data-ttu-id="e30c7-147">A ilustração a seguir mostra a comunicação entre os objetos do coletor de aviso, os objetos de origem do aviso e o MAPI.</span><span class="sxs-lookup"><span data-stu-id="e30c7-147">The following illustration shows the communication between advise sink objects, advise source objects, and MAPI.</span></span> <span data-ttu-id="e30c7-148">O MAPI é envolvido somente quando a fonte de aviso chama os métodos **IMAPISupport** para obter suporte para notificação.</span><span class="sxs-lookup"><span data-stu-id="e30c7-148">MAPI is involved only when the advise source calls the **IMAPISupport** methods for notification support.</span></span> 
  
<span data-ttu-id="e30c7-149">**Event notification calls**</span><span class="sxs-lookup"><span data-stu-id="e30c7-149">**Event notification calls**</span></span>
  
<span data-ttu-id="e30c7-150">![Chamadas de notificação de eventos] (media/amapi_51.gif "Chamadas de notificação de eventos")</span><span class="sxs-lookup"><span data-stu-id="e30c7-150">![Event notification calls](media/amapi_51.gif "Event notification calls")</span></span>
  
<span data-ttu-id="e30c7-151">A classe MFCMAPI **CAdviseSink** (usando os arquivos AdviseSink. h e AdviseSink. cpp) implementa o objeto de coletor de aviso para todas as chamadas para **Advise**.</span><span class="sxs-lookup"><span data-stu-id="e30c7-151">The MFCMAPI **CAdviseSink** class (using the AdviseSink.h and AdviseSink.cpp files) implements the advise sink object for all calls to **Advise**.</span></span> <span data-ttu-id="e30c7-152">Para obter mais informações sobre o MFCMAPI, consulte [MFCMAPI como um exemplo de código](mfcmapi-as-a-code-sample.md) e [MFCMAPI](https://go.microsoft.com/fwlink/?LinkId=124154).</span><span class="sxs-lookup"><span data-stu-id="e30c7-152">For more information about MFCMAPI, see [MFCMAPI as a Code Sample](mfcmapi-as-a-code-sample.md) and [MFCMAPI](https://go.microsoft.com/fwlink/?LinkId=124154).</span></span>
  

