---
title: Visão geral do serviço de mensagem MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 58f36a6b-bcc5-4ebb-9761-6f420a718d97
description: '�ltima altera��o: s�bado, 23 de julho de 2011'
ms.openlocfilehash: fc444725aae20e7321fa287a90cf7d3e13b7ffb4
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19767879"
---
# <a name="mapi-message-service-overview"></a><span data-ttu-id="bfc06-103">Visão geral do serviço de mensagem MAPI</span><span class="sxs-lookup"><span data-stu-id="bfc06-103">MAPI message service overview</span></span>
  
<span data-ttu-id="bfc06-104">**Aplica-se a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="bfc06-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="bfc06-105">Um serviço de mensagem define um grupo de provedores de serviço relacionado, normalmente os provedores de serviços que funcionam com o mesmo sistema de mensagens.</span><span class="sxs-lookup"><span data-stu-id="bfc06-105">A message service defines a group of related service providers, typically service providers that work with the same messaging system.</span></span> <span data-ttu-id="bfc06-106">Enquanto os provedores de serviços de executam o trabalho de comunicação entre sistemas de mensagens e o subsistema MAPI, serviços de mensagem realizar o trabalho de interface entre o usuário e os provedores de serviços que funcionam com um sistema de mensagens comuns.</span><span class="sxs-lookup"><span data-stu-id="bfc06-106">Whereas service providers perform the work of communicating between messaging systems and the MAPI subsystem, message services perform the work of interfacing between the user and service providers that work with a common messaging system.</span></span>  
  
<span data-ttu-id="bfc06-107">Serviços de mensagens existem para facilitar a instalação e configuração dos provedores de serviços para os usuários.</span><span class="sxs-lookup"><span data-stu-id="bfc06-107">Message services exist to make the installation and configuration of service providers easier for users.</span></span> <span data-ttu-id="bfc06-108">Usuários nunca diretamente instalar ou configurar um provedor de serviços; o serviço de mensagem completamente trata a instalação e configuração de cada um dos provedores de serviços que pertencem ao serviço.</span><span class="sxs-lookup"><span data-stu-id="bfc06-108">Users never directly install or configure a service provider; the message service completely handles the installation and configuration of each of the service providers that belong to the service.</span></span> <span data-ttu-id="bfc06-109">Devido a esse recurso, os usuários não precisará estar familiarizado com os requisitos de configuração de provedor de serviço específico.</span><span class="sxs-lookup"><span data-stu-id="bfc06-109">Because of this feature, users do not need to be familiar with specific service provider configuration requirements.</span></span> 
  
<span data-ttu-id="bfc06-110">A figura a seguir mostra a relação entre dois serviços de mensagem e de um aplicativo cliente baseado em mensagens.</span><span class="sxs-lookup"><span data-stu-id="bfc06-110">The following figure shows the relationship between a messaging-based client application and two message services.</span></span>
  
<span data-ttu-id="bfc06-111">**Message service installation and configuration**</span><span class="sxs-lookup"><span data-stu-id="bfc06-111">**Message service installation and configuration**</span></span>
  
<span data-ttu-id="bfc06-112">![Configuração e instalação do serviço de mensagem] (media/amapi_44.gif "Configuração e instalação do serviço de mensagem")</span><span class="sxs-lookup"><span data-stu-id="bfc06-112">![Message service installation and configuration](media/amapi_44.gif "Message service installation and configuration")</span></span>
  
<span data-ttu-id="bfc06-113">O usuário chama o código de instalação de cada serviço de mensagem para adicionar o serviço e seus provedores de serviço a um perfil.</span><span class="sxs-lookup"><span data-stu-id="bfc06-113">The user invokes the installation code of each message service to add the service and its service providers to a profile.</span></span> <span data-ttu-id="bfc06-114">Em um dos serviços de mensagem mostrados na figura, há três provedores de serviços; o outro serviço de mensagem, há dois provedores de serviço.</span><span class="sxs-lookup"><span data-stu-id="bfc06-114">In one of the message services shown in the figure, there are three service providers; in the other message service, there are two service providers.</span></span> <span data-ttu-id="bfc06-115">Em algum momento posterior após a instalação for concluída, geralmente no momento do logon, os provedores de serviços em cada serviço de mensagem são configurados.</span><span class="sxs-lookup"><span data-stu-id="bfc06-115">At some later time after installation is complete, typically at logon time, the service providers in each message service are configured.</span></span> <span data-ttu-id="bfc06-116">O código de configuração de cada serviço de mensagem lida com a configuração dos provedores no serviço.</span><span class="sxs-lookup"><span data-stu-id="bfc06-116">The configuration code in each message service handles the configuration of the providers in the service.</span></span>
  
<span data-ttu-id="bfc06-117">Quando um serviço de mensagem é instalado, o seu programa de instalação copia os arquivos necessários da origem de instalação no disco local do usuário e atualiza um arquivo de configuração, Mapisvc.</span><span class="sxs-lookup"><span data-stu-id="bfc06-117">When a message service is installed, its installation program copies necessary files from the installation source to the user's local disk and updates a configuration file, Mapisvc.inf.</span></span> <span data-ttu-id="bfc06-118">O arquivo Mapisvc contém definições de configuração para todos os serviços de mensagens e provedores de serviços que podem ser instalados no computador.</span><span class="sxs-lookup"><span data-stu-id="bfc06-118">The Mapisvc.inf file contains configuration settings for all of the message services and service providers that can be installed on the computer.</span></span> <span data-ttu-id="bfc06-119">Ele é organizado nas seções hierárquicas, com links entre cada seção em cada nível.</span><span class="sxs-lookup"><span data-stu-id="bfc06-119">It is organized in hierarchical sections, with links between each section at each level.</span></span> <span data-ttu-id="bfc06-120">Seção de nível superior contém informações relevantes para o subsistema MAPI, como uma lista de todos os serviços de mensagens disponível e para a instalação da Ajuda online.</span><span class="sxs-lookup"><span data-stu-id="bfc06-120">The section at the top level contains information that is relevant for the MAPI subsystem, such as a list of all available message services, and for the online Help installation.</span></span> <span data-ttu-id="bfc06-121">O próximo nível tem seções para cada serviço de mensagem, com informações como o nome do arquivo DLL do serviço de mensagem e o nome da sua função de ponto de entrada de configuração.</span><span class="sxs-lookup"><span data-stu-id="bfc06-121">The next level has sections for each message service, with information such as the DLL file name of the message service and the name of its configuration entry point function.</span></span> <span data-ttu-id="bfc06-122">O terceiro nível tem seções com dados de configuração para cada provedor de serviço no serviço de mensagem.</span><span class="sxs-lookup"><span data-stu-id="bfc06-122">The third level has sections with configuration data for each service provider in the message service.</span></span> 
  
<span data-ttu-id="bfc06-123">Para lidar com a configuração, um serviço de mensagem implementa uma função de ponto de entrada que seja compatível com um protótipo definido por MAPI e uma caixa de diálogo tabulada conhecido como uma folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="bfc06-123">To handle configuration, a message service implements an entry point function that complies with a prototype defined by MAPI, and a tabbed dialog box known as a property sheet.</span></span> <span data-ttu-id="bfc06-124">MAPI chama a função do ponto de entrada para solicitações de cliente de serviço relacionados ao gerenciamento de perfil e o gerenciamento dos provedores de serviço no serviço de mensagem.</span><span class="sxs-lookup"><span data-stu-id="bfc06-124">MAPI calls the entry point function to service client requests that relate to profile management and the management of service providers in the message service.</span></span> <span data-ttu-id="bfc06-125">Folhas de propriedade são usadas para exibir e alterar propriedades de configuração de provedor de serviço e de serviço de mensagem.</span><span class="sxs-lookup"><span data-stu-id="bfc06-125">Property sheets are used for viewing and changing message service and service provider configuration properties.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="bfc06-126">Confira também</span><span class="sxs-lookup"><span data-stu-id="bfc06-126">See also</span></span>

- [<span data-ttu-id="bfc06-127">Arquitetura e os recursos MAPI</span><span class="sxs-lookup"><span data-stu-id="bfc06-127">MAPI Features and Architecture</span></span>](mapi-features-and-architecture.md)

