---
title: Manipular uma mensagem de entrada
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d45d5ed9-41cd-4aaf-91d2-1e4a27bb16d4
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: f3fbe34793e3520b26b984f4bd6b14fbcab7a951
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32299402"
---
# <a name="handling-an-incoming-message"></a><span data-ttu-id="a4dbb-103">Manipular uma mensagem de entrada</span><span class="sxs-lookup"><span data-stu-id="a4dbb-103">Handling an incoming message</span></span>

<span data-ttu-id="a4dbb-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a4dbb-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="a4dbb-105">Uma mensagem de entrada é uma mensagem que foi enviada por um ou mais sistemas de mensagens.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-105">An incoming message is a message that has been sent across one or more messaging systems.</span></span> <span data-ttu-id="a4dbb-106">Ele pode ter sido enviado apenas para você ou para muitos outros destinatários.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-106">It may have been sent only to you or to many other recipients.</span></span> <span data-ttu-id="a4dbb-107">As mensagens de entrada são colocadas em uma pasta de recebimento designada para armazenar mensagens de uma determinada classe.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-107">Incoming messages are placed in a receive folder designated to hold messages of a particular class.</span></span> <span data-ttu-id="a4dbb-108">Você pode configurar uma pasta de recebimento diferente para cada classe de mensagem que você manipula ou usa uma pasta para todas as classes.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-108">You can set up a different receive folder for each message class that you handle or use one folder for all of the classes.</span></span>
  
<span data-ttu-id="a4dbb-109">Se você tiver registrado para novas notificações de email com o repositório de mensagens, será notificado sempre que uma mensagem for colocada em uma pasta de recebimento.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-109">If you have registered for new mail notifications with the message store, you will be notified whenever a message is placed in a receive folder.</span></span> <span data-ttu-id="a4dbb-110">Se você não tiver registrado para novas notificações de email, deverá abrir a pasta de recebimento apropriada periodicamente para verificar manualmente a chegada de novas mensagens.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-110">If you have not registered for new mail notifications, you must open the appropriate receive folder periodically to manually check for the arrival of new messages.</span></span>
  
<span data-ttu-id="a4dbb-111">Os clientes se registram para novas notificações de email Configurando os parâmetros para [IMsgStore:: Advise](imsgstore-advise.md) da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="a4dbb-111">Clients register for new mail notifications by setting the parameters to [IMsgStore::Advise](imsgstore-advise.md) as follows:</span></span> 
  
- <span data-ttu-id="a4dbb-112">Defina _cbEntryID_ como 0.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-112">Set  _cbEntryID_ to 0.</span></span> 
    
- <span data-ttu-id="a4dbb-113">Defina _lpEntryID_ como nulo.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-113">Set  _lpEntryID_ to NULL.</span></span> 
    
- <span data-ttu-id="a4dbb-114">Defina _ulEventMask_ como fnevNewMail.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-114">Set  _ulEventMask_ to fnevNewMail.</span></span> 
    
<span data-ttu-id="a4dbb-115">O parâmetro _lpNotifications_ na chamada para o método **IMAPIAdviseSink:: OnNotify** aponta para uma estrutura de **notificação do NEWMAIL\_** que contém informações sobre a mensagem de entrada, como sua classe de mensagens, sua entrada identificador, o identificador de entrada de sua pasta pai e o conteúdo de sua propriedade **PR_MESSAGE_FLAGS** .</span><span class="sxs-lookup"><span data-stu-id="a4dbb-115">The  _lpNotifications_ parameter in the call to your **IMAPIAdviseSink::OnNotify** method points to a **NEWMAIL\_NOTIFICATION** structure that contains information about the incoming message, such as its message class, its entry identifier, the entry identifier of its parent folder, and the contents of its **PR_MESSAGE_FLAGS** property.</span></span> <span data-ttu-id="a4dbb-116">Para obter mais informações sobre como registrar e lidar com notificações, consulte [IMAPIAdviseSink:: OnNotify](imapiadvisesink-onnotify.md), [NEWMAIL_NOTIFICATION](newmail_notification.md), **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) e [tratamento de notificações](handling-notifications.md).</span><span class="sxs-lookup"><span data-stu-id="a4dbb-116">For more information about registering for and handling notifications, see [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md), [NEWMAIL_NOTIFICATION](newmail_notification.md), **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)), and [Handling Notifications](handling-notifications.md).</span></span> 
  
<span data-ttu-id="a4dbb-117">Antes de exibir uma mensagem de entrada para um usuário, determine se sua classe de mensagem é uma classe que seu cliente suporta.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-117">Before displaying an incoming message to a user, determine if its message class is a class that your client supports.</span></span> <span data-ttu-id="a4dbb-118">Caso contrário, ignore a mensagem.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-118">If not, ignore the message.</span></span> <span data-ttu-id="a4dbb-119">Se a classe é suportada, você pode abrir e exibir a mensagem com um formulário apropriado para a classe de mensagem da mensagem.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-119">If the class is one that you support, you can open and display the message with a form that is appropriate for the message class of the message.</span></span> <span data-ttu-id="a4dbb-120">A opção de formulários é baseada na classe da mensagem.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-120">The choice of forms is based on message class.</span></span> <span data-ttu-id="a4dbb-121">As mensagens que pertencem à classe IPM usam um formulário padrão implementado por MAPI.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-121">Messages that belong to the IPM class use a default form implemented by MAPI.</span></span> <span data-ttu-id="a4dbb-122">As mensagens que pertencem a classes personalizadas definidas por clientes podem usar formulários especializados definidos pelo cliente ou o formulário MAPI padrão.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-122">Messages that belong to custom classes defined by clients can use either client-defined specialized forms or the MAPI default form.</span></span>
  
## <a name="open-and-display-an-incoming-message"></a><span data-ttu-id="a4dbb-123">Abrir e exibir uma mensagem de entrada</span><span class="sxs-lookup"><span data-stu-id="a4dbb-123">Open and display an incoming message</span></span>
  
1. <span data-ttu-id="a4dbb-124">Chame **IMsgStore:: GetReceiveFolder** para recuperar o identificador de entrada da pasta de recebimento para a classe de mensagem da mensagem e passar esse identificador de entrada para **IMsgStore:: OpenEntry** para abrir a pasta.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-124">Call **IMsgStore::GetReceiveFolder** to retrieve the entry identifier of the receive folder for the message class of the message and pass this entry identifier to **IMsgStore::OpenEntry** to open the folder.</span></span> <span data-ttu-id="a4dbb-125">Para obter mais informações, consulte [IMsgStore:: GetReceiveFolder](imsgstore-getreceivefolder.md), [IMsgStore:: OpenEntry](imsgstore-openentry.md)e [abrindo uma pasta do repositório de mensagens](opening-a-message-store-folder.md).</span><span class="sxs-lookup"><span data-stu-id="a4dbb-125">For more information, see [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md), [IMsgStore::OpenEntry](imsgstore-openentry.md), and [Opening a Message Store Folder](opening-a-message-store-folder.md).</span></span>
    
2. <span data-ttu-id="a4dbb-126">Chame o método **IMAPIContainer::** getcontenttable da pasta de recebimento para recuperar sua tabela de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-126">Call the receive folder's **IMAPIContainer::GetContentsTable** method to retrieve its contents table.</span></span> <span data-ttu-id="a4dbb-127">Para obter mais informações, consulte [IMAPIContainer::](imapicontainer-getcontentstable.md)getcontenttable.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-127">For more information, see [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md).</span></span> <span data-ttu-id="a4dbb-128">Chame o método imApitable **:: QueryRows** da tabela para recuperar todas as linhas da tabela.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-128">Call the table's **IMAPITable::QueryRows** method to retrieve all the rows in the table.</span></span> <span data-ttu-id="a4dbb-129">Para obter mais informações, consulte imApitable [:: QueryRows](imapitable-queryrows.md) e [Content Tables](contents-tables.md).</span><span class="sxs-lookup"><span data-stu-id="a4dbb-129">For more information see [IMAPITable::QueryRows](imapitable-queryrows.md) and [Contents Tables](contents-tables.md).</span></span> <span data-ttu-id="a4dbb-130">Para obter mais informações sobre como exibir uma tabela de conteúdo, consulte [exibindo uma tabela de conteúdo da pasta](displaying-a-folder-contents-table.md).</span><span class="sxs-lookup"><span data-stu-id="a4dbb-130">For more information about displaying a contents table, see [Displaying a Folder Contents Table](displaying-a-folder-contents-table.md).</span></span>
    
3. <span data-ttu-id="a4dbb-131">Se o cliente for interativo, permita que o usuário selecione uma mensagem da tabela e determine o formulário a ser usado para exibir a mensagem.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-131">If your client is interactive, allow the user to select a message from the table and determine the form to be used to display that message.</span></span> <span data-ttu-id="a4dbb-132">Os clientes podem usar o formulário padrão fornecido por MAPI ou um formulário personalizado.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-132">Clients can use the default form provided by MAPI or a custom form.</span></span> <span data-ttu-id="a4dbb-133">Para obter mais informações, consulte [tratamento de formulários MAPI](handling-mapi-forms.md).</span><span class="sxs-lookup"><span data-stu-id="a4dbb-133">For more information, see [Handling MAPI Forms](handling-mapi-forms.md).</span></span>
    
4. <span data-ttu-id="a4dbb-134">Chame **IMsgStore:: OpenEntry** para abrir a mensagem.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-134">Call **IMsgStore::OpenEntry** to open the message.</span></span> <span data-ttu-id="a4dbb-135">Para obter mais informações, consulte [abrir uma mensagem](opening-a-message.md).</span><span class="sxs-lookup"><span data-stu-id="a4dbb-135">For more information, see [Opening a Message](opening-a-message.md).</span></span>
    
5. <span data-ttu-id="a4dbb-136">Processe o texto da mensagem.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-136">Process the message text.</span></span> <span data-ttu-id="a4dbb-137">Para obter mais informações, consulte [abrindo mensagem de texto](opening-message-text.md).</span><span class="sxs-lookup"><span data-stu-id="a4dbb-137">For more information, see [Opening Message Text](opening-message-text.md).</span></span>
    
6. <span data-ttu-id="a4dbb-138">Renderizar cada um dos anexos da mensagem.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-138">Render each of the message attachments.</span></span> <span data-ttu-id="a4dbb-139">Para obter mais informações, consulte [renderizar um anexo em texto sem formatação](rendering-an-attachment-in-plain-text.md) ou [renderizar um anexo em texto RTF](rendering-an-attachment-in-rtf-text.md).</span><span class="sxs-lookup"><span data-stu-id="a4dbb-139">For more information, see [Rendering an Attachment in Plain Text](rendering-an-attachment-in-plain-text.md) or [Rendering an Attachment in RTF Text](rendering-an-attachment-in-rtf-text.md).</span></span>
    
7. <span data-ttu-id="a4dbb-140">Abra um anexo, se desejado.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-140">Open an attachment if desired.</span></span> <span data-ttu-id="a4dbb-141">Para obter mais informações, consulte [abrir um anexo](opening-an-attachment.md).</span><span class="sxs-lookup"><span data-stu-id="a4dbb-141">For more information see [Opening an Attachment](opening-an-attachment.md).</span></span>
    
## <a name="in-this-section"></a><span data-ttu-id="a4dbb-142">Nesta seção</span><span class="sxs-lookup"><span data-stu-id="a4dbb-142">In this section</span></span>

- <span data-ttu-id="a4dbb-143">[Abrindo mensagem texto](opening-message-text.md): descreve como abrir o texto da mensagem.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-143">[Opening Message Text](opening-message-text.md): Describes how to open the message text.</span></span>
    
- <span data-ttu-id="a4dbb-144">[Renderizar um anexo em texto sem formatação](rendering-an-attachment-in-plain-text.md): descreve como renderizar um anexo em texto sem formatação.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-144">[Rendering an Attachment in Plain Text](rendering-an-attachment-in-plain-text.md): Describes how to render an attachment in plain text.</span></span>
    
- <span data-ttu-id="a4dbb-145">[Renderizar um anexo em texto RTF](rendering-an-attachment-in-rtf-text.md): descreve como renderizar um anexo em texto formatado.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-145">[Rendering an Attachment in RTF Text](rendering-an-attachment-in-rtf-text.md): Describes how to render an attachment in formatted text.</span></span>
    
- <span data-ttu-id="a4dbb-146">[Abrir um anexo](opening-an-attachment.md): descreve como abrir um anexo.</span><span class="sxs-lookup"><span data-stu-id="a4dbb-146">[Opening an Attachment](opening-an-attachment.md): Describes how to open an attachment.</span></span>
    

