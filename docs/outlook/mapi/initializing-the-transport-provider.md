---
title: Inicializar o provedor de transporte
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 977c18ce-ece5-4ad1-ac97-5a680846ab83
description: '�ltima altera��o: s�bado, 23 de julho de 2011'
ms.openlocfilehash: 3b369e20101bbaba5e246b2ef9f6ab3ed1771ef6
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22563552"
---
# <a name="initializing-the-transport-provider"></a><span data-ttu-id="e71b1-103">Inicializar o provedor de transporte</span><span class="sxs-lookup"><span data-stu-id="e71b1-103">Initializing the Transport Provider</span></span>

  
  
<span data-ttu-id="e71b1-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="e71b1-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="e71b1-105">A interface de transporte-spooler define o MAPI spooler torna a um provedor de transporte de chamadas.</span><span class="sxs-lookup"><span data-stu-id="e71b1-105">The transport-spooler interface defines calls the MAPI spooler makes to a transport provider.</span></span> <span data-ttu-id="e71b1-106">Provedores de transporte implementam essas rotinas em uma biblioteca de vínculo dinâmico (DLL).</span><span class="sxs-lookup"><span data-stu-id="e71b1-106">Transport providers implement these routines in a dynamic-link library (DLL).</span></span> <span data-ttu-id="e71b1-107">O primeiro ponto de entrada direta a DLL usado pelo spooler MAPI deve ser a função de inicialização do provedor de transporte [XPProviderInit](xpproviderinit.md).</span><span class="sxs-lookup"><span data-stu-id="e71b1-107">The first direct entry point into the DLL used by the MAPI spooler must be the transport provider initialization function [XPProviderInit](xpproviderinit.md).</span></span>
  
<span data-ttu-id="e71b1-108">Usa a rotina **GetProcAddress** para obter o endereço de rotina de inicialização do provedor de serviços e, em seguida, chama esse rotina MAPI.</span><span class="sxs-lookup"><span data-stu-id="e71b1-108">MAPI uses the routine **GetProcAddress** to get the address of the service provider's initialization routine and then calls that routine.</span></span> <span data-ttu-id="e71b1-109">O nome da rotina de inicialização é **XPProviderInit** para provedores de transporte.</span><span class="sxs-lookup"><span data-stu-id="e71b1-109">The name of the initialization routine is **XPProviderInit** for transport providers.</span></span> <span data-ttu-id="e71b1-110">É diferente de outros tipos de provedores de serviço MAPI para que uma DLL pode conter qualquer combinação de tipos de provedor de serviço, mas apenas um provedor de serviços de um determinado tipo.</span><span class="sxs-lookup"><span data-stu-id="e71b1-110">It is different for other types of MAPI service providers so that one DLL can contain any combination of service provider types, but only one service provider of a particular type.</span></span> <span data-ttu-id="e71b1-111">No entanto, um provedor de serviços de um determinado tipo pode implementar vários serviços de seu tipo.</span><span class="sxs-lookup"><span data-stu-id="e71b1-111">However, one service provider of a given type can implement multiple services of its type.</span></span> <span data-ttu-id="e71b1-112">Por exemplo, um provedor de transporte pode implementar o recurso de transporte de mensagens para vários serviços de mensagem.</span><span class="sxs-lookup"><span data-stu-id="e71b1-112">For example, one transport provider can implement message transport functionality to multiple message services.</span></span> 
  
<span data-ttu-id="e71b1-113">O arquivo de cabeçalho mapispi.h tem uma definição de tipo para o protótipo de função da função de inicialização de provedor de transporte e um nome de procedimento predefinido para ele.</span><span class="sxs-lookup"><span data-stu-id="e71b1-113">The mapispi.h header file has a type definition for the function prototype of the transport provider initialization function, and a predefined procedure name for it.</span></span> <span data-ttu-id="e71b1-114">Nomeando as rotinas de inicialização em seus arquivos C e C++ com nomes iguais aos usados pelo **GetProcAddress** e usando um simples exporte declaração na sua DLL. Arquivo DEF, você obterá automaticamente verificação dos parâmetros na sua rotina de inicialização do tipo.</span><span class="sxs-lookup"><span data-stu-id="e71b1-114">By naming the initialization routines in your C and C++ files with the same names used by **GetProcAddress** and by using a straightforward export declaration in your DLL.DEF file, you automatically get type checking of the parameters on your initialization routine.</span></span> <span data-ttu-id="e71b1-115">Consulte o código de origem do provedor de transporte amostra para obter exemplos.</span><span class="sxs-lookup"><span data-stu-id="e71b1-115">See the sample transport provider source code for examples.</span></span> <span data-ttu-id="e71b1-116">Para obter mais informações, consulte [Sample do provedor de transporte](transport-provider-sample.md).</span><span class="sxs-lookup"><span data-stu-id="e71b1-116">For more information, see [Transport Provider Sample](transport-provider-sample.md).</span></span>
  
<span data-ttu-id="e71b1-117">Se chamada de inicialização de um provedor de serviços for bem-sucedido, mas retorna um provedor de serviços número da versão de interface muito pequeno para MAPI lidar com, MAPI imediatamente chama o método de **lançamento** do objeto de provedor de serviço e continua como se a inicialização de chamada tinha falhou com MAPI_E_VERSION.</span><span class="sxs-lookup"><span data-stu-id="e71b1-117">If a service provider's initialization call succeeds but returns a service provider interface version number too small for MAPI to handle, MAPI immediately calls the **Release** method of the service provider object and proceeds as if the initialization call had failed with MAPI_E_VERSION.</span></span> <span data-ttu-id="e71b1-118">Dessa maneira, MAPI e o provedor de serviço em conjunto definem o intervalo de números de versão do serviço provedor interface podem lidar com e se nada faz a correspondência de carregamento do provedor de serviços falhar com um MAPI_E_VERSION valor de retorno.</span><span class="sxs-lookup"><span data-stu-id="e71b1-118">This way MAPI and the service provider jointly define the range of service provider interface version numbers they can handle, and if nothing matches then service provider loading fails with a MAPI_E_VERSION return value.</span></span> 
  
<span data-ttu-id="e71b1-119">A última etapa para o MAPI spooler na obtenção de acesso aos recursos do provedor de serviço é para fazer logon no provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="e71b1-119">The last step for the MAPI spooler in getting access to service provider resources is to log on to the transport provider.</span></span> <span data-ttu-id="e71b1-120">O MAPI spooler chama o método [IXPProvider::TransportLogon](ixpprovider-transportlogon.md) do [IXPProvider: IUnknown](ixpprovideriunknown.md) objeto retornado de **XPProviderInit**.</span><span class="sxs-lookup"><span data-stu-id="e71b1-120">The MAPI spooler calls the [IXPProvider::TransportLogon](ixpprovider-transportlogon.md) method of the [IXPProvider : IUnknown](ixpprovideriunknown.md) object returned from **XPProviderInit**.</span></span> <span data-ttu-id="e71b1-121">Esta é a chamada onde credenciais, se for usado, serão verificadas e caixas de diálogo podem ser permitidas.</span><span class="sxs-lookup"><span data-stu-id="e71b1-121">This is the call where credentials, if used, are checked and dialog boxes can be allowed.</span></span>
  
<span data-ttu-id="e71b1-122">Se um processo abre uma segunda sessão de transporte, o mesmo provedor de transporte e sessão MAPI, o provedor de transporte DLL não deve criar um segundo objeto de provedor.</span><span class="sxs-lookup"><span data-stu-id="e71b1-122">If a process opens a second transport session on the same transport provider and MAPI session, the transport provider DLL should not create a second provider object.</span></span> <span data-ttu-id="e71b1-123">O primeiro objeto do provedor deve ser usado para fazer logon para a segunda sessão de transporte.</span><span class="sxs-lookup"><span data-stu-id="e71b1-123">The first provider object should be used to log on to the second transport session.</span></span> <span data-ttu-id="e71b1-124">Um provedor de transporte deve ser programado para dar suporte a várias sessões de transporte em um objeto único provedor.</span><span class="sxs-lookup"><span data-stu-id="e71b1-124">A transport provider should be programmed to support multiple transport sessions in a single provider object.</span></span> <span data-ttu-id="e71b1-125">Um segundo objeto de provedor deve apenas ser criado se diferentes sessões MAPI são usadas no mesmo processo.</span><span class="sxs-lookup"><span data-stu-id="e71b1-125">A second provider object should only be created if different MAPI sessions are used in the same process.</span></span>
  

