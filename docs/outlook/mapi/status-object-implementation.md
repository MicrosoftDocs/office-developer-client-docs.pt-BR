---
title: Implementação do objeto de status
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 48fd3e28-c2d2-474d-9487-5e2f08ca7319
description: '�ltima altera��o: s�bado, 23 de julho de 2011'
ms.openlocfilehash: 379378f2092f7b119a40ac44cbdcfa03f254b448
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19770511"
---
# <a name="status-object-implementation"></a><span data-ttu-id="649b8-103">Implementação do objeto de status</span><span class="sxs-lookup"><span data-stu-id="649b8-103">Status object implementation</span></span>

<span data-ttu-id="649b8-104">**Aplica-se a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="649b8-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="649b8-105">Todos os provedores de serviço devem implementar um objeto de status e forneça as propriedades à tabela de status de sessão.</span><span class="sxs-lookup"><span data-stu-id="649b8-105">All service providers must implement a status object and furnish properties from it to the session status table.</span></span> <span data-ttu-id="649b8-106">Você pode incluir uma ou mais linhas na tabela de status, dependendo do número de recursos que você controle.</span><span class="sxs-lookup"><span data-stu-id="649b8-106">You can include one or more rows in the status table, depending on the number of resources that you control.</span></span> <span data-ttu-id="649b8-107">Um provedor de transporte, por exemplo, deve criar uma linha da tabela de status de cada fila de mensagens que ele gerencia.</span><span class="sxs-lookup"><span data-stu-id="649b8-107">A transport provider, for example, should create a row in the status table for each message queue it manages.</span></span> <span data-ttu-id="649b8-108">Quando ocorrem alterações, a linha da tabela de status apropriado deve ser atualizada.</span><span class="sxs-lookup"><span data-stu-id="649b8-108">When changes occur, the appropriate status table row must be updated.</span></span> <span data-ttu-id="649b8-109">Objetos de status são implementados para fornecer acesso às informações incluído na tabela de status e para informações adicionais não incluídas na tabela.</span><span class="sxs-lookup"><span data-stu-id="649b8-109">Status objects are implemented to provide access both to the information included in the status table and to additional information not included in the table.</span></span>
  
### <a name="to-implement-a-status-object"></a><span data-ttu-id="649b8-110">Para implementar um objeto de status</span><span class="sxs-lookup"><span data-stu-id="649b8-110">To implement a status object</span></span>

1. <span data-ttu-id="649b8-111">Implemente o método **OpenStatusEntry** do seu objeto de logon.</span><span class="sxs-lookup"><span data-stu-id="649b8-111">Implement the **OpenStatusEntry** method of your logon object.</span></span> <span data-ttu-id="649b8-112">Quando clientes quiser abrir o objeto de status, ligarem [IMAPISession::OpenEntry](imapisession-openentry.md).</span><span class="sxs-lookup"><span data-stu-id="649b8-112">When clients want to open your status object, they call [IMAPISession::OpenEntry](imapisession-openentry.md).</span></span> <span data-ttu-id="649b8-113">MAPI atende a solicitação aberta chamando o método de **OpenStatusEntry** do seu provedor, fazendo com que o seu provedor abrir o objeto de status e retornar ao cliente um ponteiro para sua implementação **IMAPIStatus** .</span><span class="sxs-lookup"><span data-stu-id="649b8-113">MAPI fulfills the open request by calling your provider's **OpenStatusEntry** method, causing your provider to open its status object and return to the client a pointer to its **IMAPIStatus** implementation.</span></span> <span data-ttu-id="649b8-114">Na sua implementação **OpenStatusEntry** , conclua as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="649b8-114">In your **OpenStatusEntry** implementation, complete the following steps:</span></span> 
    
   1. <span data-ttu-id="649b8-115">Se seu objeto logon ainda não tiver criado um objeto de status, execute as seguintes tarefas:</span><span class="sxs-lookup"><span data-stu-id="649b8-115">Perform the following tasks if your logon object has not yet created a status object:</span></span>
    
      1. <span data-ttu-id="649b8-116">Chame o suporte ao método do objeto [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) para acessar a seção de perfil do seu provedor.</span><span class="sxs-lookup"><span data-stu-id="649b8-116">Call the support object's [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) method to access your provider's profile section.</span></span> 
          
      2. <span data-ttu-id="649b8-117">Crie um novo objeto de status.</span><span class="sxs-lookup"><span data-stu-id="649b8-117">Create a new status object.</span></span>
          
      3. <span data-ttu-id="649b8-118">Armazenar uma referência para a seção de perfil no objeto de status do seu provedor e chame o método de [AddRef](http://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx) da seção perfil para incrementar sua contagem de referência.</span><span class="sxs-lookup"><span data-stu-id="649b8-118">Store a reference to the profile section in your provider's status object and call the profile section's [IUnknown::AddRef](http://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx) method to increment its reference count.</span></span> 
          
      4. <span data-ttu-id="649b8-119">Armazenar uma referência ao objeto logon no objeto de status do seu provedor e chame o método de **AddRef** do objeto logon para incrementar sua contagem de referência.</span><span class="sxs-lookup"><span data-stu-id="649b8-119">Store a reference to the logon object in your provider's status object and call the logon object's **IUnknown::AddRef** method to increment its reference count.</span></span> 
          
      5. <span data-ttu-id="649b8-120">Armazene uma referência ao objeto de status no objeto de logon do seu provedor.</span><span class="sxs-lookup"><span data-stu-id="649b8-120">Store a reference to the status object in your provider's logon object.</span></span>
    
   2. <span data-ttu-id="649b8-121">Chame o status método do objeto **AddRef** para incrementar sua contagem de referência do objeto de logon.</span><span class="sxs-lookup"><span data-stu-id="649b8-121">Call the status object's **IUnknown::AddRef** method to increment its reference count in the logon object.</span></span> 
    
   3. <span data-ttu-id="649b8-122">Defina o status **PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md)) propriedade de um objeto como MAPI_STATUS.</span><span class="sxs-lookup"><span data-stu-id="649b8-122">Set the status object's **PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md)) property to MAPI_STATUS.</span></span>
    
   4. <span data-ttu-id="649b8-123">Defina o parâmetro de saída _lppMAPIStatus_ para apontar para o objeto de status e retornar.</span><span class="sxs-lookup"><span data-stu-id="649b8-123">Set the  _lppMAPIStatus_ output parameter to point to the status object, and return.</span></span> 
    
   5. <span data-ttu-id="649b8-124">Verifique o parâmetro de entrada _ulFlags_ .</span><span class="sxs-lookup"><span data-stu-id="649b8-124">Check the  _ulFlags_ input parameter.</span></span> <span data-ttu-id="649b8-125">Se ele for definido como MAPI_MODIFY e o provedor oferece suporte para acesso de leitura/gravação para seu objeto de status, retorne um objeto gravável.</span><span class="sxs-lookup"><span data-stu-id="649b8-125">If it is set to MAPI_MODIFY and your provider supports read/write access to its status object, return a writeable object.</span></span> <span data-ttu-id="649b8-126">No entanto, se o seu provedor não oferece suporte para acesso de leitura/gravação para seu objeto de status, não falhe.</span><span class="sxs-lookup"><span data-stu-id="649b8-126">However, if your provider does not support read/write access to its status object, do not fail.</span></span> <span data-ttu-id="649b8-127">Retorne um objeto de status que é somente leitura.</span><span class="sxs-lookup"><span data-stu-id="649b8-127">Return a status object that is read-only.</span></span> <span data-ttu-id="649b8-128">Clientes que receberão o objetos do status de leitura/gravação devem verificar que foi concedida permissão de leitura/gravação antes de tentar fazer alterações.</span><span class="sxs-lookup"><span data-stu-id="649b8-128">Clients that expect to receive read/write status objects should verify that read/write permission has been granted before attempting to make any changes.</span></span> 
    
2. <span data-ttu-id="649b8-129">Todos o status obrigatório defina as propriedades de objeto e o status da tabela.</span><span class="sxs-lookup"><span data-stu-id="649b8-129">Set all of the required status object and status table properties.</span></span> <span data-ttu-id="649b8-130">As propriedades que você pode incluir em sua linha da tabela de status devem estar disponíveis por meio de seu objeto de status, exceto as propriedades calculado MAPI.</span><span class="sxs-lookup"><span data-stu-id="649b8-130">The properties that you include in your status table row should be available through your status object, except for the properties calculated by MAPI.</span></span> <span data-ttu-id="649b8-131">As propriedades necessárias são:</span><span class="sxs-lookup"><span data-stu-id="649b8-131">The required properties are as follows:</span></span>
    
   - <span data-ttu-id="649b8-132">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="649b8-132">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>
    
   - <span data-ttu-id="649b8-133">**PR_PROVIDER_DLL_NAME** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="649b8-133">**PR_PROVIDER_DLL_NAME** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md))</span></span>
    
   - <span data-ttu-id="649b8-134">**PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="649b8-134">**PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md))</span></span>
    
   - <span data-ttu-id="649b8-135">**PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="649b8-135">**PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md))</span></span>
    
   - <span data-ttu-id="649b8-136">**PR_RESOURCE_METHODS** ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="649b8-136">**PR_RESOURCE_METHODS** ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md))</span></span>
    
   - <span data-ttu-id="649b8-137">**PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="649b8-137">**PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md))</span></span>
    
   - <span data-ttu-id="649b8-138">**PR_STATUS_CODE** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="649b8-138">**PR_STATUS_CODE** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md))</span></span>
    
3. <span data-ttu-id="649b8-139">Implementar o [IMAPIStatus: IMAPIProp](imapistatusimapiprop.md) métodos apropriados para seu provedor.</span><span class="sxs-lookup"><span data-stu-id="649b8-139">Implement the [IMAPIStatus : IMAPIProp](imapistatusimapiprop.md) methods that are appropriate for your provider.</span></span> <span data-ttu-id="649b8-140">Dependendo do seu provedor, você não precisará implementar todos os quatro métodos em **IMAPIStatus**.</span><span class="sxs-lookup"><span data-stu-id="649b8-140">Depending on your provider, you do not need to implement all of the four methods in **IMAPIStatus**.</span></span> <span data-ttu-id="649b8-141">Cada provedor deve implementar uma versão somente leitura dos métodos do [IMAPIProp: IUnknown](imapipropiunknown.md) interface e o método [IMAPIStatus::ValidateState](imapistatus-validatestate.md) .</span><span class="sxs-lookup"><span data-stu-id="649b8-141">Every provider should implement a read-only version of the methods of the [IMAPIProp : IUnknown](imapipropiunknown.md) interface and the [IMAPIStatus::ValidateState](imapistatus-validatestate.md) method.</span></span> 

   <span data-ttu-id="649b8-142">Provedores de transporte também deverá implementar [IMAPIStatus::FlushQueues](imapistatus-flushqueues.md)e todos os provedores devem oferecer suporte a [IMAPIStatus:: SettingsDialog](imapistatus-settingsdialog.md).</span><span class="sxs-lookup"><span data-stu-id="649b8-142">Transport providers should also implement [IMAPIStatus::FlushQueues](imapistatus-flushqueues.md), and all providers should support [IMAPIStatus::SettingsDialog](imapistatus-settingsdialog.md).</span></span> <span data-ttu-id="649b8-143">No entanto, o suporte para [IMAPIStatus:: ChangePassword](imapistatus-changepassword.md) é opcional.</span><span class="sxs-lookup"><span data-stu-id="649b8-143">However, support for [IMAPIStatus::ChangePassword](imapistatus-changepassword.md) is optional.</span></span> <span data-ttu-id="649b8-144">Apenas os provedores de serviços que exigem senhas e permitir que os usuários alterem programaticamente precisam implementar esse método.</span><span class="sxs-lookup"><span data-stu-id="649b8-144">Only service providers that require passwords and want to allow users to change them programmatically need to implement this method.</span></span> <span data-ttu-id="649b8-145">Para cada método suportado, defina o bit correspondente na propriedade **PR_RESOURCE_METHODS** .</span><span class="sxs-lookup"><span data-stu-id="649b8-145">For every method that you support, set the corresponding bit in the **PR_RESOURCE_METHODS** property.</span></span> <span data-ttu-id="649b8-146">Por exemplo, caso você ofereça suporte **ValidateState** e **SettingsDialog** apenas, defina **PR_RESOURCE_METHODS** como a seguir:</span><span class="sxs-lookup"><span data-stu-id="649b8-146">For example, if you support **ValidateState** and **SettingsDialog** only, set **PR_RESOURCE_METHODS** to the following:</span></span> 
    
   `STATUS_VALIDATE_STATE | STATUS_SETTINGS_DIALOG`
    
   <span data-ttu-id="649b8-147">Os clientes devem verificar o valor de **PR_RESOURCE_METHODS** antes de tentar chamar seu objeto de status.</span><span class="sxs-lookup"><span data-stu-id="649b8-147">Clients should check the value of **PR_RESOURCE_METHODS** before attempting to call your status object.</span></span> <span data-ttu-id="649b8-148">Trata as chamadas para qualquer um dos seus métodos sem suporte, retornando MAPI_E_NO_SUPPORT.</span><span class="sxs-lookup"><span data-stu-id="649b8-148">Handle calls to any of your unsupported methods by returning MAPI_E_NO_SUPPORT.</span></span> 
    
4. <span data-ttu-id="649b8-149">Chame [IMAPISupport::ModifyStatusRow](imapisupport-modifystatusrow.md) durante o logon para adicionar sua linha ou linhas à tabela de status.</span><span class="sxs-lookup"><span data-stu-id="649b8-149">Call [IMAPISupport::ModifyStatusRow](imapisupport-modifystatusrow.md) during logon to add your row or rows to the status table.</span></span> <span data-ttu-id="649b8-150">Passe uma matriz de valor de propriedade que contém as informações de coluna para a linha e 0 para o parâmetro _ulFlags_ .</span><span class="sxs-lookup"><span data-stu-id="649b8-150">Pass a property value array that contains the column information for the row and 0 for the  _ulFlags_ parameter.</span></span> <span data-ttu-id="649b8-151">Se em algum momento posterior na sessão de alteração de status do seu provedor e ele ficar necessário para atualizar as informações de coluna, chame **ModifyStatusRow** novamente com o sinalizador STATUSROW_UPDATE definido.</span><span class="sxs-lookup"><span data-stu-id="649b8-151">If at some point later in the session your provider's status changes and it becomes necessary to update the column information, call **ModifyStatusRow** again with the STATUSROW_UPDATE flag set.</span></span> 
    
<span data-ttu-id="649b8-152">Para obter mais informações sobre objetos de status, consulte [Objetos de Status de MAPI](mapi-status-objects.md).</span><span class="sxs-lookup"><span data-stu-id="649b8-152">For more information about status objects, see [MAPI Status Objects](mapi-status-objects.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="649b8-153">Confira também</span><span class="sxs-lookup"><span data-stu-id="649b8-153">See also</span></span>

- [<span data-ttu-id="649b8-154">Provedores de serviços MAPI</span><span class="sxs-lookup"><span data-stu-id="649b8-154">MAPI Service Providers</span></span>](mapi-service-providers.md)

