---
title: Enviar mensagens usando provedores do repositório de mensagens
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7632d784-00d8-48fd-a73b-73778efbef7f
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: b34714a230adb44417624d149d34ed6a14a2dfa5
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33437606"
---
# <a name="sending-messages-by-using-message-store-providers"></a><span data-ttu-id="3cba4-103">Enviar mensagens usando provedores do repositório de mensagens</span><span class="sxs-lookup"><span data-stu-id="3cba4-103">Sending messages by using message store providers</span></span>

<span data-ttu-id="3cba4-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="3cba4-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="3cba4-105">Os provedores de armazenamento de mensagens não são obrigados a dar suporte a envios de mensagens de saída (ou seja, a capacidade dos aplicativos clientes usarem o provedor de armazenamento de mensagens para enviar mensagens).</span><span class="sxs-lookup"><span data-stu-id="3cba4-105">Message store providers are not required to support outgoing message submissions (that is, the ability for client applications to use the message store provider to send messages).</span></span> <span data-ttu-id="3cba4-106">Os aplicativos cliente precisam usar um armazenamento de mensagens durante o envio de mensagens, porque os dados da mensagem devem ser armazenados em algum lugar entre o momento em que o usuário terminou de retorá-la e a hora em que o spooler MAPI entrega a mensagem a um provedor de transporte para envio ao sistema de mensagens subjacente.</span><span class="sxs-lookup"><span data-stu-id="3cba4-106">Client applications need to use a message store while sending messages, because the message's data must be stored somewhere between the time that the user is finished composing it and the time that the MAPI spooler gives the message to a transport provider for submission to the underlying messaging system.</span></span> <span data-ttu-id="3cba4-107">Se seu provedor de armazenamento de mensagens não suportar envios de mensagens de saída, ele não poderá ser usado como o armazenamento de mensagens padrão.</span><span class="sxs-lookup"><span data-stu-id="3cba4-107">If your message store provider does not support outgoing message submissions, it cannot be used as the default message store.</span></span>
  
<span data-ttu-id="3cba4-108">Para dar suporte ao envio de mensagens, seu provedor de armazenamento de mensagens deve fazer o seguinte:</span><span class="sxs-lookup"><span data-stu-id="3cba4-108">To support sending messages, your message store provider must do the following:</span></span>
  
- <span data-ttu-id="3cba4-109">Implemente uma fila de mensagens de saída.</span><span class="sxs-lookup"><span data-stu-id="3cba4-109">Implement an outgoing message queue.</span></span>
    
- <span data-ttu-id="3cba4-110">Suporte ao [método IMessage::SubmitMessage](imessage-submitmessage.md) em objetos de mensagem criados no armazenamento de mensagens.</span><span class="sxs-lookup"><span data-stu-id="3cba4-110">Support the [IMessage::SubmitMessage](imessage-submitmessage.md) method on message objects created in the message store.</span></span> 
    
- <span data-ttu-id="3cba4-111">Suporte aos métodos **IMsgStore** específicos para o spooler MAPI: [IMsgStore::FinishedMsg](imsgstore-finishedmsg.md), [IMsgStore::GetOutgoingQueue](imsgstore-getoutgoingqueue.md), [IMsgStore::NotifyNewMail](imsgstore-notifynewmail.md)e [IMsgStore::SetLockState](imsgstore-setlockstate.md).</span><span class="sxs-lookup"><span data-stu-id="3cba4-111">Support the **IMsgStore** methods that are specific to the MAPI spooler: [IMsgStore::FinishedMsg](imsgstore-finishedmsg.md), [IMsgStore::GetOutgoingQueue](imsgstore-getoutgoingqueue.md), [IMsgStore::NotifyNewMail](imsgstore-notifynewmail.md), and [IMsgStore::SetLockState](imsgstore-setlockstate.md).</span></span>
    
<span data-ttu-id="3cba4-112">O **método SetLockState** é importante para interoperação adequada entre o spooler MAPI e os clientes.</span><span class="sxs-lookup"><span data-stu-id="3cba4-112">The **SetLockState** method is important for proper interoperation between the MAPI spooler and clients.</span></span> <span data-ttu-id="3cba4-113">Quando o spooler MAPI chama **SetLockState** em uma mensagem de saída, o provedor de armazenamento de mensagens não deve permitir que os clientes abram a mensagem.</span><span class="sxs-lookup"><span data-stu-id="3cba4-113">When the MAPI spooler calls **SetLockState** on an outgoing message, the message store provider must not let clients open the message.</span></span> <span data-ttu-id="3cba4-114">Se um cliente tentar abrir uma mensagem bloqueada pelo spooler MAPI, o provedor de armazenamento de mensagens deverá retornar MAPI_E_NO_ACCESS.</span><span class="sxs-lookup"><span data-stu-id="3cba4-114">If a client does try to open a message that is locked by the MAPI spooler, the message store provider should return MAPI_E_NO_ACCESS.</span></span> <span data-ttu-id="3cba4-115">O estado bloqueado de uma mensagem não precisa ser persistente no caso de o armazenamento ser desligado enquanto a mensagem é bloqueada pelo spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="3cba4-115">The locked state of a message does not have to be persistent in case the store is shut down while the message is locked by the MAPI spooler.</span></span> 
  
<span data-ttu-id="3cba4-116">Independentemente de o spooler MAPI ter bloqueado uma mensagem de saída, o provedor de armazenamento de mensagens não deve permitir que uma mensagem na fila de mensagens de saída seja aberta para escrita.</span><span class="sxs-lookup"><span data-stu-id="3cba4-116">Regardless of whether the MAPI spooler has locked an outgoing message, the message store provider should not allow a message in the outgoing message queue to be opened for writing.</span></span> <span data-ttu-id="3cba4-117">Se um cliente chamar o método [IMSgStore::OpenEntry](imsgstore-openentry.md) em uma mensagem de saída com o sinalizador MAPI_MODIFY, a chamada falhará e retornará MAPI_E_SUBMITTED.</span><span class="sxs-lookup"><span data-stu-id="3cba4-117">If a client calls the [IMSgStore::OpenEntry](imsgstore-openentry.md) method on an outgoing message with the MAPI_MODIFY flag, the call should fail and return MAPI_E_SUBMITTED.</span></span> <span data-ttu-id="3cba4-118">Se um aplicativo cliente chamar **OpenEntry** em uma mensagem de saída com o sinalizador MAPI_BEST_ACCESS, o provedor de armazenamento de mensagens deverá permitir acesso somente leitura à mensagem.</span><span class="sxs-lookup"><span data-stu-id="3cba4-118">If a client application calls **OpenEntry** on an outgoing message with the MAPI_BEST_ACCESS flag, the message store provider should allow read-only access to the message.</span></span> 
  
<span data-ttu-id="3cba4-119">Quando uma mensagem deve ser manipulada pelo spooler MAPI, o provedor de armazenamento de mensagens define a propriedade **PR_SUBMIT_FLAGS** ([PidTagSubmitFlags](pidtagsubmitflags-canonical-property.md)) da mensagem como SUBMITFLAG_LOCKED.</span><span class="sxs-lookup"><span data-stu-id="3cba4-119">When a message is to be handled by the MAPI spooler, the message store provider sets the message's **PR_SUBMIT_FLAGS** ([PidTagSubmitFlags](pidtagsubmitflags-canonical-property.md)) property to SUBMITFLAG_LOCKED.</span></span> <span data-ttu-id="3cba4-120">O SUBMITFLAG_LOCKED valor indica que o spooler MAPI travadau a mensagem para seu uso exclusivo.</span><span class="sxs-lookup"><span data-stu-id="3cba4-120">The SUBMITFLAG_LOCKED value indicates that the MAPI spooler has locked the message for its exclusive use.</span></span> <span data-ttu-id="3cba4-121">O outro valor para **PR_SUBMIT_FLAGS**, SUBMITFLAG_PREPROCESS, é definido quando a mensagem exige pré-processamento por uma ou mais funções de pré-processador registradas por um provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="3cba4-121">The other value for **PR_SUBMIT_FLAGS**, SUBMITFLAG_PREPROCESS, is set when the message requires preprocessing by one or more preprocessor functions registered by a transport provider.</span></span>
  
<span data-ttu-id="3cba4-122">Os procedimentos a seguir descrevem como o armazenamento de mensagens, o transporte e o spooler MAPI interagem para enviar uma mensagem de um cliente para um ou mais destinatários.</span><span class="sxs-lookup"><span data-stu-id="3cba4-122">The following procedures describe how the message store, transport, and MAPI spooler interact to send a message from a client to one or more recipients.</span></span> 
  
<span data-ttu-id="3cba4-123">O aplicativo cliente chama o [método IMessage::SubmitMessage.](imessage-submitmessage.md)</span><span class="sxs-lookup"><span data-stu-id="3cba4-123">The client application calls the [IMessage::SubmitMessage](imessage-submitmessage.md) method.</span></span> <span data-ttu-id="3cba4-124">Em **SubmitMessage**, o provedor de armazenamento de mensagens faz o seguinte:</span><span class="sxs-lookup"><span data-stu-id="3cba4-124">In **SubmitMessage**, the message store provider does the following:</span></span>
  
1. <span data-ttu-id="3cba4-125">Chama [IMAPISupport::P repareSubmit](imapisupport-preparesubmit.md).</span><span class="sxs-lookup"><span data-stu-id="3cba4-125">Calls [IMAPISupport::PrepareSubmit](imapisupport-preparesubmit.md).</span></span> <span data-ttu-id="3cba4-126">Se MAPI retornar um erro, o provedor de armazenamento de mensagens retornará esse erro para o cliente.</span><span class="sxs-lookup"><span data-stu-id="3cba4-126">If MAPI returns an error, the message store provider returns that error to the client.</span></span>
    
2. <span data-ttu-id="3cba4-127">Define o MSGFLAG_SUBMIT bit **na propriedade PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) da mensagem.</span><span class="sxs-lookup"><span data-stu-id="3cba4-127">Sets the MSGFLAG_SUBMIT bit in the **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) property of the message.</span></span>
    
3. <span data-ttu-id="3cba4-128">Garante que haja uma coluna para a propriedade **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) na tabela de destinatários e a define como FALSE para indicar que nenhum transporte assume a responsabilidade pela transmissão da mensagem.</span><span class="sxs-lookup"><span data-stu-id="3cba4-128">Ensures that there is a column for the **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) property in the recipient table and sets it to FALSE to indicate that no transport has yet assumed responsibility for transmitting the message.</span></span>
    
4. <span data-ttu-id="3cba4-129">Define a data e a hora de origem **na propriedade PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="3cba4-129">Sets the date and time of origination in the **PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md)) property.</span></span>
    
5. <span data-ttu-id="3cba4-130">Chama [IMAPISupport::ExpandRecips](imapisupport-expandrecips.md) para fazer o seguinte:</span><span class="sxs-lookup"><span data-stu-id="3cba4-130">Calls [IMAPISupport::ExpandRecips](imapisupport-expandrecips.md) to do the following:</span></span> 
    
    1. <span data-ttu-id="3cba4-131">Expanda todas as listas de distribuição pessoais e destinatários personalizados e substitua todos os nomes de exibição alterados por seus nomes originais.</span><span class="sxs-lookup"><span data-stu-id="3cba4-131">Expand all personal distribution lists and custom recipients and replace all changed display names with their original names.</span></span>
        
    2. <span data-ttu-id="3cba4-132">Remover nomes duplicados.</span><span class="sxs-lookup"><span data-stu-id="3cba4-132">Remove duplicate names.</span></span>
        
    3. <span data-ttu-id="3cba4-133">Verifique se há qualquer pré-processamento necessário e, se o pré-processamento for necessário, de definir o sinalizador NEEDS_PREPROCESSING e a propriedade **PR_PREPROCESS** ([PidTagPreprocess](pidtagpreprocess-canonical-property.md)), que é reservado para MAPI.</span><span class="sxs-lookup"><span data-stu-id="3cba4-133">Check for any required preprocessing and, if preprocessing is required, set the NEEDS_PREPROCESSING flag and the **PR_PREPROCESS** ([PidTagPreprocess](pidtagpreprocess-canonical-property.md)) property, which is reserved for MAPI.</span></span> 
        
    4. <span data-ttu-id="3cba4-134">De definida NEEDS_SPOOLER sinalizador se o armazenamento de mensagens estiver fortemente unido a um transporte e não puder manipular todos os destinatários.</span><span class="sxs-lookup"><span data-stu-id="3cba4-134">Set the NEEDS_SPOOLER flag if the message store is tightly coupled with a transport and it cannot handle all of the recipients.</span></span> 
    
6. <span data-ttu-id="3cba4-135">Executa as seguintes tarefas se o sinalizador NEEDS_PREPROCESSING mensagem estiver definido:</span><span class="sxs-lookup"><span data-stu-id="3cba4-135">Performs the following tasks if the NEEDS_PREPROCESSING message flag is set:</span></span>
    
    1. <span data-ttu-id="3cba4-136">Coloca a mensagem na fila de saída com o SUBMITFLAG_PREPROCESS bit definido na **propriedade PR_SUBMIT_FLAGS** saída.</span><span class="sxs-lookup"><span data-stu-id="3cba4-136">Puts the message in the outgoing queue with the SUBMITFLAG_PREPROCESS bit set in the **PR_SUBMIT_FLAGS** property.</span></span> 
        
    2. <span data-ttu-id="3cba4-137">Notifica o spooler MAPI de que a fila foi alterada.</span><span class="sxs-lookup"><span data-stu-id="3cba4-137">Notifies the MAPI spooler that the queue has changed.</span></span>
        
    3. <span data-ttu-id="3cba4-138">Retorna o controle para o cliente, e o fluxo de mensagens continua no spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="3cba4-138">Returns control to the client, and message flow continues in the MAPI spooler.</span></span> <span data-ttu-id="3cba4-139">O spooler MAPI executa as seguintes tarefas:</span><span class="sxs-lookup"><span data-stu-id="3cba4-139">The MAPI spooler performs the following tasks:</span></span> 
    
       1. <span data-ttu-id="3cba4-140">Bloqueia a mensagem chamando [IMsgStore::SetLockState](imsgstore-setlockstate.md).</span><span class="sxs-lookup"><span data-stu-id="3cba4-140">Locks the message by calling [IMsgStore::SetLockState](imsgstore-setlockstate.md).</span></span>
            
       2. <span data-ttu-id="3cba4-141">Executa o pré-processamento necessário chamando todas as funções de pré-processamento na ordem de registro.</span><span class="sxs-lookup"><span data-stu-id="3cba4-141">Performs the needed preprocessing by calling all of the preprocessing functions in the order of registration.</span></span> <span data-ttu-id="3cba4-142">Provedores de transporte chamam [IMAPISupport::RegisterPreprocessor](imapisupport-registerpreprocessor.md) para registrar funções de pré-processamento.</span><span class="sxs-lookup"><span data-stu-id="3cba4-142">Transport providers call [IMAPISupport::RegisterPreprocessor](imapisupport-registerpreprocessor.md) to register preprocessing functions.</span></span> 
            
       3. <span data-ttu-id="3cba4-143">Chama [IMessage::SubmitMessage](imessage-submitmessage.md) na mensagem aberta para indicar ao armazenamento de mensagens que o pré-processamento está concluído.</span><span class="sxs-lookup"><span data-stu-id="3cba4-143">Calls [IMessage::SubmitMessage](imessage-submitmessage.md) on the open message to indicate to the message store that preprocessing is complete.</span></span> 
    
<span data-ttu-id="3cba4-144">Se não houve pré-processamento ou se houve pré-processamento e o spooler MAPI chamado **SubmitMessage**, o provedor de armazenamento de mensagens faz o seguinte no processo do cliente:</span><span class="sxs-lookup"><span data-stu-id="3cba4-144">If there was no preprocessing, or there was preprocessing and the MAPI spooler called **SubmitMessage**, the message store provider does the following in the client process:</span></span> 
  
- <span data-ttu-id="3cba4-145">Executa as seguintes tarefas se o armazenamento de mensagens estiver fortemente unido a um transporte e o sinalizador NEEDS_SPOOLER foi retornado de [IMAPISupport::ExpandRecips](imapisupport-expandrecips.md):</span><span class="sxs-lookup"><span data-stu-id="3cba4-145">Performs the following tasks if the message store is tightly coupled to a transport and the NEEDS_SPOOLER flag was returned from [IMAPISupport::ExpandRecips](imapisupport-expandrecips.md):</span></span>
    
   - <span data-ttu-id="3cba4-146">Trata todos os destinatários que ele pode manipular.</span><span class="sxs-lookup"><span data-stu-id="3cba4-146">Handles any recipients that it can handle.</span></span>
    
   - <span data-ttu-id="3cba4-147">Define a **PR_RESPONSIBILITY** propriedade como TRUE para todos os destinatários que ela manipular.</span><span class="sxs-lookup"><span data-stu-id="3cba4-147">Sets the **PR_RESPONSIBILITY** property to TRUE for any recipients that it handles.</span></span> 
    
   - <span data-ttu-id="3cba4-148">Executa as seguintes tarefas se todos os destinatários são conhecidos por esse transporte e armazenamento fortemente próximos:</span><span class="sxs-lookup"><span data-stu-id="3cba4-148">Performs the following tasks if all recipients are known to this tightly coupled store and transport:</span></span> 
    
     - <span data-ttu-id="3cba4-149">Chama [IMAPISupport::CompleteMsg](imapisupport-completemsg.md) se a mensagem foi pré-processada ou se o provedor de armazenamento de mensagens deseja que o spooler MAPI conclua o processamento de mensagens.</span><span class="sxs-lookup"><span data-stu-id="3cba4-149">Calls [IMAPISupport::CompleteMsg](imapisupport-completemsg.md) if the message was preprocessed or the message store provider wants the MAPI spooler to complete message processing.</span></span> <span data-ttu-id="3cba4-150">O fluxo de mensagens continua com o spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="3cba4-150">Message flow continues with the MAPI spooler.</span></span> 
    
     - <span data-ttu-id="3cba4-151">Executa as seguintes tarefas se a mensagem não tiver sido pré-processada ou se o provedor de armazenamento de mensagens não quiser que o spooler MAPI conclua o processamento de mensagens:</span><span class="sxs-lookup"><span data-stu-id="3cba4-151">Performs the following tasks if the message was not preprocessed or the message store provider does not want the MAPI spooler to complete message processing:</span></span>
    
       1. <span data-ttu-id="3cba4-152">Copia a mensagem para a pasta identificada pelo identificador de entrada na **propriedade PR_SENTMAIL_ENTRYID** ([PidTagSentMailEntryId](pidtagsentmailentryid-canonical-property.md)), se definida.</span><span class="sxs-lookup"><span data-stu-id="3cba4-152">Copies the message to the folder identified by the entry identifier in the **PR_SENTMAIL_ENTRYID** ([PidTagSentMailEntryId](pidtagsentmailentryid-canonical-property.md)) property, if set.</span></span>
            
       2. <span data-ttu-id="3cba4-153">Exclui a mensagem se a **PR_DELETE_AFTER_SUBMIT** ([PidTagDeleteAfterSubmit](pidtagdeleteaftersubmit-canonical-property.md)) tiver sido definida como TRUE.</span><span class="sxs-lookup"><span data-stu-id="3cba4-153">Deletes the message if the **PR_DELETE_AFTER_SUBMIT** ([PidTagDeleteAfterSubmit](pidtagdeleteaftersubmit-canonical-property.md)) property has been set to TRUE.</span></span>
            
       3. <span data-ttu-id="3cba4-154">Desbloqueia a mensagem se ela estiver bloqueada.</span><span class="sxs-lookup"><span data-stu-id="3cba4-154">Unlocks the message if it is locked.</span></span>
            
       4. <span data-ttu-id="3cba4-155">Retorna ao cliente.</span><span class="sxs-lookup"><span data-stu-id="3cba4-155">Returns to the client.</span></span> <span data-ttu-id="3cba4-156">O fluxo de mensagens está concluído.</span><span class="sxs-lookup"><span data-stu-id="3cba4-156">Message flow is complete.</span></span>
    
  - <span data-ttu-id="3cba4-157">Executa as seguintes tarefas se a mensagem foi pré-processada ou se o provedor deseja que o spooler MAPI conclua o processamento de mensagens:</span><span class="sxs-lookup"><span data-stu-id="3cba4-157">Performs the following tasks if the message was preprocessed or the provider wants the MAPI spooler to complete message processing:</span></span>
    
    1. <span data-ttu-id="3cba4-158">Chama [IMAPISupport::CompleteMsg](imapisupport-completemsg.md).</span><span class="sxs-lookup"><span data-stu-id="3cba4-158">Calls [IMAPISupport::CompleteMsg](imapisupport-completemsg.md).</span></span> 
          
    2. <span data-ttu-id="3cba4-159">Continua o fluxo de mensagens com o spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="3cba4-159">Continues message flow with the MAPI spooler.</span></span> <span data-ttu-id="3cba4-160">Para obter mais informações, consulte [Enviando Mensagens: Tarefas do Spooler MAPI.](sending-messages-mapi-spooler-tasks.md)</span><span class="sxs-lookup"><span data-stu-id="3cba4-160">For more information, see [Sending Messages: MAPI Spooler Tasks](sending-messages-mapi-spooler-tasks.md).</span></span>
    
  - <span data-ttu-id="3cba4-161">Executa as seguintes tarefas se a mensagem não tiver sido pré-processada ou se o provedor não quiser que o spooler conclua o processamento de mensagens:</span><span class="sxs-lookup"><span data-stu-id="3cba4-161">Performs the following tasks if the message was not preprocessed or the provider does not want the spooler to complete message processing:</span></span>
    
    1. <span data-ttu-id="3cba4-162">Copia a mensagem para a pasta identificada pelo identificador de entrada na propriedade **PR_SENTMAIL_ENTRYID,** se definida.</span><span class="sxs-lookup"><span data-stu-id="3cba4-162">Copies the message to the folder identified by the entry identifier in the **PR_SENTMAIL_ENTRYID** property, if set.</span></span> 
        
    2. <span data-ttu-id="3cba4-163">Exclui a mensagem se a **PR_DELETE_AFTER_SUBMIT** propriedade tiver sido definida como TRUE.</span><span class="sxs-lookup"><span data-stu-id="3cba4-163">Deletes the message if the **PR_DELETE_AFTER_SUBMIT** property has been set to TRUE.</span></span> 
        
    3. <span data-ttu-id="3cba4-164">Desbloqueia a mensagem se ela estiver bloqueada.</span><span class="sxs-lookup"><span data-stu-id="3cba4-164">Unlocks the message if it is locked.</span></span> 
        
    4. <span data-ttu-id="3cba4-165">Retorna ao chamador.</span><span class="sxs-lookup"><span data-stu-id="3cba4-165">Returns to the caller.</span></span> <span data-ttu-id="3cba4-166">O fluxo de mensagens está concluído.</span><span class="sxs-lookup"><span data-stu-id="3cba4-166">Message flow is complete.</span></span>
    
- <span data-ttu-id="3cba4-167">Executa as seguintes tarefas se o armazenamento de mensagens não estiver fortemente unido a um transporte, nem todos os destinatários eram conhecidos no armazenamento de mensagens ou o sinalizador de NEEDS_SPOOLER está definido:</span><span class="sxs-lookup"><span data-stu-id="3cba4-167">Performs the following tasks if the message store is not tightly coupled to a transport, not all of the recipients were known to the message store, or the NEEDS_SPOOLER flag is set:</span></span>
    
  1. <span data-ttu-id="3cba4-168">Coloca a mensagem na fila de saída sem definir SUBMITFLAG_PREPROCESS bit na **propriedade PR_SUBMIT_FLAGS** saída.</span><span class="sxs-lookup"><span data-stu-id="3cba4-168">Puts the message in the outgoing queue without setting the SUBMITFLAG_PREPROCESS bit in the **PR_SUBMIT_FLAGS** property.</span></span> 
    
  2. <span data-ttu-id="3cba4-169">Notifica o spooler MAPI de que a fila de saída foi alterada gerando uma notificação de tabela.</span><span class="sxs-lookup"><span data-stu-id="3cba4-169">Notifies the MAPI spooler that the outgoing queue has changed by generating a table notification.</span></span> 
    
  3. <span data-ttu-id="3cba4-170">Retorna ao cliente, e o fluxo de mensagens continua com um conjunto de tarefas executadas pelo spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="3cba4-170">Returns to the client, and message flow continues with a set of tasks performed by the MAPI spooler.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="3cba4-171">Confira também</span><span class="sxs-lookup"><span data-stu-id="3cba4-171">See also</span></span>

- [<span data-ttu-id="3cba4-172">Recursos do Armazenamento de Mensagens</span><span class="sxs-lookup"><span data-stu-id="3cba4-172">Message Store Features</span></span>](message-store-features.md)

