---
title: Cache de apelidos
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 2813c102-6778-4443-ab4b-b573f3568705
description: 'Modificado pela última vez: 30 de janeiro de 2013'
ms.openlocfilehash: 841b01ae8dfcf841b0a1d64113ce7258c4c61583
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/04/2018
ms.locfileid: "25389256"
---
# <a name="nickname-cache"></a><span data-ttu-id="d0435-103">Cache de apelidos</span><span class="sxs-lookup"><span data-stu-id="d0435-103">Nickname cache</span></span>

 
  
<span data-ttu-id="d0435-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="d0435-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="d0435-105">Microsoft Office Outlook 2007, Microsoft Outlook 2010 e Microsoft Outlook 2013 interagem com o cache de apelidos, também conhecido como "AutoCompletar stream."</span><span class="sxs-lookup"><span data-stu-id="d0435-105">Microsoft Office Outlook 2007, Microsoft Outlook 2010, and Microsoft Outlook 2013 interact with the nickname cache, also known as the "autocomplete stream."</span></span> <span data-ttu-id="d0435-106">O fluxo de AutoCompletar é onde o Outlook mantém a lista de preenchimento automático, que é a lista de nomes que exibe o **para**, **Cc**e **Cco** caixas de edição enquanto um usuário está redigindo um email.</span><span class="sxs-lookup"><span data-stu-id="d0435-106">The autocomplete stream is where Outlook persists the autocomplete list, which is the list of names that displays in the **To**, **Cc**, and **Bcc** edit boxes while a user is composing an email.</span></span> <span data-ttu-id="d0435-107">Este tópico descreve como o Outlook 2007, Outlook 2010 e Outlook 2013 interagem com o fluxo de AutoCompletar e também aborda o formato binário do arquivo e as maneiras recomendadas para interagir com o fluxo de AutoCompletar.</span><span class="sxs-lookup"><span data-stu-id="d0435-107">This topic describes how Outlook 2007, Outlook 2010, and Outlook 2013 interact with the autocomplete stream and also discusses the binary format of the file and the recommended ways for interacting with the autocomplete stream.</span></span> 
  
<span data-ttu-id="d0435-108">Para aplicativos que interagem com o Outlook 2010 ou Outlook 2013, o fluxo de AutoCompletar é armazenado como uma propriedade MAPI e pode ser modificado usando MAPI ou o objeto **PropertyAccessor** da mensagem.</span><span class="sxs-lookup"><span data-stu-id="d0435-108">For applications that interact with Outlook 2010 or Outlook 2013, the autocomplete stream is stored as a MAPI property and can be modified using the MAPI or the **PropertyAccessor** object of the message.</span></span> <span data-ttu-id="d0435-109">O objeto **PropertyAccessor** é exposto nos modelos de objeto do Outlook 2010 ou Outlook 2013.</span><span class="sxs-lookup"><span data-stu-id="d0435-109">The **PropertyAccessor** object is exposed in the Outlook 2010 or Outlook 2013 object models.</span></span> 
  
<span data-ttu-id="d0435-110">Não há nenhuma dependência no modelo de objeto do Outlook 2007 ou as APIs de MAPI.</span><span class="sxs-lookup"><span data-stu-id="d0435-110">There are no dependencies on the Outlook 2007 object model or MAPI APIs.</span></span> <span data-ttu-id="d0435-111">Portanto, os aplicativos que faça alterações para o fluxo de AutoCompletar dentro do Outlook 2007 podem ser escritos usando qualquer linguagem de programação.</span><span class="sxs-lookup"><span data-stu-id="d0435-111">Therefore, applications that make changes to the autocomplete stream within Outlook 2007 can be written using any programming language.</span></span>
  
## <a name="interacting-with-the-autocomplete-stream"></a><span data-ttu-id="d0435-112">Interação com o fluxo de preenchimento automático</span><span class="sxs-lookup"><span data-stu-id="d0435-112">Interacting with the Autocomplete Stream</span></span>

<span data-ttu-id="d0435-113">Quando as caixas de edição **para**, **Cc**ou **Cco** são acessadas em uma mensagem, o fluxo de AutoCompletar for carregado e a lista de nomes de usuário é exibida.</span><span class="sxs-lookup"><span data-stu-id="d0435-113">When the **To**, **Cc**, or **Bcc** edit boxes are accessed on a message, the autocomplete stream is loaded and the list of user names is displayed.</span></span> <span data-ttu-id="d0435-114">Outlook interage com o fluxo de preenchimento automático de duas maneiras:</span><span class="sxs-lookup"><span data-stu-id="d0435-114">Outlook interacts with the autocomplete stream in two ways:</span></span> 
  
1. <span data-ttu-id="d0435-115">Carregando o fluxo de preenchimento automático</span><span class="sxs-lookup"><span data-stu-id="d0435-115">Loading the autocomplete stream</span></span> 
    
2. <span data-ttu-id="d0435-116">Salvar as alterações nos dados no stream autocomplete</span><span class="sxs-lookup"><span data-stu-id="d0435-116">Saving changes to the data in the autocomplete stream</span></span>
    
<span data-ttu-id="d0435-117">Os meios de armazenar os dados de AutoCompletar difere entre o Outlook 2007 e Outlook 2010 ou Outlook 2013 da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="d0435-117">The means of storing the autocomplete data differs between Outlook 2007 and Outlook 2010 or Outlook 2013 as follows:</span></span> 
  
 <span data-ttu-id="d0435-118">**Outlook 2007**</span><span class="sxs-lookup"><span data-stu-id="d0435-118">**Outlook 2007**</span></span>
  
<span data-ttu-id="d0435-119">Para o Outlook 2007, o fluxo de AutoCompletar é armazenado em um arquivo com o mesmo nome que o perfil e uma extensão de. nk2.</span><span class="sxs-lookup"><span data-stu-id="d0435-119">For Outlook 2007, the autocomplete stream is stored in a file with the same name as the profile and an extension of .nk2.</span></span> <span data-ttu-id="d0435-120">Por exemplo, se o perfil padrão do "outlook" for usado, o arquivo será chamado "outlook.nk2".</span><span class="sxs-lookup"><span data-stu-id="d0435-120">For example, if the default profile of "outlook" is used, the file will be called "outlook.nk2".</span></span> <span data-ttu-id="d0435-121">O arquivo. nk2 é armazenado na pasta % APPDATA%\Microsoft\Outlook.</span><span class="sxs-lookup"><span data-stu-id="d0435-121">The .nk2 file is stored in %APPDATA%\Microsoft\Outlook.</span></span> <span data-ttu-id="d0435-122">Para obter mais informações sobre o formato de arquivo binário do cache de apelidos, consulte o [formato de arquivo do Outlook 2003/2007 NK2 e diretrizes de desenvolvedor](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf).</span><span class="sxs-lookup"><span data-stu-id="d0435-122">For more information about the nickname cache binary file format, see [Outlook 2003/2007 NK2 File Format and Developer Guidelines](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf).</span></span>
  
 <span data-ttu-id="d0435-123">**Outlook 2010 e o Outlook 2013**</span><span class="sxs-lookup"><span data-stu-id="d0435-123">**Outlook 2010 and Outlook 2013**</span></span>
  
<span data-ttu-id="d0435-124">Outlook 2010 ou Outlook 2013 lê o fluxo de preenchimento automático de uma mensagem na tabela associados conteúdo da caixa de entrada do repositório de entrega de uma conta de email.</span><span class="sxs-lookup"><span data-stu-id="d0435-124">Outlook 2010 or Outlook 2013 reads the autocomplete stream from a message in the Associated Contents table of the Inbox of the mail account's delivery store.</span></span> <span data-ttu-id="d0435-125">Essa mensagem oculta tem uma classe de mensagem e o assunto da IPM. Configuration.Autocomplete.</span><span class="sxs-lookup"><span data-stu-id="d0435-125">This hidden message has a message class and subject of IPM.Configuration.Autocomplete.</span></span> <span data-ttu-id="d0435-126">O fluxo de AutoCompletar é armazenado nesta mensagem na propriedade PR_ROAMING_BINARYSTREAM ([PidTagRoamingBinary de propriedade canônico](pidtagroamingbinary-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="d0435-126">The autocomplete stream is stored on this message in the PR_ROAMING_BINARYSTREAM property ([PidTagRoamingBinary Canonical Property](pidtagroamingbinary-canonical-property.md)).</span></span> <span data-ttu-id="d0435-127">Os dados de AutoCompletar podem ser temporariamente armazenados em cache em um arquivo. dat de AutoCompletar localizado em % USERPROFILE%\AppData\Local\Microsoft\Outlook\RoamCache.</span><span class="sxs-lookup"><span data-stu-id="d0435-127">The autocomplete data may be temporarily cached in an autocomplete .dat file located in %USERPROFILE%\AppData\Local\Microsoft\Outlook\RoamCache.</span></span> <span data-ttu-id="d0435-128">No entanto, o arquivo. dat é apenas um cache e não é usado para gravar volta ao repositório de entrega, quando o usuário sai do Outlook 2010 ou Outlook 2013.</span><span class="sxs-lookup"><span data-stu-id="d0435-128">However, the .dat file is only a cache and is not used to write back to the delivery store when the user exits Outlook 2010 or Outlook 2013.</span></span>
  
## <a name="loading-the-autocomplete-stream"></a><span data-ttu-id="d0435-129">Carregando o fluxo de preenchimento automático</span><span class="sxs-lookup"><span data-stu-id="d0435-129">Loading the Autocomplete Stream</span></span>

<span data-ttu-id="d0435-130">Outlook carrega o fluxo de AutoCompletar sempre que um item com a funcionalidade de endereçamento é inicializado.</span><span class="sxs-lookup"><span data-stu-id="d0435-130">Outlook loads the autocomplete stream whenever an item with addressing functionality is initialized.</span></span> <span data-ttu-id="d0435-131">Por exemplo, endereços de email são usados em um novo email, uma resposta de email, um item de contato, uma solicitação de reunião e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="d0435-131">For example, email addresses are used in a new mail, a mail reply, a contact item, a meeting request, and so on.</span></span> <span data-ttu-id="d0435-132">Para carregar os dados, o Outlook lê a todo o conteúdo do stream na memória.</span><span class="sxs-lookup"><span data-stu-id="d0435-132">To load the data, Outlook reads all of the contents of the stream into memory.</span></span>
  
<span data-ttu-id="d0435-133">Para operações de preenchimento automático, Outlook interage exclusivamente com esta estrutura na memória para toda a duração do tempo de vida de processo outlook.exe.</span><span class="sxs-lookup"><span data-stu-id="d0435-133">For autocomplete operations, Outlook interacts exclusively with this in-memory structure for the duration of the outlook.exe process lifetime.</span></span> <span data-ttu-id="d0435-134">Outlook salva apenas a estrutura em desligamento.</span><span class="sxs-lookup"><span data-stu-id="d0435-134">Outlook only saves the structure on shutdown.</span></span> <span data-ttu-id="d0435-135">Consulte a seção a seguir "Salvando o fluxo de AutoCompletar" para obter mais informações sobre esse processo.</span><span class="sxs-lookup"><span data-stu-id="d0435-135">See the following section "Saving the Autocomplete Stream" for more information on this process.</span></span>
  
## <a name="saving-the-autocomplete-stream"></a><span data-ttu-id="d0435-136">Salvando o fluxo de preenchimento automático</span><span class="sxs-lookup"><span data-stu-id="d0435-136">Saving the Autocomplete Stream</span></span>

<span data-ttu-id="d0435-137">Outlook salvar o fluxo de AutoCompletar durante o desligamento se a lista AutoCompletar foi alterado em qualquer uma das seguintes maneiras:</span><span class="sxs-lookup"><span data-stu-id="d0435-137">Outlook saves the autocomplete stream on shutdown if the autocomplete list has changed in any of the following ways:</span></span>
  
- <span data-ttu-id="d0435-138">Uma nova entrada de apelido for adicionada por meio de resolução de nomes, separação de um destinatário da caixa de diálogo Catálogo de endereços ou enviar um email para um destinatário que ainda não estava na lista.</span><span class="sxs-lookup"><span data-stu-id="d0435-138">A new nickname entry is added through resolving a name, picking a recipient from the address book dialog, or sending mail to a recipient that was not already in the list.</span></span>
    
- <span data-ttu-id="d0435-139">Uma entrada é modificada, enviando um email para um destinatário existente na lista.</span><span class="sxs-lookup"><span data-stu-id="d0435-139">An entry is modified by sending mail to an existing recipient in the list.</span></span>
    
- <span data-ttu-id="d0435-140">Uma entrada foi removida pelo usuário, através da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="d0435-140">An entry is removed by the user through the UI.</span></span>
    
- <span data-ttu-id="d0435-141">Outros cenários secundárias não relevantes para este tópico.</span><span class="sxs-lookup"><span data-stu-id="d0435-141">Other minor scenarios not relevant to this topic.</span></span>
    
<span data-ttu-id="d0435-142">Salvar as alterações nos dados de AutoCompletar envolve a gravação da estrutura de na memória de volta para um [fluxo de AutoCompletar](autocomplete-stream.md).</span><span class="sxs-lookup"><span data-stu-id="d0435-142">Saving changes to the autocomplete data involves writing the in-memory structure back to an [Autocomplete Stream](autocomplete-stream.md).</span></span> <span data-ttu-id="d0435-143">Ao interagir com o Outlook 2007, o fluxo é salvo em um arquivo. nk2 local.</span><span class="sxs-lookup"><span data-stu-id="d0435-143">When interacting with Outlook 2007, the stream is saved to a local .nk2 file.</span></span> <span data-ttu-id="d0435-144">Para o Outlook 2010 ou Outlook 2013, o fluxo de AutoCompletar grava de volta para o índice de conteúdo associados de caixa de entrada do repositório de entrega de uma conta de email.</span><span class="sxs-lookup"><span data-stu-id="d0435-144">For Outlook 2010 or Outlook 2013, the autocomplete stream writes back to the Associated Contents table of the Inbox of the mail account's delivery store.</span></span>
  
## <a name="recommendations"></a><span data-ttu-id="d0435-145">Recomendações</span><span class="sxs-lookup"><span data-stu-id="d0435-145">Recommendations</span></span>

- <span data-ttu-id="d0435-146">Nunca parcialmente modifica o fluxo de AutoCompletar.</span><span class="sxs-lookup"><span data-stu-id="d0435-146">Never partially modify the autocomplete stream.</span></span> <span data-ttu-id="d0435-147">A interação com suporte é 1) ler o fluxo de AutoCompletar inteira na memória, 2) modificar a estrutura de memória e 3) gravar o fluxo inteiro volta tanto o índice de conteúdo associados de caixa de entrada do repositório de entrega de uma conta de email (para o Outlook 2010 ou Outlook 2013) ou para o arquivo. nk2 local (Outlook 2007).</span><span class="sxs-lookup"><span data-stu-id="d0435-147">The supported interaction is to 1) read the entire autocomplete stream into memory, 2) modify the memory structure, and 3) write the entire stream back to either the Associated Contents table of the Inbox of the mail account's delivery store (for Outlook 2010 or Outlook 2013) or to the local .nk2 file (Outlook 2007).</span></span>
    
- <span data-ttu-id="d0435-148">Não interagem com o fluxo de AutoCompletar durante a execução do Outlook.</span><span class="sxs-lookup"><span data-stu-id="d0435-148">Do not interact with the autocomplete stream while Outlook is running.</span></span> <span data-ttu-id="d0435-149">Se o Outlook estiver em execução enquanto você modifica o fluxo, ele provavelmente substituirá as alterações quando ele for desligado.</span><span class="sxs-lookup"><span data-stu-id="d0435-149">If Outlook is running while you modify the stream, it will likely overwrite your changes when it shuts down.</span></span>
    
- <span data-ttu-id="d0435-150">Propriedades de gravação não de digite PT_MV_UNICODE e PR_MV_STRING8 em um fluxo de AutoCompletar a serem utilizados pelo Microsoft Outlook 2003.</span><span class="sxs-lookup"><span data-stu-id="d0435-150">Do not write properties of type PT_MV_UNICODE and PR_MV_STRING8 into an autocomplete stream to be consumed by Microsoft Outlook 2003.</span></span> <span data-ttu-id="d0435-151">Essas propriedades só sejam entendidas pelo Outlook 2007, Outlook 2010 e Outlook 2013.</span><span class="sxs-lookup"><span data-stu-id="d0435-151">These properties are only understood by Outlook 2007, Outlook 2010, and Outlook 2013.</span></span>
    
- <span data-ttu-id="d0435-152">Ao desenvolver o código que interage com o Outlook 2007, recomendamos que você bloquear o arquivo. nk2 contra modificação por outros processos enquanto você estiver lendo e gravando-lo usando o arquivo padrão de bloqueio de APIs (por exemplo, **LockFile** em C/C++ e \*\* FileStream.Lock\*\* em c#).</span><span class="sxs-lookup"><span data-stu-id="d0435-152">When developing code that interacts with Outlook 2007, we recommend that you lock the .nk2 file from modification by other processes while you are reading and writing it using standard file locking APIs (for example, **LockFile** in C/C++ and **FileStream.Lock** in C#).</span></span> 
    
- <span data-ttu-id="d0435-153">Modifica apenas as propriedades de tipos que são provenientes do conjunto de linhas do fluxo de AutoCompletar.</span><span class="sxs-lookup"><span data-stu-id="d0435-153">Only modify the properties of types that are from the row-set of the autocomplete stream.</span></span> <span data-ttu-id="d0435-154">Para obter mais informações sobre as propriedades do fluxo de AutoCompletar e os tipos de propriedade, consulte [fluxo de AutoCompletar](autocomplete-stream.md).</span><span class="sxs-lookup"><span data-stu-id="d0435-154">For more information about the autocomplete stream properties and property types, see [Autocomplete Stream](autocomplete-stream.md).</span></span>
    
## <a name="see-also"></a><span data-ttu-id="d0435-155">Confira também</span><span class="sxs-lookup"><span data-stu-id="d0435-155">See also</span></span>



[<span data-ttu-id="d0435-156">Fluxo de preenchimento automático</span><span class="sxs-lookup"><span data-stu-id="d0435-156">Autocomplete Stream</span></span>](autocomplete-stream.md)
  
[<span data-ttu-id="d0435-157">Perfis MAPI</span><span class="sxs-lookup"><span data-stu-id="d0435-157">MAPI Profiles</span></span>](mapi-profiles.md)


[<span data-ttu-id="d0435-158">Formato de arquivo do Outlook 2003/2007 NK2 e diretrizes de desenvolvedor</span><span class="sxs-lookup"><span data-stu-id="d0435-158">Outlook 2003/2007 NK2 File Format and Developer Guidelines</span></span>](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)

