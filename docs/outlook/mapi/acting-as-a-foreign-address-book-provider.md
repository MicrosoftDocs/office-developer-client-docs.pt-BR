---
title: Atuar como um provedor de catálogo de endereços estrangeiro
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 6d532ed4-7dc5-46a9-995a-72bc97d16f6e
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: 300681bd585e9d534113404a82f43565f4e79bb4
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33435737"
---
# <a name="acting-as-a-foreign-address-book-provider"></a><span data-ttu-id="90251-103">Atuar como um provedor de catálogo de endereços estrangeiro</span><span class="sxs-lookup"><span data-stu-id="90251-103">Acting as a foreign address book provider</span></span>

<span data-ttu-id="90251-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="90251-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="90251-105">Um provedor estrangeiro é um provedor de agendas que:</span><span class="sxs-lookup"><span data-stu-id="90251-105">A foreign provider is an address book provider that:</span></span> 
  
- <span data-ttu-id="90251-106">Atribui identificadores de modelo a seus destinatários.</span><span class="sxs-lookup"><span data-stu-id="90251-106">Assigns template identifiers for its recipients.</span></span>
    
- <span data-ttu-id="90251-107">Dá suporte [ao método IABLogon::OpenTemplateID.](iablogon-opentemplateid.md)</span><span class="sxs-lookup"><span data-stu-id="90251-107">Supports the [IABLogon::OpenTemplateID](iablogon-opentemplateid.md) method.</span></span> 
    
- <span data-ttu-id="90251-108">Fornece código para manter destinatários existentes nos contêineres de outros provedores de agendas de endereços conhecidos como provedores de host.</span><span class="sxs-lookup"><span data-stu-id="90251-108">Supplies code for maintaining recipients that exist in the containers of other address book providers known as host providers.</span></span> <span data-ttu-id="90251-109">Esse código envolve um objeto de propriedade, normalmente uma implementação de interface **IMAPIProp,** que envolve um objeto de propriedade do provedor de host.</span><span class="sxs-lookup"><span data-stu-id="90251-109">This code involves a property object, typically an **IMAPIProp** interface implementation, which wraps a property object from the host provider.</span></span> 
    
<span data-ttu-id="90251-110">Atuar como um provedor estrangeiro é uma função opcional; nem todos os provedores precisam dar suporte a identificadores de modelo e seu código relacionado.</span><span class="sxs-lookup"><span data-stu-id="90251-110">Acting as a foreign provider is an optional role; not all providers need to support template identifiers and their related code.</span></span> <span data-ttu-id="90251-111">Implemente seu provedor como um provedor estrangeiro se você quiser manter o controle sobre destinatários que os provedores de host criam usando modelos fornecidos por seu provedor.</span><span class="sxs-lookup"><span data-stu-id="90251-111">Implement your provider as a foreign provider if you want to maintain control over recipients that host providers create using templates supplied by your provider.</span></span> 
  
<span data-ttu-id="90251-112">O formato que seu provedor usa para seus identificadores de entrada também pode ser usado para seus identificadores de modelo.</span><span class="sxs-lookup"><span data-stu-id="90251-112">The format that your provider uses for its entry identifiers can also be used for its template identifiers.</span></span> <span data-ttu-id="90251-113">Os identificadores de modelo devem incluir **o MAPIUID** registrado do provedor para habilitar o MAPI para vincular com êxito os destinatários aos provedores apropriados.</span><span class="sxs-lookup"><span data-stu-id="90251-113">Template identifiers must include your provider's registered **MAPIUID** to enable MAPI to successfully bind recipients to the appropriate providers.</span></span> 
  
<span data-ttu-id="90251-114">O MAPI chama o método **IABLogon::OpenTemplateID** do provedor quando um provedor de host chama [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span><span class="sxs-lookup"><span data-stu-id="90251-114">MAPI calls your provider's **IABLogon::OpenTemplateID** method when a host provider calls [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span></span> <span data-ttu-id="90251-115">O provedor de host passa o identificador de modelo do destinatário no parâmetro  _lpTemplateID_ em sua chamada para **IMAPISupport::OpenTemplateID**.</span><span class="sxs-lookup"><span data-stu-id="90251-115">The host provider passes the template identifier of the recipient in the  _lpTemplateID_ parameter in its call to **IMAPISupport::OpenTemplateID**.</span></span> <span data-ttu-id="90251-116">O MAPI determina que o identificador do modelo pertence ao seu provedor, combinando o [MAPIUID](mapiuid.md) no identificador de modelo com o **MAPIUID** que seu provedor registrou no momento do logon.</span><span class="sxs-lookup"><span data-stu-id="90251-116">MAPI determines that the template identifier belongs to your provider by matching the [MAPIUID](mapiuid.md) in the template identifier with the **MAPIUID** that your provider registered at logon time.</span></span> <span data-ttu-id="90251-117">O MAPI encaminha a chamada do provedor de host para seu provedor por meio do **método IABLogon::OpenTemplateID.**</span><span class="sxs-lookup"><span data-stu-id="90251-117">MAPI then forwards the host provider's call to your provider through the **IABLogon::OpenTemplateID** method.</span></span> 
  
<span data-ttu-id="90251-118">O provedor de host também passa um ponteiro para sua implementação de objeto de propriedade para o destinatário no parâmetro  _lpMAPIPropData,_ um identificador de interface no parâmetro  _lpInterface_ que corresponde ao tipo de implementação de interface passada  _em lpMAPIPropData_ e um sinalizador opcional, FILL_ENTRY.</span><span class="sxs-lookup"><span data-stu-id="90251-118">The host provider also passes a pointer to its property object implementation for the recipient in the  _lpMAPIPropData_ parameter, an interface identifier in the  _lpInterface_ parameter that corresponds to the type of interface implementation passed in  _lpMAPIPropData_, and an optional flag, FILL_ENTRY.</span></span> <span data-ttu-id="90251-119">Seu provedor deve retornar no parâmetro  _lppMAPIPropNew_ um ponteiro para uma implementação de objeto de propriedade do tipo especificado em  _lpInterface_.</span><span class="sxs-lookup"><span data-stu-id="90251-119">Your provider is expected to return in the  _lppMAPIPropNew_ parameter a pointer to a property object implementation of the type specified in  _lpInterface_.</span></span> <span data-ttu-id="90251-120">O ponteiro retornado pode ser para o objeto de propriedade de empacotado implementado pelo provedor ou para o objeto fornecido pelo provedor de host em  _lpMAPIPropData_.</span><span class="sxs-lookup"><span data-stu-id="90251-120">The returned pointer can either be to the wrapped property object implemented by your provider or to the object supplied by the host provider in  _lpMAPIPropData_.</span></span> <span data-ttu-id="90251-121">Seu provedor deve retornar um ponteiro de objeto de propriedade com retorno quando:</span><span class="sxs-lookup"><span data-stu-id="90251-121">Your provider should return a wrapped property object pointer when:</span></span>
  
- <span data-ttu-id="90251-122">A tabela de exibição do destinatário contém controles de caixa de listagem.</span><span class="sxs-lookup"><span data-stu-id="90251-122">The recipient's display table contains list box controls.</span></span>
    
- <span data-ttu-id="90251-123">O endereço de email do destinatário deve ser montado a partir de dados em vários controles de tabela de exibição.</span><span class="sxs-lookup"><span data-stu-id="90251-123">The email address for the recipient must be assembled from data in multiple display table controls.</span></span>
    
- <span data-ttu-id="90251-124">Seu provedor emite notificações de tabela de exibição.</span><span class="sxs-lookup"><span data-stu-id="90251-124">Your provider issues display table notifications.</span></span>
    
<span data-ttu-id="90251-125">O FILL_ENTRY sinalizador indica ao provedor que o provedor de host exige que todas as propriedades do destinatário sejam atualizadas.</span><span class="sxs-lookup"><span data-stu-id="90251-125">The FILL_ENTRY flag indicates to your provider that the host provider requires all the properties of the recipient to be updated.</span></span> <span data-ttu-id="90251-126">Seu provedor é necessário para atender a essa solicitação.</span><span class="sxs-lookup"><span data-stu-id="90251-126">Your provider is required to fulfill this request.</span></span>
  
<span data-ttu-id="90251-127">Quando um provedor de host chama o método **OpenTemplateID** do provedor, o provedor pode:</span><span class="sxs-lookup"><span data-stu-id="90251-127">When a host provider calls your provider's **OpenTemplateID** method, your provider might:</span></span> 
  
- <span data-ttu-id="90251-128">Atualize periodicamente os dados de uma entrada copiada.</span><span class="sxs-lookup"><span data-stu-id="90251-128">Periodically update the data for a copied entry.</span></span>
    
- <span data-ttu-id="90251-129">Mantenha uma entrada copiada sincronizada com seu original, como quando uma entrada do livro de endereços é copiada para o livro de endereços pessoal.</span><span class="sxs-lookup"><span data-stu-id="90251-129">Keep a copied entry synchronized with its original, such as when an address book entry is copied to the personal address book.</span></span>
    
- <span data-ttu-id="90251-130">Implemente a funcionalidade que não pode ser implementada pelo provedor de host, como preencher dinamicamente caixas de listagem na tabela de detalhes da entrada copiada dos dados em um servidor.</span><span class="sxs-lookup"><span data-stu-id="90251-130">Implement functionality that cannot be implemented by the host provider, such as dynamically populating list boxes in the copied entry's details table from data on a server.</span></span>
    
- <span data-ttu-id="90251-131">Controlar a interação entre as propriedades em uma entrada copiada ou modelo instariado.</span><span class="sxs-lookup"><span data-stu-id="90251-131">Control the interaction among properties in a copied entry or instantiated template.</span></span> <span data-ttu-id="90251-132">Por exemplo, calcular **PR_EMAIL_ADDRESS** de outras propriedades exibidas na tabela de detalhes.</span><span class="sxs-lookup"><span data-stu-id="90251-132">For example, computing **PR_EMAIL_ADDRESS** from other properties displayed in the details table.</span></span> 
    
<span data-ttu-id="90251-133">Os dois primeiros itens são exemplos de tarefas que não exigem que seu provedor fornecer um objeto de propriedade empacotado — uma implementação de **IMAPIProp** baseada na implementação do provedor de host.</span><span class="sxs-lookup"><span data-stu-id="90251-133">The first two items are examples of tasks that do not require your provider to supply a wrapped property object — an implementation of **IMAPIProp** that is based on the host provider's implementation.</span></span> <span data-ttu-id="90251-134">Seu provedor pode simplesmente atualizar as propriedades conforme necessário e retornar, definindo o parâmetro _lppMAPIPropNew_ para apontar para o ponteiro passado pelo provedor de host no parâmetro _lpMAPIPropData._</span><span class="sxs-lookup"><span data-stu-id="90251-134">Your provider can simply update the properties as necessary and return, setting the  _lppMAPIPropNew_ parameter to point to the pointer passed in by the host provider in the  _lpMAPIPropData_ parameter.</span></span> 
  
<span data-ttu-id="90251-135">As duas segundas tarefas exigem que seu provedor retorne ao provedor de host um objeto de propriedade que envolve o objeto do provedor de host com funcionalidade adicional, como a capacidade de exibir uma folha de propriedades para a entrada.</span><span class="sxs-lookup"><span data-stu-id="90251-135">The second two tasks require that your provider return to the host provider a property object that wraps the host provider's object with additional functionality, such as the ability to display a property sheet for the entry.</span></span> <span data-ttu-id="90251-136">Esse objeto de propriedade será um usuário de mensagens ou uma lista de distribuição, dependendo do tipo de objeto passado pelo provedor de host no parâmetro _lpMAPIPropData_ e indicado pelo identificador de interface no parâmetro _lpInterface._</span><span class="sxs-lookup"><span data-stu-id="90251-136">This property object will either be a messaging user or distribution list, depending on the type of object passed in by the host provider in the  _lpMAPIPropData_ parameter and indicated by the interface identifier in the  _lpInterface_ parameter.</span></span> <span data-ttu-id="90251-137">Se o _parâmetro lpMAPIPropData_ aponta para um usuário de mensagens, o objeto de propriedade de empacotamento do provedor deve ser uma implementação **IMailUser.**</span><span class="sxs-lookup"><span data-stu-id="90251-137">If the  _lpMAPIPropData_ parameter points to a messaging user, your provider's wrapped property object must be an **IMailUser** implementation.</span></span> <span data-ttu-id="90251-138">Se _lpMAPIPropData aponta para_ uma lista de distribuição, ele deve ser uma implementação de **IDistList.**</span><span class="sxs-lookup"><span data-stu-id="90251-138">If  _lpMAPIPropData_ points to a distribution list, it must be an **IDistList** implementation.</span></span> 
  
<span data-ttu-id="90251-139">O objeto de propriedade quebrada de seu provedor intercepta chamadas de método **IMAPIProp** para executar manipulação específica de contexto do destinatário do provedor de host o objeto que ele está envolvendo.</span><span class="sxs-lookup"><span data-stu-id="90251-139">Your provider's wrapped property object intercepts **IMAPIProp** method calls to perform context-specific manipulation of the host provider's recipient—the object it is wrapping.</span></span> <span data-ttu-id="90251-140">MAPI only has one requirement for wrapped property objects: all calls to [IMAPIProp::OpenProperty](imapiprop-openproperty.md) requesting the **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) property should be passed to the host provider.</span><span class="sxs-lookup"><span data-stu-id="90251-140">MAPI only has one requirement for wrapped property objects: all calls to [IMAPIProp::OpenProperty](imapiprop-openproperty.md) requesting the **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) property should be passed to the host provider.</span></span> <span data-ttu-id="90251-141">A implementação do provedor pode usar a tabela retornada para interceptar as notificações da tabela de exibição ou adicionar suas próprias, se necessário.</span><span class="sxs-lookup"><span data-stu-id="90251-141">Your provider's implementation can use the returned table to intercept display table notifications or to add its own if necessary.</span></span> 
  
<span data-ttu-id="90251-142">A lista a seguir inclui tarefas que são normalmente implementadas no objeto de propriedade empacotado implementado por provedores externos:</span><span class="sxs-lookup"><span data-stu-id="90251-142">The following list includes tasks that are typically implemented in the wrapped property object implemented by foreign providers:</span></span>
  
- <span data-ttu-id="90251-143">Valores de propriedade de pré-processamento e pós-processamento para o destinatário do host [em IMAPIProp::GetProps](imapiprop-getprops.md).</span><span class="sxs-lookup"><span data-stu-id="90251-143">Preprocessing and postprocessing property values for the host recipient in [IMAPIProp::GetProps](imapiprop-getprops.md).</span></span>
    
- <span data-ttu-id="90251-144">Manipular detalhes exibem controles de tabela, como botões e caixas de listagem, **em IMAPIProp::OpenProperty**.</span><span class="sxs-lookup"><span data-stu-id="90251-144">Handling details display table controls, such as buttons and list boxes, in **IMAPIProp::OpenProperty**.</span></span>
    
- <span data-ttu-id="90251-145">Validando ou manipulando valores de propriedade para o destinatário do host [em IMAPIProp::SetProps](imapiprop-setprops.md).</span><span class="sxs-lookup"><span data-stu-id="90251-145">Validating or manipulating property values for the host recipient in [IMAPIProp::SetProps](imapiprop-setprops.md).</span></span>
    
- <span data-ttu-id="90251-146">Calculando as propriedades necessárias, **como PR_EMAIL_ADDRESS** e verificando se todas as propriedades necessárias foram definidas antes de salvar o destinatário do host em [IMAPIProp::SaveChanges](imapiprop-savechanges.md).</span><span class="sxs-lookup"><span data-stu-id="90251-146">Computing required properties such as **PR_EMAIL_ADDRESS** and verifying that all of the necessary properties have been set before saving the host recipient in [IMAPIProp::SaveChanges](imapiprop-savechanges.md).</span></span>
    
### <a name="to-implement-iablogonopentemplateid"></a><span data-ttu-id="90251-147">Para implementar IABLogon::OpenTemplateID</span><span class="sxs-lookup"><span data-stu-id="90251-147">To implement IABLogon::OpenTemplateID</span></span>
  
1. <span data-ttu-id="90251-148">Verifique se o identificador de modelo passado com o parâmetro  _lpTemplateID_ é válido e está em um formato que seu provedor reconhece.</span><span class="sxs-lookup"><span data-stu-id="90251-148">Check if the template identifier passed in with the  _lpTemplateID_ parameter is valid and is in a format that your provider recognizes.</span></span> <span data-ttu-id="90251-149">Se não estiver, falhe e retorne MAPI_E_INVALID_ENTRYID.</span><span class="sxs-lookup"><span data-stu-id="90251-149">If it is not, fail and return MAPI_E_INVALID_ENTRYID.</span></span> 
    
2. <span data-ttu-id="90251-150">Crie um objeto do tipo indicado pelo identificador do modelo, seja um usuário de mensagens, uma lista de distribuição ou um destinatário único.</span><span class="sxs-lookup"><span data-stu-id="90251-150">Create an object of the type indicated by the template identifier, either a messaging user, distribution list, or one-off recipient.</span></span> 
    
3. <span data-ttu-id="90251-151">Chame o **método IUnknown::AddRef** no objeto de propriedade do provedor de host, que é o objeto apontado pelo parâmetro _lpMAPIPropData._</span><span class="sxs-lookup"><span data-stu-id="90251-151">Call the **IUnknown::AddRef** method in the host provider's property object, which is the object pointed to by the  _lpMAPIPropData_ parameter.</span></span> 
    
4. <span data-ttu-id="90251-152">Se o  _parâmetro ulTemplateFlags_ for definido como FILL_ENTRY:</span><span class="sxs-lookup"><span data-stu-id="90251-152">If the  _ulTemplateFlags_ parameter is set to FILL_ENTRY:</span></span> 
    
   1. <span data-ttu-id="90251-153">Se o novo objeto for um usuário de mensagens ou uma lista de distribuição:</span><span class="sxs-lookup"><span data-stu-id="90251-153">If the new object is a messaging user or distribution list:</span></span>
      
      1. <span data-ttu-id="90251-154">Recupere todas as propriedades do novo objeto, possivelmente chamando seu **método IMAPIProp::GetProps.**</span><span class="sxs-lookup"><span data-stu-id="90251-154">Retrieve all of the properties of the new object, possibly by calling its **IMAPIProp::GetProps** method.</span></span> 
          
      2. <span data-ttu-id="90251-155">Chame o método **IMAPIProp::SetProps** do provedor de host para copiar todas as propriedades recuperadas para o objeto de propriedade do provedor de host.</span><span class="sxs-lookup"><span data-stu-id="90251-155">Call the host provider's **IMAPIProp::SetProps** method to copy all of the retrieved properties to the host provider's property object.</span></span> 
      
   2. <span data-ttu-id="90251-156">Se o novo objeto for um destinatário único, chame o método **IMAPIProp::SetProps** do provedor de host para definir as seguintes propriedades:</span><span class="sxs-lookup"><span data-stu-id="90251-156">If the new object is a one-off recipient, call the host provider's **IMAPIProp::SetProps** method to set the following properties:</span></span> 
      
      - <span data-ttu-id="90251-157">**PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md)) para o tipo de endereço manipulado pelo provedor.</span><span class="sxs-lookup"><span data-stu-id="90251-157">**PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md)) to the address type handled by your provider.</span></span>
        
      - <span data-ttu-id="90251-158">**PR \_ TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) para o identificador de modelo dos parâmetros _lpTemplateID_ e _cbTemplateID._</span><span class="sxs-lookup"><span data-stu-id="90251-158">**PR\_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) to the template identifier from the  _lpTemplateID_ and  _cbTemplateID_ parameters.</span></span> 
        
      - <span data-ttu-id="90251-159">**PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md)) para DT_MAILUSER ou DT_DISTLIST, conforme apropriado.</span><span class="sxs-lookup"><span data-stu-id="90251-159">**PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md)) to DT_MAILUSER or DT_DISTLIST, as appropriate.</span></span>
    
5. <span data-ttu-id="90251-160">De definir o conteúdo do parâmetro  _lppMAPIPropNew_ para apontar para o novo objeto do provedor ou para o objeto de propriedade passado com o parâmetro  _lpMAPIPropData,_ dependendo se o provedor determinar um objeto de empacotamento é necessário.</span><span class="sxs-lookup"><span data-stu-id="90251-160">Set the contents of the  _lppMAPIPropNew_ parameter to point to either your provider's new object or the property object passed in with the  _lpMAPIPropData_ parameter, depending on whether your provider determines a wrapped object is necessary.</span></span> 
    
6. <span data-ttu-id="90251-161">Se ocorrer um erro crítico, como uma falha de rede ou uma condição de falta de memória, retorne o valor de erro apropriado.</span><span class="sxs-lookup"><span data-stu-id="90251-161">If a critical error occurs, such as a network failure or an out of memory condition, return the appropriate error value.</span></span> <span data-ttu-id="90251-162">Esse valor deve ser propagado para o cliente com a estrutura [MAPIERROR](mapierror.md) apropriada, uma tarefa executada pelo provedor de host.</span><span class="sxs-lookup"><span data-stu-id="90251-162">This value should get propagated to the client with the appropriate [MAPIERROR](mapierror.md) structure, a task performed by the host provider.</span></span> 
    

