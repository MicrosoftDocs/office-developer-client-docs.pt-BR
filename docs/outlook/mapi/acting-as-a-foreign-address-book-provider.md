---
title: Atuando como um provedor de catálogo de endereço estrangeiro
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 6d532ed4-7dc5-46a9-995a-72bc97d16f6e
description: '�ltima altera��o: s�bado, 23 de julho de 2011'
ms.openlocfilehash: 16c3518ab4efddbd68765d9de94db64b4fdc0b64
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19766113"
---
# <a name="acting-as-a-foreign-address-book-provider"></a><span data-ttu-id="35b6f-103">Atuando como um provedor de catálogo de endereço estrangeiro</span><span class="sxs-lookup"><span data-stu-id="35b6f-103">Acting as a foreign address book provider</span></span>

<span data-ttu-id="35b6f-104">**Aplica-se a**: Outlook</span><span class="sxs-lookup"><span data-stu-id="35b6f-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="35b6f-105">Um provedor externo é um provedor de catálogo de endereços que:</span><span class="sxs-lookup"><span data-stu-id="35b6f-105">A foreign provider is an address book provider that:</span></span> 
  
- <span data-ttu-id="35b6f-106">Atribui os identificadores de modelo para seus destinatários.</span><span class="sxs-lookup"><span data-stu-id="35b6f-106">Assigns template identifiers for its recipients.</span></span>
    
- <span data-ttu-id="35b6f-107">Suporta o método [IABLogon:: OpenTemplateID](iablogon-opentemplateid.md) .</span><span class="sxs-lookup"><span data-stu-id="35b6f-107">Supports the [IABLogon::OpenTemplateID](iablogon-opentemplateid.md) method.</span></span> 
    
- <span data-ttu-id="35b6f-108">Código de suprimentos para destinatários que existem nos contêineres de outros provedores de catálogo de endereços conhecidos como provedores de host de manutenção.</span><span class="sxs-lookup"><span data-stu-id="35b6f-108">Supplies code for maintaining recipients that exist in the containers of other address book providers known as host providers.</span></span> <span data-ttu-id="35b6f-109">Este código envolve a um objeto property, normalmente uma implementação de interface de **IMAPIProp** , que distribui um objeto property do provedor de host.</span><span class="sxs-lookup"><span data-stu-id="35b6f-109">This code involves a property object, typically an **IMAPIProp** interface implementation, which wraps a property object from the host provider.</span></span> 
    
<span data-ttu-id="35b6f-110">Atuar como um provedor de estrangeiro é uma função opcional; nem todos os provedores precisam suportar os identificadores de modelo e seus códigos relacionados.</span><span class="sxs-lookup"><span data-stu-id="35b6f-110">Acting as a foreign provider is an optional role; not all providers need to support template identifiers and their related code.</span></span> <span data-ttu-id="35b6f-111">Implemente o seu provedor como um provedor de estrangeiro se você deseja manter o controle sobre destinatários que criam de provedores de host usando modelos fornecidos pelo seu provedor.</span><span class="sxs-lookup"><span data-stu-id="35b6f-111">Implement your provider as a foreign provider if you want to maintain control over recipients that host providers create using templates supplied by your provider.</span></span> 
  
<span data-ttu-id="35b6f-112">O formato que seu provedor usa para seus identificadores de entrada também pode ser usado para seus identificadores de modelo.</span><span class="sxs-lookup"><span data-stu-id="35b6f-112">The format that your provider uses for its entry identifiers can also be used for its template identifiers.</span></span> <span data-ttu-id="35b6f-113">Identificadores de modelo devem incluir registrados do seu provedor **MAPIUID** para habilitar MAPI vincular com êxito os destinatários para os provedores de apropriado.</span><span class="sxs-lookup"><span data-stu-id="35b6f-113">Template identifiers must include your provider's registered **MAPIUID** to enable MAPI to successfully bind recipients to the appropriate providers.</span></span> 
  
<span data-ttu-id="35b6f-114">MAPI chama o método de **IABLogon:: OpenTemplateID** do seu provedor quando um provedor de host chamadas [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span><span class="sxs-lookup"><span data-stu-id="35b6f-114">MAPI calls your provider's **IABLogon::OpenTemplateID** method when a host provider calls [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span></span> <span data-ttu-id="35b6f-115">O provedor de host passa o identificador de modelo do destinatário no parâmetro _lpTemplateID_ na sua chamada **IMAPISupport::OpenTemplateID**.</span><span class="sxs-lookup"><span data-stu-id="35b6f-115">The host provider passes the template identifier of the recipient in the  _lpTemplateID_ parameter in its call to **IMAPISupport::OpenTemplateID**.</span></span> <span data-ttu-id="35b6f-116">MAPI determina que o identificador de modelo pertence ao seu provedor combinando o [MAPIUID](mapiuid.md) do identificador de modelo com o seu provedor registrado no momento do logon **MAPIUID** .</span><span class="sxs-lookup"><span data-stu-id="35b6f-116">MAPI determines that the template identifier belongs to your provider by matching the [MAPIUID](mapiuid.md) in the template identifier with the **MAPIUID** that your provider registered at logon time.</span></span> <span data-ttu-id="35b6f-117">MAPI encaminha a chamada do provedor de host para o seu provedor por meio do método **IABLogon:: OpenTemplateID** .</span><span class="sxs-lookup"><span data-stu-id="35b6f-117">MAPI then forwards the host provider's call to your provider through the **IABLogon::OpenTemplateID** method.</span></span> 
  
<span data-ttu-id="35b6f-118">O provedor de host também passa um ponteiro para sua implementação do objeto de propriedade para o destinatário no parâmetro _lpMAPIPropData_ , um identificador de interface no parâmetro _lpInterface_ que corresponde ao tipo de implementação de interface passados _lpMAPIPropData_e um sinalizador opcional, FILL_ENTRY.</span><span class="sxs-lookup"><span data-stu-id="35b6f-118">The host provider also passes a pointer to its property object implementation for the recipient in the  _lpMAPIPropData_ parameter, an interface identifier in the  _lpInterface_ parameter that corresponds to the type of interface implementation passed in  _lpMAPIPropData_, and an optional flag, FILL_ENTRY.</span></span> <span data-ttu-id="35b6f-119">Espera-se que o seu provedor retornar no parâmetro _lppMAPIPropNew_ um ponteiro para uma implementação de propriedade de objeto do tipo especificado no _lpInterface_.</span><span class="sxs-lookup"><span data-stu-id="35b6f-119">Your provider is expected to return in the  _lppMAPIPropNew_ parameter a pointer to a property object implementation of the type specified in  _lpInterface_.</span></span> <span data-ttu-id="35b6f-120">O ponteiro retornado pode ser ao objeto de propriedade com quebra implementadas pelo seu provedor ou para o objeto fornecido pelo provedor de host em _lpMAPIPropData_.</span><span class="sxs-lookup"><span data-stu-id="35b6f-120">The returned pointer can either be to the wrapped property object implemented by your provider or to the object supplied by the host provider in  _lpMAPIPropData_.</span></span> <span data-ttu-id="35b6f-121">Seu provedor deve retornar um ponteiro de objeto de propriedade com quebra quando:</span><span class="sxs-lookup"><span data-stu-id="35b6f-121">Your provider should return a wrapped property object pointer when:</span></span>
  
- <span data-ttu-id="35b6f-122">Tabela de exibição do destinatário contém controles de caixa de lista.</span><span class="sxs-lookup"><span data-stu-id="35b6f-122">The recipient's display table contains list box controls.</span></span>
    
- <span data-ttu-id="35b6f-123">O endereço de email do destinatário deve ser montado a partir de dados em vários controles de exibição de tabela.</span><span class="sxs-lookup"><span data-stu-id="35b6f-123">The email address for the recipient must be assembled from data in multiple display table controls.</span></span>
    
- <span data-ttu-id="35b6f-124">Problemas de seu provedor exibem notificações de tabela.</span><span class="sxs-lookup"><span data-stu-id="35b6f-124">Your provider issues display table notifications.</span></span>
    
<span data-ttu-id="35b6f-125">O sinalizador FILL_ENTRY indica ao provedor que o provedor de host exige todas as propriedades do destinatário para serem atualizadas.</span><span class="sxs-lookup"><span data-stu-id="35b6f-125">The FILL_ENTRY flag indicates to your provider that the host provider requires all the properties of the recipient to be updated.</span></span> <span data-ttu-id="35b6f-126">Seu provedor é necessária para preencher essa solicitação.</span><span class="sxs-lookup"><span data-stu-id="35b6f-126">Your provider is required to fulfill this request.</span></span>
  
<span data-ttu-id="35b6f-127">Quando um provedor de host chama o método **OpenTemplateID** do seu provedor de serviço, talvez seu provedor:</span><span class="sxs-lookup"><span data-stu-id="35b6f-127">When a host provider calls your provider's **OpenTemplateID** method, your provider might:</span></span> 
  
- <span data-ttu-id="35b6f-128">Atualize periodicamente os dados para uma entrada copiada.</span><span class="sxs-lookup"><span data-stu-id="35b6f-128">Periodically update the data for a copied entry.</span></span>
    
- <span data-ttu-id="35b6f-129">Mantenha uma entrada copiada sincronizada com seu original, como quando uma entrada do catálogo de endereços é copiada para o catálogo de endereços pessoal.</span><span class="sxs-lookup"><span data-stu-id="35b6f-129">Keep a copied entry synchronized with its original, such as when an address book entry is copied to the personal address book.</span></span>
    
- <span data-ttu-id="35b6f-130">Funcionalidade de implementar que não pode ser implementada pelo provedor de host, como dinamicamente Popular lista caixas na tabela de detalhes da entrada copiada de dados em um servidor.</span><span class="sxs-lookup"><span data-stu-id="35b6f-130">Implement functionality that cannot be implemented by the host provider, such as dynamically populating list boxes in the copied entry's details table from data on a server.</span></span>
    
- <span data-ttu-id="35b6f-131">Controle a interação entre propriedades em uma entrada copiada ou modelo instanciado.</span><span class="sxs-lookup"><span data-stu-id="35b6f-131">Control the interaction among properties in a copied entry or instantiated template.</span></span> <span data-ttu-id="35b6f-132">Por exemplo, computação **PR_EMAIL_ADDRESS** de outras propriedades exibidas na tabela de detalhes.</span><span class="sxs-lookup"><span data-stu-id="35b6f-132">For example, computing **PR_EMAIL_ADDRESS** from other properties displayed in the details table.</span></span> 
    
<span data-ttu-id="35b6f-133">Os primeiros dois itens são exemplos de tarefas que não exigem o provedor para fornecer um objeto property com quebra — uma implementação do **IMAPIProp** que baseia-se na implementação do provedor de host.</span><span class="sxs-lookup"><span data-stu-id="35b6f-133">The first two items are examples of tasks that do not require your provider to supply a wrapped property object — an implementation of **IMAPIProp** that is based on the host provider's implementation.</span></span> <span data-ttu-id="35b6f-134">Seu provedor pode simplesmente atualizar as propriedades conforme necessário e retorno, definindo o parâmetro _lppMAPIPropNew_ para apontar para o ponteiro transmitido pelo provedor de host no parâmetro _lpMAPIPropData_ .</span><span class="sxs-lookup"><span data-stu-id="35b6f-134">Your provider can simply update the properties as necessary and return, setting the  _lppMAPIPropNew_ parameter to point to the pointer passed in by the host provider in the  _lpMAPIPropData_ parameter.</span></span> 
  
<span data-ttu-id="35b6f-135">As segundo duas tarefas exigem que seu provedor retornar ao provedor de host um objeto de propriedade que envolve o objeto do provedor de host com funcionalidades adicionais, como a capacidade de exibir uma folha de propriedades para a entrada.</span><span class="sxs-lookup"><span data-stu-id="35b6f-135">The second two tasks require that your provider return to the host provider a property object that wraps the host provider's object with additional functionality, such as the ability to display a property sheet for the entry.</span></span> <span data-ttu-id="35b6f-136">Este objeto de propriedade será uma lista de distribuição ou usuário mensagens, dependendo do tipo de objeto passado pelo provedor de host no parâmetro _lpMAPIPropData_ e indicado pelo identificador de interface no parâmetro _lpInterface_ .</span><span class="sxs-lookup"><span data-stu-id="35b6f-136">This property object will either be a messaging user or distribution list, depending on the type of object passed in by the host provider in the  _lpMAPIPropData_ parameter and indicated by the interface identifier in the  _lpInterface_ parameter.</span></span> <span data-ttu-id="35b6f-137">Se o parâmetro _lpMAPIPropData_ aponta para um usuário de mensagens, o objeto de propriedade com quebra do seu provedor deve ser uma implementação **IMailUser** .</span><span class="sxs-lookup"><span data-stu-id="35b6f-137">If the  _lpMAPIPropData_ parameter points to a messaging user, your provider's wrapped property object must be an **IMailUser** implementation.</span></span> <span data-ttu-id="35b6f-138">Se _lpMAPIPropData_ aponta para uma lista de distribuição, ela deve ser uma implementação **IDistList** .</span><span class="sxs-lookup"><span data-stu-id="35b6f-138">If  _lpMAPIPropData_ points to a distribution list, it must be an **IDistList** implementation.</span></span> 
  
<span data-ttu-id="35b6f-139">Objeto de propriedade com quebra do seu provedor intercepta as chamadas de método **IMAPIProp** para executar a manipulação de contexto específico de destinatário do provedor de host — o objeto, ele é quebrado.</span><span class="sxs-lookup"><span data-stu-id="35b6f-139">Your provider's wrapped property object intercepts **IMAPIProp** method calls to perform context-specific manipulation of the host provider's recipient—the object it is wrapping.</span></span> <span data-ttu-id="35b6f-140">MAPI tem somente um requisito para objetos com quebra property: todas as chamadas para [IMAPIProp::OpenProperty](imapiprop-openproperty.md) solicitando a propriedade **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) devem ser passadas para o provedor de host.</span><span class="sxs-lookup"><span data-stu-id="35b6f-140">MAPI only has one requirement for wrapped property objects: all calls to [IMAPIProp::OpenProperty](imapiprop-openproperty.md) requesting the **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) property should be passed to the host provider.</span></span> <span data-ttu-id="35b6f-141">Implementação do seu provedor pode usar a tabela retornada para interceptar exibir notificações de tabela ou adicionar o seu próprio, se necessário.</span><span class="sxs-lookup"><span data-stu-id="35b6f-141">Your provider's implementation can use the returned table to intercept display table notifications or to add its own if necessary.</span></span> 
  
<span data-ttu-id="35b6f-142">A lista a seguir inclui as tarefas que são geralmente implementadas no objeto de propriedade com quebra implementado pelos provedores externas:</span><span class="sxs-lookup"><span data-stu-id="35b6f-142">The following list includes tasks that are typically implemented in the wrapped property object implemented by foreign providers:</span></span>
  
- <span data-ttu-id="35b6f-143">Pré-processamento e o pós-processamento valores de propriedade para o destinatário de host em [IMAPIProp::GetProps](imapiprop-getprops.md).</span><span class="sxs-lookup"><span data-stu-id="35b6f-143">Preprocessing and postprocessing property values for the host recipient in [IMAPIProp::GetProps](imapiprop-getprops.md).</span></span>
    
- <span data-ttu-id="35b6f-144">Detalhes de tratamento de controles de tabela, botões e caixas de listagem, são exibidos no **IMAPIProp::OpenProperty**.</span><span class="sxs-lookup"><span data-stu-id="35b6f-144">Handling details display table controls, such as buttons and list boxes, in **IMAPIProp::OpenProperty**.</span></span>
    
- <span data-ttu-id="35b6f-145">Validando ou manipulação de valores de propriedade para o destinatário de host em [IMAPIProp::SetProps](imapiprop-setprops.md).</span><span class="sxs-lookup"><span data-stu-id="35b6f-145">Validating or manipulating property values for the host recipient in [IMAPIProp::SetProps](imapiprop-setprops.md).</span></span>
    
- <span data-ttu-id="35b6f-146">As propriedades necessárias, como **PR_EMAIL_ADDRESS** de computação e verificando se todas as propriedades necessárias foram definidas antes de salvar o destinatário de host no [IMAPIProp::SaveChanges](imapiprop-savechanges.md).</span><span class="sxs-lookup"><span data-stu-id="35b6f-146">Computing required properties such as **PR_EMAIL_ADDRESS** and verifying that all of the necessary properties have been set before saving the host recipient in [IMAPIProp::SaveChanges](imapiprop-savechanges.md).</span></span>
    
### <a name="to-implement-iablogonopentemplateid"></a><span data-ttu-id="35b6f-147">Para implementar IABLogon:: OpenTemplateID</span><span class="sxs-lookup"><span data-stu-id="35b6f-147">To implement IABLogon::OpenTemplateID</span></span>
  
1. <span data-ttu-id="35b6f-148">Verifique se o identificador de modelo passado com o parâmetro _lpTemplateID_ é válido e se está em um formato que o seu provedor reconheça.</span><span class="sxs-lookup"><span data-stu-id="35b6f-148">Check if the template identifier passed in with the  _lpTemplateID_ parameter is valid and is in a format that your provider recognizes.</span></span> <span data-ttu-id="35b6f-149">Se não for, falhar e retornar MAPI_E_INVALID_ENTRYID.</span><span class="sxs-lookup"><span data-stu-id="35b6f-149">If it is not, fail and return MAPI_E_INVALID_ENTRYID.</span></span> 
    
2. <span data-ttu-id="35b6f-150">Criar um objeto do tipo indicado pelo identificador de modelo, um usuário de mensagens, lista de distribuição ou destinatário único.</span><span class="sxs-lookup"><span data-stu-id="35b6f-150">Create an object of the type indicated by the template identifier, either a messaging user, distribution list, or one-off recipient.</span></span> 
    
3. <span data-ttu-id="35b6f-151">Chame o método **AddRef** no objeto de propriedade do provedor de host, que é o objeto apontado pelo parâmetro _lpMAPIPropData_ .</span><span class="sxs-lookup"><span data-stu-id="35b6f-151">Call the **IUnknown::AddRef** method in the host provider's property object, which is the object pointed to by the  _lpMAPIPropData_ parameter.</span></span> 
    
4. <span data-ttu-id="35b6f-152">Se o parâmetro _ulTemplateFlags_ estiver definido como FILL_ENTRY:</span><span class="sxs-lookup"><span data-stu-id="35b6f-152">If the  _ulTemplateFlags_ parameter is set to FILL_ENTRY:</span></span> 
    
   1. <span data-ttu-id="35b6f-153">Se o novo objeto for uma lista de usuário ou de distribuição de mensagens:</span><span class="sxs-lookup"><span data-stu-id="35b6f-153">If the new object is a messaging user or distribution list:</span></span>
      
      1. <span data-ttu-id="35b6f-154">Recupere todas as propriedades do novo objeto, possivelmente chamando seu método **IMAPIProp::GetProps** .</span><span class="sxs-lookup"><span data-stu-id="35b6f-154">Retrieve all of the properties of the new object, possibly by calling its **IMAPIProp::GetProps** method.</span></span> 
          
      2. <span data-ttu-id="35b6f-155">Chame o método de **IMAPIProp::SetProps** do provedor de host para copiar todas as propriedades recuperadas para o objeto de propriedade do provedor de host.</span><span class="sxs-lookup"><span data-stu-id="35b6f-155">Call the host provider's **IMAPIProp::SetProps** method to copy all of the retrieved properties to the host provider's property object.</span></span> 
      
   2. <span data-ttu-id="35b6f-156">Se o novo objeto for um destinatário único, chame o método de **IMAPIProp::SetProps** do provedor de host para definir as seguintes propriedades:</span><span class="sxs-lookup"><span data-stu-id="35b6f-156">If the new object is a one-off recipient, call the host provider's **IMAPIProp::SetProps** method to set the following properties:</span></span> 
      
      - <span data-ttu-id="35b6f-157">**PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md)) para o tipo de endereço manipuladas pelo seu provedor.</span><span class="sxs-lookup"><span data-stu-id="35b6f-157">**PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md)) to the address type handled by your provider.</span></span>
        
      - <span data-ttu-id="35b6f-158">**PR\_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) para o identificador de modelo dos parâmetros _lpTemplateID_ e _cbTemplateID_ .</span><span class="sxs-lookup"><span data-stu-id="35b6f-158">**PR\_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) to the template identifier from the  _lpTemplateID_ and  _cbTemplateID_ parameters.</span></span> 
        
      - <span data-ttu-id="35b6f-159">**PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md)) para DT_MAILUSER ou DT_DISTLIST, conforme apropriado.</span><span class="sxs-lookup"><span data-stu-id="35b6f-159">**PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md)) to DT_MAILUSER or DT_DISTLIST, as appropriate.</span></span>
    
5. <span data-ttu-id="35b6f-160">Defina o conteúdo do parâmetro _lppMAPIPropNew_ para apontar para o novo objeto do seu provedor ou o objeto de propriedade passado com o parâmetro _lpMAPIPropData_ , dependendo se o seu provedor determina que um objeto disposto é necessário.</span><span class="sxs-lookup"><span data-stu-id="35b6f-160">Set the contents of the  _lppMAPIPropNew_ parameter to point to either your provider's new object or the property object passed in with the  _lpMAPIPropData_ parameter, depending on whether your provider determines a wrapped object is necessary.</span></span> 
    
6. <span data-ttu-id="35b6f-161">Se ocorrer um erro crítico, como uma falha de rede ou um limite de condição de memória, retorne o valor de erro apropriado.</span><span class="sxs-lookup"><span data-stu-id="35b6f-161">If a critical error occurs, such as a network failure or an out of memory condition, return the appropriate error value.</span></span> <span data-ttu-id="35b6f-162">Este valor deve obter propagado ao cliente com a estrutura [MAPIERROR](mapierror.md) apropriado, uma tarefa seja executada pelo provedor de host.</span><span class="sxs-lookup"><span data-stu-id="35b6f-162">This value should get propagated to the client with the appropriate [MAPIERROR](mapierror.md) structure, a task performed by the host provider.</span></span> 
    

