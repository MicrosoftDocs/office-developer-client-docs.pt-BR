---
title: Provedores de armazenamento de mensagens fortemente próximos
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 2eb493d7-bbd1-45b2-bd82-2bc452b2deab
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: 3c9996dad1e9aa8c291f1cd593d9651994d86141
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33413224"
---
# <a name="tightly-coupled-message-store-providers"></a><span data-ttu-id="445a6-103">Provedores de armazenamento de mensagens fortemente próximos</span><span class="sxs-lookup"><span data-stu-id="445a6-103">Tightly Coupled Message Store Providers</span></span>

  
  
<span data-ttu-id="445a6-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="445a6-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="445a6-105">Os provedores de armazenamento de mensagens podem ser fortemente unidos a um provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="445a6-105">Message store providers can be tightly coupled with a transport provider.</span></span> <span data-ttu-id="445a6-106">Uma forte união entre os provedores de serviços MAPI significa implementar os dois provedores de forma que o provedor de armazenamento e o provedor de transporte possam se comunicar para tornar o processo de envio e recebimento de mensagens mais eficiente.</span><span class="sxs-lookup"><span data-stu-id="445a6-106">Tightly coupling MAPI service providers means implementing the two providers such that the store provider and transport provider can communicate to make the process of sending and receiving messages more efficient.</span></span> <span data-ttu-id="445a6-107">A vantagem de fazer isso é que as melhorias de desempenho podem resultar quando dois provedores de serviços podem interagir entre si diretamente, em vez de por meio do spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="445a6-107">The benefit of doing this is that performance improvements can result when two service providers can interact with each other directly rather than by means of MAPI spooler.</span></span> <span data-ttu-id="445a6-108">Para fazer a associação de um provedor de repositório de mensagens a um provedor de transporte, o provedor de transporte deve colocar o identificador de entrada do provedor de repositório de mensagens na propriedade **PR_OWN_STORE_ENTRYID** ([PidTagOwnStoreEntryId](pidtagownstoreentryid-canonical-property.md)) na linha do provedor de transporte na tabela de status MAPI.</span><span class="sxs-lookup"><span data-stu-id="445a6-108">To tightly couple a message store provider to a transport provider, the transport provider must place the message store provider's entry identifier in the **PR_OWN_STORE_ENTRYID** ([PidTagOwnStoreEntryId](pidtagownstoreentryid-canonical-property.md)) property in the transport provider's row in the MAPI status table.</span></span> <span data-ttu-id="445a6-109">Isso permite que o spooler MAPI conecte o provedor de armazenamento ao provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="445a6-109">This enables MAPI spooler to connect the store provider to the transport provider.</span></span>
  
<span data-ttu-id="445a6-110">Não é necessário que um provedor de armazenamento de mensagens seja fortemente unido a qualquer outro provedor de serviços.</span><span class="sxs-lookup"><span data-stu-id="445a6-110">There is no requirement that a message store provider ever be tightly coupled with any other service provider.</span></span> <span data-ttu-id="445a6-111">O provedor de serviços mais comum para uma relação rígida com um provedor de armazenamento de mensagens é um provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="445a6-111">The most common service provider to tightly couple with a message store provider is a transport provider.</span></span> <span data-ttu-id="445a6-112">Isso geralmente é feito para que o envio e o recebimento de mensagens possam ser realizados sem envolver o spooler MAPI.</span><span class="sxs-lookup"><span data-stu-id="445a6-112">This is usually done so that sending and receiving messages can be accomplished without involving the MAPI spooler.</span></span> <span data-ttu-id="445a6-113">Por exemplo, quando o usuário envia uma mensagem de saída, o provedor de armazenamento de mensagens combinado e o provedor de transporte podem enviá-la diretamente.</span><span class="sxs-lookup"><span data-stu-id="445a6-113">For example, when the user submits an outgoing message, the combined message store provider and transport provider can send it directly.</span></span> <span data-ttu-id="445a6-114">Os provedores de serviços combinados não têm que primeiro notificar o spooler MAPI de que há uma nova mensagem a ser processada e, em seguida, aguardar que o spooler MAPI inicie o processo de transferência da mensagem do provedor de armazenamento de mensagens para o provedor de transporte.</span><span class="sxs-lookup"><span data-stu-id="445a6-114">The combined service providers do not have to first notify MAPI spooler that there is a new message to process and then wait for MAPI spooler to initiate the process of transferring the message from the message store provider to the transport provider.</span></span> <span data-ttu-id="445a6-115">Isso tem benefícios específicos quando um armazenamento de mensagens baseado em servidor está sendo usado minimizando o tráfego de rede entre o computador do usuário e o servidor.</span><span class="sxs-lookup"><span data-stu-id="445a6-115">This has particular benefits when a server-based message store is being used by minimizing network traffic between the user's computer and the server.</span></span>
  
<span data-ttu-id="445a6-116">Em geral, não há procedimentos bem especificados para provedores de serviços fortemente próximos.</span><span class="sxs-lookup"><span data-stu-id="445a6-116">In general, there are no well-specified procedures for tightly coupling service providers.</span></span> <span data-ttu-id="445a6-117">No entanto, você deve usar as seguintes diretrizes:</span><span class="sxs-lookup"><span data-stu-id="445a6-117">However, you should use the following guidelines:</span></span>
  
- <span data-ttu-id="445a6-118">Se o motivo para os provedores de serviços de união rígida for o desempenho, esteja ciente de que o envolvimento retira partes do subsistema de MAPI dos processos em que essas partes normalmente estariam envolvidas.</span><span class="sxs-lookup"><span data-stu-id="445a6-118">If the reason for tightly coupling service providers is performance, be aware that the coupling takes parts of the MAPI subsystem out of the processes that those parts would normally be involved in.</span></span> <span data-ttu-id="445a6-119">Isso significa que as partes individuais no provedor de serviços combinados devem interagir entre si de maneira a simular a interação que normalmente teriam com as partes do subsistema MAPI que não estão sendo usadas.</span><span class="sxs-lookup"><span data-stu-id="445a6-119">This implies that the individual parts in the combined service provider should interact with each other in a way that simulates the interaction they would normally have with the parts of the MAPI subsystem that are not being used.</span></span>
    
- <span data-ttu-id="445a6-120">Quando os provedores de serviços fortemente próximos interagem com outros componentes MAPI, eles ainda devem interagir com eles exatamente da mesma maneira que interagiriam se não fossem fortemente unidos.</span><span class="sxs-lookup"><span data-stu-id="445a6-120">When tightly coupled service providers do interact with other MAPI components, they must still interact with them in exactly the way they would if they were not tightly coupled.</span></span> <span data-ttu-id="445a6-121">Por exemplo, se um usuário estiver usando um provedor de armazenamento de mensagens combinado e um provedor de transporte como seu armazenamento de mensagens padrão, mas estiver usando um provedor de transporte separado para enviar mensagens — como pode acontecer quando um usuário usa um computador na estrada e alterna para um provedor de transporte remoto — a parte do armazenamento de mensagens do provedor de serviços fortemente associado ainda deve interagir com o spooler MAPI como se fosse um provedor de armazenamento de mensagens autônomo.</span><span class="sxs-lookup"><span data-stu-id="445a6-121">For example, if a user is using a combined message store provider and transport provider as their default message store but is using a separate transport provider to send messages — as can happen when a user takes a computer on the road and switches to a remote transport provider — the message store portion of the tightly coupled service provider must still interact with MAPI spooler just as if it were a standalone message store provider.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="445a6-122">Confira também</span><span class="sxs-lookup"><span data-stu-id="445a6-122">See also</span></span>



[<span data-ttu-id="445a6-123">Desenvolver um provedor de repositórios de mensagens MAPI</span><span class="sxs-lookup"><span data-stu-id="445a6-123">Developing a MAPI Message Store Provider</span></span>](developing-a-mapi-message-store-provider.md)

