---
title: Atuar como um provedor de catálogo de endereços de host
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f06a1034-ee49-4a09-831e-9752713228a8
description: 'Última modificação: 23 de julho de 2011'
ms.openlocfilehash: 202d4b4391de7553e39e50dc527df5502ebcefb3
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32331266"
---
# <a name="acting-as-a-host-address-book-provider"></a><span data-ttu-id="a60e9-103">Atuar como um provedor de catálogo de endereços de host</span><span class="sxs-lookup"><span data-stu-id="a60e9-103">Acting as a Host Address Book Provider</span></span>

  
  
<span data-ttu-id="a60e9-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a60e9-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="a60e9-105">Um provedor de host é um provedor de catálogo de endereços que inclui destinatários de outros provedores em seus contêineres e depende da implementação dos destinatários por outros provedores para controlar parcialmente sua manutenção.</span><span class="sxs-lookup"><span data-stu-id="a60e9-105">A host provider is an address book provider that includes recipients from other providers in its containers and relies on the implementation of the recipients by the other providers to partially control their maintenance.</span></span> <span data-ttu-id="a60e9-106">Um provedor de host usa os identificadores de modelo desses destinatários estrangeiros para vincular os dados desses destinatários ao código no provedor estrangeiro.</span><span class="sxs-lookup"><span data-stu-id="a60e9-106">A host provider uses the template identifiers of these foreign recipients to bind the data for these recipients to code in the foreign provider.</span></span> <span data-ttu-id="a60e9-107">Esse processo de associação é iniciado quando o provedor recupera a propriedade **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) de um destinatário e a transmite em uma chamada para [IMAPISupport:: OpenTemplateID](imapisupport-opentemplateid.md).</span><span class="sxs-lookup"><span data-stu-id="a60e9-107">This binding process is initiated when your provider retrieves the **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) property of a recipient and passes it in a call to [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span></span> 
  
<span data-ttu-id="a60e9-108">Quando o provedor chama **IMAPISupport:: OpenTemplateID**, MAPI corresponde ao **MAPIUID** dentro do identificador de modelo com um **MAPIUID** registrado por um provedor e chama o método [IABLogon:: OpenTemplateID](iablogon-opentemplateid.md) do provedor.</span><span class="sxs-lookup"><span data-stu-id="a60e9-108">When your provider calls **IMAPISupport::OpenTemplateID**, MAPI matches the **MAPIUID** within the template identifier with a **MAPIUID** registered by a provider and calls the provider's [IABLogon::OpenTemplateID](iablogon-opentemplateid.md) method.</span></span> <span data-ttu-id="a60e9-109">O provedor estrangeiro pode retornar um ponteiro para o objeto Property do provedor, à sua própria implementação de objeto Property ou a uma implementação que envolve o objeto do provedor.</span><span class="sxs-lookup"><span data-stu-id="a60e9-109">The foreign provider might return a pointer to your provider's property object, to its own property object implementation, or to an implementation that wraps your provider's object.</span></span> <span data-ttu-id="a60e9-110">O ponteiro retornado é colocado no conteúdo do parâmetro _lppMAPIPropNew_ .</span><span class="sxs-lookup"><span data-stu-id="a60e9-110">The returned pointer is placed in the contents of the  _lppMAPIPropNew_ parameter.</span></span> 
  
<span data-ttu-id="a60e9-111">Seu provedor pode escolher se deseja ou não chamar **IMAPISupport:: OpenTemplateID** com o sinalizador FILL_ENTRY definido.</span><span class="sxs-lookup"><span data-stu-id="a60e9-111">Your provider can choose whether or not to call **IMAPISupport::OpenTemplateID** with the FILL_ENTRY flag set.</span></span> <span data-ttu-id="a60e9-112">Defina esse sinalizador quando o destinatário estiver sendo criado ou quando um longo tempo decorrido desde que seu provedor tenha atualizado as propriedades do destinatário.</span><span class="sxs-lookup"><span data-stu-id="a60e9-112">Set this flag when the recipient is being created or when a long time has passed since your provider has refreshed the recipient's properties.</span></span> <span data-ttu-id="a60e9-113">Um uso comum do sinalizador FILL_ENTRY é manter um destinatário no seu provedor sincronizado com o original.</span><span class="sxs-lookup"><span data-stu-id="a60e9-113">A common use of the FILL_ENTRY flag is to keep a recipient in your provider synchronized with the original.</span></span> <span data-ttu-id="a60e9-114">A implementação desse tipo de agendamento de sincronização melhora o desempenho.</span><span class="sxs-lookup"><span data-stu-id="a60e9-114">Implementing this type of synchronization schedule enhances performance.</span></span> 
  
 <span data-ttu-id="a60e9-115">**Para manter um destinatário estrangeiro sincronizado**</span><span class="sxs-lookup"><span data-stu-id="a60e9-115">**To keep a foreign recipient synchronized**</span></span>
  
1. <span data-ttu-id="a60e9-116">Determine um intervalo apropriado para atualizações periódicas.</span><span class="sxs-lookup"><span data-stu-id="a60e9-116">Determine an appropriate interval for periodic updates.</span></span> 
    
2. <span data-ttu-id="a60e9-117">Cada chamada de carimbo de data/hora para [IMAPISupport:: OpenTemplateID](imapisupport-opentemplateid.md).</span><span class="sxs-lookup"><span data-stu-id="a60e9-117">Timestamp each call to [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span></span> 
    
3. <span data-ttu-id="a60e9-118">Avaliar se é necessário ou não a execução de uma atualização completa com base na quantidade de tempo que expirou desde a última chamada.</span><span class="sxs-lookup"><span data-stu-id="a60e9-118">Evaluate whether or not it is necessary to perform a full update based on the amount of time that has expired since the last call.</span></span> <span data-ttu-id="a60e9-119">Se uma atualização completa for necessária, chame **IMAPISupport:: OpenTemplateID** com o sinalizador FILL_ENTRY.</span><span class="sxs-lookup"><span data-stu-id="a60e9-119">If a full update is necessary, call **IMAPISupport::OpenTemplateID** with the FILL_ENTRY flag.</span></span> <span data-ttu-id="a60e9-120">Se não for necessário, não defina o sinalizador na chamada.</span><span class="sxs-lookup"><span data-stu-id="a60e9-120">If it is not necessary, do not set the flag on the call.</span></span> 
    
<span data-ttu-id="a60e9-121">Quando um cliente faz uma solicitação para uma das propriedades do destinatário copiado, seu provedor pode escolher se deseja lidar com a solicitação ou usar o código fornecido pelo provedor estrangeiro.</span><span class="sxs-lookup"><span data-stu-id="a60e9-121">When a client makes a request for one of the copied recipient's properties, your provider can choose whether to handle the request itself or use the code supplied by the foreign provider.</span></span> <span data-ttu-id="a60e9-122">Seu provedor pode esperar que o provedor estrangeiro intercepte a maioria, se não todos, as chamadas para **IMAPIProp** , exceto [IMAPIProp:: OpenProperty](imapiprop-openproperty.md).</span><span class="sxs-lookup"><span data-stu-id="a60e9-122">Your provider can expect the foreign provider to intercept most, if not all, calls to **IMAPIProp** except for [IMAPIProp::OpenProperty](imapiprop-openproperty.md).</span></span> <span data-ttu-id="a60e9-123">Uma chamada para **OpenProperty** solicitando a propriedade **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) é sempre encaminhada para seu provedor.</span><span class="sxs-lookup"><span data-stu-id="a60e9-123">A call to **OpenProperty** requesting the **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) property is always forwarded to your provider.</span></span>
  
 <span data-ttu-id="a60e9-124">**Para acessar o código de identificador de modelo**</span><span class="sxs-lookup"><span data-stu-id="a60e9-124">**To access template identifier code**</span></span>
  
1. <span data-ttu-id="a60e9-125">Abra o destinatário e chame o método [IMAPIProp::](imapiprop-getprops.md) GetProps para recuperar a propriedade **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="a60e9-125">Open the recipient and call its [IMAPIProp::GetProps](imapiprop-getprops.md) method to retrieve the **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) property.</span></span> <span data-ttu-id="a60e9-126">Se \*\*\*\* GetProps falhar porque o **PR_TEMPLATEID** não está disponível, o provedor estrangeiro não oferece suporte a um identificador de modelo e código relacionado para esse destinatário.</span><span class="sxs-lookup"><span data-stu-id="a60e9-126">If **GetProps** fails because **PR_TEMPLATEID** is unavailable, the foreign provider does not support a template identifier and related code for this recipient.</span></span> <span data-ttu-id="a60e9-127">Seu provedor precisará usar sua implementação do destinatário para todas as manutenções.</span><span class="sxs-lookup"><span data-stu-id="a60e9-127">Your provider will need to use its implementation of the recipient for all maintenance.</span></span> 
    
2. <span data-ttu-id="a60e9-128">Se o identificador de modelo é retornado \*\*\*\* de GetProps, passe-o e um ponteiro para a implementação do **IMAPIProp** do destinatário em uma chamada para o método **IMAPISupport:: OpenTemplateID** .</span><span class="sxs-lookup"><span data-stu-id="a60e9-128">If the template identifier is returned from **GetProps**, pass it and a pointer to the recipient's **IMAPIProp** implementation in a call to the **IMAPISupport::OpenTemplateID** method.</span></span> <span data-ttu-id="a60e9-129">Defina o sinalizador FILL_ENTRY se a maioria ou todas as propriedades do destinatário precisam ser atualizadas, como no momento da criação ou se elas não foram atualizadas por um tempo.</span><span class="sxs-lookup"><span data-stu-id="a60e9-129">Set the FILL_ENTRY flag if most or all of the recipient's properties need to be updated, such as at creation time or if they have not been updated for a while.</span></span> 
    
3. <span data-ttu-id="a60e9-130">Se **OpenTemplateID** retornar a implementação de **IMAPIProp** do provedor estrangeiro, retorne ao cliente um ponteiro para esta implementação.</span><span class="sxs-lookup"><span data-stu-id="a60e9-130">If **OpenTemplateID** returns the foreign provider's **IMAPIProp** implementation, return to the client a pointer to this implementation.</span></span> 
    
4. <span data-ttu-id="a60e9-131">Se o **OpenTemplateID** não retornar uma implementação, normalmente porque o provedor estrangeiro não está no perfil, retorne ao cliente um ponteiro para a implementação do **IMAPIProp** do provedor.</span><span class="sxs-lookup"><span data-stu-id="a60e9-131">If **OpenTemplateID** does not return an implementation, typically because the foreign provider is not in the profile, return to the client a pointer to your provider's **IMAPIProp** implementation.</span></span> <span data-ttu-id="a60e9-132">O cliente deve ser capaz de trabalhar com as propriedades do objeto usando qualquer uma das interfaces.</span><span class="sxs-lookup"><span data-stu-id="a60e9-132">The client should be able to work with the object's properties using either interface.</span></span> 
    

