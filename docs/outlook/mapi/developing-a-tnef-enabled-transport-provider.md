---
title: Desenvolver um provedor de transporte habilitado por TNEF
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7525eee1-4016-49b8-9509-5ebbe1db819f
description: '�ltima altera��o: s�bado, 23 de julho de 2011'
ms.openlocfilehash: 4d4f7ed75bb1144b7cd4a813b0d093246a30cca5
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/23/2018
ms.locfileid: "22588346"
---
# <a name="developing-a-tnef-enabled-transport-provider"></a><span data-ttu-id="5c5b6-103">Desenvolver um provedor de transporte habilitado por TNEF</span><span class="sxs-lookup"><span data-stu-id="5c5b6-103">Developing a TNEF-Enabled Transport Provider</span></span>

  
  
<span data-ttu-id="5c5b6-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="5c5b6-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="5c5b6-105">Para promover a interoperabilidade entre sistemas de mensagens que oferecem suporte a diferentes conjuntos de recursos MAPI, MAPI fornece o TNEF Transport Neutral Encapsulation Format () como uma maneira padrão para transferir dados.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-105">To promote interoperability between messaging systems that support different sets of MAPI features, MAPI provides the Transport Neutral Encapsulation Format (TNEF) as a standard way to transfer data.</span></span> <span data-ttu-id="5c5b6-106">Esse formato encapsula propriedades MAPI não suportadas por um sistema de mensagens subjacente em um fluxo binário que pode ser transferido junto com a mensagem um provedor de transporte enviá-la.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-106">This format encapsulates MAPI properties not supported by an underlying messaging system into a binary stream that can be transferred along with the message when a transport provider sends it.</span></span> <span data-ttu-id="5c5b6-107">O provedor de transporte que recebe a mensagem, em seguida, pode decodificar o fluxo binário para recuperar todas as propriedades da mensagem original e torná-los disponíveis para os aplicativos cliente.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-107">The transport provider that receives the message can then decode the binary stream to retrieve all the properties of the original message and make them available to client applications.</span></span> <span data-ttu-id="5c5b6-108">O modelo operacional para TNEF é:</span><span class="sxs-lookup"><span data-stu-id="5c5b6-108">The operational model for TNEF is:</span></span>
  
- <span data-ttu-id="5c5b6-109">Clientes de mensagens enviem e recebem mensagens para um transporte TNEF como de costume.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-109">Messaging clients submit and receive messages to a TNEF transport as normal.</span></span>
    
- <span data-ttu-id="5c5b6-110">O transporte separa as propriedades nas mensagens de saída em duas categorias: aqueles que suporta o sistema de mensagem subjacente e aqueles que não existir.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-110">The transport separates the properties on outgoing messages into two categories: those that the underlying message system supports and those that it does not.</span></span> <span data-ttu-id="5c5b6-111">Os valores das propriedades que são suportados pelo sistema de mensagens subjacente são convertidos em formato exigido.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-111">The values of the properties that are supported by the underlying messaging system are translated into the required format.</span></span>
    
- <span data-ttu-id="5c5b6-112">O transporte usa os métodos de MAPI TNEF codificar todas as propriedades sem suporte em um único fluxo de dados.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-112">The transport uses the MAPI TNEF methods to encode any unsupported properties into a single data stream.</span></span> <span data-ttu-id="5c5b6-113">O transporte, em seguida, transforma esse fluxo de dados em um anexo especial na mensagem de saída, usando o modelo de anexo do sistema de mensagens subjacentes, antes de enviar a mensagem.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-113">The transport then turns that data stream into a special attachment on the outgoing message, using the underlying messaging system's attachment model, before sending the message.</span></span>
    
- <span data-ttu-id="5c5b6-114">Um transporte TNEF habilitado que recebe uma mensagem tal faz duas coisas.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-114">A TNEF enabled transport that receives such a message does two things.</span></span> <span data-ttu-id="5c5b6-115">Primeiro, ele converte propriedades da mensagem de entrada — aqueles compatíveis com o sistema de mensagem subjacente — para propriedades MAPI.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-115">First, it translates the incoming message's properties — the ones supported by the underlying message system — into MAPI properties.</span></span> <span data-ttu-id="5c5b6-116">Segundo, se o anexo especial estiver presente, ele usa os métodos de MAPI TNEF para recuperar as propriedades adicionais de MAPI do anexo antes de entregar a mensagem para um aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-116">Second, if the special attachment is present, it uses the MAPI TNEF methods to retrieve additional MAPI properties from the attachment before delivering the message to a client application.</span></span>
    
<span data-ttu-id="5c5b6-117">MAPI fornece uma implementação da interface **ITnef** para uso por provedores de transporte MAPI ao trabalhar com objetos TNEF.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-117">MAPI supplies an implementation of the **ITnef** interface for use by MAPI transport providers when working with TNEF objects.</span></span> <span data-ttu-id="5c5b6-118">A função [OpenTnefStreamEx](opentnefstreamex.md) é usada para criar objetos TNEF e associá-los a uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-118">The [OpenTnefStreamEx](opentnefstreamex.md) function is used to create TNEF objects and associate them with a message.</span></span> <span data-ttu-id="5c5b6-119">Fluxos TNEF baseiam-se na parte superior a interface **IStream** do OLE</span><span class="sxs-lookup"><span data-stu-id="5c5b6-119">TNEF streams are built on top of the OLE **IStream** interface</span></span> 
  
> [!NOTE]
> <span data-ttu-id="5c5b6-120">Você pode usar **OpenTnefStreamEx** para criar objetos TNEF.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-120">You use **OpenTnefStreamEx** to create TNEF objects.</span></span> <span data-ttu-id="5c5b6-121">A função de **OpenTnefStream** antiga ainda existe apenas para compatibilidade com o antigo código-fonte e não deve ser usada em algo novo.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-121">The old **OpenTnefStream** function still exists for compatibility with old source code and should not be used in anything new.</span></span> 
  
<span data-ttu-id="5c5b6-122">A interface **ITnef** fornece os seguintes métodos:</span><span class="sxs-lookup"><span data-stu-id="5c5b6-122">The **ITnef** interface provides the following methods:</span></span> 
  
- [<span data-ttu-id="5c5b6-123">AddProps</span><span class="sxs-lookup"><span data-stu-id="5c5b6-123">AddProps</span></span>](itnef-addprops.md)
    
- [<span data-ttu-id="5c5b6-124">EncodeRecips</span><span class="sxs-lookup"><span data-stu-id="5c5b6-124">EncodeRecips</span></span>](itnef-encoderecips.md)
    
- [<span data-ttu-id="5c5b6-125">ExtractProps</span><span class="sxs-lookup"><span data-stu-id="5c5b6-125">ExtractProps</span></span>](itnef-extractprops.md)
    
- [<span data-ttu-id="5c5b6-126">Finish</span><span class="sxs-lookup"><span data-stu-id="5c5b6-126">Finish</span></span>](itnef-finish.md)
    
- [<span data-ttu-id="5c5b6-127">FinishComponent</span><span class="sxs-lookup"><span data-stu-id="5c5b6-127">FinishComponent</span></span>](itnef-finishcomponent.md)
    
- [<span data-ttu-id="5c5b6-128">OpenTaggedBody</span><span class="sxs-lookup"><span data-stu-id="5c5b6-128">OpenTaggedBody</span></span>](itnef-opentaggedbody.md)
    
- [<span data-ttu-id="5c5b6-129">SetProps</span><span class="sxs-lookup"><span data-stu-id="5c5b6-129">SetProps</span></span>](itnef-setprops.md)
    
<span data-ttu-id="5c5b6-130">O modelo de implementação de MAPI TNEF suporta:</span><span class="sxs-lookup"><span data-stu-id="5c5b6-130">The MAPI TNEF implementation model supports:</span></span>
  
- <span data-ttu-id="5c5b6-131">Todas as propriedades MAPI sem afetar outras propriedades de mensagem.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-131">All MAPI properties without affecting other message properties.</span></span> <span data-ttu-id="5c5b6-132">Em ordem para mensagens MAPI de sobrevivência transporte por meio de um sistema de mensagens, todas as propriedades que não podem ser codificadas como propriedades do sistema de mensagens devem ser encapsuladas.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-132">In order for MAPI messages to survive transport through a messaging system, all properties that cannot be encoded as properties of the messaging system must be encapsulated.</span></span> <span data-ttu-id="5c5b6-133">Porque quase nunca é conhecido no momento em que uma mensagem é enviada se ou não um cliente compatível com MAPI irá receber a mensagem, o esquema de encapsulamento permite que um provedor de transporte codificar apenas as propriedades de mensagem MAPI que o sistema de mensagens não suporte nativo.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-133">Because it is almost never known at the time a message is sent whether or not a MAPI-compliant client will receive the message, the encapsulation scheme allows a transport provider to encode only those MAPI message properties that the messaging system does not natively support.</span></span> <span data-ttu-id="5c5b6-134">Isso significa que as mensagens que usam o TNEF não são "opacas" aos sistemas de mensagens que não são baseados em MAPI, como UNIX baseados em SMTP sistemas de mensagens.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-134">This means that messages which use TNEF are not "opaque" to messaging systems that are not based on MAPI such as SMTP-based UNIX messaging systems.</span></span> <span data-ttu-id="5c5b6-135">Esses sistemas recebem as propriedades que eles suportam na forma que é comum para-las e outras propriedades são recebidas como um fluxo de dados TNEF codificado.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-135">These systems receive the properties they support in whatever manner is typical for them, and other properties are received as an encoded TNEF data stream.</span></span> <span data-ttu-id="5c5b6-136">O provedor de transporte TNEF é responsável por distinguir entre esses dois conjuntos de propriedades e enviando o conjunto com suporte de maneira adequada para o sistema de mensagens.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-136">The TNEF transport provider is responsible for differentiating between these two sets of properties and sending the supported set in the proper manner for the messaging system.</span></span> <span data-ttu-id="5c5b6-137">TNEF não faz nenhuma suposições como para o nível de suporte fornecido por um sistema de mensagens.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-137">TNEF makes no assumptions as to the level of support provided by a messaging system.</span></span> <span data-ttu-id="5c5b6-138">No entanto, nos exemplos de uso TNEF incluído nesta seção, a pressuposição é feita que o sistema de mensagens oferece suporte a pelo menos um único anexo além da mensagem.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-138">However, in the examples of TNEF usage included in this section, the assumption is made that the messaging system supports at least one single attachment aside from the message.</span></span> <span data-ttu-id="5c5b6-139">Em alguns casos, o anexo só pode ser transmitido como parte do texto da mensagem e suportado por meio de um stream uuencoded.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-139">In some cases, the attachment can only be supported through a uuencoded stream and transmitted as part of the message text.</span></span> <span data-ttu-id="5c5b6-140">Somente em circunstâncias muito raras sistema de mensagens terão portanto pouco suporte para as propriedades de mensagem que codificação TNEF completo de todas as propriedades é necessário.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-140">Only in very rare circumstances will the messaging system have so little support for message properties that full TNEF encoding of all properties is necessary.</span></span>
    
- <span data-ttu-id="5c5b6-141">Um mecanismo para determinar se um fluxo TNEF em uma mensagem de entrada pertence à mensagem, com base na propriedade de MAPI **PR_TNEF_CORRELATION_KEY** ([PidTagTnefCorrelationKey](pidtagtnefcorrelationkey-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="5c5b6-141">A mechanism for determining whether a TNEF stream on an incoming message belongs to the message, based on the MAPI property **PR_TNEF_CORRELATION_KEY** ([PidTagTnefCorrelationKey](pidtagtnefcorrelationkey-canonical-property.md)).</span></span> <span data-ttu-id="5c5b6-142">Esta propriedade deve estar presente no stream TNEF e em um cabeçalho de mensagem apropriada.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-142">This property should be found both in the TNEF stream and in an appropriate message header.</span></span> <span data-ttu-id="5c5b6-143">Se a propriedade tem o mesmo valor em ambos os lugares, ou está falta em qualquer lugar, o fluxo TNEF é considerado pertencem à mensagem.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-143">If the property has the same value in both places, or is missing in either place, the TNEF stream is assumed to belong to the message.</span></span> <span data-ttu-id="5c5b6-144">Caso contrário, o fluxo TNEF será ignorado.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-144">Otherwise, the TNEF stream is ignored.</span></span> <span data-ttu-id="5c5b6-145">Transportes TNEF habilitado são responsáveis por escolhendo um valor para essa propriedade em mensagens de saída e a codificação em um cabeçalho de mensagem apropriada (por exemplo, o Message-ID: cabeçalho para mensagens SMTP) e no stream TNEF.</span><span class="sxs-lookup"><span data-stu-id="5c5b6-145">TNEF enabled transports are responsible for choosing a value for this property on outbound messages and encoding it in an appropriate message header (for example, the Message-ID: header for SMTP messages) and in the TNEF stream.</span></span>
    

