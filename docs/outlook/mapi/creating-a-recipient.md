---
title: Criar um destinatário
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 586c901f-d9f9-44f2-a328-051775a81265
description: 'Última modificação: 9 de março de 2015'
ms.openlocfilehash: e14430d1539b90e089a9dabe1315384050f3dd5e
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32332953"
---
# <a name="creating-a-recipient"></a><span data-ttu-id="0fbc8-103">Criar um destinatário</span><span class="sxs-lookup"><span data-stu-id="0fbc8-103">Creating a Recipient</span></span>

  
  
<span data-ttu-id="0fbc8-104">**Aplica-se a**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="0fbc8-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="0fbc8-105">Os clientes criam destinatários quando estão endereçando mensagens e quando estão adicionando entradas a contêineres de catálogos de endereços modificáveis.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-105">Clients create recipients when they are addressing messages and when they are adding entries to modifiable address book containers.</span></span> <span data-ttu-id="0fbc8-106">MAPI fornece três métodos para criar destinatários:</span><span class="sxs-lookup"><span data-stu-id="0fbc8-106">MAPI provides three methods for creating recipients:</span></span>
  
- [<span data-ttu-id="0fbc8-107">IAddrBook::CreateOneOff</span><span class="sxs-lookup"><span data-stu-id="0fbc8-107">IAddrBook::CreateOneOff</span></span>](iaddrbook-createoneoff.md)
    
- [<span data-ttu-id="0fbc8-108">IAddrBook::NewEntry</span><span class="sxs-lookup"><span data-stu-id="0fbc8-108">IAddrBook::NewEntry</span></span>](iaddrbook-newentry.md)
    
- [<span data-ttu-id="0fbc8-109">IABContainer::CreateEntry</span><span class="sxs-lookup"><span data-stu-id="0fbc8-109">IABContainer::CreateEntry</span></span>](iabcontainer-createentry.md)
    
<span data-ttu-id="0fbc8-110">Call **IAddrBook:: CreateOneOff** quando você está criando destinatários a serem usados para endereçar mensagens.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-110">Call **IAddrBook::CreateOneOff** when you are creating recipients to be used to address messages.</span></span> <span data-ttu-id="0fbc8-111">**CreateOneOff** cria um identificador de entrada one-off formatado especialmente para ser associado a um endereço de um determinado tipo de endereço.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-111">**CreateOneOff** creates a specially formatted one-off entry identifier to be associated with an address of a particular address type.</span></span> <span data-ttu-id="0fbc8-112">Para obter mais informações sobre identificadores de entrada individuais e únicos, confira [endereços únicos](one-off-addresses.md) e [identificadores de entrada one-off](one-off-entry-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="0fbc8-112">For more information about one-offs and one-off entry identifiers, see [One-Off Addresses](one-off-addresses.md) and [One-Off Entry Identifiers](one-off-entry-identifiers.md).</span></span>
  
<span data-ttu-id="0fbc8-113">Call **IAddrBook:: NewEntry** quando você está criando destinatários a serem usados para endereçar mensagens ou para adicionar a um contêiner.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-113">Call **IAddrBook::NewEntry** when you are creating recipients to be used either to address messages or to add to a container.</span></span> <span data-ttu-id="0fbc8-114">**NewEntry** tem três pares de parâmetros que contêm identificadores de entrada.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-114">**NewEntry** has three pairs of parameters that contain entry identifiers.</span></span> <span data-ttu-id="0fbc8-115">Esses parâmetros são descritos da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="0fbc8-115">These parameters are described as follows:</span></span> 
  
|<span data-ttu-id="0fbc8-116">**Par de parâmetros**</span><span class="sxs-lookup"><span data-stu-id="0fbc8-116">**Parameter pair**</span></span>|<span data-ttu-id="0fbc8-117">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="0fbc8-117">**Description**</span></span>|
|:-----|:-----|
| <span data-ttu-id="0fbc8-118">_cbEidContainer_ e _lpEidContainer_</span><span class="sxs-lookup"><span data-stu-id="0fbc8-118">_cbEidContainer_ and  _lpEidContainer_</span></span> <br/> |<span data-ttu-id="0fbc8-119">Identificador de entrada para o contêiner no qual a nova entrada deve ser colocada.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-119">Entry identifier for the container into which the new entry should be placed.</span></span>  <br/> |
| <span data-ttu-id="0fbc8-120">_cbEidNewEntryTpl_ e _lpEidNewEntryTpl_</span><span class="sxs-lookup"><span data-stu-id="0fbc8-120">_cbEidNewEntryTpl_ and  _lpEidNewEntryTpl_</span></span> <br/> |<span data-ttu-id="0fbc8-121">Identificador de entrada do modelo a ser usado para criar a nova entrada.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-121">Entry identifier for the template to be used to create the new entry.</span></span>  <br/> |
| <span data-ttu-id="0fbc8-122">_lpcbEidNewEntry_ e _lppEidNewEntry_</span><span class="sxs-lookup"><span data-stu-id="0fbc8-122">_lpcbEidNewEntry_ and  _lppEidNewEntry_</span></span> <br/> |<span data-ttu-id="0fbc8-123">Identificador de entrada para a nova entrada.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-123">Entry identifier for the new entry.</span></span>  <br/> |
   
<span data-ttu-id="0fbc8-124">Para criar um destinatário para uma mensagem de saída, defina _cbEidContainer_ como zero e _lpEidContainer_ como nulo.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-124">To create a recipient for an outgoing message, set  _cbEidContainer_ to zero and  _lpEidContainer_ to NULL.</span></span> <span data-ttu-id="0fbc8-125">**NewEntry** cria um destinatário com um identificador de entrada que está de acordo com o formato one-off, o mesmo tipo de destinatário que é produzido por uma chamada para **IAddrBook:: CreateOneOff**.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-125">**NewEntry** creates a recipient with an entry identifier that conforms to the one-off format, the same type of recipient that is produced by a call to **IAddrBook::CreateOneOff**.</span></span> 
  
<span data-ttu-id="0fbc8-126">Para criar um destinatário a ser inserido em um determinado contêiner, defina _lpEidContainer_ como o identificador de entrada do contêiner e _cbEidContainer_ como o número de bytes no identificador de entrada do contêiner.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-126">To create a recipient to be inserted into a particular container, set  _lpEidContainer_ to the container's entry identifier and  _cbEidContainer_ to the number of bytes in the container's entry identifier.</span></span> 
  
<span data-ttu-id="0fbc8-127">Para usar um modelo para criar um destinatário, defina _lpEidNewEntryTpl_ para o identificador de entrada do modelo a ser usado e _cbEidNewEntryTpl_ como a contagem de bytes nesse identificador de entrada.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-127">To use a template to create a recipient, set  _lpEidNewEntryTpl_ to the entry identifier of the template to be used and  _cbEidNewEntryTpl_ to the count of bytes in this entry identifier.</span></span> <span data-ttu-id="0fbc8-128">A maioria dos contêineres do catálogo de endereços modificável oferece suporte a um ou mais modelos para a criação de entradas de um tipo específico.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-128">Most modifiable address book containers support one or more templates for creating entries of a particular type.</span></span> <span data-ttu-id="0fbc8-129">Modelos únicos são geralmente, mas nem sempre, caixas de diálogo.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-129">One-off templates are typically, but not always, dialog boxes.</span></span> <span data-ttu-id="0fbc8-130">A inserção de informações no modelo produz um destinatário com um endereço formatado corretamente para o tipo.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-130">Entering information into the template produces a recipient with an address that is correctly formatted for the type.</span></span> 
  
<span data-ttu-id="0fbc8-131">Obtenha o identificador de entrada de modelo de:</span><span class="sxs-lookup"><span data-stu-id="0fbc8-131">Obtain the template entry identifier from either:</span></span>
  
- <span data-ttu-id="0fbc8-132">A coluna **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) na tabela one-off do contêiner, acessada chamando o método [IMAPIProp:: OpenProperty](imapiprop-openproperty.md) do contêiner e especificando **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) como a marca de propriedade e IID_IMAPITable como o identificador de interface.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-132">The **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) column in the container's one-off table, accessed by calling the container's [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method and specifying **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) as the property tag and IID_IMAPITable as the interface identifier.</span></span> 
    
- <span data-ttu-id="0fbc8-133">As propriedades **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) e **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)) do provedor de catálogo de endereços que contêm os identificadores de entrada para o objeto de usuário de mensagens do provedor e modelos de lista de distribuição.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-133">An address book provider's **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) and **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)) properties which hold the entry identifiers for the provider's messaging user object and distribution list templates.</span></span> 
    
> [!NOTE]
> <span data-ttu-id="0fbc8-134">Não confunda um novo identificador de entrada do modelo de entrada com um tipo diferente de identificador de entrada chamado identificador de modelo.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-134">Do not confuse a new entry template's entry identifier with a different type of entry identifier called a template identifier.</span></span> <span data-ttu-id="0fbc8-135">Um identificador de modelo é usado apenas por provedores para manter entradas copiadas de outros provedores; Ele nunca é usado por clientes e não é usado para criar novas entradas.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-135">A template identifier is used only by providers to maintain entries copied from other providers; it is never used by clients and it is not used to create new entries.</span></span> 
  
<span data-ttu-id="0fbc8-136">Para permitir que o usuário determine o tipo de entrada a ser criada, passe zero para _cbEidNewEntryTpl_ e nulo para _lpEidNewEntryTpl_.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-136">To enable the user to determine the type of entry to be created, pass zero for  _cbEidNewEntryTpl_ and NULL for  _lpEidNewEntryTpl_.</span></span> <span data-ttu-id="0fbc8-137">Quando isso ocorre, **NewEntry** exibe uma caixa de diálogo comum criada a partir da tabela única de MAPI — uma lista hierárquica de todos os modelos suportados por cada provedor de catálogo de endereços no perfil.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-137">When this occurs, **NewEntry** displays a common dialog box built from MAPI's one-off table — a hierarchical list of all of the templates supported by each address book provider in the profile.</span></span> 
  
<span data-ttu-id="0fbc8-138">Quando um tipo de endereço é determinado, seja por meio da configuração do parâmetro _lpEidNewEntryTpl_ ou de uma seleção pelo usuário da exibição da tabela única, **NewEntry** exibe o modelo correspondente usando sua tabela de exibição.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-138">When an address type has been determined, either through the setting of the  _lpEidNewEntryTpl_ parameter or a selection by the user from the one-off table display, **NewEntry** displays the corresponding template using its display table.</span></span> <span data-ttu-id="0fbc8-139">Todos os novos modelos de entrada oferecem suporte à propriedade **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="0fbc8-139">All new entry templates support the **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) property.</span></span> 
  
<span data-ttu-id="0fbc8-140">Para fazer com que o **NewEntry** retorne o identificador de entrada da entrada criada, passe um endereço válido para os parâmetros _lpcbEidNewEntry_ e _lppEidNewEntry_ .</span><span class="sxs-lookup"><span data-stu-id="0fbc8-140">To have **NewEntry** return the entry identifier of the created entry, pass a valid address for the  _lpcbEidNewEntry_ and  _lppEidNewEntry_ parameters.</span></span> <span data-ttu-id="0fbc8-141">O MAPI coloca o novo identificador de entrada no endereço apontado por _lppEidNewEntry_ e a contagem de bytes do novo identificador de entrada no endereço indicado por _lpcbEidNewEntry_.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-141">MAPI places the new entry identifier at the address pointed to by  _lppEidNewEntry_ and the byte count of the new entry identifier at the address pointed to by  _lpcbEidNewEntry_.</span></span>
  
<span data-ttu-id="0fbc8-142">Chame [IABContainer:: createentry](iabcontainer-createentry.md) para criar um destinatário e salvá-lo em um contêiner de catálogo de endereços específico.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-142">Call [IABContainer::CreateEntry](iabcontainer-createentry.md) to create a recipient and save it into a particular address book container.</span></span> <span data-ttu-id="0fbc8-143">Você pode usar esse método somente com contêineres modificáveis, que têm o sinalizador AB_MODIFIABLE definido em sua propriedade **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="0fbc8-143">You can use this method only with modifiable containers — containers that have the AB_MODIFIABLE flag set in their **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)) property.</span></span> <span data-ttu-id="0fbc8-144">Os provedores de catálogo de endereços com contêineres não modificáveis não dão suporte a esse método.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-144">Address book providers with nonmodifiable containers do not support this method.</span></span> <span data-ttu-id="0fbc8-145">Especifique o identificador de entrada do modelo para criar uma entrada do tipo desejado no parâmetro _lpEntryID_ .</span><span class="sxs-lookup"><span data-stu-id="0fbc8-145">Specify the entry identifier of the template for creating an entry of the desired type in the  _lpEntryID_ parameter.</span></span> 
  
<span data-ttu-id="0fbc8-146">No parâmetro _ulCreateFlags_ , especifique o tipo de verificação de entrada duplicada necessária e se as entradas novas devem ou não ser substituídas.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-146">In the  _ulCreateFlags_ parameter, specify the type of duplicate entry checking required and whether or not new entries should replace existing ones.</span></span> <span data-ttu-id="0fbc8-147">Se **createentry** falhar ao criar um novo objeto devido à verificação de entrada duplicada imposta pelo provedor, não espera ver um erro ou aviso retornado.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-147">If **CreateEntry** fails to create a new object because of the duplicate entry checking imposed by the provider, do not expect to see an error or warning returned.</span></span> <span data-ttu-id="0fbc8-148">Sob essas condições, os provedores retornam um código de sucesso.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-148">Under these conditions, providers return a success code.</span></span> 
  
<span data-ttu-id="0fbc8-149">Se você estiver trabalhando diretamente com um contêiner e souber exatamente os tipos de endereços que o contêiner pode criar, pode chamar **IABContainer:: createentry** e passar o identificador de entrada para o modelo apropriado.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-149">If you are working directly with a container and you know exactly the types of addresses that the container can create, you can call **IABContainer::CreateEntry** and pass the entry identifier for the appropriate template.</span></span> <span data-ttu-id="0fbc8-150">O provedor do catálogo de endereços define algumas propriedades padrão iniciais; Você pode chamar \*\*\*\* SetProps para definir outras pessoas.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-150">The address book provider sets some initial default properties; you can call **SetProps** to set others.</span></span> <span data-ttu-id="0fbc8-151">O usuário nunca está envolvido.</span><span class="sxs-lookup"><span data-stu-id="0fbc8-151">The user is never involved.</span></span> 
  

