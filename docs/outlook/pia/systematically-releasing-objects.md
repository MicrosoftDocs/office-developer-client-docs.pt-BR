---
title: Lançar objetos de modo sistemático
TOCTitle: Systematically releasing objects
ms:assetid: d4cd1d8e-aae6-483b-a4d8-1656171e838d
ms:mtpsurl: https://msdn.microsoft.com/library/Bb623945(v=office.15)
ms:contentKeyID: 55119785
ms.date: 07/24/2014
mtps_version: v=office.15
ms.openlocfilehash: 812f720b3ebab1100040802d7593548063497297
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/04/2018
ms.locfileid: "25406831"
---
# <a name="systematically-releasing-objects"></a><span data-ttu-id="dd5b7-102">Lançar objetos de modo sistemático</span><span class="sxs-lookup"><span data-stu-id="dd5b7-102">Systematically releasing objects</span></span>

<span data-ttu-id="dd5b7-103">Este tópico resume as recomendações de encerramento dos suplementos para desenvolvedores de suplemento e administradores de TI que usam o Outlook.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-103">This topic summarizes add-in shutdown recommendations for add-in developers and IT administrators that use Outlook.</span></span> <span data-ttu-id="dd5b7-104">Para saber mais, confira [alterações de desligamento para o Outlook 2010](https://msdn.microsoft.com/library/ee720183\(v=office.15\)).</span><span class="sxs-lookup"><span data-stu-id="dd5b7-104">For more information, see [Shutdown Changes for Outlook 2010](https://msdn.microsoft.com/library/ee720183\(v=office.15\)).</span></span>

## <a name="add-in-shutdown-changes-in-outlook"></a><span data-ttu-id="dd5b7-105">Alterações de encerramento dos suplementos no Outlook</span><span class="sxs-lookup"><span data-stu-id="dd5b7-105">Add-in shutdown changes in Outlook</span></span>

<span data-ttu-id="dd5b7-106">A partir do Outlook 2010, o Outlook, por padrão, não sinaliza suplementos que estão sendo encerrados.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-106">Starting in Outlook 2010, Outlook, by default, does not signal add-ins that it is shutting down.</span></span> <span data-ttu-id="dd5b7-107">Especificamente, o Outlook não aciona mais os métodos **OnBeginShutdown(Array)** e **OnDisconnection (ext\_DisconnectMode, matriz)** e a interface**IDTExtensibility2** durante o encerramento rápido.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-107">Specifically, Outlook no longer calls the **OnBeginShutdown(Array)** and **OnDisconnection(ext\_DisconnectMode, Array)** methods of the **IDTExtensibility2** interface during fast shutdown.</span></span> <span data-ttu-id="dd5b7-108">Da mesma forma, um suplemento do Outlook, escrito com as ferramentas de desenvolvimento do Office no Visual Studio 2010 ou em versões posteriores, não aciona o método ThisAddin\_desligamento quando o Outlook está sendo desligado.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-108">Similarly, an Outlook add-in, written with Office development tools in Visual Studio 2010 or a later version, no longer calls the ThisAddin\_Shutdown method when Outlook is shutting down.</span></span> 

<span data-ttu-id="dd5b7-109">O motivo para não acionar esses métodos é que, embora a maioria dos suplementos realize tarefas simples como o lançamento de referências, alguns suplementos fazem chamadas de serviço da Web ou outras operações de longa duração sincronicamente durante esses eventos, isso atrasa significativamente o desligamento do Outlook.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-109">The reason to stop calling these methods is that while a majority of add-ins perform simple tasks like releasing references, some add-ins make Web service calls or other long-running operations synchronously during these events, significantly delaying Outlook from shutting down.</span></span> <span data-ttu-id="dd5b7-110">Como essa alteração, o Outlook funciona melhor do que anteriormente quando está desligando.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-110">As a result of this change, Outlook works better than it has in the past when shutting down.</span></span>

## <a name="recommendations-for-add-in-shutdown-for-developers"></a><span data-ttu-id="dd5b7-111">Recomendações para o encerramento dos suplementos para desenvolvedores</span><span class="sxs-lookup"><span data-stu-id="dd5b7-111">Recommendations for add-in shutdown for developers</span></span>

<span data-ttu-id="dd5b7-112">É importante que os desenvolvedores observem as seguintes recomendações para desligamento de suplemento para garantir que os usuários finais continuem a se beneficiar de uma experiência de desligamento do Outlook rápida e eficaz.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-112">It is important that developers observe the following recommendations for add-in shutdown to ensure that end users continue to benefit from a fast and responsive Outlook shutdown experience.</span></span>

- <span data-ttu-id="dd5b7-113">Suplementos devem continuar implementando os métodos OnBeginShutdown e OnDisconnection ou ThisAddin\_desligamento para lançamento de referências e memória alocada, porque há situações em que os administradores podem reverter para desacelerar o desligamento através da política de grupo. O usuário também pode desconectar manualmente pode o suplemento por meio da caixa de diálogo **suplementos COM**.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-113">Add-ins should continue to implement the OnBeginShutdown and OnDisconnection methods or ThisAddin\_Shutdown to release references and allocated memory, because there are scenarios in which administrators might revert to slow shutdown through group policy, or the user might manually disconnect your add-in through the **COM Add-ins** dialog box.</span></span>

- <span data-ttu-id="dd5b7-114">Os desenvolvedores de suplemento só devem executar tarefas que ocorram exatamente durante o desligamento.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-114">Add-in developers should only perform tasks that absolutely must take place during shutdown.</span></span>

- <span data-ttu-id="dd5b7-115">Os desenvolvedores de suplemento devem avaliar o desempenho de seus suplementos em várias situações e em diferentes configurações de registro do Windows que controlam o encerramento do Outlook, e modificar proativamente seus suplementos para trabalhar com o Outlook.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-115">Add-in developers should evaluate the performance of their add-ins in various scenarios and under different Windows registry settings that control Outlook shutdown, and proactively modify their add-ins to work with Outlook.</span></span>

## <a name="recommendations-for-add-in-shutdown-for-it-administrators"></a><span data-ttu-id="dd5b7-116">Recomendações para o encerramento dos suplementos para administradores de TI</span><span class="sxs-lookup"><span data-stu-id="dd5b7-116">Recommendations for add-in shutdown for IT administrators</span></span>

<span data-ttu-id="dd5b7-117">Para administradores de TI, se houver suplementos que já estão implantados em uma empresa e não podem ser atualizados para se tornar compatível com o novo desligamento mecanismo do Outlook, os administradores de TI podem recorrer a algumas das configurações de registro do Windows para reverter o desligamento lento.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-117">For IT administrators, if there are add-ins that are already deployed in an enterprise and cannot be upgraded to become compatible with the new shutdown Outlook mechanism, IT administrators can resort to a couple of Windows registry settings to revert to the slow shutdown behavior.</span></span>

### <a name="individual-add-in-setting"></a><span data-ttu-id="dd5b7-118">Configuração de suplemento individual</span><span class="sxs-lookup"><span data-stu-id="dd5b7-118">Individual add-in setting</span></span>

<span data-ttu-id="dd5b7-119">Os administradores de TI podem habilitar notificações de desligamento individuais de suplementos do Outlook como parte da implantação do suplemento.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-119">IT administrators can enable shutdown notifications to individual Outlook add-ins as part of the add-in deployment.</span></span> <span data-ttu-id="dd5b7-120">Embora você não possa fazer isso por meio da política de grupo, isso será útil se você tiver requisitos de compatibilidade com versões anteriores de suplementos específicos.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-120">Although you cannot do this through group policy, it is useful if you have backward-compatibility requirements for specific add-ins.</span></span>

<span data-ttu-id="dd5b7-121">Defina essa configuração para cada suplemento através do registro de suplemento adicionar nas seções de registro HKCU HKLM, adicionando outro valor para o registro de suplemento.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-121">Configure this setting for each add-in through the add-in registration in the HKCU or the HKLM registry hives, by adding an additional value to the add-in registration.</span></span> <span data-ttu-id="dd5b7-122">Digite o seguinte texto em uma única linha:</span><span class="sxs-lookup"><span data-stu-id="dd5b7-122">Type the following text as a single line:</span></span>

`HKCU\Software\Microsoft\Office\Outlook\Add-ins\<ProgID>[RequireShutdownNotification]=dword:0x1`

<span data-ttu-id="dd5b7-123">Definir esse valor como 0x1 permite que o suplemento receba chamadas de retorno bloqueadas durante o encerramento do Outlook.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-123">Setting this value to 0x1 enables the add-in to receive blocked callbacks during Outlook shutdown.</span></span> <span data-ttu-id="dd5b7-124">Isso tem um impacto no desempenho do desligamento do Outlook e deve ser avaliado como parte de uma implantação.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-124">This has an impact on the performance of Outlook shutdown and should be evaluated as part of a deployment.</span></span> <span data-ttu-id="dd5b7-125">Essa configuração deve ser usada somente se um suplemento tiver problemas significativos de compatibilidade com o novo mecanismo de desligamento.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-125">This setting should be used only if an add-in has significant compatibility issues with the new shutdown mechanism.</span></span> <span data-ttu-id="dd5b7-126">Configurar o valor como 0x0 usa o comportamento padrão do Outlook.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-126">Setting the value to 0x0 uses the default behavior of Outlook.</span></span>

### <a name="global-setting"></a><span data-ttu-id="dd5b7-127">Configurações globais</span><span class="sxs-lookup"><span data-stu-id="dd5b7-127">Global setting</span></span>

<span data-ttu-id="dd5b7-128">Os administradores de TI podem habilitar as notificações de desligamento global para todos os suplementos com política de grupo.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-128">IT administrators can enable shutdown notifications globally for all add-ins through group policy.</span></span> <span data-ttu-id="dd5b7-129">Isso é recomendável para organizações que têm um grande número de soluções internas ou computadores que precisam implantar esta configuração para garantir a compatibilidade durante a implementação do Outlook.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-129">This is recommended for organizations that have a large number of internal solutions or desktops that need to deploy this setting to ensure compatibility during a rollout of Outlook.</span></span>

<span data-ttu-id="dd5b7-130">Use essa configuração para alterar o mecanismo de encerramento correspondente àquela usado pelo Outlook 2007.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-130">Use this setting to change the shutdown mechanism to match that used by Outlook 2007.</span></span> <span data-ttu-id="dd5b7-131">Você pode implantar a configuração por meio da política de grupo, por usuário ou por computador.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-131">You can deploy the setting through group policy, either per user or per computer.</span></span> <span data-ttu-id="dd5b7-132">Digite o seguinte texto em uma única linha:</span><span class="sxs-lookup"><span data-stu-id="dd5b7-132">Type the following text as a single line:</span></span>

`HKCU\Policies\Microsoft\Office\Outlook\15.0\Options\Shutdown[AddinFastShutdownBehavior]=dword:0x1`

<span data-ttu-id="dd5b7-133">AddinFastShutdownBehavior como 0x1 permite que as notificações de desligamento para todos os suplementos. A configuração do valor para 0x0 usa o comportamento padrão do Outlook.</span><span class="sxs-lookup"><span data-stu-id="dd5b7-133">Setting AddinFastShutdownBehavior to 0x1 enables shutdown notifications for all add-ins. Setting the value to 0x0 uses the default behavior of Outlook.</span></span>

