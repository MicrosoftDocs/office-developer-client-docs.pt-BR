---
title: Considerações sobre a automação autônoma do Office no Microsoft 365 para o ambiente RPA autônomo
ms.date: 03/30/2020
ms.audience: Developer
localization_priority: Normal
description: Considerações sobre a automação autônoma do Office no Microsoft 365 para o ambiente RPA autônomo.
ms.openlocfilehash: 576217fc85f2980a6d2451e3f930296ea4c11a56
ms.sourcegitcommit: 007aa2ceb4f569201c3f4372de5c83b6c61f8875
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/02/2020
ms.locfileid: "43103044"
---
# <a name="considerations-for-unattended-automation-of-office-in-the-microsoft-365-for-unattended-rpa-environment"></a><span data-ttu-id="c751f-103">Considerações sobre a automação autônoma do Office no Microsoft 365 para o ambiente RPA autônomo</span><span class="sxs-lookup"><span data-stu-id="c751f-103">Considerations for unattended automation of Office in the Microsoft 365 for unattended RPA environment</span></span>

<span data-ttu-id="c751f-104">Embora o Microsoft 365 para RPA autônomo fornece uma licença que permite a automação do Office sem nenhum usuário presente, todas as versões atuais do Office foram projetadas e testadas para executar como produtos de usuário final em uma estação de trabalho cliente com um usuário presente para interagir com a interface do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="c751f-104">Although Microsoft 365 for unattended RPA provides a license that enables the automation of Office with no user present, all current versions of Office were designed and tested to run as end-user products on a client workstation with a user present to interact with the application’s interface.</span></span> <span data-ttu-id="c751f-105">Comportamentos inesperados resultantes do uso de aplicativos sem um usuário presente não são defeitos.</span><span class="sxs-lookup"><span data-stu-id="c751f-105">Unexpected behaviors resulting from the use of applications without a user present are not defects.</span></span> <span data-ttu-id="c751f-106">Se quiser executar o Office nessa configuração, você deve estar preparado para levar em conta esses comportamentos inesperados na lógica do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="c751f-106">If you want to run Office in this configuration, you must be prepared to account for these unexpected behaviors in your application logic.</span></span>

<span data-ttu-id="c751f-107">Este artigo descreve algumas das considerações para a automação autônoma do Office para ajudá-lo se você usar essa abordagem.</span><span class="sxs-lookup"><span data-stu-id="c751f-107">This article outlines some of the considerations for unattended automation of Office to help you if you use this approach.</span></span> <span data-ttu-id="c751f-108">No entanto, observe que o uso do Office nessa configuração é estritamente "COMO ESTÁ" e deve levar em conta esses comportamentos inesperados.</span><span class="sxs-lookup"><span data-stu-id="c751f-108">However, note that usage of Office in this configuration is strictly “AS IS” and must account for these unexpected behaviors.</span></span> <span data-ttu-id="c751f-109">As informações fornecidas aqui não são exaustivas e não são garantidas para resolver todos os problemas de todos os clientes.</span><span class="sxs-lookup"><span data-stu-id="c751f-109">The information provided here is not exhaustive and is not guaranteed to resolve all issues for all clients.</span></span> <span data-ttu-id="c751f-110">Recomendamos que você teste sua solução exaustivamente antes de implantar.</span><span class="sxs-lookup"><span data-stu-id="c751f-110">We encourage you to test your solution thoroughly before you deploy.</span></span>

## <a name="common-problems-in-unattended-automation"></a><span data-ttu-id="c751f-111">Problemas comuns na automação autônoma</span><span class="sxs-lookup"><span data-stu-id="c751f-111">Common problems in unattended automation</span></span>

<span data-ttu-id="c751f-112">Se você quiser usar o Office sem um usuário presente, esteja ciente das seguintes áreas nas quais o Office pode se comportar de maneira diferente do esperado.</span><span class="sxs-lookup"><span data-stu-id="c751f-112">If you want to use Office without a user present, be aware of the following areas in which Office can behave differently than expected.</span></span> <span data-ttu-id="c751f-113">Para que sua solução seja executado com êxito, ela deve resolver esses problemas e minimizar os efeitos o máximo possível.</span><span class="sxs-lookup"><span data-stu-id="c751f-113">For your solution to run successfully, it must address these issues and minimize their effects as much as possible.</span></span> <span data-ttu-id="c751f-114">Considere esses problemas cuidadosamente ao criar seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="c751f-114">Consider these issues carefully when you build your application.</span></span>

### <a name="interactive-ui-elements"></a><span data-ttu-id="c751f-115">Elementos interativos da interface do usuário</span><span class="sxs-lookup"><span data-stu-id="c751f-115">Interactive UI elements</span></span>

<span data-ttu-id="c751f-116">Os aplicativos do Office presumem que eles estão sendo executados interativamente.</span><span class="sxs-lookup"><span data-stu-id="c751f-116">Office applications assume that they are being run interactively.</span></span> <span data-ttu-id="c751f-117">Se ocorrer um erro inesperado ou se for necessário um parâmetro não especificado para concluir uma função, o Office foi projetado para solicitar ao usuário uma caixa de diálogo que pergunta ao usuário como ele deseja continuar.</span><span class="sxs-lookup"><span data-stu-id="c751f-117">If an unexpected error occurs, or if an unspecified parameter is needed to complete a function, Office is designed to prompt the user with a dialog box that asks the user how they want to proceed.</span></span> <span data-ttu-id="c751f-118">Na automação autônoma, isso pode fazer com que o aplicativo pareça "travado" à medida que o aplicativo para até receber essa entrada.</span><span class="sxs-lookup"><span data-stu-id="c751f-118">In unattended automation, this might result in the application appearing to “hang” as the application stops until it receives this input.</span></span> <span data-ttu-id="c751f-119">Se você estiver automatizando o Office por meio de suas APIs públicas, poderá suprimir muitos desses alertas configurando propriedades como [Application.DisplayAlerts](https://docs.microsoft.com/office/vba/api/word.application.displayalerts) e [Application.AutomationSecurity](https://docs.microsoft.com/office/vba/api/word.application.automationsecurity) adequadamente.</span><span class="sxs-lookup"><span data-stu-id="c751f-119">If you’re automating Office via its public APIs, you can suppress many of these alerts by configuring properties like [Application.DisplayAlerts](https://docs.microsoft.com/office/vba/api/word.application.displayalerts) and [Application.AutomationSecurity](https://docs.microsoft.com/office/vba/api/word.application.automationsecurity) appropriately.</span></span> <span data-ttu-id="c751f-120">Seu código deve ser projetado para identificar e processar alertas de bloqueio a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="c751f-120">Your code should be designed to identify and process blocking alerts at any time.</span></span>

### <a name="user-identity"></a><span data-ttu-id="c751f-121">Identidade do usuário</span><span class="sxs-lookup"><span data-stu-id="c751f-121">User identity</span></span>

<span data-ttu-id="c751f-122">Os aplicativos do Office exigem uma identidade de usuário quando os aplicativos são executados, mesmo quando o aplicativo é iniciado via automação.</span><span class="sxs-lookup"><span data-stu-id="c751f-122">Office applications require a user identity when the applications are run, even when the application is started via automation.</span></span> <span data-ttu-id="c751f-123">Essa identidade de usuário pode causar um ou todos os seguintes:</span><span class="sxs-lookup"><span data-stu-id="c751f-123">This user identity can cause any or all of the following:</span></span>

- <span data-ttu-id="c751f-124">A presença de interface do usuário de login adicional que deve ser manipulada.</span><span class="sxs-lookup"><span data-stu-id="c751f-124">The presence of additional sign-in UI that must be handled.</span></span>
- <span data-ttu-id="c751f-125">Arquivos que não podem ser abertos e/ou editados com base em permissões de acesso por usuário.</span><span class="sxs-lookup"><span data-stu-id="c751f-125">Files that cannot be opened and/or edited based on per-user access permissions.</span></span>
- <span data-ttu-id="c751f-126">Alterações inesperadas nos metadados do arquivo (por exemplo, determinadas propriedades de arquivo serão atualizadas com base na identidade do usuário da instância automatizada do aplicativo).</span><span class="sxs-lookup"><span data-stu-id="c751f-126">Unexpected changes to the metadata of the file (for example, certain file properties will be updated based on the identity of the user identity of the automated application instance).</span></span>

<span data-ttu-id="c751f-127">Várias abordagens podem ajudar a atenuar esses problemas; por exemplo, executar o [Inspetor de Documento](https://docs.microsoft.com/office/vba/library-reference/concepts/using-the-document-inspector) para remover metadados.</span><span class="sxs-lookup"><span data-stu-id="c751f-127">Various approaches can help to mitigate these issues; for example, running the [Document Inspector](https://docs.microsoft.com/office/vba/library-reference/concepts/using-the-document-inspector) to remove metadata.</span></span> <span data-ttu-id="c751f-128">Considere se essas abordagens são apropriadas com base em seu cenário.</span><span class="sxs-lookup"><span data-stu-id="c751f-128">Consider whether these approaches are appropriate based on your scenario.</span></span>

### <a name="server-side-security"></a><span data-ttu-id="c751f-129">Segurança do lado do servidor</span><span class="sxs-lookup"><span data-stu-id="c751f-129">Server-side security</span></span>

<span data-ttu-id="c751f-130">Ao executar o conteúdo arbitrário de arquivo autônomo do Office e processar, nenhuma proteção adicional específica desse ambiente estará disponível para impedir que macros armazenadas nesses arquivos sejam carregadas e em execução.</span><span class="sxs-lookup"><span data-stu-id="c751f-130">When running Office unattended and processing arbitrary file content, no additional protections specific in that environment are available to prevent macros stored in those files from loading and running.</span></span> <span data-ttu-id="c751f-131">O Office não protege você de executar macros involutionamente do seu código ou de iniciar outro servidor que possa executar macros.</span><span class="sxs-lookup"><span data-stu-id="c751f-131">Office does not protect you from unintentionally running macros from your code, or from starting another server that might run macros.</span></span> <span data-ttu-id="c751f-132">Você pode usar propriedades como [Application.AutomationSecurity](https://docs.microsoft.com/office/vba/api/word.application.automationsecurity) para reduzir esse risco, mas deve garantir que está carregando apenas conteúdo confiável.</span><span class="sxs-lookup"><span data-stu-id="c751f-132">You can use properties like [Application.AutomationSecurity](https://docs.microsoft.com/office/vba/api/word.application.automationsecurity) to mitigate this risk, but you should ensure that you are only loading trusted content.</span></span>

<span data-ttu-id="c751f-133">Além disso, o Office usa muitos componentes (como SIMPLE MAPI, WinInet e MSDAIPP) que podem armazenar em cache as informações de autenticação do cliente para acelerar o processamento.</span><span class="sxs-lookup"><span data-stu-id="c751f-133">Additionally, Office uses many components (such as Simple MAPI, WinInet, and MSDAIPP) that can cache client authentication information to speed processing.</span></span> <span data-ttu-id="c751f-134">Quando o Office está sendo automatizado no lado do servidor e processando vários arquivos, se as informações de autenticação foram armazenadas em cache para essa sessão, um cliente pode usar as credenciais armazenadas em cache de outro cliente.</span><span class="sxs-lookup"><span data-stu-id="c751f-134">When Office is being automated server-side and processing multiple files, if authentication information has been cached for that session, one client can use the cached credentials of another client.</span></span> <span data-ttu-id="c751f-135">Portanto, o cliente pode obter permissões de acesso não concedidas, representando outros usuários.</span><span class="sxs-lookup"><span data-stu-id="c751f-135">Therefore, the client can gain non-granted access permissions by impersonating other users.</span></span>

### <a name="ui-changes"></a><span data-ttu-id="c751f-136">Alterações na interface do usuário</span><span class="sxs-lookup"><span data-stu-id="c751f-136">UI changes</span></span>

<span data-ttu-id="c751f-137">Os elementos de interface do usuário no Office são amplamente estáveis, mas o local específico de qualquer elemento da interface do usuário não é garantido e pode mudar à medida que o design do produto evolui para incorporar comentários do usuário e atender às necessidades do cliente.</span><span class="sxs-lookup"><span data-stu-id="c751f-137">The UI elements in Office are largely stable, but the specific location of any UI element is not guaranteed and might change as the product design evolves to incorporate user feedback and meet customer needs.</span></span> <span data-ttu-id="c751f-138">A lógica de qualquer automação deve levar em conta isso.</span><span class="sxs-lookup"><span data-stu-id="c751f-138">The logic of any automation must account for this.</span></span> <span data-ttu-id="c751f-139">Essas alterações podem resultar em alterações de nomeação de botão ou guia de grupo, movimento de comandos entre guias, adição de novas guias ou a remoção de comandos em alinhamento com nossas políticas de preteração de recursos.</span><span class="sxs-lookup"><span data-stu-id="c751f-139">These changes might result in button or group tab naming changes, movement of commands between tabs, the addition of new tabs, or the removal of commands in alignment with our feature deprecation policies.</span></span> <span data-ttu-id="c751f-140">Essas alterações podem ocorrer na interface do usuário, bem como nas informações de acessibilidade fornecidas pelo aplicativo, pois essas informações são modificadas para melhorar a usabilidade e contabilizar comentários contínuos dos clientes e podem ser disponibilizadas para usuários diferentes em momentos diferentes.</span><span class="sxs-lookup"><span data-stu-id="c751f-140">These changes can take place in the UI as well as within the accessibility information provided by the application, as that information is modified to improve usability and account for ongoing customer feedback, and might be rolled out for different users at different times.</span></span>

<span data-ttu-id="c751f-141">Mesmo sem alterações no produto, as diferenças entre ambientes do sistema (como tamanho/resolução/DPI da tela) podem resultar em alterações na localização dos itens na tela.</span><span class="sxs-lookup"><span data-stu-id="c751f-141">Even without product changes, differences between system environments (such as screen size/resolution/DPI) can result in changes in the location of items on screen.</span></span> <span data-ttu-id="c751f-142">Qualquer abordagem que depende de coordenadas de tela para simular a entrada do usuário deve considerar essas alterações e adaptar-se de acordo.</span><span class="sxs-lookup"><span data-stu-id="c751f-142">Any approach that relies on screen coordinates to simulate user input must consider these changes and adapt accordingly.</span></span>

### <a name="single-threading"></a><span data-ttu-id="c751f-143">Threading único</span><span class="sxs-lookup"><span data-stu-id="c751f-143">Single-threading</span></span>

<span data-ttu-id="c751f-144">Os aplicativos do Office são aplicativos não reentráveis e baseados em STA projetados para fornecer funcionalidade diversificada, mas que utiliza muitos recursos para um único cliente.</span><span class="sxs-lookup"><span data-stu-id="c751f-144">Office applications are non-reentrant, STA-based applications that are designed to provide diverse but resource-intensive functionality for a single client.</span></span> <span data-ttu-id="c751f-145">Os aplicativos usam recursos globais, como arquivos mapeados na memória, modelos ou complementos globais e servidores de automação compartilhados.</span><span class="sxs-lookup"><span data-stu-id="c751f-145">The applications use global resources such as memory mapped files, global add-ins or templates, and shared automation servers.</span></span> <span data-ttu-id="c751f-146">Isso pode limitar o número de instâncias que podem ser executados simultaneamente e podem levar a condições de corrida se os aplicativos estão configurados em um ambiente multicliente.</span><span class="sxs-lookup"><span data-stu-id="c751f-146">This can limit the number of instances that can run concurrently and can lead to race conditions if the applications are configured in a multiclient environment.</span></span> <span data-ttu-id="c751f-147">Se você planeja executar mais de uma instância de qualquer aplicativo do Office, planeje isolá-las no nível da máquina virtual para garantir a estabilidade da solução resultante.</span><span class="sxs-lookup"><span data-stu-id="c751f-147">If you plan to run more than one instance of any Office application, you should plan to isolate them at the virtual machine level to ensure the stability of the resulting solution.</span></span>

### <a name="resiliency-and-stability"></a><span data-ttu-id="c751f-148">Resiliência e estabilidade</span><span class="sxs-lookup"><span data-stu-id="c751f-148">Resiliency and stability</span></span>

<span data-ttu-id="c751f-149">Mesmo com as considerações acima, se os aplicativos são automatizados de maneiras que simulam a entrada do usuário ou para comprimentos de sessão que excedem drasticamente o uso interativo, eles podem encontrar problemas que não estão presentes quando executados interativamente.</span><span class="sxs-lookup"><span data-stu-id="c751f-149">Even with the considerations above, if the applications are automated in ways that simulate user input or for session lengths that dramatically exceed interactive usage, they might encounter issues that are not present when run interactively.</span></span> <span data-ttu-id="c751f-150">As soluções que utilizam o Office nesse contexto devem criar mecanismos de forma proativa para monitorar o estado do aplicativo e reiniciá-los (e/ou a máquina virtual na qual estão sendo executados) se/conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="c751f-150">Solutions that utilize Office in this context should proactively build mechanisms to monitor the state of the application and restart them (and/or the virtual machine on which they are running) if/as needed.</span></span>

## <a name="suggested-alternatives"></a><span data-ttu-id="c751f-151">Alternativas sugeridas</span><span class="sxs-lookup"><span data-stu-id="c751f-151">Suggested Alternatives</span></span>

<span data-ttu-id="c751f-152">A Microsoft recomenda fortemente algumas alternativas que não exigem que o Office seja instalado e executado no lado do servidor, e que possam executar tarefas comuns com mais eficiência e mais rapidez do que a automação nessa configuração.</span><span class="sxs-lookup"><span data-stu-id="c751f-152">Microsoft strongly recommends a few alternatives that do not require Office to be installed and run server-side, and that can perform common tasks more efficiently and more quickly than automation in this configuration.</span></span> <span data-ttu-id="c751f-153">Antes de envolver o Office como um componente do lado do servidor em seu projeto, considere alternativas.</span><span class="sxs-lookup"><span data-stu-id="c751f-153">Before you involve Office as a server-side component in your project, consider alternatives.</span></span>

### <a name="microsoft-graph"></a><span data-ttu-id="c751f-154">Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="c751f-154">Microsoft Graph</span></span>

<span data-ttu-id="c751f-155">A API do Microsoft Graph fornece acesso aos serviços, dados e inteligência que estão disponíveis para usuários e soluções como parte da nuvem da Microsoft, incluindo muitos serviços que suportam as necessidades de automação autônoma: acesso ao email/calendário/contatos /arquivos dos usuários, conversão de documentos, cálculo da planilha do Excel e muito mais.</span><span class="sxs-lookup"><span data-stu-id="c751f-155">The Microsoft Graph API provides access to the services, data, and intelligence that are available to users and solutions as part of the Microsoft cloud, including many services supporting the needs of unattended automation: access to users’ mail / calendar / contacts / files, document conversion, Excel workbook calculation, and more.</span></span> <span data-ttu-id="c751f-156">Esses serviços são projetados para uso autônomo e acesso em alta escala e utilizam uma sintaxe de API RESTful padrão.</span><span class="sxs-lookup"><span data-stu-id="c751f-156">These services are designed for unattended use and high-scale access, and utilize a standard RESTful API syntax.</span></span> <span data-ttu-id="c751f-157">Para obter mais informações sobre o Microsoft Graph e como usá-lo para trabalhar com os dados dos usuários, visite o seguinte:</span><span class="sxs-lookup"><span data-stu-id="c751f-157">For more information on Microsoft Graph and how to use it to work with users’ data, visit the following:</span></span>

- [<span data-ttu-id="c751f-158">Visão geral do Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="c751f-158">Overview of Microsoft Graph</span></span>](https://docs.microsoft.com/graph/overview) 
- [<span data-ttu-id="c751f-159">Introdução ao Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="c751f-159">Get started with Microsoft Graph</span></span>](https://developer.microsoft.com/graph/get-started)
- <span data-ttu-id="c751f-160">[Baixar um arquivo em outro formato (conversão](https://docs.microsoft.com/graph/api/driveitem-get-content-format?view=graph-rest-1.0&tabs=http) de arquivo)</span><span class="sxs-lookup"><span data-stu-id="c751f-160">[Download a file in another format](https://docs.microsoft.com/graph/api/driveitem-get-content-format?view=graph-rest-1.0&tabs=http) (file conversion)</span></span>
- <span data-ttu-id="c751f-161">[Trabalhar com o Excel no Microsoft Graph](https://docs.microsoft.com/graph/api/resources/excel?view=graph-rest-1.0) (detalhes da planilha)</span><span class="sxs-lookup"><span data-stu-id="c751f-161">[Working with Excel in Microsoft Graph](https://docs.microsoft.com/graph/api/resources/excel?view=graph-rest-1.0) (workbook details)</span></span>

### <a name="open-xml-file-formats"></a><span data-ttu-id="c751f-162">Formatos de arquivo Open XML</span><span class="sxs-lookup"><span data-stu-id="c751f-162">Open XML file formats</span></span>

<span data-ttu-id="c751f-163">Muitas tarefas de automação envolvem a criação ou edição de documentos.</span><span class="sxs-lookup"><span data-stu-id="c751f-163">Many automation tasks involve document creation or editing.</span></span> <span data-ttu-id="c751f-164">O Office dá suporte a formatos de arquivo Open XML que permitem que os desenvolvedores criem, editem, leiam e transformem conteúdo de arquivo usando tecnologias XML e ZIP padrão, definidas no ISO 29500 International Standard.</span><span class="sxs-lookup"><span data-stu-id="c751f-164">Office supports Open XML file formats that let developers create, edit, read, and transform file content using standard XML and ZIP technologies, defined in the ISO 29500 International Standard.</span></span> <span data-ttu-id="c751f-165">Esses formatos de arquivo podem ser manipulados por meio de qualquer ferramenta ZIP/XML, incluindo o namespace System.IO.Package.IO no Microsoft .NET 3.x Framework.</span><span class="sxs-lookup"><span data-stu-id="c751f-165">These file formats can be manipulated via any ZIP/XML tools, including the System.IO.Package.IO namespace in the Microsoft .NET 3.x Framework.</span></span> <span data-ttu-id="c751f-166">A edição direta dos formatos de arquivo é o método recomendado e com suporte para manipular alterações em arquivos do Office de um serviço.</span><span class="sxs-lookup"><span data-stu-id="c751f-166">Direct editing of the file formats is the recommended and supported method for handling changes to Office files from a service.</span></span>

<span data-ttu-id="c751f-167">A Microsoft fornece um SDK para manipular formatos de arquivo Open XML do .NET 3.x Framework.</span><span class="sxs-lookup"><span data-stu-id="c751f-167">Microsoft provides an SDK for manipulating Open XML file formats from the .NET 3.x Framework.</span></span> <span data-ttu-id="c751f-168">Para obter mais informações sobre o SDK e como usar o SDK para criar ou editar arquivos Open XML, visite o seguinte:</span><span class="sxs-lookup"><span data-stu-id="c751f-168">For more information about the SDK and how to use the SDK to create or edit Open XML files, visit the following:</span></span>

- [<span data-ttu-id="c751f-169">Noções básicas sobre os formatos de arquivo XML abertos</span><span class="sxs-lookup"><span data-stu-id="c751f-169">Understanding the Open XML file formats</span></span>](https://docs.microsoft.com/office/open-xml/understanding-the-open-xml-file-formats)
- [<span data-ttu-id="c751f-170">Bem-vindo ao SDK 2.5 do Open XML para Office</span><span class="sxs-lookup"><span data-stu-id="c751f-170">Welcome to the Open XML SDK 2.5 for Office</span></span>](https://docs.microsoft.com/office/open-xml/open-xml-sdk)
