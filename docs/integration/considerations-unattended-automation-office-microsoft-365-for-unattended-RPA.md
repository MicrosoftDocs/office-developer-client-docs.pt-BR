---
title: Considerações sobre a automação autônoma do Office no Microsoft 365 para o ambiente do RPA autônomo
ms.date: 03/30/2020
ms.audience: Developer
localization_priority: Normal
description: Considerações sobre a automação autônoma do Office no Microsoft 365 para o ambiente do RPA autônomo.
ms.openlocfilehash: 576217fc85f2980a6d2451e3f930296ea4c11a56
ms.sourcegitcommit: 007aa2ceb4f569201c3f4372de5c83b6c61f8875
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/02/2020
ms.locfileid: "43103044"
---
# <a name="considerations-for-unattended-automation-of-office-in-the-microsoft-365-for-unattended-rpa-environment"></a><span data-ttu-id="55409-103">Considerações sobre a automação autônoma do Office no Microsoft 365 para o ambiente do RPA autônomo</span><span class="sxs-lookup"><span data-stu-id="55409-103">Considerations for unattended automation of Office in the Microsoft 365 for unattended RPA environment</span></span>

<span data-ttu-id="55409-104">Embora o Microsoft 365 para RPA autônomo forneça uma licença que permite a automação do Office sem nenhum usuário presente, todas as versões atuais do Office foram projetadas e testadas para executar como produtos de usuário final em uma estação de trabalho cliente com um usuário presente para interagir com a interface do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="55409-104">Although Microsoft 365 for unattended RPA provides a license that enables the automation of Office with no user present, all current versions of Office were designed and tested to run as end-user products on a client workstation with a user present to interact with the application’s interface.</span></span> <span data-ttu-id="55409-105">Comportamentos inesperados resultantes do uso de aplicativos sem um usuário presente não são defeitos.</span><span class="sxs-lookup"><span data-stu-id="55409-105">Unexpected behaviors resulting from the use of applications without a user present are not defects.</span></span> <span data-ttu-id="55409-106">Se quiser executar o Office nessa configuração, você deve estar preparado para considerar esses comportamentos inesperados na lógica do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="55409-106">If you want to run Office in this configuration, you must be prepared to account for these unexpected behaviors in your application logic.</span></span>

<span data-ttu-id="55409-107">Este artigo descreve algumas das considerações da automação autônoma do Office para ajudá-lo se você usar essa abordagem.</span><span class="sxs-lookup"><span data-stu-id="55409-107">This article outlines some of the considerations for unattended automation of Office to help you if you use this approach.</span></span> <span data-ttu-id="55409-108">No entanto, observe que o uso do Office nessa configuração é estritamente "como está" e deve considerar esses comportamentos inesperados.</span><span class="sxs-lookup"><span data-stu-id="55409-108">However, note that usage of Office in this configuration is strictly “AS IS” and must account for these unexpected behaviors.</span></span> <span data-ttu-id="55409-109">As informações fornecidas aqui não são exaustivas e não garantem a resolução de todos os problemas de todos os clientes.</span><span class="sxs-lookup"><span data-stu-id="55409-109">The information provided here is not exhaustive and is not guaranteed to resolve all issues for all clients.</span></span> <span data-ttu-id="55409-110">Recomendamos que você teste sua solução exaustivamente antes de implantar o.</span><span class="sxs-lookup"><span data-stu-id="55409-110">We encourage you to test your solution thoroughly before you deploy.</span></span>

## <a name="common-problems-in-unattended-automation"></a><span data-ttu-id="55409-111">Problemas comuns na automação autônoma</span><span class="sxs-lookup"><span data-stu-id="55409-111">Common problems in unattended automation</span></span>

<span data-ttu-id="55409-112">Se você quiser usar o Office sem um usuário presente, esteja ciente das seguintes áreas nas quais o Office pode se comportar de forma diferente do esperado.</span><span class="sxs-lookup"><span data-stu-id="55409-112">If you want to use Office without a user present, be aware of the following areas in which Office can behave differently than expected.</span></span> <span data-ttu-id="55409-113">Para que sua solução seja executada com êxito, ela deve resolver esses problemas e minimizar seus efeitos tanto quanto possível.</span><span class="sxs-lookup"><span data-stu-id="55409-113">For your solution to run successfully, it must address these issues and minimize their effects as much as possible.</span></span> <span data-ttu-id="55409-114">Considere esses problemas cuidadosamente ao criar seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="55409-114">Consider these issues carefully when you build your application.</span></span>

### <a name="interactive-ui-elements"></a><span data-ttu-id="55409-115">Elementos de interface do usuário interativa</span><span class="sxs-lookup"><span data-stu-id="55409-115">Interactive UI elements</span></span>

<span data-ttu-id="55409-116">Os aplicativos do Office presumem que estão sendo executados interativamente.</span><span class="sxs-lookup"><span data-stu-id="55409-116">Office applications assume that they are being run interactively.</span></span> <span data-ttu-id="55409-117">Se ocorrer um erro inesperado ou se um parâmetro não especificado for necessário para concluir uma função, o Office será projetado para solicitar ao usuário uma caixa de diálogo que pergunte ao usuário como eles desejam proceder.</span><span class="sxs-lookup"><span data-stu-id="55409-117">If an unexpected error occurs, or if an unspecified parameter is needed to complete a function, Office is designed to prompt the user with a dialog box that asks the user how they want to proceed.</span></span> <span data-ttu-id="55409-118">Na automação autônoma, isso pode fazer com que o aplicativo apareça como "travar" à medida que o aplicativo é interrompido até receber essa entrada.</span><span class="sxs-lookup"><span data-stu-id="55409-118">In unattended automation, this might result in the application appearing to “hang” as the application stops until it receives this input.</span></span> <span data-ttu-id="55409-119">Se você estiver automatizando o Office por meio de suas APIs públicas, poderá suprimir muitos desses alertas Configurando propriedades como [Application. DisplayAlerts](https://docs.microsoft.com/office/vba/api/word.application.displayalerts) e [Application. AutomationSecurity](https://docs.microsoft.com/office/vba/api/word.application.automationsecurity) adequadamente.</span><span class="sxs-lookup"><span data-stu-id="55409-119">If you’re automating Office via its public APIs, you can suppress many of these alerts by configuring properties like [Application.DisplayAlerts](https://docs.microsoft.com/office/vba/api/word.application.displayalerts) and [Application.AutomationSecurity](https://docs.microsoft.com/office/vba/api/word.application.automationsecurity) appropriately.</span></span> <span data-ttu-id="55409-120">O código deve ser projetado para identificar e processar alertas de bloqueio a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="55409-120">Your code should be designed to identify and process blocking alerts at any time.</span></span>

### <a name="user-identity"></a><span data-ttu-id="55409-121">Identidade do usuário</span><span class="sxs-lookup"><span data-stu-id="55409-121">User identity</span></span>

<span data-ttu-id="55409-122">Os aplicativos do Office exigem uma identidade de usuário quando os aplicativos são executados, mesmo quando o aplicativo é iniciado por meio da automação.</span><span class="sxs-lookup"><span data-stu-id="55409-122">Office applications require a user identity when the applications are run, even when the application is started via automation.</span></span> <span data-ttu-id="55409-123">Essa identidade de usuário pode causar qualquer um dos seguintes:</span><span class="sxs-lookup"><span data-stu-id="55409-123">This user identity can cause any or all of the following:</span></span>

- <span data-ttu-id="55409-124">A presença de interface do usuário de entrada adicional que deve ser tratada.</span><span class="sxs-lookup"><span data-stu-id="55409-124">The presence of additional sign-in UI that must be handled.</span></span>
- <span data-ttu-id="55409-125">Arquivos que não podem ser abertos e/ou editados com base em permissões de acesso por usuário.</span><span class="sxs-lookup"><span data-stu-id="55409-125">Files that cannot be opened and/or edited based on per-user access permissions.</span></span>
- <span data-ttu-id="55409-126">Alterações inesperadas para os metadados do arquivo (por exemplo, determinadas propriedades de arquivo serão atualizadas com base na identidade da identidade do usuário da instância de aplicativo automatizada).</span><span class="sxs-lookup"><span data-stu-id="55409-126">Unexpected changes to the metadata of the file (for example, certain file properties will be updated based on the identity of the user identity of the automated application instance).</span></span>

<span data-ttu-id="55409-127">Várias abordagens podem ajudar a reduzir esses problemas; por exemplo, executando o [Inspetor de documento](https://docs.microsoft.com/office/vba/library-reference/concepts/using-the-document-inspector) para remover metadados.</span><span class="sxs-lookup"><span data-stu-id="55409-127">Various approaches can help to mitigate these issues; for example, running the [Document Inspector](https://docs.microsoft.com/office/vba/library-reference/concepts/using-the-document-inspector) to remove metadata.</span></span> <span data-ttu-id="55409-128">Considere se essas abordagens são apropriadas com base em seu cenário.</span><span class="sxs-lookup"><span data-stu-id="55409-128">Consider whether these approaches are appropriate based on your scenario.</span></span>

### <a name="server-side-security"></a><span data-ttu-id="55409-129">Segurança no servidor</span><span class="sxs-lookup"><span data-stu-id="55409-129">Server-side security</span></span>

<span data-ttu-id="55409-130">Ao executar o Office autônomo e o processamento de conteúdo de arquivo arbitrário, nenhuma proteção adicional específica nesse ambiente estará disponível para impedir que as macros armazenadas nesses arquivos sejam carregadas e executadas.</span><span class="sxs-lookup"><span data-stu-id="55409-130">When running Office unattended and processing arbitrary file content, no additional protections specific in that environment are available to prevent macros stored in those files from loading and running.</span></span> <span data-ttu-id="55409-131">O Office não protege você contra a execução acidental de macros do código ou a inicialização de outro servidor que possa executar macros.</span><span class="sxs-lookup"><span data-stu-id="55409-131">Office does not protect you from unintentionally running macros from your code, or from starting another server that might run macros.</span></span> <span data-ttu-id="55409-132">Você pode usar propriedades como [Application. AutomationSecurity](https://docs.microsoft.com/office/vba/api/word.application.automationsecurity) para reduzir esse risco, mas você deve garantir que você esteja apenas carregando conteúdo confiável.</span><span class="sxs-lookup"><span data-stu-id="55409-132">You can use properties like [Application.AutomationSecurity](https://docs.microsoft.com/office/vba/api/word.application.automationsecurity) to mitigate this risk, but you should ensure that you are only loading trusted content.</span></span>

<span data-ttu-id="55409-133">Além disso, o Office usa vários componentes (como Simple MAPI, WinInet e MSDAIPP) que podem armazenar em cache as informações de autenticação do cliente para agilizar o processamento.</span><span class="sxs-lookup"><span data-stu-id="55409-133">Additionally, Office uses many components (such as Simple MAPI, WinInet, and MSDAIPP) that can cache client authentication information to speed processing.</span></span> <span data-ttu-id="55409-134">Quando o Office está sendo automatizado no servidor e processando vários arquivos, se as informações de autenticação forem armazenadas em cache para essa sessão, um cliente poderá usar as credenciais armazenadas em cache de outro cliente.</span><span class="sxs-lookup"><span data-stu-id="55409-134">When Office is being automated server-side and processing multiple files, if authentication information has been cached for that session, one client can use the cached credentials of another client.</span></span> <span data-ttu-id="55409-135">Portanto, o cliente pode obter permissões de acesso não concedidas por meio da representação de outros usuários.</span><span class="sxs-lookup"><span data-stu-id="55409-135">Therefore, the client can gain non-granted access permissions by impersonating other users.</span></span>

### <a name="ui-changes"></a><span data-ttu-id="55409-136">Alterações na interface do usuário</span><span class="sxs-lookup"><span data-stu-id="55409-136">UI changes</span></span>

<span data-ttu-id="55409-137">Os elementos da interface do usuário do Office são amplamente estáveis, mas o local específico de qualquer elemento de interface do usuário não é garantido e pode ser alterado conforme o design do produto evolui para incorporar os comentários do usuário e atender às necessidades do cliente.</span><span class="sxs-lookup"><span data-stu-id="55409-137">The UI elements in Office are largely stable, but the specific location of any UI element is not guaranteed and might change as the product design evolves to incorporate user feedback and meet customer needs.</span></span> <span data-ttu-id="55409-138">A lógica de qualquer automação deve considerar isso.</span><span class="sxs-lookup"><span data-stu-id="55409-138">The logic of any automation must account for this.</span></span> <span data-ttu-id="55409-139">Essas alterações podem resultar em alterações de nome de guia de grupo ou de botão, movimentação de comandos entre guias, adição de novas guias ou remoção de comandos em alinhamento com as políticas de substituição de recursos.</span><span class="sxs-lookup"><span data-stu-id="55409-139">These changes might result in button or group tab naming changes, movement of commands between tabs, the addition of new tabs, or the removal of commands in alignment with our feature deprecation policies.</span></span> <span data-ttu-id="55409-140">Essas alterações podem ocorrer na interface do usuário, bem como nas informações de acessibilidade fornecidas pelo aplicativo, pois essas informações são modificadas para melhorar a usabilidade e a conta para comentários contínuos do cliente e podem ser implantadas para diferentes usuários em momentos diferentes.</span><span class="sxs-lookup"><span data-stu-id="55409-140">These changes can take place in the UI as well as within the accessibility information provided by the application, as that information is modified to improve usability and account for ongoing customer feedback, and might be rolled out for different users at different times.</span></span>

<span data-ttu-id="55409-141">Mesmo sem alterações de produto, as diferenças entre ambientes de sistema (como tamanho de tela/resolução/DPI) podem resultar em alterações no local dos itens na tela.</span><span class="sxs-lookup"><span data-stu-id="55409-141">Even without product changes, differences between system environments (such as screen size/resolution/DPI) can result in changes in the location of items on screen.</span></span> <span data-ttu-id="55409-142">Qualquer abordagem que se baseia em coordenadas de tela para simular a entrada do usuário deve considerar essas alterações e se adaptar de acordo.</span><span class="sxs-lookup"><span data-stu-id="55409-142">Any approach that relies on screen coordinates to simulate user input must consider these changes and adapt accordingly.</span></span>

### <a name="single-threading"></a><span data-ttu-id="55409-143">Segmentação única</span><span class="sxs-lookup"><span data-stu-id="55409-143">Single-threading</span></span>

<span data-ttu-id="55409-144">Os aplicativos do Office são aplicativos baseados em STA e não reentrante que são projetados para fornecer funcionalidades diversas, mas intensivamente, para um único cliente.</span><span class="sxs-lookup"><span data-stu-id="55409-144">Office applications are non-reentrant, STA-based applications that are designed to provide diverse but resource-intensive functionality for a single client.</span></span> <span data-ttu-id="55409-145">Os aplicativos usam recursos globais, como arquivos mapeados de memória, suplementos globais ou modelos e servidores de automação compartilhados.</span><span class="sxs-lookup"><span data-stu-id="55409-145">The applications use global resources such as memory mapped files, global add-ins or templates, and shared automation servers.</span></span> <span data-ttu-id="55409-146">Isso pode limitar o número de instâncias que podem ser executadas simultaneamente e podem levar a condições de corrida se os aplicativos estiverem configurados em um ambiente de vários clientes.</span><span class="sxs-lookup"><span data-stu-id="55409-146">This can limit the number of instances that can run concurrently and can lead to race conditions if the applications are configured in a multiclient environment.</span></span> <span data-ttu-id="55409-147">Se você planeja executar mais de uma instância de qualquer aplicativo do Office, você deve planejar isolá-los no nível da máquina virtual para garantir a estabilidade da solução resultante.</span><span class="sxs-lookup"><span data-stu-id="55409-147">If you plan to run more than one instance of any Office application, you should plan to isolate them at the virtual machine level to ensure the stability of the resulting solution.</span></span>

### <a name="resiliency-and-stability"></a><span data-ttu-id="55409-148">Resiliência e estabilidade</span><span class="sxs-lookup"><span data-stu-id="55409-148">Resiliency and stability</span></span>

<span data-ttu-id="55409-149">Mesmo com as considerações acima, se os aplicativos forem automatizados de maneiras de simular a entrada do usuário ou para os comprimentos da sessão que excederem drasticamente o uso interativo, poderão encontrar problemas que não estão presentes quando executado de forma interativa.</span><span class="sxs-lookup"><span data-stu-id="55409-149">Even with the considerations above, if the applications are automated in ways that simulate user input or for session lengths that dramatically exceed interactive usage, they might encounter issues that are not present when run interactively.</span></span> <span data-ttu-id="55409-150">As soluções que utilizam o Office nesse contexto devem criar mecanismos de forma proativa para monitorar o estado do aplicativo e reiniciá-los (e/ou a máquina virtual em que estão sendo executados) se/conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="55409-150">Solutions that utilize Office in this context should proactively build mechanisms to monitor the state of the application and restart them (and/or the virtual machine on which they are running) if/as needed.</span></span>

## <a name="suggested-alternatives"></a><span data-ttu-id="55409-151">Alternativas sugeridas</span><span class="sxs-lookup"><span data-stu-id="55409-151">Suggested Alternatives</span></span>

<span data-ttu-id="55409-152">A Microsoft recomenda algumas alternativas que não exigem que o Office seja instalado e execute o lado do servidor e que possa realizar tarefas comuns de forma mais eficiente e mais rápida do que a automação nessa configuração.</span><span class="sxs-lookup"><span data-stu-id="55409-152">Microsoft strongly recommends a few alternatives that do not require Office to be installed and run server-side, and that can perform common tasks more efficiently and more quickly than automation in this configuration.</span></span> <span data-ttu-id="55409-153">Antes de envolver o Office como um componente do lado do servidor em seu projeto, considere as alternativas.</span><span class="sxs-lookup"><span data-stu-id="55409-153">Before you involve Office as a server-side component in your project, consider alternatives.</span></span>

### <a name="microsoft-graph"></a><span data-ttu-id="55409-154">Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="55409-154">Microsoft Graph</span></span>

<span data-ttu-id="55409-155">A API do Microsoft Graph fornece acesso aos serviços, aos dados e à inteligência que estão disponíveis para usuários e soluções como parte da nuvem da Microsoft, incluindo vários serviços que dão suporte às necessidades de automação autônoma: acesso a emails de usuários/calendário/contatos/arquivos, conversão de documentos, cálculo de pasta de trabalho do Excel e muito mais.</span><span class="sxs-lookup"><span data-stu-id="55409-155">The Microsoft Graph API provides access to the services, data, and intelligence that are available to users and solutions as part of the Microsoft cloud, including many services supporting the needs of unattended automation: access to users’ mail / calendar / contacts / files, document conversion, Excel workbook calculation, and more.</span></span> <span data-ttu-id="55409-156">Esses serviços foram projetados para uso autônomo e acesso de alta escala e utilizam uma sintaxe de API RESTful padrão.</span><span class="sxs-lookup"><span data-stu-id="55409-156">These services are designed for unattended use and high-scale access, and utilize a standard RESTful API syntax.</span></span> <span data-ttu-id="55409-157">Para obter mais informações sobre o Microsoft Graph e como usá-lo para trabalhar com os dados dos usuários, visite o seguinte:</span><span class="sxs-lookup"><span data-stu-id="55409-157">For more information on Microsoft Graph and how to use it to work with users’ data, visit the following:</span></span>

- [<span data-ttu-id="55409-158">Visão geral do Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="55409-158">Overview of Microsoft Graph</span></span>](https://docs.microsoft.com/graph/overview) 
- [<span data-ttu-id="55409-159">Introdução ao Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="55409-159">Get started with Microsoft Graph</span></span>](https://developer.microsoft.com/graph/get-started)
- <span data-ttu-id="55409-160">[Baixar um arquivo em outro formato](https://docs.microsoft.com/graph/api/driveitem-get-content-format?view=graph-rest-1.0&tabs=http) (conversão de arquivo)</span><span class="sxs-lookup"><span data-stu-id="55409-160">[Download a file in another format](https://docs.microsoft.com/graph/api/driveitem-get-content-format?view=graph-rest-1.0&tabs=http) (file conversion)</span></span>
- <span data-ttu-id="55409-161">[Trabalhando com o Excel no Microsoft Graph](https://docs.microsoft.com/graph/api/resources/excel?view=graph-rest-1.0) (detalhes da pasta de trabalho)</span><span class="sxs-lookup"><span data-stu-id="55409-161">[Working with Excel in Microsoft Graph](https://docs.microsoft.com/graph/api/resources/excel?view=graph-rest-1.0) (workbook details)</span></span>

### <a name="open-xml-file-formats"></a><span data-ttu-id="55409-162">Formatos de arquivo Open XML</span><span class="sxs-lookup"><span data-stu-id="55409-162">Open XML file formats</span></span>

<span data-ttu-id="55409-163">Muitas tarefas de automação envolvem a criação ou edição de documentos.</span><span class="sxs-lookup"><span data-stu-id="55409-163">Many automation tasks involve document creation or editing.</span></span> <span data-ttu-id="55409-164">O Office oferece suporte a formatos de arquivo Open XML que permitem que os desenvolvedores criem, editem, leiam e transformem conteúdo de arquivo usando as tecnologias XML e ZIP padrão, definidas no ISO 29500 International Standard.</span><span class="sxs-lookup"><span data-stu-id="55409-164">Office supports Open XML file formats that let developers create, edit, read, and transform file content using standard XML and ZIP technologies, defined in the ISO 29500 International Standard.</span></span> <span data-ttu-id="55409-165">Esses formatos de arquivo podem ser manipulados por meio de ferramentas ZIP/XML, incluindo o namespace System.IO.Package.IO na estrutura do Microsoft .NET 3. x.</span><span class="sxs-lookup"><span data-stu-id="55409-165">These file formats can be manipulated via any ZIP/XML tools, including the System.IO.Package.IO namespace in the Microsoft .NET 3.x Framework.</span></span> <span data-ttu-id="55409-166">A edição direta dos formatos de arquivo é o método recomendado e com suporte para lidar com alterações em arquivos do Office de um serviço.</span><span class="sxs-lookup"><span data-stu-id="55409-166">Direct editing of the file formats is the recommended and supported method for handling changes to Office files from a service.</span></span>

<span data-ttu-id="55409-167">A Microsoft fornece um SDK para manipular formatos de arquivo Open XML da estrutura do .NET 3. x.</span><span class="sxs-lookup"><span data-stu-id="55409-167">Microsoft provides an SDK for manipulating Open XML file formats from the .NET 3.x Framework.</span></span> <span data-ttu-id="55409-168">Para obter mais informações sobre o SDK e como usar o SDK para criar ou editar arquivos Open XML, visite o seguinte:</span><span class="sxs-lookup"><span data-stu-id="55409-168">For more information about the SDK and how to use the SDK to create or edit Open XML files, visit the following:</span></span>

- [<span data-ttu-id="55409-169">Noções básicas sobre os formatos de arquivo XML abertos</span><span class="sxs-lookup"><span data-stu-id="55409-169">Understanding the Open XML file formats</span></span>](https://docs.microsoft.com/office/open-xml/understanding-the-open-xml-file-formats)
- [<span data-ttu-id="55409-170">Bem-vindo ao Open XML SDK 2,5 para Office</span><span class="sxs-lookup"><span data-stu-id="55409-170">Welcome to the Open XML SDK 2.5 for Office</span></span>](https://docs.microsoft.com/office/open-xml/open-xml-sdk)
