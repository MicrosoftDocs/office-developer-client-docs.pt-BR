---
title: Detalhes do HelloData (referência do banco de dados da área de trabalho do Access)
TOCTitle: HelloData details
ms:assetid: db51e15c-1b5b-c64a-2f84-34dd0e78c6cf
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250105(v=office.15)
ms:contentKeyID: 48548103
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 78b04b74d4e2b8d9c215235d6e7ccebed4fa2ef2
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32291996"
---
# <a name="hellodata-details"></a><span data-ttu-id="e95f1-102">Detalhes do HelloData</span><span class="sxs-lookup"><span data-stu-id="e95f1-102">HelloData details</span></span>


<span data-ttu-id="e95f1-103">**Aplica-se ao:** Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="e95f1-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="e95f1-p101">O aplicativo HelloData passa por todas as operações básicas de um aplicativo típico do ADO: obter, examinar, editar e atualizar dados. Ao iniciar o aplicativo, clique no primeiro botão, **Get Data**. Isso executará a sub-rotina GetData().</span><span class="sxs-lookup"><span data-stu-id="e95f1-p101">The HelloData application steps through the basic operations of a typical ADO application: getting, examining, editing, and updating data. When you start the application, click the first button, **Get Data**. This will run the GetData() subroutine.</span></span>

## <a name="getdata"></a><span data-ttu-id="e95f1-107">GetData</span><span class="sxs-lookup"><span data-stu-id="e95f1-107">GetData</span></span>

<span data-ttu-id="e95f1-108">GetData coloca uma sequência de conexão válida em uma variável de nível de módulo, *m \_ sConnStr*.</span><span class="sxs-lookup"><span data-stu-id="e95f1-108">GetData places a valid connection string into a module-level variable, *m\_sConnStr*.</span></span> <span data-ttu-id="e95f1-109">Para obter mais informações sobre sequências de conexão, consulte [Criando a sequência de conexão](creating-the-connection-string.md).</span><span class="sxs-lookup"><span data-stu-id="e95f1-109">For more information about connection strings, see [Creating the Connection String](creating-the-connection-string.md).</span></span>

<span data-ttu-id="e95f1-p103">Use uma instrução **OnError** do Visual Basic para atribuir um manipular de erros. Para obter mais informações sobre o tratamento de erros no ADO, consulte o [Capítulo 6: tratamento de erros](chapter-6-error-handling.md). Um novo objeto **Connection** é criado e a propriedade **CursorLocation** é definida como **adUseClient**, pois o exemplo HelloData cria um *Recordset desconectado*. Isto significa que depois que os dados forem encontrados na fonte de dados, a conexão física com a fonte de dados será interrompida, mas você poderá continuar trabalhando com os dados, que serão armazenados localmente em cache no seu objeto **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="e95f1-p103">Assign an error handler using a Visual Basic **OnError** statement. For more information about error handling in ADO, see [Chapter 6: Error Handling](chapter-6-error-handling.md). A new **Connection** object is created, and the **CursorLocation** property is set to **adUseClient** because the HelloData example creates a *disconnected Recordset*. This means that once the data has been fetched from the data source, the physical connection with the data source is broken, but you can still work with the data that is cached locally in your **Recordset** object.</span></span>

<span data-ttu-id="e95f1-114">Depois que a conexão for aberta, atribua uma cadeia de caracteres SQL a uma variável (sSQL).</span><span class="sxs-lookup"><span data-stu-id="e95f1-114">After the connection has been opened, assign a SQL string to a variable (sSQL).</span></span> <span data-ttu-id="e95f1-115">Em seguida, insinue um novo **objeto Recordset,** m \_ oRecordset1 .</span><span class="sxs-lookup"><span data-stu-id="e95f1-115">Then instantiate a new **Recordset** object, m\_oRecordset1 .</span></span> <span data-ttu-id="e95f1-116">Na próxima linha de código, abra **o Recordset** sobre a **conexão existente,** passando.</span><span class="sxs-lookup"><span data-stu-id="e95f1-116">In the next line of code, open the **Recordset** over the existing **Connection**, passing in .</span></span> <span data-ttu-id="e95f1-117">Na próxima linha de código, abra **o Recordset** sobre o **Connection** existente , passando sSQL como a origem do **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="e95f1-117">In the next line of code, open the **Recordset** over the existing **Connection**, passing in sSQL as the source of the **Recordset**.</span></span> <span data-ttu-id="e95f1-118">Para ajudar o ADO a determinar que a cadeia de caracteres SQL que você passou como fonte de **Recordset** é uma definição textual de um comando, você passará **adCmdText** no argumento final do método **Open** de **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="e95f1-118">You assist ADO in making the determination that the SQL string you have passed as the source for the **Recordset** is a textual definition of a command by passing **adCmdText** in the final argument to the **Recordset** **Open** method.</span></span> <span data-ttu-id="e95f1-119">Essa linha também define o **LockType** e o **CursorType** associados ao **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="e95f1-119">This line also sets the **LockType** and **CursorType** associated with the **Recordset**.</span></span>

<span data-ttu-id="e95f1-120">A próxima linha do código iguala as propriedades **MarshalOptions** e **adMarshalModifiedOnly**.</span><span class="sxs-lookup"><span data-stu-id="e95f1-120">The next line of code sets the **MarshalOptions** property equal to **adMarshalModifiedOnly**.</span></span> <span data-ttu-id="e95f1-121">**MarshalOptions** indica quais registros devem ser empacotados para a camada intermediária (ou servidor Web).</span><span class="sxs-lookup"><span data-stu-id="e95f1-121">**MarshalOptions** indicates which records should be marshaled to the middle tier (or web server).</span></span> <span data-ttu-id="e95f1-122">Para obter mais informações sobre o empacotamento, consulte a documentação do COM.</span><span class="sxs-lookup"><span data-stu-id="e95f1-122">For more information about marshaling, see the COM documentation.</span></span> <span data-ttu-id="e95f1-123">Ao usar **adMarshalModifiedOnly** com um cursor do lado do cliente ([CursorLocation](cursorlocation-property-ado.md)  =  **adUseClient**), somente os registros que foram modificados no cliente são gravados de volta na camada intermediária.</span><span class="sxs-lookup"><span data-stu-id="e95f1-123">When using **adMarshalModifiedOnly** with a client-side cursor ([CursorLocation](cursorlocation-property-ado.md) = **adUseClient**), only records that have been modified on the client are written back to the middle tier.</span></span> <span data-ttu-id="e95f1-124">Definir **MarshalOptions** como **adMarshalModifiedOnly** pode melhorar o desempenho, pois menos linhas são empacotadas.</span><span class="sxs-lookup"><span data-stu-id="e95f1-124">Setting **MarshalOptions** to **adMarshalModifiedOnly** can improve performance because fewer rows are marshaled.</span></span>

<span data-ttu-id="e95f1-p106">Em seguida, desconecte o **Recordset** igualando as propriedades **ActiveConnection** e **Nothing**. Para obter mais informações, consulte [Desconectando e reconectando o Recordset](disconnecting-and-reconnecting-the-recordset.md) no Capítulo 5: atualizando e mantendo a persistência de dados.</span><span class="sxs-lookup"><span data-stu-id="e95f1-p106">Next, disconnect the **Recordset** by setting its **ActiveConnection** property equal to **Nothing**. For more information, see [Disconnecting and Reconnecting the Recordset](disconnecting-and-reconnecting-the-recordset.md) in Chapter 5: Updating and Persisting Data.</span></span>

<span data-ttu-id="e95f1-127">Feche a conexão com a fonte de dados e destrua o objeto **Connection** existente para liberar os recursos que ele consumia.</span><span class="sxs-lookup"><span data-stu-id="e95f1-127">Close the connection to the data source and destroy the existing **Connection** object, thereby releasing the resources it consumed.</span></span>

<span data-ttu-id="e95f1-128">A etapa final é definir o **Recordset** como **DataSource** para o Microsoft DataBound Grid Control no formulário, de modo que você possa exibir facilmente os dados do **Recordset** no formulário.</span><span class="sxs-lookup"><span data-stu-id="e95f1-128">The final step is to set the **Recordset** as the **DataSource** for the Microsoft DataBound Grid Control on the form so that you can easily display the data from the **Recordset** on the form.</span></span>

<span data-ttu-id="e95f1-p107">Clique no segundo botão, **Examine Data**. Isso executará a sub-rotina ExamineData.</span><span class="sxs-lookup"><span data-stu-id="e95f1-p107">Click the second button, **Examine Data**. This runs the ExamineData subroutine.</span></span>

## <a name="examinedata"></a><span data-ttu-id="e95f1-131">ExamineData</span><span class="sxs-lookup"><span data-stu-id="e95f1-131">ExamineData</span></span>

<span data-ttu-id="e95f1-p108">ExamineData utiliza vários métodos e propriedades do objeto **Recordset** para exibir informações sobre os dados do **Recordeset**. Para relatar o número de registros, ela usa a propriedade **RecordCount**. Ela executa um loop por meio do **Recordset** e imprime o valor da propriedade **AbsolutePosition** na caixa de exibição de texto do formulário. Além disso, ainda durante o loop, o valor da propriedade **Bookmark** do terceiro registro é colocado em uma variável variante, *vBookmark*, para uso posterior.</span><span class="sxs-lookup"><span data-stu-id="e95f1-p108">ExamineData uses various methods and properties of the **Recordset** object to display information about the data in the **Recordset**. It reports the number of records by using the **RecordCount** property. It loops through the **Recordset** and prints the value of the **AbsolutePosition** property in the display text box on the form. Also while in the loop, the value of the **Bookmark** property for the third record is placed into a variant variable, *vBookmark*, for later use.</span></span>

<span data-ttu-id="e95f1-p109">A rotina navega diretamente de volta ao terceiro registro usando a variável indicadora que a armazenou antes. A rotina chama a sub-rotina WalkFields, que executa um loop por meio da coleção **Fields** do **Recordset** e exibe detalhes de cada **Field** existente na coleção.</span><span class="sxs-lookup"><span data-stu-id="e95f1-p109">The routine navigates directly back to the third record using the bookmark variable that it stored earlier. The routine calls the WalkFields subroutine, which loops through the **Fields** collection of the **Recordset** and displays details about each **Field** in the collection.</span></span>

<span data-ttu-id="e95f1-p110">Finalmente, ExamineData usa a propriedade **Filter** do **Recordset** para filtrar exclusivamente os registros com CategoryId igual a 2. O resultado da aplicação desse filtro é imediatamente visível na grade de exibição do formulário.</span><span class="sxs-lookup"><span data-stu-id="e95f1-p110">Finally, ExamineData uses the **Filter** property of the **Recordset** to screen for only those records with a CategoryId equal to 2. The result of applying this filter is immediately visible in the display grid on the form.</span></span>

<span data-ttu-id="e95f1-140">Para obter mais informações sobre a funcionalidade mostrada na sub-rotina ExamineData, consulte o [Capítulo 3: examinando dados](chapter-3-examining-data.md).</span><span class="sxs-lookup"><span data-stu-id="e95f1-140">For more information about the functionality shown in the ExamineData subroutine, see [Chapter 3: Examining Data](chapter-3-examining-data.md).</span></span>

<span data-ttu-id="e95f1-p111">Em seguida, clique no terceiro botão, **Edit Data**. Isso executará a sub-rotina EditData.</span><span class="sxs-lookup"><span data-stu-id="e95f1-p111">Next, click the third button, **Edit Data**. This will run the EditData subroutine.</span></span>

## <a name="editdata"></a><span data-ttu-id="e95f1-143">EditData</span><span class="sxs-lookup"><span data-stu-id="e95f1-143">EditData</span></span>

<span data-ttu-id="e95f1-p112">Quando o código chega à sub-rotina EditData, o **Recordset** ainda está filtrado com base em CategoryId igual a 2 e, portanto, somente os itens que atendem aos critérios do filtro estão visíveis. Inicialmente, o código executa um loop por meio do **Recordset** e aumenta o preço de cada item visível do **Recordset** em 10%. Para mudar o valor do campo **Price**, a propriedade **Value** desse campo deve ser definida como igual a uma nova quantia válida.</span><span class="sxs-lookup"><span data-stu-id="e95f1-p112">When the code enters the EditData subroutine, the **Recordset** is still filtered on CategoryId equal to 2, so only those items that meet the filter criteria are visible. It first loops through the **Recordset** and increases the price of each visible item in the **Recordset** by 10 percent. The value of the **Price** field is changed by setting the **Value** property for that field equal to a new, valid amount.</span></span>

<span data-ttu-id="e95f1-p113">Lembre-se de que o **Recordset** está desconectado da fonte de dados. As alterações feitas em EditData afetam somente a cópia dos dados armazenada no cache local. Para obter mais informações, consulte o [Capítulo 4: editando dados](chapter-4-editing-data.md).</span><span class="sxs-lookup"><span data-stu-id="e95f1-p113">Remember that the **Recordset** is disconnected from the data source. The changes made in EditData are made only to the locally cached copy of the data. For more information, see [Chapter 4: Editing Data](chapter-4-editing-data.md).</span></span>

<span data-ttu-id="e95f1-p114">As alterações só serão aplicadas à fonte de dados quando você clicar no quarto botão, **Update Data**. Isso executará a sub-rotina UpdateData.</span><span class="sxs-lookup"><span data-stu-id="e95f1-p114">The changes will not be made on the data source until you click the fourth button, **Update Data**. This will run the UpdateData subroutine.</span></span>

## <a name="updatedata"></a><span data-ttu-id="e95f1-152">UpdateData</span><span class="sxs-lookup"><span data-stu-id="e95f1-152">UpdateData</span></span>

<span data-ttu-id="e95f1-153">Inicialmente, UpdateData remove o filtro que foi aplicado ao **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="e95f1-153">UpdateData first removes the filter that has been applied to the **Recordset**.</span></span> <span data-ttu-id="e95f1-154">O código remove e redefine como **o DataSource** para o Microsoft Bound DataGrid no formulário para que o **Recordset** não filtrado apareça na grade.</span><span class="sxs-lookup"><span data-stu-id="e95f1-154">The code removes and resets as the **DataSource** for the Microsoft Bound DataGrid on the form so that the unfiltered **Recordset** appears in the grid.</span></span>

<span data-ttu-id="e95f1-155">Em seguida, o código verifica se você pode retroceder no **Recordset** usando o método **Supports** com o argumento **adMovePrevious**.</span><span class="sxs-lookup"><span data-stu-id="e95f1-155">The code then checks to see whether you can move backward in the **Recordset** by using the **Supports** method with the **adMovePrevious** argument.</span></span>

<span data-ttu-id="e95f1-p116">A rotina move-se para o primeiro registro usando o método **MoveFirst** e exibe os valores original e atual do campo usando as propriedades **OriginalValue** e **Value** do objeto **Field**. Essas propriedades, juntamente com a propriedade **UnderlyingValue** (não utilizada aqui), são discutidas no [Capítulo 5: atualizando e mantendo a persistência de dados](chapter-5-updating-and-persisting-data.md).</span><span class="sxs-lookup"><span data-stu-id="e95f1-p116">The routine moves to the first record using the **MoveFirst** method and displays the field's original and current values, using the **OriginalValue** and **Value** properties of the **Field** object. These properties, along with the **UnderlyingValue** property (not used here), are discussed in [Chapter 5: Updating and Persisting Data](chapter-5-updating-and-persisting-data.md).</span></span>

<span data-ttu-id="e95f1-p117">Em seguida, um novo objeto **Connection** é criado e usado para restabelecer uma conexão com a fonte de dados. Para reconectar o **Recordset** à fonte de dados, o novo **Connection** é definido como **ActiveConnection** no **Recordset**. Para enviar as atualizações para o servidor, o código chama o método **UpdateBatch** no **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="e95f1-p117">Next, a new **Connection** object is created and used to reestablish a connection to the data source. You reconnect the **Recordset** to the data source by setting the new **Connection** as the **ActiveConnection** for the **Recordset**. To send the updates to the server, the code calls **UpdateBatch** on the **Recordset**.</span></span>

<span data-ttu-id="e95f1-161">Se a atualização em lotes for bem-sucedida, uma variável de sinalizador de nível de módulo será definida como True.</span><span class="sxs-lookup"><span data-stu-id="e95f1-161">If the batch update succeeds, a module-level flag variable, , is set to True.</span></span> <span data-ttu-id="e95f1-162">Mais adiante, isto servirá para lembrá-lo de limpar todas as alterações feitas no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e95f1-162">This will remind you later to clean up all changes made to the database.</span></span>

<span data-ttu-id="e95f1-p119">Finalmente, o código volta ao primeiro registro do **Recordset** e exibe os valores originais e atuais. Os valores são os mesmos após a chamada de **UpdateBatch**.</span><span class="sxs-lookup"><span data-stu-id="e95f1-p119">Finally, the code moves back to the first record in the **Recordset** and displays the original and current values. The values are the same after the call to **UpdateBatch**.</span></span>

<span data-ttu-id="e95f1-165">Para obter informações mais detalhadas sobre a atualização de dados, inclusive o que fazer se os dados no servidor forem alterados enquanto o seu **Recordset** estiver desconectado, consulte o [Capítulo 5: atualizando e mantendo a persistência de dados](chapter-5-updating-and-persisting-data.md).</span><span class="sxs-lookup"><span data-stu-id="e95f1-165">For more detailed information about updating data, including what to do when data on the server changes while your **Recordset** is disconnected, see [Chapter 5: Updating and Persisting Data](chapter-5-updating-and-persisting-data.md).</span></span>

## <a name="form_unload"></a><span data-ttu-id="e95f1-166">Descarregar \_ Formulário</span><span class="sxs-lookup"><span data-stu-id="e95f1-166">Form\_Unload</span></span>

<span data-ttu-id="e95f1-167">A \_ sub-rotina Descarregar Formulário é importante por vários motivos.</span><span class="sxs-lookup"><span data-stu-id="e95f1-167">The Form\_Unload subroutine is important for several reasons.</span></span> <span data-ttu-id="e95f1-168">Primeiro, como este é um aplicativo de exemplo, o Form Unload limpa as alterações feitas no banco de dados \_ antes de o aplicativo sair.</span><span class="sxs-lookup"><span data-stu-id="e95f1-168">First, because this is a sample application, Form\_Unload cleans up the changes made to the database before the application exits.</span></span> <span data-ttu-id="e95f1-169">Em segundo lugar, o código mostra como o método **Execute** pode ser usado para executar um comando diretamente a partir de um objeto **Connection** aberto.</span><span class="sxs-lookup"><span data-stu-id="e95f1-169">Second, the code shows how a command can be executed directly from an open **Connection** object using the **Execute** method.</span></span> <span data-ttu-id="e95f1-170">Finalmente, ele mostra um exemplo da execução de uma consulta à fonte de dados sem retorno de linhas (uma consulta UPDATE).</span><span class="sxs-lookup"><span data-stu-id="e95f1-170">Finally, it shows an example of executing a non-row–returning query (an UPDATE query) against the data source.</span></span>

