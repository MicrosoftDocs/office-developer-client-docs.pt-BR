---
title: Outras formas de movimentação em um conjunto de registros
TOCTitle: More ways to move in a Recordset
ms:assetid: ae49b20e-0050-c44b-67e9-7e39de5098c4
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249822(v=office.15)
ms:contentKeyID: 48547067
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 2d10a493aac39934a047c6fa311233fd6c9fac4e
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288859"
---
# <a name="more-ways-to-move-in-a-recordset"></a><span data-ttu-id="87072-102">Outras formas de movimentação em um conjunto de registros</span><span class="sxs-lookup"><span data-stu-id="87072-102">More ways to move in a Recordset</span></span>

<span data-ttu-id="87072-103">**Aplica-se ao:** Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="87072-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="87072-p101">Os seguintes métodos são usados para se mover em torno de ou para rolar em um objeto **Recordset**: [MoveFirst, MoveLast, MoveNext e MovePrevious](movefirst-movelast-movenext-and-moveprevious-methods-ado.md). (Alguns desses métodos não estão disponíveis em cursores apenas de avanço.)</span><span class="sxs-lookup"><span data-stu-id="87072-p101">The following four methods are used to move around, or scroll, in the **Recordset**: [MoveFirst, MoveLast, MoveNext, and MovePrevious](movefirst-movelast-movenext-and-moveprevious-methods-ado.md). (Some of these methods are unavailable on forward-only cursors.)</span></span>

<span data-ttu-id="87072-p102">**MoveFirst** transfere a posição de registro atual para o primeiro registro no **Recordset**. **MoveLast** transfere a posição de registro atual para o último registro no **Recordset**. Para usar **MoveFirst** ou **MoveLast**, o objeto **Recordset** deve oferecer suporte a marcadores ou a movimentação de cursor para trás; caso contrário, o método gerará um erro.</span><span class="sxs-lookup"><span data-stu-id="87072-p102">**MoveFirst** changes the current record position to the first record in the **Recordset**. **MoveLast** changes the current record position to the last record in the **Recordset**. To use **MoveFirst** or **MoveLast**, the **Recordset** object must support bookmarks or backward cursor movement; otherwise, the method call will generate an error.</span></span>

<span data-ttu-id="87072-p103">**MoveNext** move o registro atual uma posição para frente. Se você estiver no último registro quando chamar **MoveNext**, **EOF** será definida como **True**. **MovePrevious** move o registro atual uma posição para trás. Se você estiver no primeiro registro quando chamar **MovePrevious**, **BOF** será definida como **True**. É recomendável verificar as propriedades **EOF** e **BOF** ao usar esses métodos e mover o cursor para trás até uma posição de registro atual válida caso se mova para fora de do **Recordset**, conforme mostrado aqui:</span><span class="sxs-lookup"><span data-stu-id="87072-p103">**MoveNext** moves the current record position one place forward. If you are on the last record when you call **MoveNext**, **EOF** will be set to **True**. **MovePrevious** moves the current record position one place backward. If you are on the first record when you call **MovePrevious**, **BOF** will be set to **True**. It is wise to check the **EOF** and **BOF** properties when using these methods and to move the cursor back to a valid current record position if you move off either end of the **Recordset**, as shown here:</span></span>

```vb
. . . 
oRs.MoveNext 
If oRs.EOF Then oRs.MoveLast 
. . . 
```

<span data-ttu-id="87072-114">Ou, no caso do método **MovePrevious**:</span><span class="sxs-lookup"><span data-stu-id="87072-114">Or, in the case of the **MovePrevious** method:</span></span>

```vb
. . . 
oRs.MovePrevious 
If oRs.BOF Then oRs.MoveFirst 
. . . 
```

<span data-ttu-id="87072-115">Nos casos em que o **Recordset** foi filtrado ou classificado e os dados do registro atual forem alterados, a posição também pode ser alterada.</span><span class="sxs-lookup"><span data-stu-id="87072-115">In cases where the **Recordset** has been filtered or sorted and the current record's data is changed, the position may also change.</span></span> <span data-ttu-id="87072-116">Nesses casos, o método **MoveNext** funciona normalmente, mas esteja ciente de que a posição é movida um registro para a frente a partir da nova posição, não da posição antiga.</span><span class="sxs-lookup"><span data-stu-id="87072-116">In such cases the **MoveNext** method works normally, but be aware that the position is moved one record forward from the new position, not the old position.</span></span> <span data-ttu-id="87072-117">Por exemplo, alterar os dados no registro atual, de modo que o registro seja movido para o final do conjunto de **registros**classificados, significa que a chamada de **MoveNext** resultará no ADO definindo o registro atual como a posição após o último registro **da Recordset** (**EOF** = **true**).</span><span class="sxs-lookup"><span data-stu-id="87072-117">For example, changing the data in the current record, such that the record is moved to the end of the sorted **Recordset**, would mean that calling **MoveNext** results in ADO setting the current record to the position after the last record in the **Recordset** (**EOF** = **True**).</span></span>

<span data-ttu-id="87072-p105">O comportamento de vários métodos Move do objeto **Recordset** depende, de alguma forma, dos dados no **Recordset**. Os novos registros adicionados ao **Recordset** são inicialmente adicionados em uma ordem específica, que é definida pela fonte de dados e pode ser dependente, de forma implícita ou explícita, dos dados no novo registro. Por exemplo, se uma classificação ou junção for feita dentro da consulta que popula o **Recordset**, o novo registro será inserido no local apropriado dentro do **Recordset**. Se a ordem não estiver especificada de forma clara na criação do **Recordset**, as alterações na implementação da fonte de dados podem modificar a ordem das linhas retornadas inadvertidamente. Além disso, as funções de classificação, filtragem e edição do **Recordset** podem afetar a ordem e possivelmente a visibilidade de algumas linhas no Recordset.</span><span class="sxs-lookup"><span data-stu-id="87072-p105">The behavior of the various Move methods of the **Recordset** object depends, to some extent, on the data within the **Recordset**. New records added to the **Recordset** are initially added in a particular order, which is defined by the data source and may be dependent implicitly or explicitly on the data in the new record. For example, if a sort or a join is done within the query that populates the **Recordset**, the new record will be inserted in the appropriate place within the **Recordset**. If ordering is not explicitly specified when creating the **Recordset**, changes in the data source implementation may cause the ordering of the returned rows to change inadvertently. In addition, the sorting, filtering, and editing functions of the **Recordset** can affect the order and possibly which rows in the recordset will be visible.</span></span>

<span data-ttu-id="87072-p106">Portanto, **MoveNext**, **MovePrevious**, **MoveFirst**, **MoveLast** e **Move** são todos afetados por outras operações executadas no mesmo **Recordset**. O ADO sempre tentará manter sua posição atual até que você explicitamente mova-o, mas algumas vezes essas interferências dificultam o entendimento dos efeitos de uma movimentação subsequente. Por exemplo, se chamar **MoveFirst** para uma posição na primeira linha de um **Recordset** classificado da forma crescente para a decrescente, você ainda estará na mesma linha  mas agora ela será a última linha no **Recordset**. **MoveFirst** o levará a uma linha diferente (a nova primeira linha).</span><span class="sxs-lookup"><span data-stu-id="87072-p106">Therefore, **MoveNext**, **MovePrevious**, **MoveFirst**, **MoveLast**, and **Move** are all sensitive to other operations performed on the same **Recordset**. ADO will always try to maintain your current position until you explicitly move it, but sometimes intervening changes make it difficult to understand the effects of a subsequent move. For example, if you call **MoveFirst** to position on the first row of a sorted **Recordset** and you change the sort from ascending order to descending order, you are still on the same row — but now it is the last row in the **Recordset**. **MoveFirst** will take you to a different row (the new first row).</span></span>

<span data-ttu-id="87072-p107">Como outro exemplo, se estiver posicionado em uma linha específica no meio de um **Recordset** e chamar **Delete** e, em seguida, chamar **MoveNext**, você agora estará posicionado no registro seguinte ao registro excluído. Mas chamar **MovePrevious** torna o registro anterior ao excluído o registro atual, porque o registro excluído não é mais contado na associação ativa do **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="87072-p107">As another example, if you are positioned on a particular row in the middle of a **Recordset** and you call **Delete** and then call **MoveNext**, you are now on the record immediately following the deleted record. But calling **MovePrevious** makes the record preceding the one you deleted the current record, because the deleted record is no longer counted in the active membership of the **Recordset**.</span></span>

<span data-ttu-id="87072-p108">É especialmente difícil definir de forma consistente a semântica de movimentação pelos provedores de métodos que se movem de forma relativa ao registro atual — **MovePrevious**, **MoveNext** e **Move** — diante da alteração de dados no registro atual. Por exemplo, se você estiver trabalhando com um **Recordset** e alterar os dados no registro atual de forma que ele preceda todos os outros registros, mas os dados alterados não mais corresponderem ao filtro, não fica muito claro onde uma operação **MoveNext** poderá levá-lo. A conclusão mais segura é que o movimento relativo dentro do **Recordset** é mais arriscado do que o movimento absoluto (como usar **MoveFirst** ou **MoveLast**) quando os dados estiverem sendo modificados enquanto os registros forem editados, adicionados ou excluídos. A classificação e a filtragem devem ter como base a identificação ou a chave primária, porque esse tipo de valor não deve ser alterado.</span><span class="sxs-lookup"><span data-stu-id="87072-p108">It is particularly difficult to define consistent move semantics across all providers for methods that move relative to the current record — **MovePrevious**, **MoveNext**, and **Move** — in the face of changing data in the current record. For example, if you are working with a sorted, filtered **Recordset**, and you change the data in the current record so that it would precede all other records, but your changed data also no longer matches the filter, it is not clear where a **MoveNext** operation should take you. The safest conclusion is that relative movement within a **Recordset** is riskier than absolute movement (such as using **MoveFirst** or **MoveLast**) when the data is changing while records are being edited, added, or deleted. Sorting and filtering should be based on a primary key or ID, because this type of value should not change.</span></span>

