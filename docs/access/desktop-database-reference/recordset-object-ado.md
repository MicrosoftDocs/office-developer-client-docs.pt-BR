---
title: Objeto Recordset (ADO)
TOCTitle: Recordset object (ADO)
ms:assetid: 0f963bf8-f066-dc8a-b754-f427de712df1
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248865(v=office.15)
ms:contentKeyID: 48543267
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 636681cf8e0c20f078387b21974141a9cb66cfcd
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: Auto
ms.contentlocale: pt-BR
ms.lasthandoff: 01/17/2019
ms.locfileid: "28719992"
---
# <a name="recordset-object-ado"></a><span data-ttu-id="2507b-102">Objeto Recordset (ADO)</span><span class="sxs-lookup"><span data-stu-id="2507b-102">Recordset object (ADO)</span></span>

<span data-ttu-id="2507b-103">**Aplica-se a**: Access 2013, o Office 2013</span><span class="sxs-lookup"><span data-stu-id="2507b-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="2507b-p101">Representa o conjunto completo de registros de uma tabela base ou os resultados de um comando executado. Sempre que for adequado, o objeto **Recordset** fará referência somente a um único registro do conjunto como o registro atual.</span><span class="sxs-lookup"><span data-stu-id="2507b-p101">Represents the entire set of records from a base table or the results of an executed command. At any time, the **Recordset** object refers to only a single record within the set as the current record.</span></span>

## <a name="remarks"></a><span data-ttu-id="2507b-106">Comentários</span><span class="sxs-lookup"><span data-stu-id="2507b-106">Remarks</span></span>

<span data-ttu-id="2507b-p102">Use os objetos **Recordset** para manipular os dados de um provedor. Quando você usa o ADO, manipula os dados de forma quase completa usando os objetos **Recordset**. Todos os objetos **Recordset** são compostos de registros (linhas) e campos (colunas). Dependendo da funcionalidade suportada pelo provedor, alguns métodos ou propriedades **Recordset** podem não estar disponíveis.</span><span class="sxs-lookup"><span data-stu-id="2507b-p102">You use **Recordset** objects to manipulate data from a provider. When you use ADO, you manipulate data almost entirely using **Recordset** objects. All **Recordset** objects consist of records (rows) and fields (columns). Depending on the functionality supported by the provider, some **Recordset** methods or properties may not be available.</span></span>

<span data-ttu-id="2507b-p103">ADODB.Recordset é o ProgID que deve ser usado para criar um objeto **Recordset**. Os aplicativos existentes que fazem referência ao ADOR.Recordset ProgID desatualizado continuarão funcionando sem recompilação, mas o novo desenvolvimento deverá fazer referência ao ADODB.Recordset.</span><span class="sxs-lookup"><span data-stu-id="2507b-p103">ADODB.Recordset is the ProgID that should be used to create a **Recordset** object. Existing applications that reference the outdated ADOR.Recordset ProgID will continue to work without recompiling, but new development should reference ADODB.Recordset.</span></span>

<span data-ttu-id="2507b-113">Existem quatro tipos de cursores diferentes definidos no ADO:</span><span class="sxs-lookup"><span data-stu-id="2507b-113">There are four different cursor types defined in ADO:</span></span>

  - <span data-ttu-id="2507b-114">**Cursor dinâmico**  possibilita a exibição de adições, alterações e exclusões de outros usuários; permite todos os tipos de movimento por meio do **Recordset** que não conta com indicadores e aceita indicadores se o provedor oferecer suporte.</span><span class="sxs-lookup"><span data-stu-id="2507b-114">**Dynamic cursor** — allows you to view additions, changes, and deletions by other users; allows all types of movement through the **Recordset** that doesn't rely on bookmarks; and allows bookmarks if the provider supports them.</span></span>

  - <span data-ttu-id="2507b-p104">**Cursor controlado por conjuntos de chaves**  se comporta como um cursor dinâmico, exceto pelo fato de impedir que você veja os registros adicionados por outros usuários e não permitir o acesso aos registros excluídos por outros usuários. As alterações de dados feitas por outros usuários permanecerão visíveis. Oferece suporte para indicadores e, por esse motivo, possibilita todos os tipos de movimento por meio do **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="2507b-p104">**Keyset cursor** — behaves like a dynamic cursor, except that it prevents you from seeing records that other users add, and prevents access to records that other users delete. Data changes by other users will still be visible. It always supports bookmarks and therefore allows all types of movement through the **Recordset**.</span></span>

  - <span data-ttu-id="2507b-p105">**Cursor estático**  fornece uma cópia estática do conjunto de registros usado para localizar dados ou gerar relatórios; sempre aceita indicadores e, por esse motivo, permite todos os tipos de movimento por meio do **Recordset**. Não serão visíveis adições, alterações ou exclusões dos outros usuários. Este será o único tipo de cursor permitido quando você abrir o objeto **Recordset** do cliente.</span><span class="sxs-lookup"><span data-stu-id="2507b-p105">**Static cursor** — provides a static copy of a set of records for you to use to find data or generate reports; always allows bookmarks and therefore allows all types of movement through the **Recordset**. Additions, changes, or deletions by other users will not be visible. This is the only type of cursor allowed when you open a client-side **Recordset** object.</span></span>

  - <span data-ttu-id="2507b-p106">**Cursor apenas de avanço**  permite somente o avanço do **Recordset**. Não serão visíveis adições, alterações ou exclusões dos outros usuários. Isso melhora o desempenho em situações nas quais você precisar fazer somente uma única passagem em um **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="2507b-p106">**Forward-only cursor** — allows you to only scroll forward through the **Recordset**. Additions, changes, or deletions by other users will not be visible. This improves performance in situations where you need to make only a single pass through a **Recordset**.</span></span>

<span data-ttu-id="2507b-124">Defina a propriedade [CursorType](cursortype-property-ado.md) antes de abrir o **Recordset** para escolher o tipo de cursor ou passar um argumento *CursorType* com o método [Open](open-method-ado-recordset.md) .</span><span class="sxs-lookup"><span data-stu-id="2507b-124">Set the [CursorType](cursortype-property-ado.md) property prior to opening the **Recordset** to choose the cursor type, or pass a *CursorType* argument with the [Open](open-method-ado-recordset.md) method.</span></span> <span data-ttu-id="2507b-125">Alguns provedores não suportam todos os tipos de cursores.</span><span class="sxs-lookup"><span data-stu-id="2507b-125">Some providers don't support all cursor types.</span></span> <span data-ttu-id="2507b-126">Verifique a documentação do provedor.</span><span class="sxs-lookup"><span data-stu-id="2507b-126">Check the documentation for the provider.</span></span> <span data-ttu-id="2507b-127">Se você não especificar um tipo de cursor, o ADO abrirá o cursor apenas de avanço por padrão.</span><span class="sxs-lookup"><span data-stu-id="2507b-127">If you don't specify a cursor type, ADO opens a forward-only cursor by default.</span></span>

<span data-ttu-id="2507b-p108">Se a propriedade [CursorLocation](cursorlocation-property-ado.md) está definida como **adUseClient** para abrir um **Recordset**, a propriedade **UnderlyingValue** nos objetos [Field](field-object-ado.md) não estará disponível no objeto **Recordset** retornado. Quando usada com alguns provedores (como o Microsoft ODBC Provider for OLE DB em conjunto com o Microsoft SQL Server), permite criar objetos **Recordset** de forma independente de um objeto [Connection](connection-object-ado.md) definido anteriormente por meio da passagem de uma sequência de conexão com o método **Open**. O ADO ainda criará um objeto [Connection](connection-object-ado.md), mas não atribuirá esse objeto a uma variável de objeto. No entanto, se você está abrindo vários objetos **Recordset** na mesma conexão, deverá criar e abrir, de forma explícita, um objeto **Connection**; isso atribuirá o objeto **Connection** a uma variável de objeto. Se você não usar essa variável de objeto ao abrir os objetos **Recordset**, o ADO criará um novo objeto **Connection** para cada novo **Recordset**, ainda que você passe a mesma sequência de conexão.</span><span class="sxs-lookup"><span data-stu-id="2507b-p108">If the [CursorLocation](cursorlocation-property-ado.md) property is set to **adUseClient** to open a **Recordset**, the **UnderlyingValue** property on [Field](field-object-ado.md) objects is not available in the returned **Recordset** object. When used with some providers (such as the Microsoft ODBC Provider for OLE DB in conjunction with Microsoft SQL Server), you can create **Recordset** objects independently of a previously defined [Connection](connection-object-ado.md) object by passing a connection string with the **Open** method. ADO still creates a [Connection](connection-object-ado.md) object, but it doesn't assign that object to an object variable. However, if you are opening multiple **Recordset** objects over the same connection, you should explicitly create and open a **Connection** object; this assigns the **Connection** object to an object variable. If you do not use this object variable when opening your **Recordset** objects, ADO creates a new **Connection** object for each new **Recordset**, even if you pass the same connection string.</span></span>

<span data-ttu-id="2507b-133">Crie quantos objetos **Recordset** forem necessários.</span><span class="sxs-lookup"><span data-stu-id="2507b-133">You can create as many **Recordset** objects as needed.</span></span>

<span data-ttu-id="2507b-p109">Quando você abrir um **Recordset**, o registro atual será posicionado no primeiro registro (se houver) e as propriedades [BOF](bof-eof-properties-ado.md) e [EOF](bof-eof-properties-ado.md) serão definidas como **False**. Se não houver registros, as definições das propriedades **BOF** e **EOF** serão **True**.</span><span class="sxs-lookup"><span data-stu-id="2507b-p109">When you open a **Recordset**, the current record is positioned to the first record (if any) and the [BOF](bof-eof-properties-ado.md) and [EOF](bof-eof-properties-ado.md) properties are set to **False**. If there are no records, the **BOF** and **EOF** property settings are **True**.</span></span>

<span data-ttu-id="2507b-p110">Use os métodos [MoveFirst](movefirst-movelast-movenext-and-moveprevious-methods-ado.md), **MoveLast**, **MoveNext** e **MovePrevious**; o método [Move](move-method-ado.md); e as propriedades [AbsolutePosition](absoluteposition-property-ado.md), [AbsolutePage](absolutepage-property-ado.md) e [Filter](filter-property-ado.md) para reposicionar o registro atual, supondo que o provedor ofereça suporte para a funcionalidade relevante. Os objetos **Recordset** somente de encaminhamento oferecem suporte apenas para o método [MoveNext](movefirst-movelast-movenext-and-moveprevious-methods-ado.md). Quando você usar os métodos **Move** para visitar cada registro (ou enumerar o **Recordset**), poderá usar as propriedades **BOF** e **EOF** para determinar se você se moveu além do inicio ou do final do **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="2507b-p110">You can use the [MoveFirst](movefirst-movelast-movenext-and-moveprevious-methods-ado.md), **MoveLast**, **MoveNext**, and **MovePrevious** methods; the [Move](move-method-ado.md) method; and the [AbsolutePosition](absoluteposition-property-ado.md), [AbsolutePage](absolutepage-property-ado.md), and [Filter](filter-property-ado.md) properties to reposition the current record, assuming the provider supports the relevant functionality. Forward-only **Recordset** objects support only the [MoveNext](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) method. When you use the **Move** methods to visit each record (or enumerate the **Recordset**), you can use the **BOF** and **EOF** properties to determine if you've moved beyond the beginning or end of the **Recordset**.</span></span>

<span data-ttu-id="2507b-p111">Os objetos **Recordset** oferecem suporte a dois tipos de atualização: imediata e em lotes. Na atualização imediata, todas as alterações dos dados são gravadas imediatamente na fonte de dados base assim que você chamar o método [Update](update-method-ado.md). Também é possível passar matrizes de valores como parâmetros com os métodos [AddNew](addnew-method-ado.md) e **Update** e atualizar simultaneamente vários campos de um registro.</span><span class="sxs-lookup"><span data-stu-id="2507b-p111">**Recordset** objects can support two types of updating: immediate and batched. In immediate updating, all changes to data are written immediately to the underlying data source once you call the [Update](update-method-ado.md) method. You can also pass arrays of values as parameters with the [AddNew](addnew-method-ado.md) and **Update** methods and simultaneously update several fields in a record.</span></span>

<span data-ttu-id="2507b-p112">Se um provedor oferecer suporte para a atualização em lotes, você terá as alterações do cache do provedor para mais de um registro e depois irá transmiti-las em uma única chamada para o banco de dados com o método [UpdateBatch](updatebatch-method-ado.md). Isso se aplica a alterações feitas com os métodos **AddNew**, **Update** e [Delete](delete-method-ado-recordset.md). Depois de chamar o método **UpdateBatch**, use a propriedade [Status](status-property-ado-recordset.md) para procurar quaisquer conflitos de dados e resolvê-los.</span><span class="sxs-lookup"><span data-stu-id="2507b-p112">If a provider supports batch updating, you can have the provider cache changes to more than one record and then transmit them in a single call to the database with the [UpdateBatch](updatebatch-method-ado.md) method. This applies to changes made with the **AddNew**, **Update**, and [Delete](delete-method-ado-recordset.md) methods. After you call the **UpdateBatch** method, you can use the [Status](status-property-ado-recordset.md) property to check for any data conflicts in order to resolve them.</span></span>

> [!NOTE]
> <span data-ttu-id="2507b-p113">[!OBSERVAçãO] Para executar uma consulta sem usar o objeto [Command](command-object-ado.md), passe uma sequência de consulta para o método **Open** de um objeto **Recordset**. No entanto, um objeto **Command** será necessário quando você desejar insistirno texto de comando e reexecutá-lo ou usar os parâmetros de consulta.</span><span class="sxs-lookup"><span data-stu-id="2507b-p113">To execute a query without using a [Command](command-object-ado.md) object, pass a query string to the **Open** method of a **Recordset** object. However, a **Command** object is required when you want to persist the command text and re-execute it, or use query parameters.</span></span>

<span data-ttu-id="2507b-147">A propriedade [Mode](mode-property-ado.md) governa as permissões de acesso.</span><span class="sxs-lookup"><span data-stu-id="2507b-147">The [Mode](mode-property-ado.md) property governs access permissions.</span></span>

<span data-ttu-id="2507b-p114">A coleção **Fields** é o membro padrão do objeto **Recordset**. Como resultado, as duas instruções de código a seguir são equivalentes.</span><span class="sxs-lookup"><span data-stu-id="2507b-p114">The **Fields** collection is the default member of the **Recordset** object. As a result, the following two code statements are equivalent.</span></span>

```vb
    Debug.Print objRs.Fields.Item(0)  ' Both statements print 
    Debug.Print objRs(0)              '  the Value of Item(0).
```
