---
title: Sobre o assembly de interoperabilidade primário do InfoPath do Microsoft Office
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
keywords:
- InfoPath 2007, assembly de interoperabilidade primário, assembly de interoperabilidade primário do InfoPath, PIAs [InfoPath 2007], assemblies de interoperabilidade primário [InfoPath 2007]
localization_priority: Normal
ms.assetid: 1b3ae03c-6951-49e4-a489-4712d3f7ba72
description: Para dar suporte à criação de soluções do InfoPath que usem linguagens de código gerenciado, como Visual C# e Visual Basic, a opção de suporte à programação do .NET no programa de instalação do InfoPath instala três assemblies de interoperabilidade.
ms.openlocfilehash: 51773ad46b1371c410c4249e13a489f0c5550cd1
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32310133"
---
# <a name="about-the-microsoft-office-infopath-primary-interop-assembly"></a><span data-ttu-id="d2101-104">Sobre o assembly de interoperabilidade primário do InfoPath do Microsoft Office</span><span class="sxs-lookup"><span data-stu-id="d2101-104">About the Microsoft Office InfoPath Primary Interop Assembly</span></span>

<span data-ttu-id="d2101-105">O aplicativo InfoPath é criado como um aplicativo de modelo de objeto de componente (COM) que expõe suas interfaces de programação para automação externa como interfaces COM.</span><span class="sxs-lookup"><span data-stu-id="d2101-105">The InfoPath application is built as a Component Object Model (COM) application that exposes its programmability interfaces for external automation as COM interfaces.</span></span> <span data-ttu-id="d2101-106">Para dar suporte à criação de soluções do InfoPath que usem linguagens de código gerenciado, como Visual C# e Visual Basic, a opção de **suporte à programação do .net** no programa de instalação do InfoPath instala três assemblies de interoperabilidade.</span><span class="sxs-lookup"><span data-stu-id="d2101-106">To support the creation of InfoPath solutions that use managed-code languages such as Visual C# and Visual Basic, the **.NET Programmability Support** option in the InfoPath setup program installs three interop assemblies.</span></span> <span data-ttu-id="d2101-107">Os assemblies de interoperabilidade são assemblies .NET que atuam como uma ponte entre código gerenciado e não gerenciado, mapeando membros de objeto COM para membros gerenciados .NET equivalentes.</span><span class="sxs-lookup"><span data-stu-id="d2101-107">Interop assemblies are .NET assemblies that act as a bridge between managed and unmanaged code, mapping COM object members to equivalent .NET managed members.</span></span> 
  
<span data-ttu-id="d2101-108">Os arquivos para os três assemblies de interoperabilidade instalados pelo InfoPath são chamados:</span><span class="sxs-lookup"><span data-stu-id="d2101-108">The files for the three interop assemblies installed by InfoPath are named:</span></span>
  
- <span data-ttu-id="d2101-109">Microsoft.Office.Interop.InfoPath.dll</span><span class="sxs-lookup"><span data-stu-id="d2101-109">Microsoft.Office.Interop.InfoPath.dll</span></span>
    
- <span data-ttu-id="d2101-110">Microsoft.Office.Interop.InfoPath.SemiTrust.dll</span><span class="sxs-lookup"><span data-stu-id="d2101-110">Microsoft.Office.Interop.InfoPath.SemiTrust.dll</span></span>
    
- <span data-ttu-id="d2101-111">Microsoft.Office.Interop.InfoPath.Xml.dll</span><span class="sxs-lookup"><span data-stu-id="d2101-111">Microsoft.Office.Interop.InfoPath.Xml.dll</span></span>
    
<span data-ttu-id="d2101-112">Este tópico discute o modelo de objeto exposto por meio do assembly de interoperabilidade Microsoft. Office. Interop. InfoPath, que é usado exclusivamente para o código de automação externa.</span><span class="sxs-lookup"><span data-stu-id="d2101-112">This topic discusses the object model exposed through the Microsoft.Office.Interop.InfoPath interop assembly, which is used exclusively for external automation code.</span></span> <span data-ttu-id="d2101-113">Para obter informações sobre o assembly Microsoft. Office. Interop. InfoPath. SemiTrust, que é usado exclusivamente para gravar e executar o código gerenciado que é executado de dentro dos modelos de formulário do InfoPath (. xsn), confira [modelos de objeto compatíveis com o infopath 2003](https://msdn.microsoft.com/library/e4511af6-d7e7-44ad-a50d-1b7ee04f8215%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="d2101-113">For information on the Microsoft.Office.Interop.InfoPath.SemiTrust assembly, which is used exclusively for writing and running managed code that runs from within InfoPath form templates (.xsn), see [InfoPath 2003 Compatible Object Models](https://msdn.microsoft.com/library/e4511af6-d7e7-44ad-a50d-1b7ee04f8215%28Office.15%29.aspx).</span></span>
  
## <a name="important-installation-information"></a><span data-ttu-id="d2101-114">Informações importantes de instalação</span><span class="sxs-lookup"><span data-stu-id="d2101-114">Important Installation Information</span></span>

<span data-ttu-id="d2101-115">A opção de instalação padrão do programa de instalação do InfoPath instala o assembly Microsoft. Office. Interop. InfoPath no cache de assembly global (GAC), o conteúdo do qual pode ser exibido na pasta C:\Windows\Assembly (ou no C:\Windows\assembly\GAC_ MSIL ao exibir diretamente o sistema de arquivos).</span><span class="sxs-lookup"><span data-stu-id="d2101-115">The default installation option of the InfoPath setup program installs the Microsoft.Office.Interop.InfoPath assembly in the Global Assembly Cache (GAC), the contents of which can be viewed from the C:\Windows\Assembly folder (or in C:\Windows\assembly\GAC_MSIL when viewing the file system directly).</span></span> <span data-ttu-id="d2101-116">Esse assembly é conhecido como o assembly de interOperabilidade primário do Microsoft Office InfoPath e é freqüentemente usado em conjunto com o assembly Microsoft. Office. Interop. InfoPath. xml, que também é instalado no GAC, para automatizar o aplicativo InfoPath do aplicativos externos que usam código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="d2101-116">This assembly is referred to as the "Microsoft Office InfoPath Primary Interop Assembly" and is often used in conjunction with the Microsoft.Office.Interop.InfoPath.Xml assembly, which is also installed in the GAC, to automate the InfoPath application from external applications that use managed code.</span></span> <span data-ttu-id="d2101-117">Para obter informações sobre o assembly Microsoft. Office. Interop. InfoPath. xml, consulte [sobre o assembly de InteroperaBILIDADE XML do InfoPath](about-the-infopath-xml-interop-assembly.md).</span><span class="sxs-lookup"><span data-stu-id="d2101-117">For information about the Microsoft.Office.Interop.InfoPath.Xml assembly, see [About the InfoPath XML Interop Assembly](about-the-infopath-xml-interop-assembly.md).</span></span>
  
<span data-ttu-id="d2101-118">Se o assembly Microsoft. Office. Interop. InfoPath não estiver visível no GAC, você deverá confirmar que o InfoPath foi instalado corretamente.</span><span class="sxs-lookup"><span data-stu-id="d2101-118">If the Microsoft.Office.Interop.InfoPath assembly is not visible in the GAC, you should confirm that InfoPath was installed correctly.</span></span> <span data-ttu-id="d2101-119">Por padrão, a opção de **suporte à programação do .net** no programa de instalação está definida para **executar a partir do meu computador** , desde que o .NET Framework 1,1 Redistributable, o .NET Framework 1,1 Software Development Kit (SDK) ou uma versão posterior do .NET Framework é instalado antes de executar a instalação.</span><span class="sxs-lookup"><span data-stu-id="d2101-119">By default, the **.NET Programmability Support** option in the setup program is set to **Run from My Computer** as long as the .NET Framework 1.1 Redistributable, .NET Framework 1.1 Software Development Kit (SDK), or a later version of the .NET Framework is installed before running setup.</span></span> <span data-ttu-id="d2101-120">Se esses assemblies de interoperabilidade não estiverem disponíveis em seu computador, você deve confirmar se o .NET Framework 1,1 ou posterior está instalado e, em seguida, usar **programas e recursos** no **painel de controle** para alterar a configuração configurando a \*\*programação do .net \*\*Opção de suporte no **Microsoft Office InfoPath** para **executar a partir de meu computador**.</span><span class="sxs-lookup"><span data-stu-id="d2101-120">If these interop assemblies are not available on your computer, you must confirm that .NET Framework 1.1 or later is installed, and then use **Programs and Features** from the **Control Panel** to change setup by setting the **.NET Programmability Support** option under **Microsoft Office InfoPath** to **Run from My Computer**.</span></span>
  
<span data-ttu-id="d2101-121">Para obter informações sobre como baixar o .NET Framework 1,1 Redistributable, consulte [.NET framework 1,1 Redistributable](https://www.microsoft.com/en-us/download/details.aspx?id=26).</span><span class="sxs-lookup"><span data-stu-id="d2101-121">For information about downloading the .NET Framework 1.1 Redistributable, see [.NET Framework 1.1 Redistributable](https://www.microsoft.com/en-us/download/details.aspx?id=26).</span></span>
  
## <a name="the-microsoftofficeinteropinfopath-namespace"></a><span data-ttu-id="d2101-122">O namespace Microsoft. Office. Interop. InfoPath</span><span class="sxs-lookup"><span data-stu-id="d2101-122">The Microsoft.Office.Interop.InfoPath Namespace</span></span>

<span data-ttu-id="d2101-123">Embora o processo de gravação de código gerenciado para uma determinada tarefa seja muito semelhante à execução da mesma tarefa usando uma linguagem como Visual Basic for Applications ou JScript, o modelo de objeto exposto ao exibir o **Microsoft. Office. Interop. InfoPath** o namespace do **pesquisador de objetos** no Microsoft Visual Studio parece mais complexo.</span><span class="sxs-lookup"><span data-stu-id="d2101-123">Although the process of writing managed code for a given task is very similar to performing the same task using a language such as Visual Basic for Applications or JScript, the object model exposed when viewing the **Microsoft.Office.Interop.InfoPath** namespace from the **Object Browser** in Microsoft Visual Studio looks more complex.</span></span> <span data-ttu-id="d2101-124">Isso ocorre porque a interoperabilidade com o .NET Framework requer um servidor COM para expor todas as interfaces públicas, bem como algumas construções adicionais necessárias para o próprio .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="d2101-124">This is because interoperability with the .NET Framework requires a COM server to expose all of its public interfaces, as well as some additional constructs required by the .NET Framework itself.</span></span> <span data-ttu-id="d2101-125">Para obter mais informações sobre como e por que o modelo de objeto exposto por um assembly de interoperabilidade parece mais complexo, consulte a seção "como os objetos COM são expostos ao código gerenciado" do tópico [modelos de objeto compatíveis com o InfoPath 2003](../form-templates/infopath-2003-compatible-object-models.md) .</span><span class="sxs-lookup"><span data-stu-id="d2101-125">For more information on how and why the object model exposed by an interop assembly appears more complex, see the "How COM Objects are Exposed to Managed Code" section of the [InfoPath 2003 Compatible Object Models](../form-templates/infopath-2003-compatible-object-models.md) topic.</span></span> 
  
### <a name="using-intellisense"></a><span data-ttu-id="d2101-126">Como usar o IntelliSense</span><span class="sxs-lookup"><span data-stu-id="d2101-126">Using IntelliSense</span></span>

<span data-ttu-id="d2101-127">Os exemplos nesta seção supõem que você tenha estabelecido referências aos assemblies Microsoft. Office. Interop. InfoPath e Microsoft. Office. Interop. InfoPath. xml.</span><span class="sxs-lookup"><span data-stu-id="d2101-127">The examples in this section assume that you have established references to the Microsoft.Office.Interop.InfoPath and Microsoft.Office.Interop.InfoPath.Xml assemblies.</span></span> <span data-ttu-id="d2101-128">Para obter informações sobre como definir referências e exemplos adicionais de automação externa, consulte [cenários e exemplos de automação externa](external-automation-scenarios-and-examples.md).</span><span class="sxs-lookup"><span data-stu-id="d2101-128">For information on how to set references and additional external automation examples, see [External Automation Scenarios and Examples](external-automation-scenarios-and-examples.md).</span></span>
  
<span data-ttu-id="d2101-129">Antes de poder usar a conclusão da instrução Microsoft IntelliSense no código de automação externo, você deve criar uma variável de objeto para uma instância da classe [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.Application.aspx) , conforme mostrado na seguinte linha de código.</span><span class="sxs-lookup"><span data-stu-id="d2101-129">Before you can use Microsoft IntelliSense statement completion in external automation code, you must create an object variable for an instance of the [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.Application.aspx) class as shown in the following line of code.</span></span> 
  
```cs
Application myApp = 
    new Microsoft.Office.Interop.InfoPath.Application();
```

```vb
Dim myApp As Application = _
    New Microsoft.Office.Interop.InfoPath.Application()
```

<span data-ttu-id="d2101-130">Após criar a variável de objeto, quando você digita o nome da variável seguido por um ponto, uma lista suspensa é exibida com membros da classe de **aplicativo** a ser selecionada.</span><span class="sxs-lookup"><span data-stu-id="d2101-130">After creating the object variable, when you type the variable name followed by a period, a drop-down list is displayed with members of the **Application** class to select.</span></span> 
  
<span data-ttu-id="d2101-131">Para trabalhar com um formulário do InfoPath, declare uma variável de objeto do tipo [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.XDocument.aspx) e, em seguida, inicialize-a abrindo o formulário da coleção [XDocuments](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.XDocuments.aspx) da variável de objeto **Application** , conforme mostrado na linha de código a seguir.</span><span class="sxs-lookup"><span data-stu-id="d2101-131">To work with an InfoPath form, declare an object variable of type [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.XDocument.aspx) , and then initialize it by opening the form from the [XDocuments](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.XDocuments.aspx) collection of the **Application** object variable as shown in the following line of code.</span></span> 
  
```cs
XDocument myXDoc = myApp.XDocuments.Open(
    "c:\\temp\\Form1.xml",
    (int) XdDocumentVersionMode.xdFailOnVersionOlder);
```

```vb
Dim myXDoc As XDocument = myApp.XDocuments.Open( _
    "c:\\temp\\Form1.xml", _
    XdDocumentVersionMode.xdFailOnVersionOlder)
```

<span data-ttu-id="d2101-132">A lista suspensa de conclusão da instrução IntelliSense para os membros da classe **XDocument** será exibida quando você digitar o nome da variável seguida por um ponto.</span><span class="sxs-lookup"><span data-stu-id="d2101-132">The IntelliSense statement completion drop-down list for members of the **XDocument** class will be displayed when you type the name of the variable followed by a period.</span></span> 
  
<span data-ttu-id="d2101-133">Para trabalhar com o conteúdo do documento XML subjacente para o formulário usando o Microsoft XML Core Services (MSXML), você deve criar uma variável do tipo [IXMLDOMDocument2](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.Xml.IXMLDOMDocument2.aspx) e, em seguida, usar a propriedade [dom](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._XDocument2.DOM.aspx) da classe **XDocument** para atribuir o XML Modelo de objeto de documento (DOM) do formulário para essa variável.</span><span class="sxs-lookup"><span data-stu-id="d2101-133">To work with the contents of the underlying XML document for the form using Microsoft XML Core Services (MSXML), you must create a variable of type [IXMLDOMDocument2](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.Xml.IXMLDOMDocument2.aspx) , and then use the [DOM](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._XDocument2.DOM.aspx) property of the **XDocument** class to assign the XML Document Object Model (DOM) of the form to that variable.</span></span> 
  
```cs
IXMLDOMDocument2 doc= myXDoc.DOM as IXMLDOMDocument2;
```

```vb
Dim doc As IXMLDOMDocument2 = myXDoc.DOM
```

<span data-ttu-id="d2101-134">A lista suspensa de conclusão da instrução IntelliSense para os membros da classe **IXMLDOMDocument2** será exibida quando você digitar o nome da variável seguida por um ponto, o que permite usar o MSXML para trabalhar com o documento XML.</span><span class="sxs-lookup"><span data-stu-id="d2101-134">The IntelliSense statement completion drop-down list for members of the **IXMLDOMDocument2** class will be displayed when you type the name of the variable followed by a period, which allows you to use MSXML to work with the XML document.</span></span> 
  
### <a name="using-the-class-library-reference-documentation"></a><span data-ttu-id="d2101-135">Usando a documentação de referência da biblioteca de classes</span><span class="sxs-lookup"><span data-stu-id="d2101-135">Using the Class Library Reference Documentation</span></span>

<span data-ttu-id="d2101-136">A organização da documentação de referência da biblioteca de classes do namespace [Microsoft. Office. Interop. InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.aspx) reflete as relações entre interfaces de coclass e as interfaces herdadas que elas implementam.</span><span class="sxs-lookup"><span data-stu-id="d2101-136">The organization of the [Microsoft.Office.Interop.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.aspx) namespace Class Library reference documentation reflects the relationships between coclass interfaces and the inherited interfaces they implement.</span></span> 
  
<span data-ttu-id="d2101-137">Quando você abre um tópico para uma interface de coclass, como [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.Application.aspx) , o link para os membros da interface de coclass após a descrição da interface no início do tópico exibe um tópico vazio.</span><span class="sxs-lookup"><span data-stu-id="d2101-137">When you open a topic for a coclass interface, such as [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.Application.aspx) , the link to the members of the coclass interface following the description of the interface at the beginning of the topic displays an empty topic.</span></span> <span data-ttu-id="d2101-138">Para exibir a lista de membros implementados pela interface de coclass, você deve abrir o tópico da interface mais recente herdada pela coclass e, em seguida, abrir a tabela dos seus membros.</span><span class="sxs-lookup"><span data-stu-id="d2101-138">To display the list of members that are implemented by the coclass interface, you must open the topic for the most recent interface that is inherited by the coclass, and then open the table of its members.</span></span> <span data-ttu-id="d2101-139">Um link para a interface herdada é fornecido no início da seção Comentários no tópico da interface de coclass.</span><span class="sxs-lookup"><span data-stu-id="d2101-139">A link to the inherited interface is provided at the beginning of the Remarks section in the coclass interface topic.</span></span> 
  
<span data-ttu-id="d2101-140">Quando você pressiona F1 no editor de código do Visual Studio, o comportamento é semelhante, exceto pelo fato de que o membro no qual você invoca a ajuda F1 será exibido diretamente, porque você está mais trabalhando com membros de uma interface.</span><span class="sxs-lookup"><span data-stu-id="d2101-140">When you press F1 in the Visual Studio Code Editor, the behavior is similar, except that the member on which you invoke F1 Help will be displayed directly, because you are most typically working with members of an interface.</span></span> <span data-ttu-id="d2101-141">No entanto, o fato de um membro poder se implementado de uma interface com versão pode parece confuso na primeira vez que você o encontrar.</span><span class="sxs-lookup"><span data-stu-id="d2101-141">However, the fact that a member can be implemented from a versioned interface may be confusing the first time you encounter it.</span></span> <span data-ttu-id="d2101-142">Por exemplo, se você digitar `myXDocument.UI.Alert`, posicionar o cursor sobre `Alert` e pressionar F1, um tópico intitulado "Método de Alerta UI2"é exibido.</span><span class="sxs-lookup"><span data-stu-id="d2101-142">For example, if you type  `myXDocument.UI.Alert` and place the cursor on  `Alert` and press F1, a topic titled "UI2.Alert Method" is displayed.</span></span> <span data-ttu-id="d2101-143">Isso ocorre porque o método **Alerta** é uma implementação de um membro da interface **UI2**.</span><span class="sxs-lookup"><span data-stu-id="d2101-143">This is because the **Alert** method is an implementation of a member of the **UI2** interface.</span></span> 
  
### <a name="passing-optional-parameters-to-infopath-object-model-members"></a><span data-ttu-id="d2101-144">Passando parâmetros opcionais para membros do modelo de objeto do InfoPath</span><span class="sxs-lookup"><span data-stu-id="d2101-144">Passing Optional Parameters to InfoPath Object Model Members</span></span>

<span data-ttu-id="d2101-145">Se um membro do modelo de objeto do InfoPath contiver um parâmetro opcional e você não especificar um valor para esse parâmetro, você deverá passar o **tipo. campo ausente** para esse parâmetro.</span><span class="sxs-lookup"><span data-stu-id="d2101-145">If an InfoPath object model member contains an optional parameter, and you do not specify a value for that parameter, you must pass the **Type.Missing** field for that parameter.</span></span> <span data-ttu-id="d2101-146">Não transferir o campo **Type.Missing** quando um valor real for omitido resultará em um erro de compilação.</span><span class="sxs-lookup"><span data-stu-id="d2101-146">Failure to pass the **Type.Missing** field when an actual value is omitted will result in a build error.</span></span> <span data-ttu-id="d2101-147">Isso se aplica ao código escrito em C# e Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="d2101-147">This is true for code written in both C# and Visual Basic.</span></span> <span data-ttu-id="d2101-148">Por exemplo, o método [SelectNodes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.View2.SelectNodes.aspx) da interface [ViewObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ViewObject.aspx) inclui dois parâmetros opcionais: _varEndNode_ e _varViewContext_.</span><span class="sxs-lookup"><span data-stu-id="d2101-148">For example, the [SelectNodes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.View2.SelectNodes.aspx) method of the [ViewObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ViewObject.aspx) interface includes two optional parameters:  _varEndNode_ and  _varViewContext_.</span></span> <span data-ttu-id="d2101-149">Uma linha de código que não especifique valores reais para esses parâmetros opcionais deve parecer com os exemplos a seguir.</span><span class="sxs-lookup"><span data-stu-id="d2101-149">A line of code that does not specify actual values for these optional parameters should look like the following examples.</span></span>
  
```cs
myXDocument.View.SelectNodes(group1, Type.Missing, Type.Missing);
```

```vb
myXDocument.View.SelectNodes(group1, Type.Missing, Type.Missing)
```

## <a name="see-also"></a><span data-ttu-id="d2101-150">Confira também</span><span class="sxs-lookup"><span data-stu-id="d2101-150">See also</span></span>

- [<span data-ttu-id="d2101-151">Cenários e exemplos de automação externa</span><span class="sxs-lookup"><span data-stu-id="d2101-151">External automation scenarios and examples</span></span>](external-automation-scenarios-and-examples.md)

