---
title: Criar um suplemento COM para adicionar recursos personalizados ao InfoPath
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- InfoPath 2007, a criação de suplementos de com, InfoPath 2007, adicionando recursos personalizados, suplementos COM [InfoPath 2007]
localization_priority: Normal
ms.assetid: af0b0bc9-20ef-4503-8b3b-8f2a97b671a2
description: Microsoft InfoPath oferece suporte a suplementos COM para estender o experiência do usuário de edição de formulários. Embora o suporte para suplementos COM foi adicionado pela primeira vez no InfoPath, outros aplicativos do Office, como o Microsoft Office Word e Microsoft Office Excel o oferecem suporte a suplementos COM desde o Office 2000.
ms.openlocfilehash: 4c70dfb71cf7b15a0978b4567ffac02a8ba524c3
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19765505"
---
# <a name="create-a-com-add-in-to-add-custom-features-to-infopath"></a><span data-ttu-id="e00a6-105">Criar um suplemento COM para adicionar recursos personalizados ao InfoPath</span><span class="sxs-lookup"><span data-stu-id="e00a6-105">Create a COM Add-in to Add Custom Features to InfoPath</span></span>

<span data-ttu-id="e00a6-106">Microsoft InfoPath oferece suporte a suplementos COM para estender o experiência do usuário de edição de formulários.</span><span class="sxs-lookup"><span data-stu-id="e00a6-106">Microsoft InfoPath supports COM Add-ins for extending the form editing user experience.</span></span> <span data-ttu-id="e00a6-107">Embora o suporte para suplementos COM foi adicionado pela primeira vez no InfoPath, outros aplicativos do Office, como o Microsoft Office Word e Microsoft Office Excel o oferecem suporte a suplementos COM desde o Office 2000.</span><span class="sxs-lookup"><span data-stu-id="e00a6-107">Although support for COM Add-ins was first added in InfoPath, other Office applications such as Microsoft Office Word and Microsoft Office Excel have supported COM add-ins since Office 2000.</span></span>
  
<span data-ttu-id="e00a6-108">Add-in COM suporte no InfoPath está disponível para o ambiente de edição de formulários.</span><span class="sxs-lookup"><span data-stu-id="e00a6-108">COM Add-in support in InfoPath is available for the form editing environment.</span></span> <span data-ttu-id="e00a6-109">O ambiente de design do formulário não pode ser estendido usando suplementos COM.</span><span class="sxs-lookup"><span data-stu-id="e00a6-109">The form design environment cannot be extended by using COM Add-ins.</span></span>
  
## <a name="the-idtextensibility2-interface"></a><span data-ttu-id="e00a6-110">A Interface IDTExtensibility2</span><span class="sxs-lookup"><span data-stu-id="e00a6-110">The IDTExtensibility2 Interface</span></span>

<span data-ttu-id="e00a6-111">O InfoPath ambiente de edição oferece suporte para a interface **IDTExtensibility2** , que deve ser implementada por desenvolvedores de suplementos de COM **IDTExtensibility2** é um objeto de interface dupla que fornece cinco métodos que atuam como eventos dentro do ambiente de edição.</span><span class="sxs-lookup"><span data-stu-id="e00a6-111">The InfoPath editing environment provides support for the **IDTExtensibility2** interface, which must be implemented by developers of COM Add-ins. **IDTExtensibility2** is a dual-interface object that provides five methods which act as events within the editing environment.</span></span> <span data-ttu-id="e00a6-112">Esses métodos permitem que o suplemento COM responder a ambiente inicialização e desligamento condições listadas na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="e00a6-112">These methods allow the COM add-in to respond to environment startup and shutdown conditions, listed in the following table.</span></span> 
  
|<span data-ttu-id="e00a6-113">**Interface**</span><span class="sxs-lookup"><span data-stu-id="e00a6-113">**Interface**</span></span>|<span data-ttu-id="e00a6-114">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="e00a6-114">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="e00a6-115">**OnAddInsUpdate (ByVal custom() como variante)**</span><span class="sxs-lookup"><span data-stu-id="e00a6-115">**OnAddInsUpdate (ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="e00a6-116">Ocorre quando um suplemento for carregado ou descarregado no ambiente.</span><span class="sxs-lookup"><span data-stu-id="e00a6-116">Occurs when an add-in is loaded or unloaded in the environment.</span></span>  <br/> |
|<span data-ttu-id="e00a6-117">**OnBeginShutdown (ByVal custom() como variante)**</span><span class="sxs-lookup"><span data-stu-id="e00a6-117">**OnBeginShutdown (ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="e00a6-118">Ocorre quando o ambiente está sendo desligado.</span><span class="sxs-lookup"><span data-stu-id="e00a6-118">Occurs when the environment is being shut down.</span></span>  <br/> |
|<span data-ttu-id="e00a6-119">**OnConnection (ByVal como objeto Application, ByVal ConnectMode como ext_ConnectMode, ByVal AddInInst como objeto, ByVal custom() como Variant)**</span><span class="sxs-lookup"><span data-stu-id="e00a6-119">**OnConnection(ByVal Application As Object, ByVal ConnectMode As ext_ConnectMode, ByVal AddInInst As Object, ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="e00a6-120">Ocorre quando um suplemento é carregado no ambiente.</span><span class="sxs-lookup"><span data-stu-id="e00a6-120">Occurs when an add-in is loaded in the environment.</span></span>  <br/> |
|<span data-ttu-id="e00a6-121">**OnDisconnection (ByVal RemoveMode como ext_DisconnectMode, ByVal custom() como Variant)**</span><span class="sxs-lookup"><span data-stu-id="e00a6-121">**OnDisconnection (ByVal RemoveMode As ext_DisconnectMode, ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="e00a6-122">Ocorre quando um suplemento seja descarregado do ambiente.</span><span class="sxs-lookup"><span data-stu-id="e00a6-122">Occurs when an add-in is unloaded from the environment.</span></span>  <br/> |
|<span data-ttu-id="e00a6-123">**OnStartupComplete (ByVal custom() como variante)**</span><span class="sxs-lookup"><span data-stu-id="e00a6-123">**OnStartupComplete (ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="e00a6-124">Ocorre quando o ambiente completou a inicialização.</span><span class="sxs-lookup"><span data-stu-id="e00a6-124">Occurs when the environment has completed starting.</span></span>  <br/> |
   
## <a name="registering-com-add-ins"></a><span data-ttu-id="e00a6-125">Registrando suplementos COM</span><span class="sxs-lookup"><span data-stu-id="e00a6-125">Registering COM Add-ins</span></span>

<span data-ttu-id="e00a6-126">Todos os aplicativos do Office, incluindo o InfoPath, usam o registro aos suplementos de lista da coleção de suplementos COM, para armazenar o estado de conectar e para armazenar as informações de inicialização ou a demanda de carga.</span><span class="sxs-lookup"><span data-stu-id="e00a6-126">All Office applications, including InfoPath, use the registry to list add-ins in the COM Add-Ins collection, to store the connect state, and to store the boot or demand load information.</span></span> <span data-ttu-id="e00a6-127">Para InfoPath suplementos COM, o nome de cada suplemento aparece na seguinte chave:</span><span class="sxs-lookup"><span data-stu-id="e00a6-127">For InfoPath COM Add-ins, the name of each add-in appears under the following key:</span></span>
  
`HKEY_CURRENT_USER\Software\Microsoft\Office\InfoPath\AddIns\`
  
<span data-ttu-id="e00a6-128">Para suplementos COM instalados para uso por cada usuário do computador cliente, a chave do registro está localizada no hive do registro HKLM:</span><span class="sxs-lookup"><span data-stu-id="e00a6-128">For COM Add-ins installed for use by every user of the client computer, the registry key is located in the HKLM registry hive:</span></span>
  
`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\InfoPath\AddIns\`
  
<span data-ttu-id="e00a6-129">O nome da chave do registro corresponde ao **ProgIdAttribute** do add-in e contém os seguintes valores.</span><span class="sxs-lookup"><span data-stu-id="e00a6-129">The registry key name corresponds to the **ProgIdAttribute** of the add-in, and contains the following values.</span></span> 
  
|<span data-ttu-id="e00a6-130">**Name**</span><span class="sxs-lookup"><span data-stu-id="e00a6-130">**Name**</span></span>|<span data-ttu-id="e00a6-131">**Type**</span><span class="sxs-lookup"><span data-stu-id="e00a6-131">**Type**</span></span>|<span data-ttu-id="e00a6-132">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="e00a6-132">**Description**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="e00a6-133">**FriendlyName**</span><span class="sxs-lookup"><span data-stu-id="e00a6-133">**FriendlyName**</span></span> <br/> |<span data-ttu-id="e00a6-134">**String**</span><span class="sxs-lookup"><span data-stu-id="e00a6-134">**String**</span></span> <br/> |<span data-ttu-id="e00a6-135">O nome que é exibido na caixa de diálogo **suplementos COM** e listado na página **Add-ins** do **Centro de confiança**.</span><span class="sxs-lookup"><span data-stu-id="e00a6-135">The name that is displayed in the **COM Add-ins** dialog box and listed in the **Add-ins** page of the **Trust Center**.</span></span>  <br/> |
|<span data-ttu-id="e00a6-136">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="e00a6-136">**Description**</span></span> <br/> |<span data-ttu-id="e00a6-137">**String**</span><span class="sxs-lookup"><span data-stu-id="e00a6-137">**String**</span></span> <br/> |<span data-ttu-id="e00a6-138">A cadeia de caracteres que é exibida quando o suplemento é selecionado na **Central de confiabilidade**.</span><span class="sxs-lookup"><span data-stu-id="e00a6-138">The string that is displayed when the add-in is selected in the **Trust Center**.</span></span>  <br/> |
|<span data-ttu-id="e00a6-139">**LoadBehavior**</span><span class="sxs-lookup"><span data-stu-id="e00a6-139">**LoadBehavior**</span></span> <br/> |<span data-ttu-id="e00a6-140">**DWORD**</span><span class="sxs-lookup"><span data-stu-id="e00a6-140">**DWORD**</span></span> <br/> |<span data-ttu-id="e00a6-141">Especifica a maneira como o Add-in COM é carregado.</span><span class="sxs-lookup"><span data-stu-id="e00a6-141">Specifies the way the COM Add-in is loaded.</span></span> <span data-ttu-id="e00a6-142">O valor pode ser uma combinação de 0, 1, 2, 8 e 16.</span><span class="sxs-lookup"><span data-stu-id="e00a6-142">The value can be a combination of 0, 1, 2, 8, and 16.</span></span> <span data-ttu-id="e00a6-143">Consulte a tabela abaixo para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="e00a6-143">See the table below for more information.</span></span>  <br/> |
   
<span data-ttu-id="e00a6-144">O valor de **DWORD** **LoadBehavior** deve conter um valor que descreve como o Add-in COM carrega no ambiente de edição.</span><span class="sxs-lookup"><span data-stu-id="e00a6-144">The **DWORD** value for **LoadBehavior** should contain a value describing how the COM Add-in loads in the editing environment.</span></span> <span data-ttu-id="e00a6-145">O valor pode estar entre a tabela a seguir, ou uma combinação dos valores da tabela.</span><span class="sxs-lookup"><span data-stu-id="e00a6-145">The value can be from the table below, or a combination of values from the table.</span></span> <span data-ttu-id="e00a6-146">Por exemplo, um Add-in COM criado no Visual Studio 2005 terá um **LoadBehavior** de "3" carregado na inicialização do aplicativo e estar conectado.</span><span class="sxs-lookup"><span data-stu-id="e00a6-146">For example, a COM Add-in created in Visual Studio 2005 will have a **LoadBehavior** of "3" loaded at application startup and be connected.</span></span> 
  
|<span data-ttu-id="e00a6-147">**Valor**</span><span class="sxs-lookup"><span data-stu-id="e00a6-147">**Value**</span></span>|<span data-ttu-id="e00a6-148">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="e00a6-148">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="e00a6-149">0</span><span class="sxs-lookup"><span data-stu-id="e00a6-149">0</span></span>  <br/> |<span data-ttu-id="e00a6-150">Desconectada.</span><span class="sxs-lookup"><span data-stu-id="e00a6-150">Disconnected.</span></span> <span data-ttu-id="e00a6-151">O suplemento mostrado como inativo na caixa de diálogo **suplementos de COM** .</span><span class="sxs-lookup"><span data-stu-id="e00a6-151">The add-in shows as Inactive in the **COM Add-in** dialog box.</span></span>  <br/> |
|<span data-ttu-id="e00a6-152">1</span><span class="sxs-lookup"><span data-stu-id="e00a6-152">1</span></span>  <br/> |<span data-ttu-id="e00a6-153">Conectado.</span><span class="sxs-lookup"><span data-stu-id="e00a6-153">Connected.</span></span> <span data-ttu-id="e00a6-154">O suplemento mostra como ativo na caixa de diálogo **suplementos de COM** .</span><span class="sxs-lookup"><span data-stu-id="e00a6-154">The add-in shows as Active in the **COM Add-in** dialog box.</span></span>  <br/> |
|<span data-ttu-id="e00a6-155">2</span><span class="sxs-lookup"><span data-stu-id="e00a6-155">2</span></span>  <br/> |<span data-ttu-id="e00a6-156">Carrega na inicialização.</span><span class="sxs-lookup"><span data-stu-id="e00a6-156">Load at Startup.</span></span> <span data-ttu-id="e00a6-157">O suplemento é carregado e conectado quando o aplicativo host for iniciado.</span><span class="sxs-lookup"><span data-stu-id="e00a6-157">The add-in is loaded and connected when the host application starts.</span></span>  <br/> |
|<span data-ttu-id="e00a6-158">8</span><span class="sxs-lookup"><span data-stu-id="e00a6-158">8</span></span>  <br/> |<span data-ttu-id="e00a6-159">Carrega por demanda.</span><span class="sxs-lookup"><span data-stu-id="e00a6-159">Load on Demand.</span></span> <span data-ttu-id="e00a6-160">O suplemento é carregado e conectado quando o aplicativo host exige, por exemplo, quando um usuário clica em um botão que usa a funcionalidade do add-in.</span><span class="sxs-lookup"><span data-stu-id="e00a6-160">The add-in is loaded and connected when the host application requires it, for example when a user clicks a button that uses functionality in the add-in.</span></span>  <br/> |
|<span data-ttu-id="e00a6-161">16</span><span class="sxs-lookup"><span data-stu-id="e00a6-161">16</span></span>  <br/> |<span data-ttu-id="e00a6-162">Conecte-se pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="e00a6-162">Connect first time.</span></span> <span data-ttu-id="e00a6-163">O suplemento será carregado e conectado na primeira vez em que o usuário executa o aplicativo host após se registrar o suplemento.</span><span class="sxs-lookup"><span data-stu-id="e00a6-163">The add-in will be loaded and connected the first time the user runs the host application after registering the add-in.</span></span>  <br/> |
   
## <a name="creating-a-managed-com-add-in-with-visual-studio-2005-or-visual-studio-2008"></a><span data-ttu-id="e00a6-164">Criando um suplemento de COM gerenciado com o Visual Studio 2005 ou o Visual Studio 2008</span><span class="sxs-lookup"><span data-stu-id="e00a6-164">Creating a Managed COM Add-in with Visual Studio 2005 or Visual Studio 2008</span></span>

<span data-ttu-id="e00a6-165">Para criar uma gerenciada COM suplemento usando o Microsoft Visual Studio 2005 ou o Visual Studio 2008, criar um projeto de suplemento compartilhado da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="e00a6-165">To create a managed COM add-in using Microsoft Visual Studio 2005 or Visual Studio 2008, create a Shared Add-In project as follows:</span></span> 
  
1. <span data-ttu-id="e00a6-166">Inicie o Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e00a6-166">Start Visual Studio.</span></span>
    
2. <span data-ttu-id="e00a6-167">On the **File** menu, click **New Project**.</span><span class="sxs-lookup"><span data-stu-id="e00a6-167">On the **File** menu, click **New Project**.</span></span>
    
3. <span data-ttu-id="e00a6-168">No painel **Tipos de projeto** da caixa de diálogo **Novo projeto** , clique na pasta de **Outros tipos de projetos** e clique em **extensibilidade**.</span><span class="sxs-lookup"><span data-stu-id="e00a6-168">In the **Project Types** pane of the **New Project** dialog box, click the **Other Projects Types** folder, and then click **Extensibility**.</span></span>
    
4. <span data-ttu-id="e00a6-169">No painel de **modelos** , clique em **Suplemento compartilhado**.</span><span class="sxs-lookup"><span data-stu-id="e00a6-169">In the **Templates** pane, click **Shared Add-In**.</span></span>
    
5. <span data-ttu-id="e00a6-170">Na caixa **nome** , digite um nome para o projeto.</span><span class="sxs-lookup"><span data-stu-id="e00a6-170">In the **Name** box, type a name for the project.</span></span> 
    
6. <span data-ttu-id="e00a6-171">Na caixa **local** , digite um caminho de pasta ou clique em **Procurar** e selecione um caminho de pasta e clique em **Okey**.</span><span class="sxs-lookup"><span data-stu-id="e00a6-171">In the **Location** box, type a folder path or click **Browse** and select a folder path, and then click **OK**.</span></span> <span data-ttu-id="e00a6-172">O **Assistente de suplemento compartilhado** aparece.</span><span class="sxs-lookup"><span data-stu-id="e00a6-172">The **Shared Add-in Wizard** appears.</span></span> 
    
7. <span data-ttu-id="e00a6-173">Clique em **Avançar** no **Assistente de suplemento compartilhado**.</span><span class="sxs-lookup"><span data-stu-id="e00a6-173">Click **Next** in the **Shared Add-in Wizard**.</span></span> <span data-ttu-id="e00a6-174">A página **Selecionar um idioma de programação** aparece.</span><span class="sxs-lookup"><span data-stu-id="e00a6-174">The **Select a Programming Language** page appears.</span></span> 
    
8. <span data-ttu-id="e00a6-175">Clique em **criar um suplemento usando o Visual Basic**, clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="e00a6-175">Click **Create an Add-in using Visual Basic**, then click **Next**.</span></span> <span data-ttu-id="e00a6-176">A página **Selecionar um aplicativo Host** aparece.</span><span class="sxs-lookup"><span data-stu-id="e00a6-176">The **Select An Application Host** page appears.</span></span> 
    
9. <span data-ttu-id="e00a6-177">Desmarque as caixas ao lado de cada aplicativo, exceto **Microsoft InfoPath**e clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="e00a6-177">Uncheck the boxes next to each application except **Microsoft InfoPath**, and then click **Next**.</span></span> <span data-ttu-id="e00a6-178">A página **Insira um nome e descrição** aparece.</span><span class="sxs-lookup"><span data-stu-id="e00a6-178">The **Enter a Name and Description** page appears.</span></span> 
    
10. <span data-ttu-id="e00a6-179">Na caixa **qual é o nome do seu suplemento** , digite o nome do seu COM Add-in.</span><span class="sxs-lookup"><span data-stu-id="e00a6-179">In the **What is the name of your Add-In** box, type the name of your COM Add-in.</span></span> 
    
11. <span data-ttu-id="e00a6-180">Na caixa **qual é a descrição do seu suplemento** , digite a descrição para o COM Add-in e clique em **Avançar**.</span><span class="sxs-lookup"><span data-stu-id="e00a6-180">In the **What is the description of your Add-In** box, type the description for your COM Add-in, and click **Next**.</span></span> <span data-ttu-id="e00a6-181">A página **Escolher opções de suplemento** aparece.</span><span class="sxs-lookup"><span data-stu-id="e00a6-181">The **Choose Add-In Options** page appears.</span></span> 
    
12. <span data-ttu-id="e00a6-182">Verifique os **gostaria de meu suplemento carregado quando o aplicativo host for carregado** e caixas de **Meu suplemento deve estar disponível para todos os usuários do computador em que ele foi instalado, não somente a pessoa que instala a ele** .</span><span class="sxs-lookup"><span data-stu-id="e00a6-182">Check the **I would like my Add-in to load when the host application loads** and **My Add-in should be available to all users of the computer it was installed on, not just the person who installs it** boxes.</span></span> 
    
13. <span data-ttu-id="e00a6-183">Clique em **próximo** para revisar a página de **Resumo** , clique em **Concluir**.</span><span class="sxs-lookup"><span data-stu-id="e00a6-183">Click **Next** to review the **Summary** page, then click **Finish**.</span></span>
    
<span data-ttu-id="e00a6-184">Depois que o projeto é criado pelo Visual Studio, você verá dois projetos na janela do Gerenciador de soluções.</span><span class="sxs-lookup"><span data-stu-id="e00a6-184">After the project is created by Visual Studio, you will see two projects in the Solution Explorer window.</span></span> <span data-ttu-id="e00a6-185">O primeiro projeto é o projeto para o COM Add-in; o segundo projeto é um projeto de instalação para implantar o Add-in de COM.</span><span class="sxs-lookup"><span data-stu-id="e00a6-185">The first project is the project for the COM Add-in; the second project is a setup project for deploying the COM Add-in.</span></span> <span data-ttu-id="e00a6-186">O **Assistente de suplemento compartilhado** apenas insere uma referência para a **Biblioteca de objetos do Microsoft Office 14.0**, portanto, é necessário inserir uma referência à biblioteca de objeto do InfoPath usando as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="e00a6-186">The **Shared Add-in Wizard** only inserts a reference to the **Microsoft Office 14.0 Object Library**, so it is necessary to insert a reference to the InfoPath object library using the following steps:</span></span>
  
1. <span data-ttu-id="e00a6-187">Clique duas vezes em **Meu projeto** para exibir as propriedades do projeto de suplemento.</span><span class="sxs-lookup"><span data-stu-id="e00a6-187">Double-click **My Project** to display the add-in project properties.</span></span> <span data-ttu-id="e00a6-188">Clique na guia **referências** para exibir as referências automaticamente adicionadas ao projeto.</span><span class="sxs-lookup"><span data-stu-id="e00a6-188">Click the **References** tab to display the references automatically added to the project.</span></span> 
    
2. <span data-ttu-id="e00a6-189">Clique no botão **Adicionar** para exibir a caixa de diálogo **Adicionar referência** .</span><span class="sxs-lookup"><span data-stu-id="e00a6-189">Click the **Add** button to display the **Add Reference** dialog box.</span></span> 
    
3. <span data-ttu-id="e00a6-190">Na guia **COM** , clique duas vezes em **Biblioteca de tipos do Microsoft.InfoPath 2.0**e clique em **Okey**.</span><span class="sxs-lookup"><span data-stu-id="e00a6-190">On the **COM** tab, double-click **Microsoft.InfoPath 2.0 Type Library**, and click **OK**.</span></span>
    
4. <span data-ttu-id="e00a6-191">Adicionando uma referência à **Biblioteca de tipos do Microsoft InfoPath 3.0** também adiciona o referências a três assemblies que devem ser removidos: **ADODB**, **MSHTML**e **MSXML2**.</span><span class="sxs-lookup"><span data-stu-id="e00a6-191">Adding a reference to the **Microsoft InfoPath 3.0 Type Library** also adds references to three assemblies that must be removed: **ADODB**, **MSHTML**, and **MSXML2**.</span></span> <span data-ttu-id="e00a6-192">No **Solution Explorer** sob **referências**, do mouse em cada uma dessas referências e clique em **Remover**.</span><span class="sxs-lookup"><span data-stu-id="e00a6-192">In **Solution Explorer** under **References**, right-click each of these references, and then click **Remove**.</span></span>
    
## <a name="viewing-the-registry-settings"></a><span data-ttu-id="e00a6-193">Exibindo as configurações do registro</span><span class="sxs-lookup"><span data-stu-id="e00a6-193">Viewing the Registry Settings</span></span>

<span data-ttu-id="e00a6-194">Para exibir as configurações do registro que serão criadas quando o COM Add-in estiver instalado, siga estas etapas:</span><span class="sxs-lookup"><span data-stu-id="e00a6-194">To view the registry settings that will be created when the COM Add-in is installed, follow these steps:</span></span>
  
1. <span data-ttu-id="e00a6-195">Com o botão direito no nó raiz do projeto de instalação no **Solution Explorer**, clique em **modo de exibição**, em seguida, **Editor**, e clique em **registro**.</span><span class="sxs-lookup"><span data-stu-id="e00a6-195">Right-click the root node of the setup project in the **Solution Explorer**, click **View**, then **Editor**, then click **Registry**.</span></span>
    
2. <span data-ttu-id="e00a6-196">No painel esquerdo, clique no sinal de mais para expandir **HKEY_LOCAL_MACHINE**, **Software**, **Microsoft**, **InfoPath**e **AddIns**.</span><span class="sxs-lookup"><span data-stu-id="e00a6-196">In the left-hand pane, click the plus to expand **HKEY_LOCAL_MACHINE**, **Software**, **Microsoft**, **InfoPath**, then **AddIns**.</span></span>
    
3. <span data-ttu-id="e00a6-197">Clique no nome correspondente à compartilhado suplemento do seu projeto **ProgID**.</span><span class="sxs-lookup"><span data-stu-id="e00a6-197">Click the name corresponding to your shared add-in project's **ProgID**.</span></span>
    
<span data-ttu-id="e00a6-198">Para alterar qualquer uma dessas propriedades, clique com o botão a propriedade, clique na **Janela Propriedades**e altere a caixa de **valor** na **Janela Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="e00a6-198">To change any of these properties, right-click the property, click **Properties Window**, and change the **Value** box in the **Properties Window**.</span></span>
  
## <a name="compiling-and-distributing-the-shared-add-in"></a><span data-ttu-id="e00a6-199">Compilando e distribuir o suplemento compartilhado</span><span class="sxs-lookup"><span data-stu-id="e00a6-199">Compiling and Distributing the Shared Add-In</span></span>

<span data-ttu-id="e00a6-200">Para compilar o Add-in COM gerenciado para testes no computador em que o projeto de suplemento compartilhado foi desenvolvido, com o botão direito no nó raiz do projeto de suplemento compartilhado no Solution Explorer e clique em criar.</span><span class="sxs-lookup"><span data-stu-id="e00a6-200">To compile the managed COM Add-in for testing on the computer on which the Shared Add-In project was developed, right-click the root node of the Shared Add-In project in the Solution Explorer and click Build.</span></span> <span data-ttu-id="e00a6-201">Se o projeto é compilado sem erros, você pode iniciar o ambiente de edição do InfoPath e começar a usar o Add-in COM gerenciado.</span><span class="sxs-lookup"><span data-stu-id="e00a6-201">If the project builds with no errors, you can start the InfoPath editing environment and begin using the managed COM Add-in.</span></span> <span data-ttu-id="e00a6-202">Se você tiver uma instância do InfoPath em execução, feche-o antes de criar o projeto.</span><span class="sxs-lookup"><span data-stu-id="e00a6-202">If you have an instance of InfoPath running, close it before building the project.</span></span> <span data-ttu-id="e00a6-203">Talvez também seja necessário abrir a caixa de diálogo Suplementos COM para verificar se o Add-in COM está registrado.</span><span class="sxs-lookup"><span data-stu-id="e00a6-203">It may also be necessary to open the COM Add-ins dialog box to verify that the COM Add-in is registered.</span></span> <span data-ttu-id="e00a6-204">Para abrir a caixa de diálogo Suplementos COM, siga estas etapas:</span><span class="sxs-lookup"><span data-stu-id="e00a6-204">To open the COM Add-ins dialog box, follow these steps:</span></span>
  
1. <span data-ttu-id="e00a6-205">Abra o ambiente de edição do InfoPath.</span><span class="sxs-lookup"><span data-stu-id="e00a6-205">Open the InfoPath editing environment.</span></span> <span data-ttu-id="e00a6-206">A maneira mais fácil de fazer isso é abrir um modelo de formulário existente, que criará um novo formulário baseado no modelo de formulário.</span><span class="sxs-lookup"><span data-stu-id="e00a6-206">The easiest way to do this is to open an existing form template, which will create a new form based on that form template.</span></span>
    
2. <span data-ttu-id="e00a6-207">No menu **Ferramentas** , clique em **Central de confiabilidade** .</span><span class="sxs-lookup"><span data-stu-id="e00a6-207">Click **Trust Center** on the **Tools** menu.</span></span> 
    
3. <span data-ttu-id="e00a6-208">Clique na categoria de **suplementos** no lado esquerdo.</span><span class="sxs-lookup"><span data-stu-id="e00a6-208">Click the **Add-ins** category on the left.</span></span> 
    
4. <span data-ttu-id="e00a6-209">Na seção **Gerenciar** na parte inferior da caixa de diálogo **Central de confiabilidade** , selecione **suplementos COM** na lista e clique no botão **Ir** .</span><span class="sxs-lookup"><span data-stu-id="e00a6-209">In the **Manage** section near the bottom of the **Trust Center** dialog box, select **COM Add-ins** from the list and click the **Go** button.</span></span> 
    
5. <span data-ttu-id="e00a6-210">Na caixa de diálogo **suplementos COM** , você verá o nome do seu suplemento recentemente criado e deve haver uma caixa de seleção ao lado dela.</span><span class="sxs-lookup"><span data-stu-id="e00a6-210">In the **COM Add-ins** dialog box, you will see the name of your recently-built add-in and there should be a check box next to it.</span></span> <span data-ttu-id="e00a6-211">Se não houver nenhuma caixa de seleção ao lado dela, o Add-in COM Falha ao carregar devido a um erro, o que será listado na seção **Carregar o comportamento** da caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="e00a6-211">If there is no check box next to it, the COM Add-in failed to load due to an error, which will be listed in the **Load Behavior** section of the dialog box.</span></span> 
    
<span data-ttu-id="e00a6-212">Para compilar o gerenciada suplemento COM para uso em um computador diferente do computador no qual o projeto de suplemento compartilhado desenvolvido, você deve seguir etapas adicionais para proteger seu código.</span><span class="sxs-lookup"><span data-stu-id="e00a6-212">To compile the managed COM add-in for use on a computer other than the computer on which the Shared Add-In project was developed, you must follow additional steps to secure your code.</span></span> <span data-ttu-id="e00a6-213">Para obter informações sobre como proteger os projetos de suplemento compartilhado para uso em outros computadores, consulte três artigos a seguir:</span><span class="sxs-lookup"><span data-stu-id="e00a6-213">For information on securing Shared Add-In projects for use on other computers, see the following three articles:</span></span>
  
- [<span data-ttu-id="e00a6-214">Implantação de gerenciada suplementos COM no Office XP</span><span class="sxs-lookup"><span data-stu-id="e00a6-214">Deployment of Managed COM Add-Ins in Office XP</span></span>](http://go.microsoft.com/fwlink/?LinkID=73473)
  
- [<span data-ttu-id="e00a6-215">Usando a solução de correção de suplemento COM para implantar gerenciado suplementos COM no Office XP</span><span class="sxs-lookup"><span data-stu-id="e00a6-215">Using the COM Add-in Shim Solution to Deploy Managed COM Add-ins in Office XP</span></span>](http://go.microsoft.com/fwlink/?LinkID=73474)
  
- [<span data-ttu-id="e00a6-216">Isolando extensões do Office com o Assistente de correção de COM</span><span class="sxs-lookup"><span data-stu-id="e00a6-216">Isolating Office Extensions with the COM Shim Wizard</span></span>](http://go.microsoft.com/fwlink/?LinkID=73475)
  
> [!IMPORTANT]
> <span data-ttu-id="e00a6-217">Não isolar o Add-in COM pode causar vazamento de memória e instabilidade do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e00a6-217">Not isolating the COM Add-in may cause memory leaks and application instability.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="e00a6-218">Se o .NET Framework ou outros assemblies necessários do projeto de instalação não já estiverem instalados em computadores de destino, o arquivo. msi pode não ser instalado corretamente.</span><span class="sxs-lookup"><span data-stu-id="e00a6-218">If the .NET Framework or other required assemblies from the setup project are not already installed on target computers, the .msi file may not install properly.</span></span> <span data-ttu-id="e00a6-219">Além disso, você não pode distribuir o arquivo. msi e, em seguida, tente instalar o arquivo. msi.</span><span class="sxs-lookup"><span data-stu-id="e00a6-219">Also, you cannot distribute the .msi file and then attempt to install the .msi file.</span></span> <span data-ttu-id="e00a6-220">Você também deve distribuir os outros arquivos de suporte na mesma pasta do arquivo. msi original gerado pelo Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e00a6-220">You must also distribute the other support files in the same folder as the original .msi file generated by Visual Studio.</span></span> 
  
## <a name="coding-in-the-com-add-in"></a><span data-ttu-id="e00a6-221">Codificação no suplemento COM</span><span class="sxs-lookup"><span data-stu-id="e00a6-221">Coding in the COM Add-in</span></span>

<span data-ttu-id="e00a6-222">Eventos de aplicativo que ocorrem no ambiente de edição de formulário do InfoPath podem ser capturados por um COM Add-in.</span><span class="sxs-lookup"><span data-stu-id="e00a6-222">Application events that occur in the InfoPath form editing environment can be captured by a COM Add-in.</span></span> <span data-ttu-id="e00a6-223">Os eventos a seguir do objeto [ApplicationEvents](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ApplicationEvents.aspx) podem ser usados pelo COM Add-in para responder a ações do usuário:</span><span class="sxs-lookup"><span data-stu-id="e00a6-223">The following events of the [ApplicationEvents](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ApplicationEvents.aspx) object can be used by the COM Add-in to respond to user actions:</span></span> 
  
|<span data-ttu-id="e00a6-224">**Event**</span><span class="sxs-lookup"><span data-stu-id="e00a6-224">**Event**</span></span>|<span data-ttu-id="e00a6-225">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="e00a6-225">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="e00a6-226">[NewXDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.NewXDocument.aspx) Evento</span><span class="sxs-lookup"><span data-stu-id="e00a6-226">[NewXDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.NewXDocument.aspx) Event</span></span>  <br/> |<span data-ttu-id="e00a6-227">Ocorre quando um novo formulário é criado.</span><span class="sxs-lookup"><span data-stu-id="e00a6-227">Occurs when a new form is created.</span></span>  <br/> |
|<span data-ttu-id="e00a6-228">[Encerre](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.Quit.aspx) Evento</span><span class="sxs-lookup"><span data-stu-id="e00a6-228">[Quit](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.Quit.aspx) Event</span></span>  <br/> |<span data-ttu-id="e00a6-229">Ocorre quando o usuário encerra o InfoPath.</span><span class="sxs-lookup"><span data-stu-id="e00a6-229">Occurs when the user quits InfoPath.</span></span>  <br/> |
|<span data-ttu-id="e00a6-230">[WindowActivate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowActivate.aspx) Evento</span><span class="sxs-lookup"><span data-stu-id="e00a6-230">[WindowActivate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowActivate.aspx) Event</span></span>  <br/> |<span data-ttu-id="e00a6-231">Ocorre quando qualquer janela de documento é ativada.</span><span class="sxs-lookup"><span data-stu-id="e00a6-231">Occurs when any document window is activated.</span></span>  <br/> |
|<span data-ttu-id="e00a6-232">[WindowDeactivate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowDeactivate.aspx) Evento</span><span class="sxs-lookup"><span data-stu-id="e00a6-232">[WindowDeactivate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowDeactivate.aspx) Event</span></span>  <br/> |<span data-ttu-id="e00a6-233">Ocorre quando qualquer janela de documento é desativada.</span><span class="sxs-lookup"><span data-stu-id="e00a6-233">Occurs when any document window is deactivated.</span></span>  <br/> |
|<span data-ttu-id="e00a6-234">[WindowSize](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowSize.aspx) Evento</span><span class="sxs-lookup"><span data-stu-id="e00a6-234">[WindowSize](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowSize.aspx) Event</span></span>  <br/> |<span data-ttu-id="e00a6-235">Ocorre quando qualquer janela de documento é redimensionada ou movida.</span><span class="sxs-lookup"><span data-stu-id="e00a6-235">Occurs when any document window is resized or moved.</span></span>  <br/> |
|<span data-ttu-id="e00a6-236">[XDocumentBeforeClose](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforeClose.aspx) Evento</span><span class="sxs-lookup"><span data-stu-id="e00a6-236">[XDocumentBeforeClose](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforeClose.aspx) Event</span></span>  <br/> |<span data-ttu-id="e00a6-237">Ocorre imediatamente antes de qualquer documento aberto fechar.</span><span class="sxs-lookup"><span data-stu-id="e00a6-237">Occurs immediately before any open document closes.</span></span>  <br/> |
|<span data-ttu-id="e00a6-238">[XDocumentBeforePrint](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforePrint.aspx) Evento</span><span class="sxs-lookup"><span data-stu-id="e00a6-238">[XDocumentBeforePrint](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforePrint.aspx) Event</span></span>  <br/> |<span data-ttu-id="e00a6-239">Ocorre imediatamente antes de qualquer documento aberto seja impresso.</span><span class="sxs-lookup"><span data-stu-id="e00a6-239">Occurs immediately before any open document is printed.</span></span>  <br/> |
|<span data-ttu-id="e00a6-240">[XDocumentBeforeSave](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforeSave.aspx) Evento</span><span class="sxs-lookup"><span data-stu-id="e00a6-240">[XDocumentBeforeSave](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforeSave.aspx) Event</span></span>  <br/> |<span data-ttu-id="e00a6-241">Ocorre imediatamente antes de qualquer documento aberto seja salvo.</span><span class="sxs-lookup"><span data-stu-id="e00a6-241">Occurs immediately before any open document is saved.</span></span>  <br/> |
|<span data-ttu-id="e00a6-242">[XDocumentChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentChange.aspx) Evento</span><span class="sxs-lookup"><span data-stu-id="e00a6-242">[XDocumentChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentChange.aspx) Event</span></span>  <br/> |<span data-ttu-id="e00a6-243">Ocorre quando um novo formulário é criado, quando um formulário existente é aberto ou quando outro formulário é feito formulário ativo.</span><span class="sxs-lookup"><span data-stu-id="e00a6-243">Occurs when a new form is created, when an existing form is opened, or when another form is made the active form.</span></span>  <br/> |
|<span data-ttu-id="e00a6-244">[XDocumentOpen](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentOpen.aspx) Evento</span><span class="sxs-lookup"><span data-stu-id="e00a6-244">[XDocumentOpen](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentOpen.aspx) Event</span></span>  <br/> |<span data-ttu-id="e00a6-245">Ocorre quando um documento é aberto.</span><span class="sxs-lookup"><span data-stu-id="e00a6-245">Occurs when a document is opened.</span></span>  <br/> |
   
<span data-ttu-id="e00a6-246">Para capturar esses eventos na COM Add-in, você deve declarar as seguintes variáveis de nível de classe na classe **Connect** :</span><span class="sxs-lookup"><span data-stu-id="e00a6-246">To capture these events in the COM Add-in, you must declare the following class-level variables in your **Connect** class:</span></span> 
  
```vb
InfoPathApplication = DirectCast( _
   application, Microsoft.Office.Interop.InfoPath._Application3)
InfoPathApplicationEvents = DirectCast( _
   InfoPathApplication.Events, _
   Microsoft.Office.Interop.InfoPath.ApplicationEvents)
```

```cs
InfoPathApplication =
   (Microsoft.Office.Interop.InfoPath._Application3)application;
InfoPathApplicationEvents =
   (Microsoft.Office.Interop.InfoPath.ApplicationEvents)
   InfoPathApplication.Events;
```

<span data-ttu-id="e00a6-247">A primeira linha projeta o aplicativo genérico **objeto** recebida pelo suplemento para o objeto [_Application3](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._Application3.aspx) .</span><span class="sxs-lookup"><span data-stu-id="e00a6-247">The first line casts the generic application **Object** received by the add-in to the [_Application3](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._Application3.aspx) object.</span></span> <span data-ttu-id="e00a6-248">A segunda linha usa a propriedade de [eventos](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._Application3.Events.aspx) do objeto **_Application3** (representado pela variável **InfoPathApplication** ) ao objeto [ApplicationEvents](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ApplicationEvents.aspx) .</span><span class="sxs-lookup"><span data-stu-id="e00a6-248">The second line casts the [Events](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._Application3.Events.aspx) property of the **_Application3** object (represented by the **InfoPathApplication** variable) to the [ApplicationEvents](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ApplicationEvents.aspx) object.</span></span> 
  
<span data-ttu-id="e00a6-249">Para criar manipuladores de eventos, selecione **InfoPathApplicationEvents** na caixa de lista suspensa de **Nome de classe** na parte superior da janela do Visual Studio e, em seguida, selecione o evento que você deseja manipular na caixa suspensa **Nome do método** na parte superior do Visual Janela Studio.</span><span class="sxs-lookup"><span data-stu-id="e00a6-249">To create event handlers, select **InfoPathApplicationEvents** from the **Class Name** drop-down box at the top of the Visual Studio window, and then select the event you want to handle in the **Method Name** drop-down box at the top of the Visual Studio window.</span></span> <span data-ttu-id="e00a6-250">Por exemplo, se você precisar controlar quando um formulário é salvo, manipular o evento **XDocumentBeforeSave** .</span><span class="sxs-lookup"><span data-stu-id="e00a6-250">For example, if you need to control when a form is saved, you handle the **XDocumentBeforeSave** event.</span></span> <span data-ttu-id="e00a6-251">Selecionar **XDocumentBeforeSave** na lista suspensa **Nome do método** automaticamente insere o procedimento a seguir:</span><span class="sxs-lookup"><span data-stu-id="e00a6-251">Selecting **XDocumentBeforeSave** from the **Method Name** drop-down automatically inserts the following procedure:</span></span> 
  
```vb
Private Sub InfoPathApplicationEvents_XDocumentBeforeSave( _
   ByVal pDocument As Microsoft.Office.Interop.InfoPath._XDocument, _
   ByRef pfCancel As Boolean) _
   Handles InfoPathApplicationEvents.XDocumentBeforeSave
End Sub
```

```cs
private void InfoPathApplicationEvents_XDocumentBeforeSave(
   Microsoft.Office.Interop.InfoPath._XDocument pDocument, ref bool pfCancel)
{
}

```

<span data-ttu-id="e00a6-252">Qualquer um dos eventos do objeto **ApplicationEvents** podem ser administrados COM Add-in do usando o mesmo método.</span><span class="sxs-lookup"><span data-stu-id="e00a6-252">Any of the events of the **ApplicationEvents** object can be handled by the COM Add-in using the same method.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="e00a6-253">Confira também</span><span class="sxs-lookup"><span data-stu-id="e00a6-253">See also</span></span>

- [<span data-ttu-id="e00a6-254">Criando um Microsoft Office 2000 suplemento COM</span><span class="sxs-lookup"><span data-stu-id="e00a6-254">Creating a Microsoft Office 2000 COM Add-in</span></span>](http://go.microsoft.com/fwlink/?LinkID=73468) 
- [<span data-ttu-id="e00a6-255">Criando o Office gerenciado suplementos de COM o Visual Studio .NET</span><span class="sxs-lookup"><span data-stu-id="e00a6-255">Creating Office Managed COM Add-Ins with Visual Studio .NET</span></span>](http://go.microsoft.com/fwlink/?LinkID=73470)
- [<span data-ttu-id="e00a6-256">Trabalhando com os procedimentos de evento IDTExtensibility2</span><span class="sxs-lookup"><span data-stu-id="e00a6-256">Working with the IDTExtensibility2 Event Procedures</span></span>](http://go.microsoft.com/fwlink/?LinkID=73471)
- [<span data-ttu-id="e00a6-257">Construir um Office suplemento COM o Visual Basic .NET</span><span class="sxs-lookup"><span data-stu-id="e00a6-257">Build an Office COM Add-in With Visual Basic .NET</span></span>](http://go.microsoft.com/fwlink/?LinkID=73469)
- [<span data-ttu-id="e00a6-258">Construir um Office suplemento COM o Visual c# .NET</span><span class="sxs-lookup"><span data-stu-id="e00a6-258">Build an Office COM Add-in With Visual C# .NET</span></span>](http://go.microsoft.com/fwlink/?LinkID=73472)
- [<span data-ttu-id="e00a6-259">Criando suplementos de 2007 do InfoPath usando o Visual Studio 2005 Tools for the Office System SE</span><span class="sxs-lookup"><span data-stu-id="e00a6-259">Creating InfoPath 2007 Add-Ins by Using Visual Studio 2005 Tools for the Office System SE</span></span>](http://msdn.microsoft.com/en-us/library/bb968857%28office.12%29.aspx)

