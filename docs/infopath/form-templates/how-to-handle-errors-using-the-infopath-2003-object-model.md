---
title: Tratar erros usando o modelo de objeto do InfoPath 2003
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- modelos de formulário compatíveis com o InfoPath 2003, tratamento de erros, modelos de formulário compatíveis com o InfoPath 2003, tratamento de erros, modelos de formulário [InfoPath 2007], tratamento de erros, tratamento de erros [InfoPath 2007], modelos de formulário compatíveis com o InfoPath 2003
localization_priority: Normal
ms.assetid: eeb05205-d6f4-4931-b9a9-55a663bb1a25
description: Ao criar aplicativos personalizados, os desenvolvedores geralmente devem executar tratamento de erro que envolve escrever código de programação para verificar se há erros gerados pelo aplicativo ou para criar e gerar erros personalizados. O modelo de objeto compatível com o InfoPath 2003 oferece suporte ao tratamento de erros por meio do uso do objeto ErrorObject em associação com a coleção ErrorsCollection.
ms.openlocfilehash: 93991e33d8867f89454bec08b41ba83e98ab0a17
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33439475"
---
# <a name="handle-errors-using-the-infopath-2003-object-model"></a><span data-ttu-id="a8e7e-105">Tratar erros usando o modelo de objeto do InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="a8e7e-105">Handle Errors Using the InfoPath 2003 Object Model</span></span>

<span data-ttu-id="a8e7e-106">Ao criar aplicativos personalizados, os desenvolvedores geralmente devem executar tratamento de erro que envolve escrever código de programação para verificar se há erros gerados pelo aplicativo ou para criar e gerar erros personalizados.</span><span class="sxs-lookup"><span data-stu-id="a8e7e-106">When creating custom applications, developers must often perform error handling that involves writing programming code to check for errors raised by the application or to create and raise custom errors.</span></span> <span data-ttu-id="a8e7e-107">O modelo de objeto compatível com o InfoPath 2003 dá suporte ao tratamento de erros por meio do uso do objeto [ErrorObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorObject.aspx) em associação com a [coleção ErrorsCollection.](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8e7e-107">The InfoPath 2003-compatible object model supports error handling through the use of the [ErrorObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorObject.aspx) object in association with the [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) collection.</span></span> 
  
<span data-ttu-id="a8e7e-108">No InfoPath, os erros podem ocorrer quando os dados inseridos em um formulário falham na validação do esquema XML, quando uma restrição de validação personalizada falha, quando um erro é gerado pelo método [ReportError](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReportError.aspx) do objeto [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) ou quando um erro é criado usando o método [Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) da coleção [ErrorsCollection.](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8e7e-108">In InfoPath, errors can occur when data entered into a form fails XML schema validation, when a custom validation constraint fails, when an error is generated by the [ReportError](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReportError.aspx) method of the [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) object, or when an error is created using the [Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) method of the [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) collection.</span></span> 
  
## <a name="overview-of-the-errorscollection-collection"></a><span data-ttu-id="a8e7e-109">Visão geral da coleção ErrorsCollection</span><span class="sxs-lookup"><span data-stu-id="a8e7e-109">Overview of the ErrorsCollection Collection</span></span>

<span data-ttu-id="a8e7e-110">A **coleção ErrorsCollection** fornece os seguintes métodos e propriedades, que os desenvolvedores de formulário podem usar para gerenciar os objetos **ErrorObject** que a coleção contém.</span><span class="sxs-lookup"><span data-stu-id="a8e7e-110">The **ErrorsCollection** collection provides the following methods and properties, which form developers can use to manage the **ErrorObject** objects that the collection contains.</span></span> 
  
|<span data-ttu-id="a8e7e-111">**Nome**</span><span class="sxs-lookup"><span data-stu-id="a8e7e-111">**Name**</span></span>|<span data-ttu-id="a8e7e-112">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="a8e7e-112">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="a8e7e-113">Método[Adicionar](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8e7e-113">[Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) method</span></span>  <br/> |<span data-ttu-id="a8e7e-114">Cria um **objeto ErrorObject** e o adiciona à coleção.</span><span class="sxs-lookup"><span data-stu-id="a8e7e-114">Creates an **ErrorObject** object and adds it to the collection.</span></span>  <br/> |
|<span data-ttu-id="a8e7e-115">Método[Excluir](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Delete.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8e7e-115">[Delete](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Delete.aspx) method</span></span>  <br/> |<span data-ttu-id="a8e7e-116">Exclui todos os **objetos ErrorObject** associados ao nó XML especificado e ao nome da condição, exceto os erros personalizados adicionados usando o **método ReportError.**</span><span class="sxs-lookup"><span data-stu-id="a8e7e-116">Deletes all **ErrorObject** objects associated with the specified XML node and condition name, except for custom errors added using the **ReportError** method.</span></span>  <br/> |
|<span data-ttu-id="a8e7e-117">[Método DeleteAll](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.DeleteAll.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8e7e-117">[DeleteAll](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.DeleteAll.aspx) method</span></span>  <br/> |<span data-ttu-id="a8e7e-118">Exclui todos **os objetos ErrorObject** contidos na coleção.</span><span class="sxs-lookup"><span data-stu-id="a8e7e-118">Deletes all **ErrorObject** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="a8e7e-119">Propriedade [Count](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Count.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8e7e-119">[Count](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="a8e7e-120">Obtém uma contagem do número de **objetos ErrorObject** contidos na coleção.</span><span class="sxs-lookup"><span data-stu-id="a8e7e-120">Gets a count of the number of **ErrorObject** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="a8e7e-121">Propriedade [Item](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Item.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8e7e-121">[Item](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="a8e7e-122">Obtém uma referência a **um objeto ErrorObject** com base no número de índice especificado.</span><span class="sxs-lookup"><span data-stu-id="a8e7e-122">Gets a reference to an **ErrorObject** object based on the specified index number.</span></span>  <br/> |
   
## <a name="overview-of-the-errorobject-object"></a><span data-ttu-id="a8e7e-123">Visão geral do objeto ErrorObject</span><span class="sxs-lookup"><span data-stu-id="a8e7e-123">Overview of the ErrorObject Object</span></span>

<span data-ttu-id="a8e7e-124">O **objeto ErrorObject** fornece as seguintes propriedades, que os desenvolvedores de formulário podem usar para acessar informações sobre o erro gerado.</span><span class="sxs-lookup"><span data-stu-id="a8e7e-124">The **ErrorObject** object provides the following properties, which form developers can use to access information about the error that was raised.</span></span> 
  
|<span data-ttu-id="a8e7e-125">**Nome**</span><span class="sxs-lookup"><span data-stu-id="a8e7e-125">**Name**</span></span>|<span data-ttu-id="a8e7e-126">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="a8e7e-126">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="a8e7e-127">[Propriedade ConditionName](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ConditionName.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8e7e-127">[ConditionName](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ConditionName.aspx) property</span></span>  <br/> |<span data-ttu-id="a8e7e-128">Obtém o nome da condição de erro ou retorna **nulo**, dependendo do tipo de **objeto ErrorObject** .</span><span class="sxs-lookup"><span data-stu-id="a8e7e-128">Gets the name of the error condition, or returns **null**, depending on the type of **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="a8e7e-129">[Propriedade DetailedErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.DetailedErrorMessage.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8e7e-129">[DetailedErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.DetailedErrorMessage.aspx) property</span></span>  <br/> |<span data-ttu-id="a8e7e-130">Obtém ou define a mensagem de erro detalhada do **objeto ErrorObject** .</span><span class="sxs-lookup"><span data-stu-id="a8e7e-130">Gets or sets the detailed error message of the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="a8e7e-131">[Propriedade ErrorCode](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorCode.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8e7e-131">[ErrorCode](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorCode.aspx) property</span></span>  <br/> |<span data-ttu-id="a8e7e-132">Obtém ou define o código de erro do **objeto ErrorObject** .</span><span class="sxs-lookup"><span data-stu-id="a8e7e-132">Gets or sets the error code of the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="a8e7e-133">[Propriedade Node](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.Node.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8e7e-133">[Node](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.Node.aspx) property</span></span>  <br/> |<span data-ttu-id="a8e7e-134">Obtém uma referência ao nó XML associado ao **objeto ErrorObject** .</span><span class="sxs-lookup"><span data-stu-id="a8e7e-134">Gets a reference to the XML node associated with the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="a8e7e-135">[Propriedade ShortErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ShortErrorMessage.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8e7e-135">[ShortErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ShortErrorMessage.aspx) property</span></span>  <br/> |<span data-ttu-id="a8e7e-136">Obtém ou define a mensagem de erro curta do **objeto ErrorObject** .</span><span class="sxs-lookup"><span data-stu-id="a8e7e-136">Gets or sets the short error message of the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="a8e7e-137">[Propriedade ErrorType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorType.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8e7e-137">[ErrorType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorType.aspx) property</span></span>  <br/> |<span data-ttu-id="a8e7e-138">Obtém o tipo do **objeto ErrorObject** .</span><span class="sxs-lookup"><span data-stu-id="a8e7e-138">Gets the type of the **ErrorObject** object.</span></span>  <br/> |
   
## <a name="using-the-errorscollection-and-errorobject"></a><span data-ttu-id="a8e7e-139">Usando ErrorsCollection e ErrorObject</span><span class="sxs-lookup"><span data-stu-id="a8e7e-139">Using the ErrorsCollection and ErrorObject</span></span>

<span data-ttu-id="a8e7e-140">A **coleção ErrorsCollection** é acessada por meio da [propriedade Errors](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument.Errors.aspx) do [objeto XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) .</span><span class="sxs-lookup"><span data-stu-id="a8e7e-140">The **ErrorsCollection** collection is accessed through the [Errors](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument.Errors.aspx) property of the [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) object.</span></span> <span data-ttu-id="a8e7e-141">A **coleção ErrorsCollection** está associada ao documento XML subjacente de um formulário para que, quando ocorrer um erro, ele ocorra dentro do documento XML.</span><span class="sxs-lookup"><span data-stu-id="a8e7e-141">The **ErrorsCollection** collection is associated with a form's underlying XML document so that when an error occurs, it occurs within the XML document.</span></span> <span data-ttu-id="a8e7e-142">O exemplo a seguir demonstra como um loop **foreach** do Visual C# pode ser usado para verificar os erros que podem existir no documento XML subjacente de um formulário.</span><span class="sxs-lookup"><span data-stu-id="a8e7e-142">The following example demonstrates how a Visual C# **foreach** loop can be used to check the errors that may exist in a form's underlying XML document.</span></span> <span data-ttu-id="a8e7e-143">Se houver erros, a função exibirá um loop por cada um deles e, usando a propriedade **ShortErrorMessage** do objeto **ErrorObject,** exibirá uma caixa de mensagem para o usuário.</span><span class="sxs-lookup"><span data-stu-id="a8e7e-143">If there are errors, the function loops through each of them, and, using the **ShortErrorMessage** property of the **ErrorObject** object, displays a message box to the user.</span></span> 
  
```cs
public void CheckErrors(IXMLDOMNode xmlNode)
{
   foreach(ErrorObject err in thisXDocument.Errors)
   {
      if(xmlNode==err.Node)
         thisXDocument.UI.Alert("The following error has occured: "
             + err.ShortErrorMessage + ".");
   }
}
```

<span data-ttu-id="a8e7e-144">A função anterior poderia ser chamada de um dos manipuladores de eventos de validação de dados do formulário.</span><span class="sxs-lookup"><span data-stu-id="a8e7e-144">The preceding function could be called from one of the form's data validation event handlers.</span></span> <span data-ttu-id="a8e7e-145">For example, when used in the [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) event handler for a field in the form, the call to the function would pass the XML node argument using the [Site](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.Site.aspx) property of the [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) object as follows.</span><span class="sxs-lookup"><span data-stu-id="a8e7e-145">For example, when used in the [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) event handler for a field in the form, the call to the function would pass the XML node argument using the [Site](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.Site.aspx) property of the [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) object as follows.</span></span> 
  
```cs
CheckErrors(e.Site);
```

<span data-ttu-id="a8e7e-146">Além de manipular erros gerados pelo InfoPath, os desenvolvedores de formulário também podem gerar erros personalizados usando o método **ReportError** do objeto **DataDOMEventObject** ou usando o método **Add** da coleção **ErrorsCollection** .</span><span class="sxs-lookup"><span data-stu-id="a8e7e-146">In addition to handling errors generated by InfoPath, form developers can also generate custom errors by using the **ReportError** method of the **DataDOMEventObject** object, or by using the **Add** method of the **ErrorsCollection** collection.</span></span> <span data-ttu-id="a8e7e-147">Para obter informações sobre como **usar os métodos ReportError** ou **Add,** clique nos métodos no início deste tópico.</span><span class="sxs-lookup"><span data-stu-id="a8e7e-147">For information about using the **ReportError** or **Add** methods, click the methods at the beginning of this topic.</span></span> 
  
## <a name="handling-managed-code-exceptions"></a><span data-ttu-id="a8e7e-148">Manipulando Managed-Code exceções</span><span class="sxs-lookup"><span data-stu-id="a8e7e-148">Handling Managed-Code Exceptions</span></span>

<span data-ttu-id="a8e7e-149">Você pode usar o tratamento de exceção try-catch para manipular exceções ativas no modelo de formulário de código gerenciado, conforme mostrado no exemplo de código a seguir.</span><span class="sxs-lookup"><span data-stu-id="a8e7e-149">You can use try-catch exception handling to handle exceptions raised in managed-code form template as shown in the following code example.</span></span>
  
```cs
DataAdapters dataAdapters;
dataAdapters = thisXDocument.DataAdapters; 
XMLFileAdapterObject queryXMLFile = 
   (XMLFileAdapterObject)dataAdapters["form1"];
// Perform the query.
try
{
   queryXMLFile.Query();
}
catch (Exception ex)
{
   thisXDocument.UI.Alert("Failed to query.\n\n" + ex.Message);
}
// Perform the submit.
try
{
   queryXMLFile.Submit();
}
catch (Exception ex)
{
   thisXDocument.UI.Alert("Failed to submit.\n\n" + ex.Message);
}
```

<span data-ttu-id="a8e7e-150">Se você não usar o tratamento de exceção try-catch no código do formulário, o InfoPath exibirá informações sobre exceções não manipuladas na caixa de diálogo de erro do InfoPath durante a depuração e visualização.</span><span class="sxs-lookup"><span data-stu-id="a8e7e-150">If you do not use try-catch exception handling in your form code, InfoPath will display information about unhandled exceptions in the InfoPath error dialog box while debugging and previewing.</span></span> 
  

