---
title: Responder a eventos de formulário usando o modelo de objeto do InfoPath 2003
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- modelos de formulário [InfoPath 2007], responder a eventos, modelos de formulário compatíveis com o InfoPath 2003, responder a eventos de formulário
localization_priority: Normal
ms.assetid: 59e9c1ed-32a8-4bcd-bdfc-9aa568a34d2a
description: Você pode escrever código para responder a vários eventos que podem ocorrer quando um usuário preenche um formulário. Para trabalhar com eventos no InfoPath, você cria manipuladores de eventos no designer do InfoPath.
ms.openlocfilehash: b7347f882df991e64bdf4e76c471b1220a84dc58
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32300095"
---
# <a name="respond-to-form-events-using-the-infopath-2003-object-model"></a><span data-ttu-id="daabd-105">Responder a eventos de formulário usando o modelo de objeto do InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="daabd-105">Respond to Form Events Using the InfoPath 2003 Object Model</span></span>

<span data-ttu-id="daabd-106">Você pode escrever código para responder a vários eventos que podem ocorrer quando um usuário preenche um formulário.</span><span class="sxs-lookup"><span data-stu-id="daabd-106">You can write code to respond to various events that can occur as a user fills out a form.</span></span> <span data-ttu-id="daabd-107">Para trabalhar com eventos no InfoPath, você cria manipuladores de eventos no designer do InfoPath.</span><span class="sxs-lookup"><span data-stu-id="daabd-107">To work with events in InfoPath, you create event handlers in the InfoPath designer.</span></span>
  
<span data-ttu-id="daabd-108">Os manipuladores de eventos do InfoPath devem ser criados no designer do InfoPath porque, ao usar o modelo de objeto compatível com o InfoPath 2003, o InfoPath adiciona automaticamente a declaração correta e aplica um atributo ([InfoPathEventHandlerAttribute](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.aspx) ) em um arquivo de código do formulário (FormCode.cs ou FormCode. vb) para identificar e coletar o manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="daabd-108">InfoPath event handlers should be created in the InfoPath designer because, when using the InfoPath 2003-compatible object model, InfoPath automatically adds the correct declaration and applies an attribute ([InfoPathEventHandlerAttribute](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.aspx) ) in a form's code file (FormCode.cs or FormCode.vb) to identify and sink the event handler.</span></span> <span data-ttu-id="daabd-109">Após ter criado um manipulador de eventos, você não deve alterar sua declaração e atributo no arquivo de código do formulário.</span><span class="sxs-lookup"><span data-stu-id="daabd-109">After you have created an event handler, you should not alter its declaration and attribute in the form's code file.</span></span> 
  
<span data-ttu-id="daabd-110">Para obter informações sobre como criar os manipuladores de eventos do InfoPath, consulte [Adicionar um manipulador de eventos usando o modelo de objeto do infopath 2003](how-to-add-an-event-handler-using-the-infopath-2003-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="daabd-110">For information about creating the InfoPath event handlers, see [Add an Event Handler Using the InfoPath 2003 Object Model](how-to-add-an-event-handler-using-the-infopath-2003-object-model.md).</span></span>
  
## <a name="overview-of-the-event-objects"></a><span data-ttu-id="daabd-111">Visão geral dos objetos Event</span><span class="sxs-lookup"><span data-stu-id="daabd-111">Overview of the Event Objects</span></span>

<span data-ttu-id="daabd-112">O modelo de objeto compatível com o InfoPath 2003 implementa nove objetos de evento que são expostos no namespace [Microsoft. Office. Interop. InfoPath. SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) .</span><span class="sxs-lookup"><span data-stu-id="daabd-112">The InfoPath 2003-compatible object model implements nine event objects that are exposed in the [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) namespace.</span></span> <span data-ttu-id="daabd-113">A tabela a seguir lista cada um dos objetos de evento do InfoPath, os manipuladores de eventos aos quais estão associados e uma descrição da funcionalidade que fornecem.</span><span class="sxs-lookup"><span data-stu-id="daabd-113">The following table lists each of the InfoPath event objects, the event handlers they are associated with, and a description of the functionality they provide.</span></span> 
  
|<span data-ttu-id="daabd-114">**Nome**</span><span class="sxs-lookup"><span data-stu-id="daabd-114">**Name**</span></span>|<span data-ttu-id="daabd-115">**Manipuladores de eventos**</span><span class="sxs-lookup"><span data-stu-id="daabd-115">**Event handlers**</span></span>|<span data-ttu-id="daabd-116">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="daabd-116">**Description**</span></span>|
|:-----|:-----|:-----|
|[<span data-ttu-id="daabd-117">DataDOMEvent</span><span class="sxs-lookup"><span data-stu-id="daabd-117">DataDOMEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.aspx) <br/> |[<span data-ttu-id="daabd-118">OnBeforeChange</span><span class="sxs-lookup"><span data-stu-id="daabd-118">OnBeforeChange</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnBeforeChange.aspx) <br/> <span data-ttu-id="daabd-119">[](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnValidate.aspx) OnValidate, [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx)</span><span class="sxs-lookup"><span data-stu-id="daabd-119">[OnValidate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnValidate.aspx) , [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx)</span></span> <br/> |<span data-ttu-id="daabd-120">Retorna uma referência ao documento XML subjacente de um formulário, o status de retorno e outras propriedades que contêm informações sobre o nó XML durante uma alteração DOM (modelo de objeto do documento) XML.</span><span class="sxs-lookup"><span data-stu-id="daabd-120">Returns a reference to a form's underlying XML document, the return status, and other properties that contain information about the XML node during an XML Document Object Model (DOM) change.</span></span> <span data-ttu-id="daabd-121">Também inclui um método para gerar um erro.</span><span class="sxs-lookup"><span data-stu-id="daabd-121">Also includes a method for raising an error.</span></span>  <br/> |
|[<span data-ttu-id="daabd-122">DocActionEvent</span><span class="sxs-lookup"><span data-stu-id="daabd-122">DocActionEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DocActionEvent.aspx) <br/> |[<span data-ttu-id="daabd-123">OnClick</span><span class="sxs-lookup"><span data-stu-id="daabd-123">OnClick</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._ButtonEventSink_Event.OnClick.aspx) <br/> |<span data-ttu-id="daabd-124">Retorna uma referência ao documento XML subjacente de um formulário, o status de retorno e o nó XML de origem durante um clique no botão na área do formulário.</span><span class="sxs-lookup"><span data-stu-id="daabd-124">Returns a reference to a form's underlying XML document, the return status, and the source XML node during a button click in the form area.</span></span>  <br/> |
|[<span data-ttu-id="daabd-125">DocContextChangeEvent</span><span class="sxs-lookup"><span data-stu-id="daabd-125">DocContextChangeEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DocContextChangeEvent.aspx) <br/> |[<span data-ttu-id="daabd-126">OnContextChange</span><span class="sxs-lookup"><span data-stu-id="daabd-126">OnContextChange</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnContextChange.aspx) <br/> |<span data-ttu-id="daabd-127">Retorna informações sobre o nó DOM (modelo de objeto de documento) XML que é o contexto atual do documento XML subjacente do formulário.</span><span class="sxs-lookup"><span data-stu-id="daabd-127">Returns information about the XML Document Object Model (DOM) node that is the current context of the form's underlying XML document.</span></span>  <br/> |
|[<span data-ttu-id="daabd-128">DocEvent</span><span class="sxs-lookup"><span data-stu-id="daabd-128">DocEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DocEvent.aspx) <br/> |<span data-ttu-id="daabd-129">[OnSwitchView](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnSwitchView.aspx) , [OnAfterImport](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnAfterImport.aspx)</span><span class="sxs-lookup"><span data-stu-id="daabd-129">[OnSwitchView](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnSwitchView.aspx) , [OnAfterImport](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnAfterImport.aspx)</span></span> <br/> |<span data-ttu-id="daabd-130">Retorna uma referência ao documento XML subjacente de um formulário durante um modo de exibição de alternância ou operação de mesclagem de formulários.</span><span class="sxs-lookup"><span data-stu-id="daabd-130">Returns a reference to a form's underlying XML document during a switch view or form merge operation.</span></span>  <br/> |
|[<span data-ttu-id="daabd-131">DocReturnEvent</span><span class="sxs-lookup"><span data-stu-id="daabd-131">DocReturnEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DocReturnEvent.aspx) <br/> |<span data-ttu-id="daabd-132">[OnLoad](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnLoad.aspx) , [OnSubmitRequest](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnSubmitRequest.aspx)</span><span class="sxs-lookup"><span data-stu-id="daabd-132">[OnLoad](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnLoad.aspx) , [OnSubmitRequest](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnSubmitRequest.aspx)</span></span> <br/> |<span data-ttu-id="daabd-133">Retorna uma referência ao documento XML subjacente de um formulário e o status de retorno durante o carregamento ou o envio de um formulário.</span><span class="sxs-lookup"><span data-stu-id="daabd-133">Returns a reference to a form's underlying XML document and the return status during the loading or submission of a form.</span></span>  <br/> |
|[<span data-ttu-id="daabd-134">MergeEvent</span><span class="sxs-lookup"><span data-stu-id="daabd-134">MergeEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.MergeEvent.aspx) <br/> |[<span data-ttu-id="daabd-135">OnMergeRequest</span><span class="sxs-lookup"><span data-stu-id="daabd-135">OnMergeRequest</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnMergeRequest.aspx) <br/> |<span data-ttu-id="daabd-136">Retorna propriedades e métodos que podem ser usados durante um evento **OnMergeRequest** para interagir de forma programática com o documento XML subjacente de um formulário e determinar propriedades de mesclagem, como o número de arquivos que estão sendo mesclados.</span><span class="sxs-lookup"><span data-stu-id="daabd-136">Returns properties and methods that can be used during an **OnMergeRequest** event to programmatically interact with a form's underlying XML document and to determine merge properties such as the number of files being merged.</span></span>  <br/> |
|[<span data-ttu-id="daabd-137">SaveEvent</span><span class="sxs-lookup"><span data-stu-id="daabd-137">SaveEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SaveEvent.aspx) <br/> |[<span data-ttu-id="daabd-138">OnSaveRequest</span><span class="sxs-lookup"><span data-stu-id="daabd-138">OnSaveRequest</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnSaveRequest.aspx) <br/> |<span data-ttu-id="daabd-139">Retorna um número de propriedades e métodos que podem ser usados durante uma operação de salvamento do manipulador de eventos **OnSaveRequest** para interagir de forma programática com o documento XML subjacente de um formulário, determinar salvar propriedades e realizar a operação salvar.</span><span class="sxs-lookup"><span data-stu-id="daabd-139">Returns a number of properties and methods that can be used during a save operation from the **OnSaveRequest** event handler to programmatically interact with a form's underlying XML document, determine save properties, and perform the save operation.</span></span>  <br/> |
|[<span data-ttu-id="daabd-140">SignEvent</span><span class="sxs-lookup"><span data-stu-id="daabd-140">SignEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignEvent.aspx) <br/> |[<span data-ttu-id="daabd-141">OnSign</span><span class="sxs-lookup"><span data-stu-id="daabd-141">OnSign</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnSign.aspx) <br/> |<span data-ttu-id="daabd-142">Usado para adicionar dados adicionais à assinatura digital.</span><span class="sxs-lookup"><span data-stu-id="daabd-142">Used to add additional data to the digital signature.</span></span>  <br/> |
|[<span data-ttu-id="daabd-143">VersionUpgradeEvent</span><span class="sxs-lookup"><span data-stu-id="daabd-143">VersionUpgradeEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.VersionUpgradeEvent.aspx) <br/> |[<span data-ttu-id="daabd-144">OnVersionUpgrade</span><span class="sxs-lookup"><span data-stu-id="daabd-144">OnVersionUpgrade</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnVersionUpgrade.aspx) <br/> |<span data-ttu-id="daabd-145">Retorna uma referência ao documento XML subjacente de um formulário, o status de retorno e os números de versão do documento e da solução durante a operação de atualização de versão.</span><span class="sxs-lookup"><span data-stu-id="daabd-145">Returns a reference to a form's underlying XML document, the return status, and the document and solution version numbers during the version upgrade operation.</span></span>  <br/> |
   
## <a name="using-the-event-objects"></a><span data-ttu-id="daabd-146">Usando os objetos Event</span><span class="sxs-lookup"><span data-stu-id="daabd-146">Using the Event Objects</span></span>

<span data-ttu-id="daabd-147">Quando você cria um manipulador de eventos, o InfoPath cria a declaração do manipulador de eventos no arquivo de código de formulário do projeto (FormCode.cs ou FormCode. vb).</span><span class="sxs-lookup"><span data-stu-id="daabd-147">When you create an event handler, InfoPath creates the event handler's declaration in the project's form code file (FormCode.cs or FormCode.vb).</span></span> <span data-ttu-id="daabd-148">Na declaração do manipulador de eventos, o InfoPath usa **e** como o nome do parâmetro que é passado para o manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="daabd-148">In the declaration of the event handler, InfoPath uses **e** as the name of the parameter that is passed to the event handler.</span></span> <span data-ttu-id="daabd-149">Este parâmetro contém o objeto Event que está associado ao manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="daabd-149">This parameter contains the event object that is associated with the event handler.</span></span> 
  
<span data-ttu-id="daabd-150">Por exemplo, quando você cria um manipulador de eventos para o evento **OnLoad** no modo de design (clicando **no evento Load** na guia **desenvolvedor** ), o InfoPath adiciona a declaração para o manipulador de eventos que recebe o objeto **DocReturnEvent** para o arquivo de código do formulário e, em seguida, abre o editor de códigos para que você possa adicionar seu código à seguinte declaração de manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="daabd-150">For example, when you create an event handler for the **OnLoad** event in design mode (by clicking **On Load Event** on the **Developer** tab), InfoPath adds the declaration for the event handler that receives the **DocReturnEvent** object to the form code file, and then opens the Code Editor so that you can add your code to the following event handler declaration.</span></span> 
  
```cs
// The following function handler is created by Microsoft Office 
// InfoPath. Do not modify the type or number of arguments.
[InfoPathEventHandler(EventType=InfoPathEventType.OnLoad)]
public void FormEvents_OnLoad(DocReturnEvent e)
{
   // Write your code here.
}
```

```vb
' The following function handler is created by Microsoft Office 
' InfoPath. Do not modify the type or number of arguments.
<InfoPathEventHandler(EventType:=InfoPathEventType.OnLoad)> _
Public Sub FormEvents_OnLoad(ByVal e As DocReturnEvent)
   ' Write your code here.
End Sub
```

<span data-ttu-id="daabd-151">Ao escrever código para um manipulador de eventos, você pode usar as propriedades e os métodos implementados pelo objeto Event que é passado pelo parâmetro **e** .</span><span class="sxs-lookup"><span data-stu-id="daabd-151">When writing code for an event handler, you can use the properties and methods implemented by the event object that is passed through the **e** parameter.</span></span> <span data-ttu-id="daabd-152">Por exemplo, no seguinte manipulador de eventos **OnBeforeChange** , a propriedade [NewValue](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.NewValue.aspx) do objeto de evento DataDOMEvent é usada para verificar o valor do campo que acabou de ser alterado. \*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="daabd-152">For example, in the following **OnBeforeChange** event handler, the [NewValue](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.NewValue.aspx) property of the **DataDOMEvent** event object is used to check the value of the field that was just changed.</span></span> <span data-ttu-id="daabd-153">Se estiver em branco, a propriedade [ReturnMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReturnMessage.aspx) do objeto de evento DataDOMEvent é usada para exibir um erro para o usuário em uma caixa de diálogo e a propriedade [ReturnStatus](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReturnStatus.aspx) é definida como **false**, indicando que as alterações que o usuário fez devem \*\*\*\* não ser aceito.</span><span class="sxs-lookup"><span data-stu-id="daabd-153">If it is blank, the [ReturnMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReturnMessage.aspx) property of the **DataDOMEvent** event object is used to display an error to the user in a dialog box, and the [ReturnStatus](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReturnStatus.aspx) property is set to **false**, indicating that the changes the user made should not be accepted.</span></span>
  
```cs
[InfoPathEventHandler(MatchPath="/my:myFields/my:field1", 
    EventType=InfoPathEventType.OnBeforeChange)]
public void field1_OnBeforeChange(DataDOMEvent e)
{
   // Determine whether there is a new value.
   if ((string)e.NewValue == "")
   {
      // The value is blank, so display an error message and roll
      // back the changes.
      e.ReturnMessage = "You must supply a value for this field.";
      e.ReturnStatus = false;
      return;
   }
}
```

```vb
<InfoPathEventHandler(MatchPath:="/my:myFields/my:field1", _ EventType:=InfoPathEventType.OnBeforeChange)> _
Public Sub field1_OnBeforeChange(ByVal e As DataDOMEvent)
   ' Determine whether there is a new value.
   If (e.NewValue = "") Then
      ' The value is blank, so display an error message and roll back
      ' the changes.
      e.ReturnMessage = "You must supply a value for this field."
      e.ReturnStatus = False
      Return
   End If
End Sub
```

> [!NOTE]
> <span data-ttu-id="daabd-154">Cada um dos objetos Event do InfoPath no modelo de objeto compatível com o InfoPath 2003 implementa diferentes propriedades e métodos.</span><span class="sxs-lookup"><span data-stu-id="daabd-154">Each of the InfoPath event objects in the InfoPath 2003-compatible object model implements different properties and methods.</span></span> <span data-ttu-id="daabd-155">Para obter mais informações sobre um determinado objeto Event, clique no objeto apropriado na tabela de objetos de eventos mostrada anteriormente.</span><span class="sxs-lookup"><span data-stu-id="daabd-155">For more information about a particular event object, click the appropriate object in the Event Objects table shown earlier.</span></span> 
  

