---
title: Solucionar problemas de modelos de formulário que usam o modelo de objeto do InfoPath no tempo de design
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
keywords:
- modelos de formulário compatíveis com o InfoPath 2003, Solucionando problemas no tempo de design, Solucionando problemas de modelos de formulário [InfoPath 2007], tempo de design
localization_priority: Normal
ms.assetid: 4179b235-e21d-4c37-ae2b-ad01388296ec
description: As seções a seguir descrevem cenários de solução de problemas comuns que você pode encontrar ao criar e depurar modelos de formulário de código gerenciado que usam o modelo de objeto compatível com o InfoPath 2003 fornecido pelo Microsoft. Office. Interop. InfoPath. SemiTrust namespace.
ms.openlocfilehash: 106f12602bae86d85c2a7d2f920f59d50326c908
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33436521"
---
# <a name="troubleshoot-form-templates-that-use-the-infopath-object-model-at-design-time"></a><span data-ttu-id="3e7f3-104">Solucionar problemas de modelos de formulário que usam o modelo de objeto do InfoPath no tempo de design</span><span class="sxs-lookup"><span data-stu-id="3e7f3-104">Troubleshoot form templates that use the InfoPath object model at design time</span></span>

<span data-ttu-id="3e7f3-105">As seções a seguir descrevem cenários de solução de problemas comuns que você pode encontrar ao criar e depurar modelos de formulário de código gerenciado que usam o modelo de objeto compatível com o InfoPath 2003 fornecido pelo \*\* Namespace Microsoft. Office. Interop. InfoPath. SemiTrust\*\* .</span><span class="sxs-lookup"><span data-stu-id="3e7f3-105">The following sections describe common troubleshooting scenarios you may encounter while designing and debugging managed code form templates that use the InfoPath 2003-compatible object model provided by the **Microsoft.Office.Interop.InfoPath.SemiTrust** namespace.</span></span> 
  
## <a name="cannot-preview-or-debug-form-templates-that-use-calls-to-object-model-security-level-3-methods-and-properties"></a><span data-ttu-id="3e7f3-106">Não é possível visualizar ou depurar modelos de formulário que usam chamadas para métodos de segurança do modelo de objeto 3 e propriedades</span><span class="sxs-lookup"><span data-stu-id="3e7f3-106">Cannot Preview or Debug Form Templates That Use Calls to Object Model Security Level 3 Methods and Properties</span></span>

<span data-ttu-id="3e7f3-107">Se você tentar depurar ou Visualizar um projeto de código gerenciado que contenha código que invoque membros de modelo de objeto que exigem confiança total, o InfoPath exibirá a mensagem de erro "ocorreu uma exceção de segurança sem tratamento no código do formulário" e o formulário não será aberto .</span><span class="sxs-lookup"><span data-stu-id="3e7f3-107">If you attempt to debug or preview a managed-code project that contains code that invokes object model members that require full trust, InfoPath will display the error message "An unhandled security exception has occurred in the form's code" and the form will not open.</span></span> <span data-ttu-id="3e7f3-108">Para permitir que a lógica de negócios no modelo de formulário seja depurada ou visualizada, você deve definir o nível de segurança como **confiança total** e assinar digitalmente o modelo de formulário.</span><span class="sxs-lookup"><span data-stu-id="3e7f3-108">To allow business logic in the form template to be debugged or previewed, you must set the security level to **Full Trust** and digitally sign the form template.</span></span> <span data-ttu-id="3e7f3-109">Para obter detalhes sobre como fazer isso, confira [Visualizar e depurar modelos de formulário que exigem confiança total](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span><span class="sxs-lookup"><span data-stu-id="3e7f3-109">For details on how to do this, see [Preview and Debug Form Templates that Require Full Trust](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span></span>
  
## <a name="cannot-update-xpath-expressions-in-event-handlers-if-the-matchpath-parameter-value-was-deleted-manually"></a><span data-ttu-id="3e7f3-110">Não é possível atualizar expressões XPath em manipuladores de eventos se o valor do parâmetro MatchPath tiver sido excluído manualmente</span><span class="sxs-lookup"><span data-stu-id="3e7f3-110">Cannot Update XPath Expressions in Event Handlers If the MatchPath Parameter Value Was Deleted Manually</span></span>

<span data-ttu-id="3e7f3-111">Se você adicionar um manipulador de eventos a um campo ou grupo e posteriormente alterar o esquema da fonte de dados no painel de tarefas **campos** do InfoPath de uma maneira que afete esse campo ou grupo (por exemplo, renomeando ou movendo-o), uma mensagem será exibida perguntando se você deseja atualizar e as expressões XPath no código do seu formulário.</span><span class="sxs-lookup"><span data-stu-id="3e7f3-111">If you add an event handler to a field or group and later change the schema of the data source in the InfoPath **Fields** task pane in a way that affects that field or group (for example, by renaming or moving it), a message will be displayed asking if you want to update the XPath expressions in your form's code.</span></span> <span data-ttu-id="3e7f3-112">As expressões XPath referenciadas nesta mensagem são os valores especificados no parâmetro [MatchPath](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.MatchPath.aspx) do atributo [InfoPathEventHandlerAttribute](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.aspx) , que são usados para associar o manipulador de eventos a um campo ou grupo na fonte de dados do formulário .</span><span class="sxs-lookup"><span data-stu-id="3e7f3-112">The XPath expressions referred to in this message are the values specified in the [MatchPath](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.MatchPath.aspx) parameter of the [InfoPathEventHandlerAttribute](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.aspx) attribute, which are used to associate the event handler with a field or group in your form's data source.</span></span> <span data-ttu-id="3e7f3-113">Nenhuma outra expressão XPath no seu código será atualizada.</span><span class="sxs-lookup"><span data-stu-id="3e7f3-113">No other XPath expressions in your code will be updated.</span></span> <span data-ttu-id="3e7f3-114">O algoritmo para atualizar as expressões XPath depende de um valor presente no parâmetro **MatchPath** dos atributos **InfoPathEventHandler** que são aplicados no seu código de formulário.</span><span class="sxs-lookup"><span data-stu-id="3e7f3-114">The algorithm for updating the XPath expressions depends on a value being present in the **MatchPath** parameter of the **InfoPathEventHandler** attributes that are applied in your form code.</span></span> <span data-ttu-id="3e7f3-115">Se você excluiu manualmente esses valores antes de responder ao prompt para atualizar expressões XPath, o InfoPath não poderá atualizar as expressões XPath automaticamente.</span><span class="sxs-lookup"><span data-stu-id="3e7f3-115">If you manually deleted these values before responding to the prompt to update XPath expressions, InfoPath will not be able to update the XPath expressions automatically.</span></span> <span data-ttu-id="3e7f3-116">Para obter mais informações, consulte [Adicionar um manipulador de eventos usando o modelo de objeto do InfoPath 2003](how-to-add-an-event-handler-using-the-infopath-2003-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="3e7f3-116">For more information, see [Add an Event Handler Using the InfoPath 2003 Object Model](how-to-add-an-event-handler-using-the-infopath-2003-object-model.md).</span></span>
  
## <a name="cannot-call-members-of-the-infopath-2003-compatible-object-model-on-a-separate-thread"></a><span data-ttu-id="3e7f3-117">Não é possível chamar membros do modelo de objeto compatível com o InfoPath 2003 em um thread separado</span><span class="sxs-lookup"><span data-stu-id="3e7f3-117">Cannot Call Members of the InfoPath 2003 Compatible Object Model on a Separate Thread</span></span>

<span data-ttu-id="3e7f3-118">O modelo de objeto compatível com o InfoPath 2003 não oferece suporte a chamadas em um thread separado.</span><span class="sxs-lookup"><span data-stu-id="3e7f3-118">The InfoPath 2003-compatible object model does not support calls on a separate thread.</span></span> <span data-ttu-id="3e7f3-119">Por exemplo, o código a seguir, que chama uma função chamada LaunchOMFunction que chama membros do modelo de objeto do InfoPath, não será executado.</span><span class="sxs-lookup"><span data-stu-id="3e7f3-119">For example, the following code, which calls a function named LaunchOMFunction that calls members of the InfoPath object model, will not run.</span></span> 
  
```cs
Thread th = new Thread(new ThreadStart(LaunchOMFunction));
th.Start();
```

<span data-ttu-id="3e7f3-120">Quando necessário, há uma forma de contornar essa limitação.</span><span class="sxs-lookup"><span data-stu-id="3e7f3-120">When necessary, there is a way to work around this limitation.</span></span> <span data-ttu-id="3e7f3-121">Para saber mais, confira [suporte a Threading em projetos do InfoPath usando o modelo de objeto do infopath 2003](threading-support-in-infopath-projects-using-the-infopath-2003-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="3e7f3-121">For information, see [Threading Support in InfoPath Projects Using the InfoPath 2003 Object Model](threading-support-in-infopath-projects-using-the-infopath-2003-object-model.md).</span></span>
  
## <a name="omitting-optional-parameters-causes-a-build-error-in-visual-basic-and-visual-c"></a><span data-ttu-id="3e7f3-122">A omissão de parâmetros opcionais causa um erro de compilação no Visual Basic e no Visual C#</span><span class="sxs-lookup"><span data-stu-id="3e7f3-122">Omitting Optional Parameters Causes a Build Error in Visual Basic and Visual C#</span></span>

<span data-ttu-id="3e7f3-123">Se um membro do modelo de objeto do InfoPath contiver um parâmetro opcional e você não especificar um valor para esse parâmetro, você deverá passar o **tipo. campo ausente** para esse parâmetro.</span><span class="sxs-lookup"><span data-stu-id="3e7f3-123">If an InfoPath object model member contains an optional parameter, and you do not specify a value for that parameter, you must pass the **Type.Missing** field for that parameter instead.</span></span> <span data-ttu-id="3e7f3-124">Não transferir o campo **Type.Missing** quando um valor real for omitido resultará em um erro de compilação.</span><span class="sxs-lookup"><span data-stu-id="3e7f3-124">Failure to pass the **Type.Missing** field when an actual value is omitted will result in a build error.</span></span> <span data-ttu-id="3e7f3-125">Isso se aplica ao código escrito em Visual Basic e Visual C#.</span><span class="sxs-lookup"><span data-stu-id="3e7f3-125">This is true for code written in both Visual Basic and Visual C#.</span></span> <span data-ttu-id="3e7f3-126">Para obter mais informações e exemplos, consulte a seção "passando parâmetros opcionais para membros do modelo de objeto do InfoPath" no tópico [modelos de objeto compatíveis com o infopath 2003](infopath-2003-compatible-object-models.md) .</span><span class="sxs-lookup"><span data-stu-id="3e7f3-126">For more information and examples see the "Passing Optional Parameters to InfoPath Object Model Members" section in the [InfoPath 2003 Compatible Object Models](infopath-2003-compatible-object-models.md) topic.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="3e7f3-127">Confira também</span><span class="sxs-lookup"><span data-stu-id="3e7f3-127">See also</span></span>

- [<span data-ttu-id="3e7f3-128">Sobre o modelo de segurança para modelos de formulário com código</span><span class="sxs-lookup"><span data-stu-id="3e7f3-128">About the Security Model for Form Templates with Code</span></span>](about-the-security-model-for-form-templates-with-code.md)
- [<span data-ttu-id="3e7f3-129">Implantar modelos de formulário do InfoPath com código</span><span class="sxs-lookup"><span data-stu-id="3e7f3-129">Deploy InfoPath Form Templates with Code</span></span>](how-to-deploy-infopath-form-templates-with-code.md)
- [<span data-ttu-id="3e7f3-130">Manipular erros usando o modelo de objeto do InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="3e7f3-130">Handle Errors Using the InfoPath 2003 Object Model</span></span>](how-to-handle-errors-using-the-infopath-2003-object-model.md)
- [<span data-ttu-id="3e7f3-131">Visualizar e depurar modelos de formulário que exigem confiança total</span><span class="sxs-lookup"><span data-stu-id="3e7f3-131">Preview and Debug Form Templates that Require Full Trust</span></span>](how-to-preview-and-debug-form-templates-that-require-full-trust.md)
- [<span data-ttu-id="3e7f3-132">Depurar projetos do InfoPath usando o modelo de objeto do InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="3e7f3-132">Debug InfoPath Projects Using the InfoPath 2003 Object Model</span></span>](how-to-debug-infopath-projects-using-the-infopath-2003-object-model.md)

