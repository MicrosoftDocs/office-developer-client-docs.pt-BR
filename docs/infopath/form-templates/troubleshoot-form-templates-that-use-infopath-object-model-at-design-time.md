---
title: Solucionar problemas de modelos de formulário que usam o modelo de objeto do InfoPath em tempo de design
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
keywords:
- tempo de design de modelos de formulário de 2003 compatíveis do InfoPath, solução de problemas em tempo de design, solucionando problemas de modelos de formulário [InfoPath 2007]
localization_priority: Normal
ms.assetid: 4179b235-e21d-4c37-ae2b-ad01388296ec
description: As próximas seções descrevem os cenários de solução de problemas comuns, que você pode encontrar durante a criação e depuração de modelos de formulário de código gerenciado que usam o modelo de objeto compatível com o InfoPath 2003 fornecido pelo SemiTrust namespace.
ms.openlocfilehash: af71c8058744561a4c8ee0870fb37054e9979751
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19765708"
---
# <a name="troubleshoot-form-templates-that-use-the-infopath-object-model-at-design-time"></a><span data-ttu-id="cf5be-104">Solucionar problemas de modelos de formulário que usam o modelo de objeto do InfoPath em tempo de design</span><span class="sxs-lookup"><span data-stu-id="cf5be-104">Troubleshoot form templates that use the InfoPath object model at design time</span></span>

<span data-ttu-id="cf5be-105">As próximas seções descrevem os cenários de solução de problemas comuns, que você pode encontrar durante a criação e depuração de modelos de formulário de código gerenciado que usam o modelo de objeto compatível com o InfoPath 2003 fornecido pelo ** SemiTrust** namespace.</span><span class="sxs-lookup"><span data-stu-id="cf5be-105">The following sections describe common troubleshooting scenarios you may encounter while designing and debugging managed code form templates that use the InfoPath 2003-compatible object model provided by the **Microsoft.Office.Interop.InfoPath.SemiTrust** namespace.</span></span> 
  
## <a name="cannot-preview-or-debug-form-templates-that-use-calls-to-object-model-security-level-3-methods-and-properties"></a><span data-ttu-id="cf5be-106">Não é possível visualizar ou modelos de formulário de depuração que usam chamadas para o objeto modelar propriedades e métodos de nível 3 de segurança</span><span class="sxs-lookup"><span data-stu-id="cf5be-106">Cannot Preview or Debug Form Templates That Use Calls to Object Model Security Level 3 Methods and Properties</span></span>

<span data-ttu-id="cf5be-107">Se você tentar depurar ou preview confiar em um projeto de código gerenciado que contém código que chama os membros do modelo de objeto que exigem completa, InfoPath exibirá a mensagem de erro "Ocorreu uma exceção de segurança não tratada no código do formulário" e o formulário não será aberto. .</span><span class="sxs-lookup"><span data-stu-id="cf5be-107">If you attempt to debug or preview a managed-code project that contains code that invokes object model members that require full trust, InfoPath will display the error message "An unhandled security exception has occurred in the form's code" and the form will not open.</span></span> <span data-ttu-id="cf5be-108">Para permitir que a lógica de negócios no modelo de formulário a ser depurados ou visualizados, você deve definir o nível de segurança como **Confiança total** e assinar digitalmente o modelo de formulário.</span><span class="sxs-lookup"><span data-stu-id="cf5be-108">To allow business logic in the form template to be debugged or previewed, you must set the security level to **Full Trust** and digitally sign the form template.</span></span> <span data-ttu-id="cf5be-109">Para obter detalhes sobre como fazer isso, consulte [Visualizar e depurar modelos de formulário que exigem confiança total](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span><span class="sxs-lookup"><span data-stu-id="cf5be-109">For details on how to do this, see [Preview and Debug Form Templates that Require Full Trust](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span></span>
  
## <a name="cannot-update-xpath-expressions-in-event-handlers-if-the-matchpath-parameter-value-was-deleted-manually"></a><span data-ttu-id="cf5be-110">Não é possível atualizar as expressões XPath nos manipuladores de eventos, se o valor do parâmetro MatchPath foi excluído manualmente</span><span class="sxs-lookup"><span data-stu-id="cf5be-110">Cannot Update XPath Expressions in Event Handlers If the MatchPath Parameter Value Was Deleted Manually</span></span>

<span data-ttu-id="cf5be-111">Se você adiciona um manipulador de eventos a um campo ou grupo e posteriormente alterar o esquema da fonte de dados no painel de tarefas do InfoPath **campos** de uma forma que afeta esse campo ou grupo (por exemplo, por renomeando ou movendo-), uma mensagem será exibida perguntando se você deseja atualiza f o XPath expressões em código do formulário.</span><span class="sxs-lookup"><span data-stu-id="cf5be-111">If you add an event handler to a field or group and later change the schema of the data source in the InfoPath **Fields** task pane in a way that affects that field or group (for example, by renaming or moving it), a message will be displayed asking if you want to update the XPath expressions in your form's code.</span></span> <span data-ttu-id="cf5be-112">As expressões XPath referidas nessa mensagem são os valores especificados no parâmetro [MatchPath](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.MatchPath.aspx) do atributo [InfoPathEventHandlerAttribute](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.aspx) , que são usados para associar o manipulador de eventos um campo ou grupo na fonte de dados do formulário .</span><span class="sxs-lookup"><span data-stu-id="cf5be-112">The XPath expressions referred to in this message are the values specified in the [MatchPath](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.MatchPath.aspx) parameter of the [InfoPathEventHandlerAttribute](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.aspx) attribute, which are used to associate the event handler with a field or group in your form's data source.</span></span> <span data-ttu-id="cf5be-113">Não há outras expressões XPath em seu código serão atualizados.</span><span class="sxs-lookup"><span data-stu-id="cf5be-113">No other XPath expressions in your code will be updated.</span></span> <span data-ttu-id="cf5be-114">O algoritmo para atualizar as expressões XPath depende de um valor que está sendo presente no parâmetro **MatchPath** dos atributos **InfoPathEventHandler** que são aplicados em seu código de formulário.</span><span class="sxs-lookup"><span data-stu-id="cf5be-114">The algorithm for updating the XPath expressions depends on a value being present in the **MatchPath** parameter of the **InfoPathEventHandler** attributes that are applied in your form code.</span></span> <span data-ttu-id="cf5be-115">Se você excluiu manualmente esses valores antes de responder ao prompt para atualizar as expressões XPath, o InfoPath não poderá atualizar as expressões XPath automaticamente.</span><span class="sxs-lookup"><span data-stu-id="cf5be-115">If you manually deleted these values before responding to the prompt to update XPath expressions, InfoPath will not be able to update the XPath expressions automatically.</span></span> <span data-ttu-id="cf5be-116">Para obter mais informações, consulte [Adicionar um manipulador de eventos usando o modelo de objeto do InfoPath 2003](how-to-add-an-event-handler-using-the-infopath-2003-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="cf5be-116">For more information, see [Add an Event Handler Using the InfoPath 2003 Object Model](how-to-add-an-event-handler-using-the-infopath-2003-object-model.md).</span></span>
  
## <a name="cannot-call-members-of-the-infopath-2003-compatible-object-model-on-a-separate-thread"></a><span data-ttu-id="cf5be-117">Não é possível chamar membros do modelo de objeto do InfoPath 2003 compatível com em um segmento separado</span><span class="sxs-lookup"><span data-stu-id="cf5be-117">Cannot Call Members of the InfoPath 2003 Compatible Object Model on a Separate Thread</span></span>

<span data-ttu-id="cf5be-118">O modelo de objeto compatível com o InfoPath 2003 não oferece suporte a chamadas em um segmento separado.</span><span class="sxs-lookup"><span data-stu-id="cf5be-118">The InfoPath 2003-compatible object model does not support calls on a separate thread.</span></span> <span data-ttu-id="cf5be-119">Por exemplo, o código a seguir, que chama uma função chamada LaunchOMFunction que chama os membros do modelo de objeto do InfoPath, não será executado.</span><span class="sxs-lookup"><span data-stu-id="cf5be-119">For example, the following code, which calls a function named LaunchOMFunction that calls members of the InfoPath object model, will not run.</span></span> 
  
```cs
Thread th = new Thread(new ThreadStart(LaunchOMFunction));
th.Start();
```

<span data-ttu-id="cf5be-120">Quando necessário, há uma maneira para contornar esta limitação.</span><span class="sxs-lookup"><span data-stu-id="cf5be-120">When necessary, there is a way to work around this limitation.</span></span> <span data-ttu-id="cf5be-121">Para obter informações, consulte [Suporte Threading InfoPath projetos usando o modelo de objeto do InfoPath 2003](threading-support-in-infopath-projects-using-the-infopath-2003-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="cf5be-121">For information, see [Threading Support in InfoPath Projects Using the InfoPath 2003 Object Model](threading-support-in-infopath-projects-using-the-infopath-2003-object-model.md).</span></span>
  
## <a name="omitting-optional-parameters-causes-a-build-error-in-visual-basic-and-visual-c"></a><span data-ttu-id="cf5be-122">Omitir os parâmetros opcionais causará um erro de compilação no Visual Basic e Visual c#</span><span class="sxs-lookup"><span data-stu-id="cf5be-122">Omitting Optional Parameters Causes a Build Error in Visual Basic and Visual C#</span></span>

<span data-ttu-id="cf5be-123">Se um membro de modelo de objeto do InfoPath contém um parâmetro opcional e você não especificar um valor para esse parâmetro, você deve passar o campo **Type.Missing** para esse parâmetro em vez disso.</span><span class="sxs-lookup"><span data-stu-id="cf5be-123">If an InfoPath object model member contains an optional parameter, and you do not specify a value for that parameter, you must pass the **Type.Missing** field for that parameter instead.</span></span> <span data-ttu-id="cf5be-124">Falha ao passar o campo **Type.Missing** quando um valor real for omitido resultará em um erro de compilação.</span><span class="sxs-lookup"><span data-stu-id="cf5be-124">Failure to pass the **Type.Missing** field when an actual value is omitted will result in a build error.</span></span> <span data-ttu-id="cf5be-125">Isso é verdadeiro para códigos escritos em Visual Basic e Visual c#.</span><span class="sxs-lookup"><span data-stu-id="cf5be-125">This is true for code written in both Visual Basic and Visual C#.</span></span> <span data-ttu-id="cf5be-126">Para obter mais informações e exemplos, consulte a seção "Passando opcional para InfoPath modelo membros do objeto Parameters" no tópico [Modelos de objeto do InfoPath 2003 compatíveis](infopath-2003-compatible-object-models.md) .</span><span class="sxs-lookup"><span data-stu-id="cf5be-126">For more information and examples see the "Passing Optional Parameters to InfoPath Object Model Members" section in the [InfoPath 2003 Compatible Object Models](infopath-2003-compatible-object-models.md) topic.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="cf5be-127">Confira também</span><span class="sxs-lookup"><span data-stu-id="cf5be-127">See also</span></span>

- [<span data-ttu-id="cf5be-128">Sobre o modelo de segurança para modelos de formulário com código</span><span class="sxs-lookup"><span data-stu-id="cf5be-128">About the Security Model for Form Templates with Code</span></span>](about-the-security-model-for-form-templates-with-code.md)
- [<span data-ttu-id="cf5be-129">Implantar modelos de formulário do InfoPath com código</span><span class="sxs-lookup"><span data-stu-id="cf5be-129">Deploy InfoPath Form Templates with Code</span></span>](how-to-deploy-infopath-form-templates-with-code.md)
- [<span data-ttu-id="cf5be-130">Lidar com erros usando o modelo de objeto do InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="cf5be-130">Handle Errors Using the InfoPath 2003 Object Model</span></span>](how-to-handle-errors-using-the-infopath-2003-object-model.md)
- [<span data-ttu-id="cf5be-131">Visualizar e depurar modelos de formulário que exigem confiança total</span><span class="sxs-lookup"><span data-stu-id="cf5be-131">Preview and Debug Form Templates that Require Full Trust</span></span>](how-to-preview-and-debug-form-templates-that-require-full-trust.md)
- [<span data-ttu-id="cf5be-132">Depurar projetos do InfoPath usando o modelo de objeto do InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="cf5be-132">Debug InfoPath Projects Using the InfoPath 2003 Object Model</span></span>](how-to-debug-infopath-projects-using-the-infopath-2003-object-model.md)

