---
title: Trabalhar com configurações do Gerenciamento de Direitos de Informação
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- gerenciamento de direitos de informação [infopath 2007], IRM do InfoPath 2007, gerenciamento de direitos de informação, [InfoPath 2007]
localization_priority: Normal
ms.assetid: 4ad91898-b23e-4410-8839-a65259e53d37
description: 'Há dois tipos de configurações de gerenciamento de direitos de informação (IRM) disponíveis no Microsoft InfoPath: um para proteger o acesso aos modelos de formulário do InfoPath e outro para controlar o acesso aos e ações nos dados do formulário contidos em formulários preenchidos.'
ms.openlocfilehash: 4e6fdac6a0b2b5cd6a29de948cc9dbbd01a407d8
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19765644"
---
# <a name="work-with-information-rights-management-settings"></a><span data-ttu-id="5cfdd-104">Trabalhar com configurações do Gerenciamento de Direitos de Informação</span><span class="sxs-lookup"><span data-stu-id="5cfdd-104">Work with Information Rights Management Settings</span></span>

<span data-ttu-id="5cfdd-105">Há dois tipos de configurações de gerenciamento de direitos de informação (IRM) disponíveis no Microsoft InfoPath: um para proteger o acesso aos modelos de formulário do InfoPath e outro para controlar o acesso aos e ações nos dados do formulário contidos em formulários preenchidos.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-105">There are two types of Information Rights Management (IRM) settings available in Microsoft InfoPath: one for protecting access to InfoPath form templates, and one for controlling access to and actions on form data contained in completed forms.</span></span>
  
> [!NOTE]
> <span data-ttu-id="5cfdd-106">Restringindo permissão só está disponível para modelos de formulário compatíveis com o editor do InfoPath.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-106">Restricting permission is only available to form templates compatible with the InfoPath editor.</span></span> <span data-ttu-id="5cfdd-107">Modelos de formulário compatíveis com navegador não suportam o IRM.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-107">Browser-compatible form templates do not support IRM.</span></span> 
  
## <a name="adding-the-manage-credentials-command-to-the-quick-access-toolbar"></a><span data-ttu-id="5cfdd-108">Adicionando o comando de credenciais de gerenciar na barra de ferramentas de acesso rápido</span><span class="sxs-lookup"><span data-stu-id="5cfdd-108">Adding the Manage Credentials Command to the Quick Access Toolbar</span></span>

<span data-ttu-id="5cfdd-109">O comando **Gerenciar credenciais** usado para trabalhar com configurações de IRM durante a criação de um modelo de formulário não está disponível por padrão.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-109">The **Manage Credentials** command used to work with IRM settings when designing a form template is not available by default.</span></span> <span data-ttu-id="5cfdd-110">Use as seguintes etapas para adicioná-lo à barra de **Ferramentas de acesso rápido**.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-110">Use the following steps to add it to the **Quick Access Toolbar**.</span></span>
  
### <a name="add-the-manage-credentials-command-to-the-quick-access-toolbar"></a><span data-ttu-id="5cfdd-111">Adicione o comando de credenciais de gerenciar na barra de ferramentas de acesso rápido</span><span class="sxs-lookup"><span data-stu-id="5cfdd-111">Add the Manage Credentials Command to the Quick Access Toolbar</span></span>

1.  <span data-ttu-id="5cfdd-112">Clique na seta na extremidade direita da barra de **Ferramentas de acesso rápido** para baixar os menu **Personalizar ferramentas de acesso rápido** e, em seguida, clique em **Mais de comandos**.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-112">Click the arrow on the right end of the **Quick Access Toolbar** to pull down the **Customize Quick Access Toolbar** menu, and then click **More Commands**.</span></span>
    
2. <span data-ttu-id="5cfdd-113">Na lista **Escolher comandos em** , selecione **Todos os comandos**.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-113">In the **Choose commands from** list, select **All Commands**.</span></span>
    
3. <span data-ttu-id="5cfdd-114">Percorra a lista para **Gerenciar credenciais**e, em seguida, clique em **Adicionar**.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-114">Scroll down the list to **Manage Credentials**, and then click **Add**.</span></span>
    
4. <span data-ttu-id="5cfdd-115">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-115">Click **OK**.</span></span>
    
<span data-ttu-id="5cfdd-116">Para obter mais informações sobre o uso de **Credenciais de gerenciar** comando e a caixa de diálogo **permissão** caixa no InfoPath, consulte o tópico "Criar um formulário modelo com permissão restrita" na Ajuda do InfoPath.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-116">For more information about using **Manage Credentials** command and the **Permission** dialog box in InfoPath, see the "Create a Form Template with Restricted Permission" topic in InfoPath help.</span></span> 
  
## <a name="the-irm-object-model"></a><span data-ttu-id="5cfdd-117">O modelo de objeto do IRM</span><span class="sxs-lookup"><span data-stu-id="5cfdd-117">The IRM Object Model</span></span>

<span data-ttu-id="5cfdd-118">Use a classe de [permissão](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.aspx) para acessar as configurações de permissão [UserPermissionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.aspx) e IRM que podem ser aplicadas a um formulário.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-118">Use the [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.aspx) class to access the [UserPermissionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.aspx) and IRM permission settings that can be applied to a form.</span></span> <span data-ttu-id="5cfdd-119">Para acessar o objeto de **permissão** associado a um modelo de formulário, use a propriedade [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Permission.aspx) da classe [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) .</span><span class="sxs-lookup"><span data-stu-id="5cfdd-119">To access the **Permission** object associated with a form template, use the [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Permission.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class.</span></span> <span data-ttu-id="5cfdd-120">O objeto retornado da **permissão** fornece acesso à coleção de objetos [UserPermission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.aspx) associados com o modelo de formulário e cada instância do formulário criado com esse modelo.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-120">The returned **Permission** object provides access to the collection of [UserPermission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.aspx) objects associated with the form template and each form instance created with that template.</span></span> 
  
<span data-ttu-id="5cfdd-121">Objeto **Permission** e suas propriedades e métodos estão disponíveis se as permissões são restritas no modelo de formulário ativo ou não.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-121">The **Permission** object and its properties and methods are available whether permissions are restricted on the active form template or not.</span></span> <span data-ttu-id="5cfdd-122">Use a propriedade [Enabled](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.Enabled.aspx) para determinar se um formulário possui permissões restritas.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-122">Use the [Enabled](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.Enabled.aspx) property to determine whether a form has restricted permissions.</span></span> 
  
<span data-ttu-id="5cfdd-123">Usando propriedades e métodos da classe permissão, permissões em um formulário são habilitadas em uma das seguintes maneiras:</span><span class="sxs-lookup"><span data-stu-id="5cfdd-123">Permissions on a form are enabled in one of the following ways by using properties and methods of the Permission class:</span></span>
  
<span data-ttu-id="5cfdd-124">A propriedade **Enabled** é definida como **true**.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-124">The **Enabled** property is set to **true**.</span></span>
  
<span data-ttu-id="5cfdd-125">A propriedade [DocumentAuthor](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.DocumentAuthor.aspx) é definida.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-125">The [DocumentAuthor](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.DocumentAuthor.aspx) property is set.</span></span> 
  
<span data-ttu-id="5cfdd-126">A propriedade [RequestPermissionUrl](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.RequestPermissionUrl.aspx) estiver definida.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-126">The [RequestPermissionUrl](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.RequestPermissionUrl.aspx) property is set.</span></span> 
  
<span data-ttu-id="5cfdd-127">A propriedade [StoreLicenses](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.StoreLicenses.aspx) é definida como **true** ou **false**.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-127">The [StoreLicenses](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.StoreLicenses.aspx) property is set to **true** or **false**.</span></span>
  
<span data-ttu-id="5cfdd-128">O método [ApplyPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.ApplyPolicy.aspx) é chamado.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-128">The [ApplyPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.ApplyPolicy.aspx) method is called.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="5cfdd-129">Se o cliente Windows Rights Management não está instalado no computador de um usuário, usando a classe de **permissão** levanta uma exceção.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-129">If the Windows Rights Management client is not installed on a user's computer, using the **Permission** class raises an exception.</span></span> 
  
<span data-ttu-id="5cfdd-130">Para trabalhar programaticamente com as configurações de IRM de usuários individuais em formulários, use as classes **UserPermissionCollection** e **UserPermission** .</span><span class="sxs-lookup"><span data-stu-id="5cfdd-130">To work programmatically with IRM settings of individual users in forms, use the **UserPermissionCollection** and **UserPermission** classes.</span></span> 
  
<span data-ttu-id="5cfdd-131">Um objeto **UserPermission** associa um conjunto de permissões para o formulário atual com um único usuário e uma data de vencimento opcional.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-131">A **UserPermission** object associates a set of permissions for the current form with a single user and an optional expiration date.</span></span> <span data-ttu-id="5cfdd-132">Use o método [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Add.aspx) da classe **UserPermissionCollection** para adicionar e conceder a um usuário um conjunto de permissões no formulário atual.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-132">Use the [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Add.aspx) method of the **UserPermissionCollection** class to add and grant a user a set of permissions on the current form.</span></span> <span data-ttu-id="5cfdd-133">Use o método [Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Remove.aspx) da classe **UserPermissionCollection** para remover um usuário e as permissões do usuário.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-133">Use the [Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Remove.aspx) method of the **UserPermissionCollection** class to remove a user and the user's permissions.</span></span> <span data-ttu-id="5cfdd-134">Enquanto algumas permissões concedidas através da interface do usuário se aplicam a todos os usuários, como a data de expiração e de impressão, você pode usar as classes **UserPermission** e **UserPermissionCollection** para atribuí-las em uma base por usuário com por usuário datas de expiração.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-134">While some permissions granted through the user interface apply to all users, such as printing and expiration date, you can use the **UserPermission** and **UserPermissionCollection** classes to assign them on a per-user basis with per-user expiration dates.</span></span> <span data-ttu-id="5cfdd-135">O modelo de objeto permite aos desenvolvedores para enumerar as configurações de permissão em um formulário e fornecem funcionalidade que permite que os usuários do formulário Adicionar permissões ao formulário sem precisar usar o painel de tarefas de **Permissão do formulário** ou caixa de diálogo **permissão** .</span><span class="sxs-lookup"><span data-stu-id="5cfdd-135">The object model allows developers to enumerate permission settings in a form and to provide functionality that allows form users to add permissions to the form without having to use the **Form Permission** task pane or the **Permission** dialog box.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="5cfdd-136">Permissões não podem ser aplicadas quando um formulário está no modo de visualização.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-136">Permissions cannot be applied when a form is in preview mode.</span></span> <span data-ttu-id="5cfdd-137">Por esse motivo, todas as propriedades da classe **permissão** são somente leitura quando um formulário está sendo visualizado.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-137">For this reason, all of the properties of the **Permission** class are read-only when a form is being previewed.</span></span> <span data-ttu-id="5cfdd-138">No modo de visualização, a propriedade **Enabled** sempre retornará **false**e se o código tentar alterar essa configuração, um **System.Runtime.InteropServices.COMException** é gerado e o erro "o método/propriedade não está disponível no modo de visualização modo"é retornado.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-138">In preview mode, the **Enabled** property will always return **false**, and if code attempts to change this setting, a **System.Runtime.InteropServices.COMException** is raised and the error "The property/method is not available in preview mode" is returned.</span></span> <span data-ttu-id="5cfdd-139">Da mesma forma, os métodos associados as classes **UserPermission** e **UserPermissionCollection** também retornará essa mensagem de erro quando usado no modo de visualização.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-139">Similarly, the methods associated with the **UserPermission** and **UserPermissionCollection** classes will also return this error message when used in preview mode.</span></span> 
  
### <a name="overview-of-the-permission-class"></a><span data-ttu-id="5cfdd-140">Visão geral da classe permissão</span><span class="sxs-lookup"><span data-stu-id="5cfdd-140">Overview of the Permission Class</span></span>

<span data-ttu-id="5cfdd-141">A classe **UserPermissionCollection** fornece as seguintes propriedades e um método.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-141">The **UserPermissionCollection** class provides the following properties and one method.</span></span> 
  
|<span data-ttu-id="5cfdd-142">**Nome**</span><span class="sxs-lookup"><span data-stu-id="5cfdd-142">**Name**</span></span>|<span data-ttu-id="5cfdd-143">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="5cfdd-143">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="5cfdd-144">Método [ApplyPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.ApplyPolicy.aspx)</span><span class="sxs-lookup"><span data-stu-id="5cfdd-144">[ApplyPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.ApplyPolicy.aspx) method</span></span>  <br/> |<span data-ttu-id="5cfdd-145">Aplica uma diretiva para o formulário usando um arquivo de modelo de política.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-145">Applies a policy to the form using a policy template file.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-146">Propriedade [DocumentAuthor](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.DocumentAuthor.aspx)</span><span class="sxs-lookup"><span data-stu-id="5cfdd-146">[DocumentAuthor](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.DocumentAuthor.aspx) property</span></span>  <br/> |<span data-ttu-id="5cfdd-147">Obtém ou define o autor do formulário atual como um endereço de email.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-147">Gets or sets the author of the current form as an email address.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-148">Propriedade [Enabled](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.Enabled.aspx)</span><span class="sxs-lookup"><span data-stu-id="5cfdd-148">[Enabled](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.Enabled.aspx) property</span></span>  <br/> |<span data-ttu-id="5cfdd-149">Obtém ou define se as configurações de permissão representadas pelo objeto de **permissão** estão habilitadas para o formulário atual.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-149">Gets or sets whether the permission settings represented by the **Permission** object are enabled for the current form.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-150">Propriedade [PermissionFromPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PermissionFromPolicy.aspx)</span><span class="sxs-lookup"><span data-stu-id="5cfdd-150">[PermissionFromPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PermissionFromPolicy.aspx) property</span></span>  <br/> |<span data-ttu-id="5cfdd-151">Obtém ou define se uma política de permissão foi aplicada ao formulário atual.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-151">Gets or sets whether a permission policy has been applied to the current form.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-152">Propriedade [PolicyDescription](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PolicyDescription.aspx)</span><span class="sxs-lookup"><span data-stu-id="5cfdd-152">[PolicyDescription](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PolicyDescription.aspx) property</span></span>  <br/> |<span data-ttu-id="5cfdd-153">Obtém uma descrição da política que foi aplicada ao formulário atual.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-153">Gets a description of the policy that was applied to the current form.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-154">Propriedade [PolicyName](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PolicyName.aspx)</span><span class="sxs-lookup"><span data-stu-id="5cfdd-154">[PolicyName](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PolicyName.aspx) property</span></span>  <br/> |<span data-ttu-id="5cfdd-155">Obtém o nome da política que foi aplicado ao formulário atual.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-155">Gets the name of the policy that was applied to the current form.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-156">Propriedade [RequestPermissionUrl](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.RequestPermissionUrl.aspx)</span><span class="sxs-lookup"><span data-stu-id="5cfdd-156">[RequestPermissionUrl](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.RequestPermissionUrl.aspx) property</span></span>  <br/> |<span data-ttu-id="5cfdd-157">Obtém ou define o arquivo, URL ou endereço de email de contato para usuários que precisam de permissões adicionais no formulário atual.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-157">Gets or sets the file, URL, or email address to contact for users who need additional permissions on the current form.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-158">Propriedade [StoreLicenses](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.StoreLicenses.aspx)</span><span class="sxs-lookup"><span data-stu-id="5cfdd-158">[StoreLicenses](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.StoreLicenses.aspx) property</span></span>  <br/> |<span data-ttu-id="5cfdd-159">Obtém ou define se a licença do usuário para exibir o formulário atual deve ser armazenados em cache para permitir a exibição offline quando o usuário não pode se conectar a um servidor de gerenciamento de direitos.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-159">Gets or sets whether the user's license to view the current form should be cached to allow offline viewing when the user cannot connect to a rights management server.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-160">Propriedade [permissõesde usuário](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.UserPermissions.aspx)</span><span class="sxs-lookup"><span data-stu-id="5cfdd-160">[UserPermissions](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.UserPermissions.aspx) property</span></span>  <br/> |<span data-ttu-id="5cfdd-161">Obtém um objeto **UserPermissionCollection** para o formulário atual.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-161">Gets a **UserPermissionCollection** object for the current form.</span></span>  <br/> |
   
### <a name="overview-of-the-userpermissioncollection-class"></a><span data-ttu-id="5cfdd-162">Visão geral da classe UserPermissionCollection</span><span class="sxs-lookup"><span data-stu-id="5cfdd-162">Overview of the UserPermissionCollection Class</span></span>

<span data-ttu-id="5cfdd-163">A classe **UserPermissionCollection** fornece as seguintes propriedades e métodos.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-163">The **UserPermissionCollection** class provides the following properties and methods.</span></span> 
  
|<span data-ttu-id="5cfdd-164">**Nome**</span><span class="sxs-lookup"><span data-stu-id="5cfdd-164">**Name**</span></span>|<span data-ttu-id="5cfdd-165">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="5cfdd-165">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="5cfdd-166">Método [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Add.aspx) (sobrecargas + 3)</span><span class="sxs-lookup"><span data-stu-id="5cfdd-166">[Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Add.aspx) method (+3 overloads)</span></span>  <br/> |<span data-ttu-id="5cfdd-167">Adiciona um novo usuário ao formulário atual, opcionalmente, especificando permissões e uma data de validade.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-167">Adds a new user to the current form, optionally specifying permissions and an expiration date.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-168">Método [Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Remove.aspx)</span><span class="sxs-lookup"><span data-stu-id="5cfdd-168">[Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Remove.aspx) method</span></span>  <br/> |<span data-ttu-id="5cfdd-169">Remove o objeto **UserPermission** com o especificado **UserId** da coleção.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-169">Removes the **UserPermission** object with the specified **UserId** from the collection.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-170">Método [RemoveAll](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.RemoveAll.aspx)</span><span class="sxs-lookup"><span data-stu-id="5cfdd-170">[RemoveAll](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.RemoveAll.aspx) method</span></span>  <br/> |<span data-ttu-id="5cfdd-171">Remove todos os objetos **UserPermission** da coleção.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-171">Removes all **UserPermission** objects from the collection.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-172">Propriedade [Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Count.aspx)</span><span class="sxs-lookup"><span data-stu-id="5cfdd-172">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="5cfdd-173">Obtém o número de objetos **UserPermission** da coleção.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-173">Gets the number of **UserPermission** objects in the collection.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-174">Propriedade [item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Item.aspx) (sobrecarga + 1)</span><span class="sxs-lookup"><span data-stu-id="5cfdd-174">[Item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Item.aspx) property (+1 overload)</span></span>  <br/> |<span data-ttu-id="5cfdd-175">Obtém um objeto **UserPermission** .</span><span class="sxs-lookup"><span data-stu-id="5cfdd-175">Gets a **UserPermission** object.</span></span>  <br/> |
   
### <a name="overview-of-the-userpermission-class"></a><span data-ttu-id="5cfdd-176">Visão geral da classe UserPermission</span><span class="sxs-lookup"><span data-stu-id="5cfdd-176">Overview of the UserPermission Class</span></span>

<span data-ttu-id="5cfdd-177">A classe **UserPermission** fornece as seguintes propriedades e um método.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-177">The **UserPermission** class provides the following properties and one method.</span></span> 
  
|<span data-ttu-id="5cfdd-178">**Nome**</span><span class="sxs-lookup"><span data-stu-id="5cfdd-178">**Name**</span></span>|<span data-ttu-id="5cfdd-179">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="5cfdd-179">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="5cfdd-180">Método [Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.Remove.aspx)</span><span class="sxs-lookup"><span data-stu-id="5cfdd-180">[Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.Remove.aspx) method</span></span>  <br/> |<span data-ttu-id="5cfdd-181">Remove o objeto **UserPermission** atual de permissões do formulário.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-181">Removes the current **UserPermission** object from the form's permissions.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-182">Propriedade [ExpirationDate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.ExpirationDate.aspx)</span><span class="sxs-lookup"><span data-stu-id="5cfdd-182">[ExpirationDate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.ExpirationDate.aspx) property</span></span>  <br/> |<span data-ttu-id="5cfdd-183">Obtém ou define a data de vencimento opcional para as permissões no formulário atual atribuído ao usuário associado a uma instância da classe **UserPermission** .</span><span class="sxs-lookup"><span data-stu-id="5cfdd-183">Gets or sets the optional expiration date for the permissions on the current form assigned to the user associated with an instance of the **UserPermission** class.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-184">Propriedade [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.Permission.aspx)</span><span class="sxs-lookup"><span data-stu-id="5cfdd-184">[Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.Permission.aspx) property</span></span>  <br/> |<span data-ttu-id="5cfdd-185">Obtém ou define um valor que representa as permissões no formulário atual atribuído ao usuário associado a uma instância da classe **UserPermission** .</span><span class="sxs-lookup"><span data-stu-id="5cfdd-185">Gets or sets a value representing the permissions on the current form assigned to the user associated with an instance of the **UserPermission** class.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-186">Propriedade [UserId](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.UserId.aspx)</span><span class="sxs-lookup"><span data-stu-id="5cfdd-186">[UserId](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.UserId.aspx) property</span></span>  <br/> |<span data-ttu-id="5cfdd-187">Obtém o endereço de email do usuário cujas permissões no formulário atual são determinadas pelo objeto **UserPermission** especificado.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-187">Gets the email address of the user whose permissions on the current form are determined by the specified **UserPermission** object.</span></span>  <br/> |
   
### <a name="the-permissiontype-enumeration"></a><span data-ttu-id="5cfdd-188">A enumeração PermissionType</span><span class="sxs-lookup"><span data-stu-id="5cfdd-188">The PermissionType Enumeration</span></span>

<span data-ttu-id="5cfdd-189">Permissões de um usuário são definidas ou lido usando valores de enumeração [PermissionType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.PermissionType.aspx) .</span><span class="sxs-lookup"><span data-stu-id="5cfdd-189">A user's permissions are set or read using [PermissionType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.PermissionType.aspx) enumeration values.</span></span> 
  
|<span data-ttu-id="5cfdd-190">**Nome**</span><span class="sxs-lookup"><span data-stu-id="5cfdd-190">**Name**</span></span>|<span data-ttu-id="5cfdd-191">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="5cfdd-191">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="5cfdd-192">**PermissionType.Change**</span><span class="sxs-lookup"><span data-stu-id="5cfdd-192">**PermissionType.Change**</span></span> <br/> |<span data-ttu-id="5cfdd-193">Permite aos usuários exibir, editar, copiar e salvar, mas não imprimir um formulário.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-193">Allows users to view, edit, copy, and save, but not print a form.</span></span> <span data-ttu-id="5cfdd-194">Equivalente à **leitura**, as permissões **Editar**, **Salvar**e **extrair** combinadas.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-194">Equivalent to the **Read**, **Edit**, **Save**, and **Extract** permissions combined.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-195">**PermissionType.Edit**</span><span class="sxs-lookup"><span data-stu-id="5cfdd-195">**PermissionType.Edit**</span></span> <br/> |<span data-ttu-id="5cfdd-196">Permite que o usuário edite o formulário.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-196">Allows the user to edit the form.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-197">**PermissionType.Extract**</span><span class="sxs-lookup"><span data-stu-id="5cfdd-197">**PermissionType.Extract**</span></span> <br/> |<span data-ttu-id="5cfdd-198">Permite que um usuário com a permissão de **leitura** copiem o conteúdo no formulário.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-198">Allows a user with the **Read** permission to copy content in the form.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-199">**PermissionType.FullControl**</span><span class="sxs-lookup"><span data-stu-id="5cfdd-199">**PermissionType.FullControl**</span></span> <br/> |<span data-ttu-id="5cfdd-200">Permite ao usuário adicionar, alterar e remover permissões para outros usuários de um formulário.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-200">Allows the user to add, change, and remove permissions for other users of a form.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-201">**PermissionType.ObjectModel**</span><span class="sxs-lookup"><span data-stu-id="5cfdd-201">**PermissionType.ObjectModel**</span></span> <br/> |<span data-ttu-id="5cfdd-202">Permite que um usuário acessar o documento de formulário de forma programática por meio de seu modelo de objeto.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-202">Allows a user to access the form document programmatically through its object model.</span></span> <span data-ttu-id="5cfdd-203">Os usuários sem a permissão **ObjectModel** não podem usar o modelo de objeto para determinar suas próprias permissões.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-203">Users without the **ObjectModel** permission cannot use the object model to determine their own permissions.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-204">**PermissionType.Print**</span><span class="sxs-lookup"><span data-stu-id="5cfdd-204">**PermissionType.Print**</span></span> <br/> |<span data-ttu-id="5cfdd-205">Permite ao usuário imprimir o formulário.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-205">Allows the user to print the form.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-206">**PermissionType.Read**</span><span class="sxs-lookup"><span data-stu-id="5cfdd-206">**PermissionType.Read**</span></span> <br/> |<span data-ttu-id="5cfdd-207">Permite ao usuário ler (exibição) o formulário.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-207">Allows the user to read (view) the form.</span></span> <span data-ttu-id="5cfdd-208">(As permissões de **leitura** e o **modo de exibição** são equivalentes).</span><span class="sxs-lookup"><span data-stu-id="5cfdd-208">(The **Read** and **View** permissions are equivalent.)</span></span>  <br/> |
|<span data-ttu-id="5cfdd-209">**PermissionType.Save**</span><span class="sxs-lookup"><span data-stu-id="5cfdd-209">**PermissionType.Save**</span></span> <br/> |<span data-ttu-id="5cfdd-210">Permite que o usuário salve o formulário.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-210">Allows the user to save the form.</span></span>  <br/> |
|<span data-ttu-id="5cfdd-211">**PermissionType.View**</span><span class="sxs-lookup"><span data-stu-id="5cfdd-211">**PermissionType.View**</span></span> <br/> |<span data-ttu-id="5cfdd-212">Permite ao usuário exibir (leitura) do formulário.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-212">Allows the user to view (read) the form.</span></span> <span data-ttu-id="5cfdd-213">(As permissões de **leitura** e o **modo de exibição** são equivalentes).</span><span class="sxs-lookup"><span data-stu-id="5cfdd-213">(The **Read** and **View** permissions are equivalent.)</span></span>  <br/> |
   
### <a name="example"></a><span data-ttu-id="5cfdd-214">Exemplo</span><span class="sxs-lookup"><span data-stu-id="5cfdd-214">Example</span></span>

<span data-ttu-id="5cfdd-215">No exemplo a seguir, clicando no controle de **botão** obtém o **UserPermissionsCollection** para o formulário atual, adiciona e atribui um usuário para o nível de acesso de alteração e define uma data de validade de dois dias a partir da data atual.</span><span class="sxs-lookup"><span data-stu-id="5cfdd-215">In the following example, clicking the **Button** control gets the **UserPermissionsCollection** for the current form, adds and assigns a user to the Change access level, and sets an expiration date of two days from the current date.</span></span> 
  
```cs
public void CTRL1_Clicked(object sender, ClickedEventArgs e)
{
   string strExpirationDate = DateTime.Today.AddDays(2).ToString();
   DateTime dtExpirationDate = DateTime.Parse(strExpirationDate);
   this.Permission.UserPermissions.Add("someone@example.com", 
      PermissionType.Change, dtExpirationDate);
}
```

```vb
Public Sub CTRL1_Clicked(ByVal sender As Object, _
   ByVal e As ClickedEventArgs)
   Dim strExpirationDate As String = _
      DateTime.Today.AddDays(2).ToString()
   dtExpirationDate As DateTime = DateTime.Parse(strExpirationDate)
   Me.Permission.UserPermissions.Add("someone@example.com", _
      PermissionType.Change, dtExpirationDate)
End Sub
```


