---
title: Trabalhar com assinaturas digitais
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- assinaturas digitais [InfoPath 2007], InfoPath 2007, assinaturas digitais
localization_priority: Normal
ms.assetid: fd13fb71-aecf-47bb-8a6b-db70bd90ceeb
description: O modelo de objeto do namespace Microsoft. Office. InfoPath fornece recursos para trabalhar com assinaturas digitais programaticamente.
ms.openlocfilehash: ea657f80f6e38a06a91e19c245eadc203c7c580c
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32303581"
---
# <a name="work-with-digital-signatures"></a><span data-ttu-id="86c16-104">Trabalhar com assinaturas digitais</span><span class="sxs-lookup"><span data-stu-id="86c16-104">Work with Digital Signatures</span></span>

<span data-ttu-id="86c16-105">O modelo de objeto do namespace [Microsoft. Office. InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) fornece recursos para trabalhar com assinaturas digitais programaticamente.</span><span class="sxs-lookup"><span data-stu-id="86c16-105">The object model of the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace provides features for working with digital signatures programmatically.</span></span> 
  
## <a name="digital-signature-features"></a><span data-ttu-id="86c16-106">Recursos de assinatura digital</span><span class="sxs-lookup"><span data-stu-id="86c16-106">Digital Signature Features</span></span>

<span data-ttu-id="86c16-107">Os recursos de assinaturas digitais fornecidos pelo InfoPath permitem:</span><span class="sxs-lookup"><span data-stu-id="86c16-107">The digital signatures features provided by InfoPath enable you to:</span></span> 
  
- <span data-ttu-id="86c16-108">Habilitar assinaturas para o formulário inteiro ou para conjuntos específicos de dados no formulário que podem ser assinados separadamente.</span><span class="sxs-lookup"><span data-stu-id="86c16-108">Enable signatures for the entire form, or for specific sets of data in the form that can be signed separately.</span></span>
    
- <span data-ttu-id="86c16-109">Especifique, para cada conjunto de dados que podem ser assinados, se uma assinatura única ou várias assinaturas são permitidas e qual será a relação.</span><span class="sxs-lookup"><span data-stu-id="86c16-109">Specify, for each set of data that can be signed, whether a single signature or multiple signatures are allowed and what their relationship will be.</span></span> <span data-ttu-id="86c16-110">Por exemplo, você pode especificar se são assinaturas paralelas ou se cada nova assinatura assina todas as assinaturas anteriores.</span><span class="sxs-lookup"><span data-stu-id="86c16-110">For example, you can specify whether they are parallel co-signatures or whether each new signature countersigns all the earlier signatures.</span></span>
    
- <span data-ttu-id="86c16-111">Especifique uma mensagem a ser mostrada para os usuários de forma que eles assinem o formulário.</span><span class="sxs-lookup"><span data-stu-id="86c16-111">Specify a message to be shown to form users as they sign the form.</span></span>
    
- <span data-ttu-id="86c16-112">Insira e veja uma assinatura no documento.</span><span class="sxs-lookup"><span data-stu-id="86c16-112">Insert and see a signature in the document.</span></span> 
    
- <span data-ttu-id="86c16-113">Exibir informações verificáveis de não repúdio que foram adicionadas a cada assinatura para aumentar a segurança.</span><span class="sxs-lookup"><span data-stu-id="86c16-113">View verifiable non-repudiation information that has been added to each signature for increased security.</span></span> <span data-ttu-id="86c16-114">Essas informações adicionais, que incluem um modo de exibição do formulário como foram apresentadas a cada signatário, fazem parte da assinatura e não podem ser removidas sem invalidar a assinatura.</span><span class="sxs-lookup"><span data-stu-id="86c16-114">This additional information, which includes a view of the form as it was presented to each signer, is part of the signature and cannot be removed without invalidating the signature.</span></span> <span data-ttu-id="86c16-115">A qualquer momento, você pode recuperar esses dados clicando na assinatura no formulário para exibir a caixa de diálogo **verificar assinatura digital** .</span><span class="sxs-lookup"><span data-stu-id="86c16-115">At any time, you can recall this data by clicking on the signature in the form to display the **Verify Digital Signature** dialog box.</span></span> 
    
- <span data-ttu-id="86c16-116">Aproveite um modelo de objeto para trabalhar com assinaturas digitais.</span><span class="sxs-lookup"><span data-stu-id="86c16-116">Take advantage of an object model for working with digital signatures.</span></span> <span data-ttu-id="86c16-117">Adicione informações personalizadas ao bloco de assinatura em formulários totalmente confiáveis por meio do modelo de objeto de assinatura digital.</span><span class="sxs-lookup"><span data-stu-id="86c16-117">Add custom information to the signature block in fully trusted forms through the digital signature object model.</span></span> 
    
## <a name="overview-of-the-digital-signatures-object-model"></a><span data-ttu-id="86c16-118">Visão geral do modelo de objeto de assinaturas digitais</span><span class="sxs-lookup"><span data-stu-id="86c16-118">Overview of the Digital Signatures Object Model</span></span>

### <a name="the-sign-event"></a><span data-ttu-id="86c16-119">O evento Sign</span><span class="sxs-lookup"><span data-stu-id="86c16-119">The Sign Event</span></span>

<span data-ttu-id="86c16-120">O modelo de objeto para assinaturas digitais fornece o seguinte evento.</span><span class="sxs-lookup"><span data-stu-id="86c16-120">The object model for digital signatures provides the following event.</span></span>
  
|<span data-ttu-id="86c16-121">**Nome**</span><span class="sxs-lookup"><span data-stu-id="86c16-121">**Name**</span></span>|<span data-ttu-id="86c16-122">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="86c16-122">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="86c16-123">Sign</span><span class="sxs-lookup"><span data-stu-id="86c16-123">Sign</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) <br/> |<span data-ttu-id="86c16-124">Ocorre depois que um conjunto de dados é selecionado para assinar.</span><span class="sxs-lookup"><span data-stu-id="86c16-124">Occurs after a set of data has been selected to sign.</span></span>  <br/> <span data-ttu-id="86c16-125">Você pode usar esse evento para manipular os dados armazenados na assinatura digital.</span><span class="sxs-lookup"><span data-stu-id="86c16-125">You can use this event to manipulate the data stored within the digital signature.</span></span> <span data-ttu-id="86c16-126">Por exemplo, você pode adicionar dados de um servidor de carimbo de data/hora confiável ou adicionar uma referenda do lado do servidor da transação.</span><span class="sxs-lookup"><span data-stu-id="86c16-126">For example, you can add data from a trusted timestamp server, or add a server-side countersignature of the transaction.</span></span> <span data-ttu-id="86c16-127">Você também pode usar esse evento para bloquear a assinatura se o usuário atual não for um membro de um grupo específico.</span><span class="sxs-lookup"><span data-stu-id="86c16-127">You can also use this event to block signing if the current user is not a member of a particular group.</span></span>  <br/> |
   
### <a name="the-signeventargs-object"></a><span data-ttu-id="86c16-128">O objeto Signeventargs</span><span class="sxs-lookup"><span data-stu-id="86c16-128">The SignEventArgs Object</span></span>

<span data-ttu-id="86c16-129">Um manipulador de eventos para o evento [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) pode funcionar com o objeto Event de [signeventargs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignEventArgs.aspx) , que fornece as propriedades a seguir.</span><span class="sxs-lookup"><span data-stu-id="86c16-129">An event handler for the [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) event can work with the [SignEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignEventArgs.aspx) event object, which provides the following properties.</span></span> 
  
|<span data-ttu-id="86c16-130">**Nome**</span><span class="sxs-lookup"><span data-stu-id="86c16-130">**Name**</span></span>|<span data-ttu-id="86c16-131">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="86c16-131">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="86c16-132">SignedDataBlock</span><span class="sxs-lookup"><span data-stu-id="86c16-132">SignedDataBlock</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignEventArgs.SignedDataBlock.aspx) <br/> |<span data-ttu-id="86c16-133">Obtém o conjunto de dados que gerou o evento [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) .</span><span class="sxs-lookup"><span data-stu-id="86c16-133">Gets the set of data that raised the [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) event.</span></span>  <br/> |
|[<span data-ttu-id="86c16-134">SignatureWizard</span><span class="sxs-lookup"><span data-stu-id="86c16-134">SignatureWizard</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignEventArgs.SignatureWizard.aspx) <br/> |<span data-ttu-id="86c16-135">Obtém ou define se a caixa de diálogo **assinaturas digitais** deve ser exibida.</span><span class="sxs-lookup"><span data-stu-id="86c16-135">Gets or sets whether to display the **Digital Signatures** dialog box.</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="86c16-136">No modelo de objeto de código gerenciado [Microsoft. Office. Interop. InfoPath. SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) que acompanha o InfoPath 2003, o objeto de evento [SignEvent](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignEvent.aspx) para o evento OnSign fornece uma propriedade [](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2.OnSign.aspx) **XDocument** para acessar o \*\* Objeto XDocument\*\* do formulário associado ao evento.</span><span class="sxs-lookup"><span data-stu-id="86c16-136">In the [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) managed code object model that shipped with InfoPath 2003, the [SignEvent](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignEvent.aspx) event object for the [OnSign](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2.OnSign.aspx) event provides an **XDocument** property for accessing the **XDocument** object of the form associated with the event.</span></span> <span data-ttu-id="86c16-137">Isso não é necessário com modelos de formulário criados com o InfoPath Forms Services ou o InfoPath usando o modelo de objeto [Microsoft. Office. InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) porque os membros de modelo de objeto da classe XmlForm podem ser acessados em código de formulário usando [](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) \*\*este \*\*(C#) ou **me** (Visual Basic) palavra-chave.</span><span class="sxs-lookup"><span data-stu-id="86c16-137">This is not necessary with form templates created with InfoPath Forms Services or InfoPath using the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) object model because the object model members of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class can be accessed in form code using the **this** (C#) or **Me** (Visual Basic) keyword.</span></span> <span data-ttu-id="86c16-138">Por exemplo, para acessar a propriedade [signed](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Signed.aspx) da classe [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) para determinar se um formulário está assinado, você pode digitar um `this.Signed` ou`Me.Signed.`</span><span class="sxs-lookup"><span data-stu-id="86c16-138">For example, to access the [Signed](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Signed.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class to determine if a form is signed, you can type either  `this.Signed` or  `Me.Signed.`</span></span>
  
### <a name="collections-and-objects"></a><span data-ttu-id="86c16-139">Coleções e objetos</span><span class="sxs-lookup"><span data-stu-id="86c16-139">Collections and Objects</span></span>

<span data-ttu-id="86c16-140">O modelo de objeto para assinaturas digitais fornece as seguintes coleções.</span><span class="sxs-lookup"><span data-stu-id="86c16-140">The object model for digital signatures provides the following collections.</span></span>
  
|<span data-ttu-id="86c16-141">**Nome**</span><span class="sxs-lookup"><span data-stu-id="86c16-141">**Name**</span></span>|<span data-ttu-id="86c16-142">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="86c16-142">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="86c16-143">SignedDataBlockCollection</span><span class="sxs-lookup"><span data-stu-id="86c16-143">SignedDataBlockCollection</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) <br/> |<span data-ttu-id="86c16-144">A coleção dos objetos [signedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) no modelo de formulário, conforme definido no tempo de design no modo de design do InfoPath.</span><span class="sxs-lookup"><span data-stu-id="86c16-144">The collection of the [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) objects in the form template as defined at design time in InfoPath design mode.</span></span>  <br/> <span data-ttu-id="86c16-145">A coleção [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) implementa propriedades que podem ser usadas para acessar os objetos [signedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) associados a um formulário.</span><span class="sxs-lookup"><span data-stu-id="86c16-145">The [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) collection implements properties that can be used to access the [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) objects associated with a form.</span></span> <span data-ttu-id="86c16-146">O objeto [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) associado a um formulário pode ser acessado através da propriedade [SignedDataBlocks](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SignedDataBlocks.aspx) da classe XmlForm. [](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx)</span><span class="sxs-lookup"><span data-stu-id="86c16-146">The [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) object associated with a form is accessible through the [SignedDataBlocks](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SignedDataBlocks.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class.</span></span>  <br/> |
|[<span data-ttu-id="86c16-147">Signaturecollection</span><span class="sxs-lookup"><span data-stu-id="86c16-147">SignatureCollection</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) <br/> |<span data-ttu-id="86c16-148">Contém uma coleção de objetos [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) para cada objeto [signedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) no formulário.</span><span class="sxs-lookup"><span data-stu-id="86c16-148">Contains a collection of [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) objects for each [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) object in the form.</span></span>  <br/> <span data-ttu-id="86c16-149">A [](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) classe signaturecollection implementa propriedades e um método que pode ser usado para acessar os objetos de [assinatura](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) associados de um formulário e para criar uma assinatura.</span><span class="sxs-lookup"><span data-stu-id="86c16-149">The [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) class implements properties and a method that can be used to access a form's associated [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) objects and to create a signature.</span></span> <span data-ttu-id="86c16-150">O [](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) objeto signaturecollection associado a um [signedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) pode ser acessado usando a propriedade [Signatures](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.Signatures.aspx) .</span><span class="sxs-lookup"><span data-stu-id="86c16-150">The [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) object associated with a [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) is accessible using the [Signatures](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.Signatures.aspx) property.</span></span>  <br/> <span data-ttu-id="86c16-151">Quando você usa o [](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.CreateSignature.aspx) método CreateSignature da classe [signaturecollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) , tenha em mente que a assinatura não é gravada até que o método [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.Sign.aspx) seja chamado no objeto [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) .</span><span class="sxs-lookup"><span data-stu-id="86c16-151">When you use the [CreateSignature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.CreateSignature.aspx) method of the [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) class, keep in mind that the signature is not written until the [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.Sign.aspx) method is called on the [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) object.</span></span> <span data-ttu-id="86c16-152">Esses métodos podem ser chamados apenas do manipulador de eventos **assinar** de um modelo de formulário totalmente confiável.</span><span class="sxs-lookup"><span data-stu-id="86c16-152">These methods can be called only from the **Sign** event handler of a fully trusted form template.</span></span>  <br/> |
   
<span data-ttu-id="86c16-153">O modelo de objeto para assinaturas digitais fornece os seguintes objetos.</span><span class="sxs-lookup"><span data-stu-id="86c16-153">The object model for digital signatures provides the following objects.</span></span>
  
|<span data-ttu-id="86c16-154">**Nome**</span><span class="sxs-lookup"><span data-stu-id="86c16-154">**Name**</span></span>|<span data-ttu-id="86c16-155">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="86c16-155">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="86c16-156">SignedDataBlock</span><span class="sxs-lookup"><span data-stu-id="86c16-156">SignedDataBlock</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) <br/> |<span data-ttu-id="86c16-157">Representa um conjunto de dados assináveis em um formulário.</span><span class="sxs-lookup"><span data-stu-id="86c16-157">Represents a set of signable data in a form.</span></span> <span data-ttu-id="86c16-158">O objeto [signedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) fornece várias propriedades e um método que pode ser usado para interagir programaticamente com um conjunto de dados assináveis.</span><span class="sxs-lookup"><span data-stu-id="86c16-158">The [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) object provides a number of properties and one method that can be used to programmatically interact with a set of signable data.</span></span>  <br/> |
|[<span data-ttu-id="86c16-159">Signature</span><span class="sxs-lookup"><span data-stu-id="86c16-159">Signature</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) <br/> |<span data-ttu-id="86c16-160">Representa uma assinatura digital que foi adicionada a um formulário ou a um conjunto de dados assináveis em um formulário.</span><span class="sxs-lookup"><span data-stu-id="86c16-160">Represents a digital signature that has been added to a form or set of signable data in a form.</span></span> <span data-ttu-id="86c16-161">O objeto [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) implementa as propriedades que podem ser usadas para recuperar informações sobre a assinatura digital e o método [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.Sign.aspx) para gravar o bloco de assinatura digital XML e a computação de seu valor de hash criptográfico.</span><span class="sxs-lookup"><span data-stu-id="86c16-161">The [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) object implements properties that can be used to retrieve information about the digital signature, and the [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.Sign.aspx) method for writing the XML digital signature block and computing its cryptographic hash value.</span></span>  <br/> |
|[<span data-ttu-id="86c16-162">Certificate</span><span class="sxs-lookup"><span data-stu-id="86c16-162">Certificate</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Certificate.aspx) <br/> |<span data-ttu-id="86c16-163">Representa o certificado digital X. 509 que foi usado para criar a assinatura.</span><span class="sxs-lookup"><span data-stu-id="86c16-163">Represents the X.509 digital certificate that has been used to create the signature.</span></span>  <br/> |
   
## <a name="working-with-digital-signatures-programmatically"></a><span data-ttu-id="86c16-164">Trabalhar com assinaturas digitais de forma programática</span><span class="sxs-lookup"><span data-stu-id="86c16-164">Working with Digital Signatures Programmatically</span></span>

<span data-ttu-id="86c16-165">O modelo de objeto do namespace [Microsoft. Office. InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) fornece membros para interagir com assinaturas digitais programaticamente.</span><span class="sxs-lookup"><span data-stu-id="86c16-165">The object model of the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace provides members for interacting with digital signatures programmatically.</span></span> <span data-ttu-id="86c16-166">Em particular, os formulários totalmente confiáveis podem adicionar informações personalizadas ao bloco de assinatura antes de serem confirmadas, de acordo com a seguinte linha do tempo:</span><span class="sxs-lookup"><span data-stu-id="86c16-166">In particular, fully-trusted forms can add custom information to the signature block before it is committed, according to the following timeline:</span></span> 
  
1. <span data-ttu-id="86c16-167">O usuário opta por adicionar uma assinatura digital a um formulário.</span><span class="sxs-lookup"><span data-stu-id="86c16-167">User chooses to add a digital signature to a form.</span></span>
    
2. <span data-ttu-id="86c16-168">A caixa de diálogo **assinaturas digitais** é exibida, o usuário clica em **Adicionar**e, em seguida, seleciona os dados a serem assinados.</span><span class="sxs-lookup"><span data-stu-id="86c16-168">The **Digital Signatures** dialog box is displayed, the user clicks **Add**, and then selects the data to sign.</span></span>
    
3. <span data-ttu-id="86c16-169">O evento [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) dos dados selecionados, representado pelo objeto [signedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) , é gerado e o método [Sign ()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.Sign.aspx) do objeto [signedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) e o método [CreateSignature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.CreateSignature.aspx) de signaturecollection [](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) coleção são executadas.</span><span class="sxs-lookup"><span data-stu-id="86c16-169">The [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) event for the selected data represented by the [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) object is raised, and the [Sign()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.Sign.aspx) method of [SignedDataBlock](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.aspx) object and the [CreateSignature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.CreateSignature.aspx) method of the [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) collection are executed.</span></span> 
    
4. <span data-ttu-id="86c16-170">Qualquer ação personalizada opcional é executada.</span><span class="sxs-lookup"><span data-stu-id="86c16-170">Any optional custom actions are executed.</span></span>
    
5. <span data-ttu-id="86c16-171">O método [Sign ()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.Sign.aspx) do objeto [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) é executado.</span><span class="sxs-lookup"><span data-stu-id="86c16-171">The [Sign()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.Sign.aspx) method of the [Signature](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Signature.aspx) object is executed.</span></span> 
    
6. <span data-ttu-id="86c16-172">A caixa de diálogo **assinar** é exibida para digitar um nome (ou selecionar uma imagem de assinatura), selecionar um certificado para entrar e inserir comentários.</span><span class="sxs-lookup"><span data-stu-id="86c16-172">The **Sign** dialog box is displayed for typing a name (or selecting a signature image), selecting a certificate to sign with, and to enter comments.</span></span> 
    
7. <span data-ttu-id="86c16-173">Quando o botão de **sinal** é clicado, a assinatura é adicionada à coleção de assinaturas para o formulário e as informações de não recusa são capturadas e salvas com a assinatura (que pode ser exibida posteriormente clicando em **Exibir formulário assinado** no \*\* Assinaturas digitais\*\* e, em seguida, clique em **ver as informações adicionais de assinatura coletadas**.</span><span class="sxs-lookup"><span data-stu-id="86c16-173">When the **Sign** button is clicked, the signature is added to the collection of signatures for the form and the non-repudiation information is captured and saved with the signature (which can be viewed later by clicking **View Signed Form** on the **Digital Signatures** dialog box, and then clicking **See the additional signing information that was collected**).</span></span>
    
<span data-ttu-id="86c16-174">O exemplo a seguir invoca o método [Sign ()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.Sign.aspx) quando o usuário assina os dados selecionados e o referenda com um valor de carimbo de data/hora recuperado de um serviço de carimbo de data/hora confiável.</span><span class="sxs-lookup"><span data-stu-id="86c16-174">The following example invokes the [Sign()](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlock.Sign.aspx) method when the user signs the selected data and countersigns the signature with a timestamp value retrieved from a trusted timestamp service.</span></span> 
  
```cs
public void FormEvents_Sign(object sender, SignEventArgs e)
{
   // Add a new Signature object to the SignedDataBlockCollection.
   Signature thisSignature = 
      e.SignedDataBlock.Signatures.CreateSignature();
   // Write the XML digital signature block and compute hash
   // for signed data.
   thisSignature.Sign();
   // Countersign the signature with a trusted timestamp.
   // Get the XML node storing the signature block.
   XPathNavigator oNodeSig = thisSignature.SignatureBlockXmlNode;
   XPathNavigator oNodeSigValue = 
      oNodeSig.SelectSingleNode(
      ".//*[local-name(.)='signatureValue']");
   // Get timestamp from a trusted timestamp service (fictitious).
   MyTrustedTimeStampService s = new MyTrustedTimeStampService();
   string strVerifiedTimeStamp = s.AddTimeStamp(oNodeSigValue.Value);
   // Add the value returned from the timestamp service to the 
   // unsigned part of the signature block.
   XPathNavigator oNodeObj = 
      oNodeSig.SelectSingleNode(".//*[local-name(.)='Object']");
   XPathNavigator oNode = oNodeObj.Clone();
   oNode.SetValue(strVerifiedTimeStamp);
   oNodeObj.MoveToParent();
   oNodeObj.AppendChild(oNode);
   e.SignatureWizard = false;
}
```

```vb
Public Sub FormEvents_Sign(ByVal sender As Object, _
   ByVal e As SignEventArgs)
   ' Add a new Signature object to the SignedDataBlockCollection.
   Dim thisSignature As Signature = 
      e.SignedDataBlock.Signatures.CreateSignature
   ' Write the XML digital signature block and compute hash
   ' for signed data.
   thisSignature.Sign()
   ' Countersign the signature with a trusted timestamp.
   ' Get the XML node storing the signature block
   Dim oNodeSig As XPathNavigator  = _
      thisSignature.SignatureBlockXmlNode
   Dim oNodeSigValue As XPathNavigator  = _
      oNodeSig.SelectSingleNode(_
      ".//*[local-name(.)='signatureValue']")
   ' Get timestamp from a trusted timestamp service (fictitious).
   Dim s As MyTrustedTimeStampService = New MyTrustedTimeStampService()
   Dim strVerifiedTimeStamp As String  = _
      s.AddTimeStamp(oNodeSigValue.Value)
   ' Add the value returned from the timestamp service to the 
   ' unsigned part of the signature block.
   Dim oNodeObj As XPathNavigator  = 
      oNodeSig.SelectSingleNode(".//*[local-name(.)='Object']")
   Dim oNode As XPathNavigator  = oNodeObj.Clone()
   oNode.SetValue(strVerifiedTimeStamp)
   oNodeObj.MoveToParent()
   oNodeObj.AppendChild(oNode)
   e.SignatureWizard = False
```


