---
title: Trabalhar com assinaturas digitais usando o modelo de objeto do InfoPath 2003
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- assinaturas digitais [infopath 2007], modelos de formulário compatíveis com 2003 do infopath, modelos de formulário compatíveis com o InfoPath 2003, assinaturas digitais
localization_priority: Normal
ms.assetid: d6318238-fd45-4854-a3c9-c27c5685bd6b
description: O modelo de objeto compatível com o InfoPath 2003 fornece recursos para trabalhando de maneira programática com assinaturas digitais.
ms.openlocfilehash: ae9934e36766b7e783d1404a12a49e9b0b08543a
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19765626"
---
# <a name="work-with-digital-signatures-using-the-infopath-2003-object-model"></a><span data-ttu-id="86f65-104">Trabalhar com assinaturas digitais usando o modelo de objeto do InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="86f65-104">Work with Digital Signatures Using the InfoPath 2003 Object Model</span></span>

<span data-ttu-id="86f65-105">O modelo de objeto compatível com o InfoPath 2003 fornece recursos para trabalhando de maneira programática com assinaturas digitais.</span><span class="sxs-lookup"><span data-stu-id="86f65-105">The InfoPath 2003-compatible object model provides features for working with digital signatures programmatically.</span></span>
  
## <a name="digital-signature-features"></a><span data-ttu-id="86f65-106">Recursos de assinatura digital</span><span class="sxs-lookup"><span data-stu-id="86f65-106">Digital Signature Features</span></span>

<span data-ttu-id="86f65-107">Os recursos de assinaturas digitais disponíveis no InfoPath permitem:</span><span class="sxs-lookup"><span data-stu-id="86f65-107">The digital signatures features available in InfoPath enable you to:</span></span> 
  
- <span data-ttu-id="86f65-108">Ativar as assinaturas para o formulário inteiro, ou para conjuntos de dados no formato que pode ser conectado separadamente específicos.</span><span class="sxs-lookup"><span data-stu-id="86f65-108">Enable signatures for the entire form, or for specific sets of data in the form that can be signed separately.</span></span>
    
- <span data-ttu-id="86f65-109">Especifica, para cada conjunto de dados que podem ser assinados, se são permitidas várias assinaturas ou uma única assinatura e quais serão elas se relacionam.</span><span class="sxs-lookup"><span data-stu-id="86f65-109">Specify, for each set of data that can be signed, whether a single signature or multiple signatures are allowed and what their relationship will be.</span></span> <span data-ttu-id="86f65-110">Por exemplo, você pode especificar estarem ou assinaturas colegas paralelas ou se cada nova assinatura countersigns todas as assinaturas anteriores.</span><span class="sxs-lookup"><span data-stu-id="86f65-110">For example, you can specify whether they are parallel co-signatures or whether each new signature countersigns all the earlier signatures.</span></span>
    
- <span data-ttu-id="86f65-111">Especifica uma mensagem a ser mostrada para os usuários do formulário como eles assinem o formulário.</span><span class="sxs-lookup"><span data-stu-id="86f65-111">Specify a message to be shown to form users as they sign the form.</span></span>
    
- <span data-ttu-id="86f65-112">Inserir e ver uma assinatura do documento.</span><span class="sxs-lookup"><span data-stu-id="86f65-112">Insert and see a signature in the document.</span></span> 
    
- <span data-ttu-id="86f65-113">Modo de exibição não repúdio informações verificáveis que foi adicionadas para cada assinatura para aumentar a segurança.</span><span class="sxs-lookup"><span data-stu-id="86f65-113">View verifiable non-repudiation information that has been added to each signature for increased security.</span></span> <span data-ttu-id="86f65-114">Essas informações adicionais, que inclui um modo de exibição do formulário como ela foi apresentada para cada signatário, é parte da assinatura e não podem ser removidas sem invalidar a assinatura.</span><span class="sxs-lookup"><span data-stu-id="86f65-114">This additional information, which includes a view of the form as it was presented to each signer, is part of the signature and cannot be removed without invalidating the signature.</span></span> <span data-ttu-id="86f65-115">A qualquer momento, você pode recuperar esses dados clicando na assinatura do formulário para exibir a caixa de diálogo **Verificar Assinatura Digital** .</span><span class="sxs-lookup"><span data-stu-id="86f65-115">At any time, you can recall this data by clicking on the signature in the form to display the **Verify Digital Signature** dialog box.</span></span> 
    
- <span data-ttu-id="86f65-116">Beneficie-se de um modelo de objeto para trabalhar com assinaturas digitais.</span><span class="sxs-lookup"><span data-stu-id="86f65-116">Take advantage of an object model for working with digital signatures.</span></span> <span data-ttu-id="86f65-117">Adicione informações personalizadas para o bloco de assinatura em formulários totalmente confiáveis através do modelo de objeto de assinatura digital.</span><span class="sxs-lookup"><span data-stu-id="86f65-117">Add custom information to the signature block in fully trusted forms through the digital signature object model.</span></span> 
    
## <a name="overview-of-the-digital-signatures-object-model"></a><span data-ttu-id="86f65-118">Visão geral do modelo de objeto de assinaturas digitais</span><span class="sxs-lookup"><span data-stu-id="86f65-118">Overview of the Digital Signatures Object Model</span></span>

### <a name="events"></a><span data-ttu-id="86f65-119">Eventos</span><span class="sxs-lookup"><span data-stu-id="86f65-119">Events</span></span>

<span data-ttu-id="86f65-120">O modelo de objeto para assinaturas digitais fornece o evento a seguir.</span><span class="sxs-lookup"><span data-stu-id="86f65-120">The object model for digital signatures provides the following event.</span></span>
  
|<span data-ttu-id="86f65-121">**Nome**</span><span class="sxs-lookup"><span data-stu-id="86f65-121">**Name**</span></span>|<span data-ttu-id="86f65-122">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="86f65-122">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="86f65-123">OnSign</span><span class="sxs-lookup"><span data-stu-id="86f65-123">OnSign</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnSign.aspx) <br/> |<span data-ttu-id="86f65-124">Ocorre depois que um conjunto de dados assinados foi selecionado para fazer logon.</span><span class="sxs-lookup"><span data-stu-id="86f65-124">Occurs after a set of signable data has been selected to sign.</span></span>  <br/> <span data-ttu-id="86f65-125">Você pode usar esse evento para manipular os dados armazenados em assinaturas digitais.</span><span class="sxs-lookup"><span data-stu-id="86f65-125">You can use this event to manipulate the data stored within the digital signature.</span></span> <span data-ttu-id="86f65-126">Por exemplo, você pode adicionar dados a partir de um servidor de carimbo de hora confiável, ou adicionar uma referenda no servidor da transação.</span><span class="sxs-lookup"><span data-stu-id="86f65-126">For example, you can add data from a trusted timestamp server, or add a server-side countersignature of the transaction.</span></span> <span data-ttu-id="86f65-127">Você também pode usar esse evento para bloquear a assinatura se o usuário atual não for membro de um grupo específico.</span><span class="sxs-lookup"><span data-stu-id="86f65-127">You can also use this event to block signing if the current user is not a member of a particular group.</span></span>  <br/> |
   
<span data-ttu-id="86f65-128">O evento **OnSign** retorna uma referência ao objeto [SignEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignEventObject.aspx) , que fornece as seguintes propriedades.</span><span class="sxs-lookup"><span data-stu-id="86f65-128">The **OnSign** event returns a reference to the [SignEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignEventObject.aspx) object, which provides the following properties.</span></span> 
  
|<span data-ttu-id="86f65-129">**Nome**</span><span class="sxs-lookup"><span data-stu-id="86f65-129">**Name**</span></span>|<span data-ttu-id="86f65-130">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="86f65-130">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="86f65-131">ReturnStatus</span><span class="sxs-lookup"><span data-stu-id="86f65-131">ReturnStatus</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SignEvent.ReturnStatus.aspx) <br/> |<span data-ttu-id="86f65-132">Obtém ou define um valor **Boolean** que indica o status de retorno do evento **OnSign** .</span><span class="sxs-lookup"><span data-stu-id="86f65-132">Gets or sets a **Boolean** value indicating the return status of the **OnSign** event.</span></span>  <br/> |
|[<span data-ttu-id="86f65-133">SignedDataBlock</span><span class="sxs-lookup"><span data-stu-id="86f65-133">SignedDataBlock</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SignEvent.SignedDataBlock.aspx) <br/> |<span data-ttu-id="86f65-134">Obtém o bloco de dados assinados que acionou o evento **OnSign** .</span><span class="sxs-lookup"><span data-stu-id="86f65-134">Gets the signed data block that triggered the **OnSign** event.</span></span>  <br/> |
|[<span data-ttu-id="86f65-135">XDocument</span><span class="sxs-lookup"><span data-stu-id="86f65-135">XDocument</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignEvent.XDocument.aspx) <br/> |<span data-ttu-id="86f65-136">Obtém uma referência ao objeto **XDocument** associada ao evento **OnSign** .</span><span class="sxs-lookup"><span data-stu-id="86f65-136">Gets a reference to the **XDocument** object associated with the **OnSign** event.</span></span>  <br/> |
   
### <a name="collections-and-objects"></a><span data-ttu-id="86f65-137">Objetos e coleções</span><span class="sxs-lookup"><span data-stu-id="86f65-137">Collections and Objects</span></span>

<span data-ttu-id="86f65-138">O modelo de objeto para assinaturas digitais fornece as seguintes coleções.</span><span class="sxs-lookup"><span data-stu-id="86f65-138">The object model for digital signatures provides the following collections.</span></span>
  
|<span data-ttu-id="86f65-139">**Nome**</span><span class="sxs-lookup"><span data-stu-id="86f65-139">**Name**</span></span>|<span data-ttu-id="86f65-140">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="86f65-140">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="86f65-141">SignedDataBlocksCollection</span><span class="sxs-lookup"><span data-stu-id="86f65-141">SignedDataBlocksCollection</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignedDataBlocksCollection.aspx) <br/> |<span data-ttu-id="86f65-142">A coleção dos objetos [SignedDataBlockObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignedDataBlockObject.aspx) no modelo de formulário, como definido no arquivo de definição de formulário (. xsf).</span><span class="sxs-lookup"><span data-stu-id="86f65-142">The collection of the [SignedDataBlockObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignedDataBlockObject.aspx) objects in the form template as defined in the form definition file (.xsf).</span></span>  <br/> <span data-ttu-id="86f65-143">A coleção de **SignedDataBlocksCollection** implementa propriedades que podem ser usadas para acessar os objetos **SignedDataBlockObjects** associados a um formulário.</span><span class="sxs-lookup"><span data-stu-id="86f65-143">The **SignedDataBlocksCollection** collection implements properties that can be used to access the **SignedDataBlockObjects** objects associated with a form.</span></span> <span data-ttu-id="86f65-144">**O pode ser acessada por meio da propriedade [SignedDataBlocks](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.SignedDataBlocks.aspx) do objeto [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) .**</span><span class="sxs-lookup"><span data-stu-id="86f65-144">The **SignedDataBlocks** collection is accessible through the [SignedDataBlocks](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.SignedDataBlocks.aspx) property of the [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) object.</span></span>  <br/> |
|[<span data-ttu-id="86f65-145">SignaturesCollection</span><span class="sxs-lookup"><span data-stu-id="86f65-145">SignaturesCollection</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignaturesCollection.aspx) <br/> |<span data-ttu-id="86f65-146">Contém uma coleção de objetos [SignatureObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignatureObject.aspx) para cada **SignedDataBlockObject** no formulário.</span><span class="sxs-lookup"><span data-stu-id="86f65-146">Contains a collection of [SignatureObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignatureObject.aspx) objects for each **SignedDataBlockObject** in the form.</span></span>  <br/> <span data-ttu-id="86f65-147">A coleção de **SignaturesCollection** implementa propriedades e um método que pode ser usado para acessar objetos **SignatureObject** associados a um formulário e criar uma assinatura.</span><span class="sxs-lookup"><span data-stu-id="86f65-147">The **SignaturesCollection** collection implements properties and a method that can be used to access a form's associated **SignatureObject** objects and to create a signature.</span></span> <span data-ttu-id="86f65-148">Ele é acessível através do objeto **SignedDataBlockObject** .</span><span class="sxs-lookup"><span data-stu-id="86f65-148">It is accessible through the **SignedDataBlockObject** object.</span></span>  <br/> <span data-ttu-id="86f65-149">Quando você usa o método [Create](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Signatures.Create.aspx) da coleção **SignaturesCollection** , mantenha em mente que a assinatura não é gravada até o [sinal de](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Signature.Sign.aspx) método é chamado no objeto **SignatureObject** .</span><span class="sxs-lookup"><span data-stu-id="86f65-149">When you use the [Create](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Signatures.Create.aspx) method of the **SignaturesCollection** collection, keep in mind that the signature is not written until the [Sign](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Signature.Sign.aspx) method is called on the **SignatureObject** object.</span></span> <span data-ttu-id="86f65-150">Esses métodos podem ser chamados somente do manipulador de eventos **OnSign** de um modelo de formulário totalmente confiável.</span><span class="sxs-lookup"><span data-stu-id="86f65-150">These methods can be called only from the **OnSign** event handler of a fully trusted form template.</span></span>  <br/> |
   
<span data-ttu-id="86f65-151">O modelo de objeto para assinaturas digitais fornece os seguintes objetos.</span><span class="sxs-lookup"><span data-stu-id="86f65-151">The object model for digital signatures provides the following objects.</span></span>
  
|<span data-ttu-id="86f65-152">**Nome**</span><span class="sxs-lookup"><span data-stu-id="86f65-152">**Name**</span></span>|<span data-ttu-id="86f65-153">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="86f65-153">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="86f65-154">SignedDataBlockObject</span><span class="sxs-lookup"><span data-stu-id="86f65-154">SignedDataBlockObject</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignedDataBlockObject.aspx) <br/> |<span data-ttu-id="86f65-155">Representa um conjunto de dados assinados em um formulário.</span><span class="sxs-lookup"><span data-stu-id="86f65-155">Represents a set of signable data in a form.</span></span> <span data-ttu-id="86f65-156">O objeto **SignedDataBlock** fornece um número de propriedades e um método que pode ser usado para interagir programaticamente com um conjunto de dados assinados.</span><span class="sxs-lookup"><span data-stu-id="86f65-156">The **SignedDataBlock** object provides a number of properties and one method that can be used to programmatically interact with a set of signable data.</span></span>  <br/> |
|[<span data-ttu-id="86f65-157">SignatureObject</span><span class="sxs-lookup"><span data-stu-id="86f65-157">SignatureObject</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.SignatureObject.aspx) <br/> |<span data-ttu-id="86f65-158">Representa uma assinatura digital que foi adicionada a um formulário ou um conjunto de dados assinados em um formulário.</span><span class="sxs-lookup"><span data-stu-id="86f65-158">Represents a digital signature that has been added to a form or set of signable data in a form.</span></span> <span data-ttu-id="86f65-159">A coleção de **SignatureObject** implementa propriedades que podem ser usadas para recuperar informações sobre a assinatura digital e o método de [entrada](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Signature.Sign.aspx) para escrever o bloco de assinatura digital XML e seu valor de hash criptográfico de computação.</span><span class="sxs-lookup"><span data-stu-id="86f65-159">The **SignatureObject** collection implements properties that can be used to retrieve information about the digital signature, and the [Sign](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Signature.Sign.aspx) method for writing the XML digital signature block and computing its cryptographic hash value.</span></span>  <br/> |
|[<span data-ttu-id="86f65-160">CertificateObject</span><span class="sxs-lookup"><span data-stu-id="86f65-160">CertificateObject</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.CertificateObject.aspx) <br/> |<span data-ttu-id="86f65-161">Representa o certificado digital x. 509 que foi usado para criar a assinatura.</span><span class="sxs-lookup"><span data-stu-id="86f65-161">Represents the X.509 digital certificate that has been used to create the signature.</span></span>  <br/> |
   
## <a name="working-with-digital-signatures-programmatically"></a><span data-ttu-id="86f65-162">Trabalhando de maneira programática com assinaturas digitais</span><span class="sxs-lookup"><span data-stu-id="86f65-162">Working with Digital Signatures Programmatically</span></span>

<span data-ttu-id="86f65-163">O modelo de objeto compatível com o InfoPath 2003 fornece membros para interação com assinaturas digitais programaticamente.</span><span class="sxs-lookup"><span data-stu-id="86f65-163">The InfoPath 2003-compatible object model provides members for interacting with digital signatures programmatically.</span></span> <span data-ttu-id="86f65-164">Em particular, formulários totalmente confiáveis podem adicionar informações personalizadas para o bloco de assinatura antes que ele seja confirmado, de acordo com a seguinte linha de tempo:</span><span class="sxs-lookup"><span data-stu-id="86f65-164">In particular, fully-trusted forms can add custom information to the signature block before it is committed, according to the following timeline:</span></span>
  
1. <span data-ttu-id="86f65-165">Usuário optar por adicionar uma assinatura digital a um formulário.</span><span class="sxs-lookup"><span data-stu-id="86f65-165">User chooses to add a digital signature to a form.</span></span>
    
2. <span data-ttu-id="86f65-166">O primeiro painel do **Assistente de Assinatura Digital** é exibido.</span><span class="sxs-lookup"><span data-stu-id="86f65-166">The first panel of the **Digital Signature Wizard** is displayed.</span></span> 
    
3. <span data-ttu-id="86f65-167">O evento **OnSign** para os dados selecionados representados pelo objeto **SignedDataBlockObject** é gerado e o método de **entrada** do **SignedDataBlockObject** e o método **Create** do **SignaturesCollection** coleção são executados.</span><span class="sxs-lookup"><span data-stu-id="86f65-167">The **OnSign** event for the selected data represented by the **SignedDataBlockObject** object is raised, and the **Sign** method of **SignedDataBlockObject** and the **Create** method of the **SignaturesCollection** collection are executed.</span></span> 
    
4. <span data-ttu-id="86f65-168">Quaisquer ações personalizadas opcionais são executadas.</span><span class="sxs-lookup"><span data-stu-id="86f65-168">Any optional custom actions are executed.</span></span>
    
5. <span data-ttu-id="86f65-169">O método de **entrada** do **SignatureObject** é executado.</span><span class="sxs-lookup"><span data-stu-id="86f65-169">The **Sign** method of the **SignatureObject** is executed.</span></span> 
    
6. <span data-ttu-id="86f65-170">Painéis de segundo e terceiro do assistente são exibidos para selecionar um certificado para assinar com e insira comentários.</span><span class="sxs-lookup"><span data-stu-id="86f65-170">Second and third panes of the wizard are displayed for selecting a certificate to sign with and to enter comments.</span></span>
    
7. <span data-ttu-id="86f65-171">As informações de não-recusa são exibidas (que podem ser exibidos posteriormente com a caixa de diálogo **Verificar Assinatura Digital** ).</span><span class="sxs-lookup"><span data-stu-id="86f65-171">The non-repudiation information is displayed (which can be viewed later with the **Verify Digital Signature** dialog box).</span></span> 
    
8. <span data-ttu-id="86f65-172">Quando o botão de **entrada** é clicado, a assinatura é adicionada à coleção de assinaturas para o formulário.</span><span class="sxs-lookup"><span data-stu-id="86f65-172">When the **Sign** button is clicked, the signature is added to collection of signatures for the form.</span></span> 
    
<span data-ttu-id="86f65-173">O exemplo a seguir invoca a caixa de diálogo de **logon** e countersigns a assinatura com um valor de carimbo de hora é recuperada de um serviço de carimbo de hora confiável.</span><span class="sxs-lookup"><span data-stu-id="86f65-173">The following example invokes the **Sign** dialog box and countersigns the signature with a timestamp value retrieved from a trusted timestamp service.</span></span> 
  
```cs
[InfoPathEventHandler(EventType=InfoPathEventType.OnSign)]
public void OnSign(SignEvent e)
{
    Signature signature = e.SignedDataBlock.Signatures.Create();
    // Invoke the Sign dialog box to sign the data block.
    signature.Sign();
    // Countersign the signature with a trusted timestamp
    // Get the XML node storing the signature block
    IXMLDOMNode oNodeSig = signature.SignatureBlockXmlNode;
    IXMLDOMNode oNodeSigValue = oNodeSig.selectSingleNode(".//*[local-name(.)='signatureValue']");
    // Get timestamp from a trusted timestamp service (fictitious).
    MyTrustedTimeStampService s = new MyTrustedTimeStampService();
    string strVerifiedTimeStamp = s.AddTimeStamp(oNodeSigValue.text);
    
    //Add the value returned from the timestamp service to the 
    //unsigned part of the signature block
    IXMLDOMNode oNodeObj = oNodeSig.selectSingleNode(".//*[local-name(.)='Object']");
    IXMLDOMNode oNode = oNodeObj.cloneNode(false);
    oNode.text = strVerifiedTimeStamp;
    oNodeObj.parentNode.appendChild(oNode);
    e.ReturnStatus = true;
}
```


