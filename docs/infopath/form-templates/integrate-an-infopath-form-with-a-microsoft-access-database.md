---
title: Integrar um formulário do InfoPath a um banco de dados do Microsoft Access
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 5ec9a9c0-b348-4a31-b377-e95db2f92455
description: O Microsoft InfoPath dá suporte ao uso de um banco de dados do Microsoft Access 2010 como a fonte de dados primária para um formulário, ou como uma fonte de dados secundária para um formulário ou controle. Este artigo explica como usar um banco de dados do Access 2010 como uma fonte de dados.
ms.openlocfilehash: 30aea15a5e9a8d19f64b3f089b71e859cff93e0e
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19765658"
---
# <a name="integrate-an-infopath-form-with-a-microsoft-access-database"></a><span data-ttu-id="a45a2-104">Integrar um formulário do InfoPath a um banco de dados do Microsoft Access</span><span class="sxs-lookup"><span data-stu-id="a45a2-104">Integrate an InfoPath Form with a Microsoft Access Database</span></span>

<span data-ttu-id="a45a2-p102">O Microsoft InfoPath dá suporte ao uso de um banco de dados do Microsoft Access 2010 como a fonte de dados primária para um formulário, ou como uma fonte de dados secundária para um formulário ou controle. Este artigo explica como usar um banco de dados do Access 2010 como uma fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="a45a2-p102">Microsoft InfoPath supports using a Microsoft Access 2010 database as the primary data source for a form, or as a secondary data source for a form or control. This article explains how to use an Access 2010 database as a data source.</span></span>
  
## <a name="using-a-microsoft-access-database-as-a-data-source"></a><span data-ttu-id="a45a2-107">Usando um banco de dados do Microsoft Access como fonte de dados</span><span class="sxs-lookup"><span data-stu-id="a45a2-107">Using a Microsoft Access Database as a Data Source</span></span>

### <a name="setting-up-a-microsoft-access-database-as-a-forms-primary-data-source"></a><span data-ttu-id="a45a2-108">Configurando um banco de dados do Microsoft Access Database como a fonte de dados principal de um formulário</span><span class="sxs-lookup"><span data-stu-id="a45a2-108">Setting Up a Microsoft Access Database as a Form's Primary Data Source</span></span>

<span data-ttu-id="a45a2-p103">As conexões de banco de dados são estabelecidas no InfoPath usando o **Assistente de Conexão de Dados**. Esse assistente é aberto selecionando **Banco de Dados** na seção **Modelos de Formulário Avançados** na guia **Novo** do Microsoft Office Backstage e então clicando em **Criar Este Formulário**.</span><span class="sxs-lookup"><span data-stu-id="a45a2-p103">Database connections are established in InfoPath by using the **Data Connection Wizard**. This wizard is opened by selecting **Database** in the **Advanced Form Templates** section on the **New** tab of the Microsoft Office Backstage, and then clicking pressing **Design This Form**.</span></span>
  
<span data-ttu-id="a45a2-111">Ao clicar em **Selecionar Banco de Dados**, você poderá escolher uma fonte de dados existente ou se conectar diretamente a um arquivo de banco de dados específico.</span><span class="sxs-lookup"><span data-stu-id="a45a2-111">By clicking **Select Database**, you can choose an existing data source or connect directly to a specific database file.</span></span>
  
<span data-ttu-id="a45a2-p104">Depois de selecionar um banco de dados, o assistente solicitará que você selecione uma tabela do banco de dados a ser usado como a fonte de dados para o formulário. À medida que você adiciona tabelas, os relacionamentos das tabelas umas com as outras serão estabelecidos, e o assistente exibirá as tabelas e os relacionamentos hierárquicos na lista **Estrutura da fonte de dados**. Se você marcar a caixa de seleção **Mostrar colunas da tabela**, o assistente exibirá os nomes de campo de cada tabela na lista Estrutura da fonte de dados; use as caixas de seleção ao lado de cada campo para especificar se um campo será incluído na instrução SQL criada pelo assistente.</span><span class="sxs-lookup"><span data-stu-id="a45a2-p104">After you select a database, the wizard prompts you to select a table from the database to use as the data source for the form. As you add tables, their relationships to each other are established, and the wizard displays the tables and their hierarchical relationships in the **Data source structure** list. If you select the **Show table columns** check box, the wizard displays the field names of each table in the Data source structure list; you use the check boxes next to each field name to specify whether a field is included in the SQL statement that the wizard constructs.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="a45a2-115">Os campos de chave primária de cada tabela sempre estarão selecionados e não podem ser removidos.</span><span class="sxs-lookup"><span data-stu-id="a45a2-115">Primary key fields from each table are always selected and cannot be removed.</span></span> 
  
<span data-ttu-id="a45a2-p105">Quando as tabelas, os relacionamentos e os campos tiverem sido especificados usando o **Assistente de Conexão de Dados**, você poderá clicar em **Editar SQL** para exibir a instrução SQL que será usada para estabelecer a fonte de dados para o formulário. Na caixa de diálogo **Editar SQL**, é possível clicar em **Testar Instrução SQL** para verificar se o InfoPath conseguirá criar a fonte de dados das informações fornecidas. Também é possível usar a caixa de diálogo **Editar SQL** para modificar a instrução SQL para criar consultas mais complexas.</span><span class="sxs-lookup"><span data-stu-id="a45a2-p105">When the tables, relationships, and fields have been specified using the **Data Connection Wizard**, you can click **Edit SQL** to view the SQL statement that will be used to establish the data source for the form. In the **Edit SQL** dialog box, you can click **Test SQL Statement** to verify that InfoPath will be able to create the data source from the information provided. You can also use the **Edit SQL** dialog box to modify the SQL statement to create more complex queries.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="a45a2-p106">As instruções SQL usadas pelo InfoPath são consultas de modelagem de dados. As consultas de modelagem de dados permitem a criação de relacionamentos hierárquicos entre duas ou mais entidades lógicas. É possível usar instruções JOIN SQL, mas isso não é recomendável, porque fazer isso desabilitará o envio de formulários. Para saber mais sobre consultas de modelagem de dados, consulte a documentação no Microsoft Developer Network (MSDN).</span><span class="sxs-lookup"><span data-stu-id="a45a2-p106">The SQL statements used by InfoPath are data shaping queries. Data shaping queries allow the building of hierarchical relationships between two or more logical entities in a query. It is possible to use SQL JOIN statements, but this is not recommended, because doing so will disable form submission. For more information on data shaping queries, see the documentation on the Microsoft Developer Network (MSDN).</span></span> 
  
<span data-ttu-id="a45a2-p107">A última página do **Assistente de Conexão de Dados** exibe informações de resumo sobre a fonte de dados, incluindo o nome e o local do arquivo da fonte de dados, o nome da tabela pai primária, o número de tabelas usadas e o status de envio. O status de envio diz a você se a instrução SQL gerada permitirá o envio de dados bem-sucedido para a fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="a45a2-p107">The last page of the **Data Connection Wizard** displays summary information about the data source, including the name and file location of the data source, the name of the primary parent table, the number of tables used, and the submit status. The submit status tells you whether the generated SQL statement will allow for successful submission of data to the data source.</span></span> 
  
### <a name="setting-up-a-microsoft-access-database-as-a-secondary-data-source"></a><span data-ttu-id="a45a2-125">Configurando um banco de dados do Microsoft Access como uma fonte de dados secundária</span><span class="sxs-lookup"><span data-stu-id="a45a2-125">Setting up a Microsoft Access Database as a Secondary Data Source</span></span>

<span data-ttu-id="a45a2-p108">As fontes de dados secundárias podem ser usadas para fornecer as entradas para uma caixa de listagem ou uma caixa de lista suspensa, ou você pode escrever código para adicionar dados de uma fonte de dados secundária para seu formulário. Para trabalhar com fontes de dados secundárias em seu formulário, clique em **Conexões de Dados** na guia **Dados** ao projetar um formulário.</span><span class="sxs-lookup"><span data-stu-id="a45a2-p108">Secondary data sources can be used to provide the entries for a list box or drop-down list box, or you can write code to add data from a secondary data source to your form. To work with secondary data sources in your form, click **Data Connections** on the **Data** tab when designing a form.</span></span> 
  
<span data-ttu-id="a45a2-p109">Quando você iniciar o **Assistente de Conexão de Dados**, será solicitado que você selecione se deseja receber dados para usá-los no formulário ou enviar dados no formulário. Escolha **Receber dados** e então clique em **Avançar**. Para criar uma fonte de dados secundária de um banco de dados, selecione **Banco de Dados (somente Microsoft SQL Server ou Microsoft Office Access)**. Na próxima página do assistente, clique em **Selecionar Banco de Dados** para escolher uma fonte de dados existente ou conecte-se diretamente a um arquivo de banco de dados específico.</span><span class="sxs-lookup"><span data-stu-id="a45a2-p109">When you start the **Data Connection Wizard**, you are prompted to select whether to receive data to use in the form, or to submit data in the form. Choose **Receive data**, and then click **Next**. To create a secondary data source from a database, select **Database (Microsoft SQL Server or Microsoft Office Access only)**. On the next page of the wizard, click **Select Database** to choose an existing data source or connect directly to a specific database file.</span></span> 
  
<span data-ttu-id="a45a2-p110">Depois de selecionar um banco de dados, o assistente solicitará a seleção de uma tabela ou consulta do banco de dados a ser usada como a fonte de dados do formulário. Você deve selecionar uma tabela ou consulta para começar, mas poderá selecionar tabelas adicionais posteriormente se quiser incluí-las. Depois de selecionar uma tabela ou consulta, o assistente permitirá que você selecione os campos que deseja usar na lista **Estrutura da fonte de dados**. Por padrão, todos os campos da tabela são selecionados, mas é possível remover campos se eles não forem necessários para seu formulário. Você também pode controlar como os registros retornados da tabela são classificados e se vários registros são permitidos. Para fazer isso, clique em **Modificar Tabela** e então selecione até três critérios de classificação na caixa de seleção **Ordem de Classificação**. Quando estiver satisfeito, clique em **Concluir**.</span><span class="sxs-lookup"><span data-stu-id="a45a2-p110">After you select a database, the wizard prompts you to select a table or query from the database to use as the data source for the form. You must select one table or query to begin with, but you can select additional tables later if you want to include them. After you've selected a table or query, the wizard allows you to select the fields you want to use in the **Data source structure** list. By default, all the fields of the table are selected, but you can remove fields if they aren't necessary for your form. You can also control how the records returned from the table are sorted, and whether multiple records are allowed. To do so, click **Modify Table**, and then select up to three sorting criteria in the **Sort Order** dialog box. When you're satisfied, click **Finish**.</span></span>
  
> [!NOTE]
> <span data-ttu-id="a45a2-139">Os campos de chave primária de cada tabela sempre estarão selecionados e não podem ser removidos.</span><span class="sxs-lookup"><span data-stu-id="a45a2-139">Primary key fields from each table are always selected and cannot be removed.</span></span> 
  
<span data-ttu-id="a45a2-p111">O InfoPath também permite que você recupere dados de várias tabelas ou consultas ao mesmo tempo. Quando você recupera dados de várias tabelas ou consultas, deve ser capaz de estabelecer um relacionamento entre todas as tabelas ou consultas envolvidas com a tabela ou consulta original selecionada no **Assistente de Conexão de Dados**. Por exemplo, se for preciso recuperar dados da tabela Clientes do banco de dados Northwind, você poderá adicionar a tabela Pedidos para recuperar dados sobre todos os pedidos para aquele cliente e poderá adicionar a tabela Detalhes do Pedido para recuperar os detalhes de cada pedido.</span><span class="sxs-lookup"><span data-stu-id="a45a2-p111">InfoPath also enables you to retrieve data from multiple tables or queries at the same time. When you retrieve data from multiple tables or queries, you must be able to establish a relationship between all of the tables or queries involved with the original table or query you selected in the **Data Connection Wizard**. For example, if you were retrieving data from the Customers table of the Northwind database, you could add the Orders table to retrieve data about all the orders for that customer, and you could add the Order Details table to retrieve the details of each order.</span></span>
  
<span data-ttu-id="a45a2-p112">Para adicionar outra tabela à fonte de dados, selecione a tabela que você deseja adicionar a uma tabela filha à lista **Estrutura da fonte de dados** e então clique em **Adicionar Tabela**. Selecione a tabela ou a consulta que você deseja adicionar e então clique em **Avançar**. O InfoPath solicita que você selecione o relacionamento ou os relacionamentos que deseja usar. Se campos das duas tabelas tiverem o mesmo nome, o InfoPath adicionará automaticamente esses campos como um relacionamento; caso contrário, ou se você não quiser usar um relacionamento personalizado, poderá clicar em **Adicionar Relacionamento** para especificar quais campos da tabela pai correspondem aos campos da tabela filha. Também é possível remover relacionamentos existentes clicando em **Remover Relacionamento** na caixa de diálogo **Editar Relacionamento**.</span><span class="sxs-lookup"><span data-stu-id="a45a2-p112">To add an additional table to the data source, select the table you want to add a child table to in the **Data source structure** list, and then click **Add Table**. Select the table or query you want to add, and then click **Next**. InfoPath prompts you to select the relationship or relationships you want to use. If fields in the two tables have the same name, InfoPath automatically adds those fields as a relationship, but if not, or if you want to use a custom relationship, you can click **Add Relationship** to specify which fields in the parent table correspond to fields in the child table. You can also remove existing relationships by clicking **Remove Relationship** in the **Edit Relationship** dialog box.</span></span> 
  
<span data-ttu-id="a45a2-p113">Quando estiver satisfeito com os relacionamentos, clique em **Concluir**. Assim como acontece com a tabela principal, você pode especificar quais campos serão retornados da tabela filha. No entanto, você não pode usar o botão **Modificar Tabela** para editar a ordem na qual os registros são retornados.</span><span class="sxs-lookup"><span data-stu-id="a45a2-p113">When you're satisfied with the relationships, click **Finish**. As with the main table, you can specify which fields are returned from the child table. You cannot, however, use the **Modify Table** button to edit the order in which the records are returned.</span></span> 
  
<span data-ttu-id="a45a2-p114">Quando as tabelas, os relacionamentos e os campos tiverem sido especificados, você poderá clicar em **Editar SQL** para exibir a instrução da consulta SQL que será usada para estabelecer a fonte de dados para o formulário. Na caixa de diálogo **Editar SQL**, você pode clicar em **Testar Instrução SQL** para verificar se o InfoPath poderá criar a fonte de dados desde as informações fornecidas. Também é possível usar a caixa de diálogo **Editar SQL** para modificar a instrução SQL para criar consultas mais complexas.</span><span class="sxs-lookup"><span data-stu-id="a45a2-p114">When the tables, relationships, and fields have been specified, you can click **Edit SQL** to view the SQL query statement that will be used to establish the data source for the form. In the **Edit SQL** dialog box, you can click **Test SQL Statement** to verify that InfoPath will be able to create the data source from the information provided. You can also use the **Edit SQL** dialog box to modify the SQL statement to create more complex queries.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="a45a2-p115">As instruções SQL usadas pelo InfoPath são consultas de modelagem de dados. As consultas de modelagem de dados permitem a criação de relacionamentos hierárquicos entre duas ou mais entidades lógicas. É possível usar instruções JOIN SQL, mas isso não é recomendável, porque fazer isso desabilitará o envio de formulários. Para saber mais sobre consultas de modelagem de dados, consulte a documentação no Microsoft Developer Network (MSDN).</span><span class="sxs-lookup"><span data-stu-id="a45a2-p115">The SQL statements used by InfoPath are data shaping queries. Data shaping queries allow the building of hierarchical relationships between two or more logical entities in a query. It is possible to use SQL JOIN statements, but this is not recommended, because doing so will disable form submission. For more information on data shaping queries, see the documentation on the Microsoft Developer Network (MSDN).</span></span> 
  
## <a name="enabling-form-submission"></a><span data-ttu-id="a45a2-158">Habilitando o envio de formulários</span><span class="sxs-lookup"><span data-stu-id="a45a2-158">Enabling Form Submission</span></span>

<span data-ttu-id="a45a2-p116">Além do recebimento de dados de um banco de dados do Access, o InfoPath pode enviar dados novos ou alterados de volta para o banco de dados. Quando você usa o comando **Enviar** na guia **Início** ou o Microsoft Office Backstage para enviar alterações para o banco de dados, o InfoPath usa ADO (ActiveX Data Objects) para atualizar os registros no banco de dados. O envio de formulário será habilitado quando todas as condições a seguir forem atendidas:</span><span class="sxs-lookup"><span data-stu-id="a45a2-p116">In addition to receiving data from an Access database, InfoPath can submit new or changed data back to the database. When you use the **Submit** command on the **Home** tab or the Microsoft Office Backstage to submit changes to the database, InfoPath uses ActiveX Data Objects (ADO) to update the records in the database. Form submission is enabled when all of the following conditions are met:</span></span> 
  
- <span data-ttu-id="a45a2-162">Deve haver uma coluna base para todas as colunas usadas na consulta do formulário.</span><span class="sxs-lookup"><span data-stu-id="a45a2-162">There must be a base column for every column that is used in the form's query.</span></span>
    
- <span data-ttu-id="a45a2-163">Talvez uma coluna de tabela não apareça várias vezes na consulta inteira.</span><span class="sxs-lookup"><span data-stu-id="a45a2-163">A table column may not appear multiple times in the entire query.</span></span>
    
- <span data-ttu-id="a45a2-164">Uma chave primária, uma restrição exclusiva ou um índice exclusivo deve estar disponível para todas as tabelas em uma cláusula SELECT usada na consulta do formulário.</span><span class="sxs-lookup"><span data-stu-id="a45a2-164">A primary key, unique constraint, or unique index must be available for every table in a SELECT clause that is used in the form's query.</span></span>
    
- <span data-ttu-id="a45a2-165">Uma tabela não pode ser incluída várias vezes na consulta do formulário.</span><span class="sxs-lookup"><span data-stu-id="a45a2-165">A table cannot be included multiple times in the form's query.</span></span>
    
- <span data-ttu-id="a45a2-166">Os relacionamentos entre as tabelas principais e secundárias devem incluir todas as colunas de chave primária da tabela pai.</span><span class="sxs-lookup"><span data-stu-id="a45a2-166">Relationships between parent and child tables must include all primary key columns from the parent table.</span></span>
    
- <span data-ttu-id="a45a2-167">Só pode haver uma tabela base para todas as colunas em uma cláusula SELECT usada na consulta do formulário.</span><span class="sxs-lookup"><span data-stu-id="a45a2-167">There can only be one base table for all columns in a SELECT clause that is used in the form's query.</span></span>
    
<span data-ttu-id="a45a2-p117">Existem algumas circunstâncias sob as quais o InfoPath não pode enviar alterações de formulário para um banco de dados. Por exemplo, se você criar um formulário que retire dados de uma consulta em vez de uma tabela, ou se você personalizar a instrução SQL usada pelo InfoPath para incluir uma instrução JOIN, o InfoPath não poderá enviar alterações. Outra circunstância que impediria que o InfoPath enviasse alterações seria adicionar tabelas ao formulário que tem um relacionamento muitos para um com a tabela principal delas. Em situações onde o InfoPath não consegue enviar alterações para o banco de dados, o campo **Status de envio** na última página do **Assistente de Conexão de Dados** exibirá o motivo para a limitação.</span><span class="sxs-lookup"><span data-stu-id="a45a2-p117">There are some circumstances under which InfoPath cannot submit form changes to a database. For example, if you create a form that draws data from a query instead of a table, or if you customize the SQL statement that is used by InfoPath to include a JOIN statement, InfoPath will be unable to submit changes. Another circumstance that would prevent InfoPath from submitting changes is if you were to add tables to the form that have a many-to-one relationship with their parent table. In situations where InfoPath will be unable to submit changes to the database, the **Submit status** field on the last page of the **Data Connection Wizard** will display the reason for the limitation.</span></span> 
  

