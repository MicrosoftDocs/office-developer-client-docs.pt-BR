---
title: Sobre o modelo de segurança para modelos de formulário com código
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- InfoPath 2007, segurança, segurança de acesso do código [InfoPath 2007], [InfoPath 2007] de segurança, o modelo de segurança para o código gerenciado, segurança [InfoPath 2007], níveis, CAS [InfoPath 2007], modelos de formulário compatíveis com o InfoPath 2003, segurança, permissões [InfoPath 2007]
localization_priority: Normal
ms.assetid: 5e1c1c72-f98d-4871-9c57-82c315277aa1
description: Suporte de modelos de formulário de código a mesma segurança redistribui como script em execução nos modelos de formulário não gerenciadas de gerenciado do InfoPath e também dão suporte a recursos de segurança de acesso de código adicionais que se aplicam ao código gerenciado executadas sob o common language runtime (CLR) dos. NET Framework.
ms.openlocfilehash: cfeb2117232d041cef43d282ff5aab482609f512
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19765592"
---
# <a name="about-the-security-model-for-form-templates-with-code"></a><span data-ttu-id="14aa3-104">Sobre o modelo de segurança para modelos de formulário com código</span><span class="sxs-lookup"><span data-stu-id="14aa3-104">About the Security Model for Form Templates with Code</span></span>

<span data-ttu-id="14aa3-105">Suporte de modelos de formulário de código a mesma segurança redistribui como script em execução nos modelos de formulário não gerenciadas de gerenciado do InfoPath e também dão suporte a recursos de segurança de acesso de código adicionais que se aplicam ao código gerenciado executadas sob o common language runtime (CLR) dos. NET Framework.</span><span class="sxs-lookup"><span data-stu-id="14aa3-105">InfoPath managed code form templates support the same security levels as script running in unmanaged form templates, and they also support additional code access security features that apply to managed code running under the common language runtime (CLR) of the .NET Framework.</span></span>
  
## <a name="infopath-managed-object-model-security-levels"></a><span data-ttu-id="14aa3-106">Níveis de segurança do modelo de objeto de gerenciado do InfoPath</span><span class="sxs-lookup"><span data-stu-id="14aa3-106">InfoPath Managed Object Model Security Levels</span></span>

<span data-ttu-id="14aa3-107">A tabela a seguir descreve a relação entre os níveis de segurança para membros do modelo de objeto de script e o conjunto de permissões correspondente que é exigido para cada nível quando o membro de modelo de objeto é usado em um modelo de formulário de código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="14aa3-107">The following table describes the relationship between the security levels for script object model members and the corresponding permission set that is demanded for each level when the object model member is used in a managed code form template.</span></span>
  
|<span data-ttu-id="14aa3-108">**Nível de segurança do modelo de objeto**</span><span class="sxs-lookup"><span data-stu-id="14aa3-108">**Object Model Security Level**</span></span>|<span data-ttu-id="14aa3-109">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="14aa3-109">**Description**</span></span>|<span data-ttu-id="14aa3-110">**Permissão definida usado**</span><span class="sxs-lookup"><span data-stu-id="14aa3-110">**Permission Set Demanded**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="14aa3-111">0</span><span class="sxs-lookup"><span data-stu-id="14aa3-111">0</span></span>  <br/> |<span data-ttu-id="14aa3-112">Pode ser acessado sem restrições.</span><span class="sxs-lookup"><span data-stu-id="14aa3-112">Can be accessed without restrictions.</span></span>  <br/> |<span data-ttu-id="14aa3-113">None</span><span class="sxs-lookup"><span data-stu-id="14aa3-113">None</span></span>  <br/> |
|<span data-ttu-id="14aa3-114">2</span><span class="sxs-lookup"><span data-stu-id="14aa3-114">2</span></span>  <br/> |<span data-ttu-id="14aa3-115">Pode ser acessado apenas por formulários sendo executados no mesmo domínio que o formulário atualmente aberto ou por formulários que receberam permissões entre domínios.</span><span class="sxs-lookup"><span data-stu-id="14aa3-115">Can be accessed only by forms running in the same domain as the currently open form, or by forms that have been granted cross-domain permissions.</span></span>  <br/> |<span data-ttu-id="14aa3-116">None</span><span class="sxs-lookup"><span data-stu-id="14aa3-116">None</span></span>  <br/> |
|<span data-ttu-id="14aa3-117">3</span><span class="sxs-lookup"><span data-stu-id="14aa3-117">3</span></span>  <br/> |<span data-ttu-id="14aa3-118">Pode ser acessado apenas por formulários totalmente confiáveis.</span><span class="sxs-lookup"><span data-stu-id="14aa3-118">Can be accessed only by fully trusted forms.</span></span>  <br/> |<span data-ttu-id="14aa3-119">FullTrust</span><span class="sxs-lookup"><span data-stu-id="14aa3-119">FullTrust</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="14aa3-120">O nível de segurança "1" não é usado pelo servidor atual COM o InfoPath e está reservado para uso futuro.</span><span class="sxs-lookup"><span data-stu-id="14aa3-120">The security level "1" is not used by the current InfoPath COM server and is reserved for future use.</span></span> 
  
> [!IMPORTANT]
> <span data-ttu-id="14aa3-121">Embora os níveis de modelo de objeto 0 e 2 não exigem qualquer conjunto de permissões, porque eles contêm código gerenciado, elas se comportam conforme definido para o nível de segurança de acesso de domínio do domínio que é descrito na seção a seguir.</span><span class="sxs-lookup"><span data-stu-id="14aa3-121">Even though object model levels 0 and 2 do not demand any permission set, because they contain managed code, they behave as defined for the Domain domain access security level that is described in the following section.</span></span> 
  
<span data-ttu-id="14aa3-122">O nível de segurança de cada membro de modelo de objeto exposto pelos assemblies Microsoft.Office.InfoPath e SemiTrust é especificado na seção comentários do tópico que documenta esse membro no [ Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) e namespaces [SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) .</span><span class="sxs-lookup"><span data-stu-id="14aa3-122">The security level of each object model member exposed by the Microsoft.Office.InfoPath and Microsoft.Office.Interop.InfoPath.SemiTrust assemblies is specified in the Remarks section of the topic that documents that member in the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) and [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) namespaces.</span></span> 
  
## <a name="infopath-domain-access-security-levels"></a><span data-ttu-id="14aa3-123">Níveis de segurança de acesso do domínio do InfoPath</span><span class="sxs-lookup"><span data-stu-id="14aa3-123">InfoPath Domain Access Security Levels</span></span>

<span data-ttu-id="14aa3-124">Em conjunto com os níveis de segurança do modelo de objeto que são impostas pelo servidor COM expostos pelo aplicativo InfoPath, InfoPath define três níveis de segurança que são aplicados dependendo de onde o modelo de formulário está localizado, como o formulário é implantado, e definições configuradas no modo de design.</span><span class="sxs-lookup"><span data-stu-id="14aa3-124">In conjunction with the object model security levels that are enforced by the COM server exposed by the InfoPath application, InfoPath defines three security levels that are applied depending on where the form template is located, how the form is deployed, and settings configured in design mode.</span></span> <span data-ttu-id="14aa3-125">Esses três níveis de segurança são definidos na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="14aa3-125">These three security levels are defined in the following table.</span></span>
  
|<span data-ttu-id="14aa3-126">**Nível de segurança de acesso do domínio**</span><span class="sxs-lookup"><span data-stu-id="14aa3-126">**Domain Access Security Level**</span></span>|<span data-ttu-id="14aa3-127">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="14aa3-127">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="14aa3-128">Restrito</span><span class="sxs-lookup"><span data-stu-id="14aa3-128">Restricted</span></span>  <br/> |<span data-ttu-id="14aa3-129">Não permitir que qualquer comunicação fora o modelo de formulário.</span><span class="sxs-lookup"><span data-stu-id="14aa3-129">Does not permit any communication outside of the form template.</span></span> <span data-ttu-id="14aa3-130">Esse nível de segurança é destinado a impedir a transmissão de dados do seu computador para um invasor mal-intencionado formulários prejudiciais.</span><span class="sxs-lookup"><span data-stu-id="14aa3-130">This security level is intended to prevent harmful forms from transmitting any data from your computer to a malicious attacker.</span></span> <span data-ttu-id="14aa3-131">Ao executar neste modo de segurança, os seguintes recursos não funcionará: o painel de tarefas personalizado, conexões de dados (exceto o envio de email), os controles ActiveX, código de formulário de código gerenciado, funções e fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="14aa3-131">When running in this security mode, the following features will not work: Custom Task Pane, Data Connections (except email submit), ActiveX controls, managed code form code, Roles, and Workflow.</span></span> <span data-ttu-id="14aa3-132">Gerenciados não podem ser executado no domínio restrito modelos de formulário de código.</span><span class="sxs-lookup"><span data-stu-id="14aa3-132">Managed code form templates cannot run in the Restricted domain.</span></span> <span data-ttu-id="14aa3-133">Quando um modelo de formulário de código gerenciado é definido como a configuração de **determinar o nível de segurança automaticamente** na categoria de **segurança e confiança** da caixa de diálogo **Opções de formulário** , o modelo de formulário sempre exigirá pelo menos o acesso de segurança de domínio nível para executar um código.</span><span class="sxs-lookup"><span data-stu-id="14aa3-133">When a managed code form template is set to the **Automatically determine security level** setting in the **Security and Trust** category of the **Form Options** dialog box, the form template will always require at least the Domain security access level to run code.</span></span>  <br/><br/><span data-ttu-id="14aa3-134">**Importante**: O assembly de código gerenciado criado para um modelo de formulário de código gerenciado não vai ser carregado e executado quando um formulário é aberto a partir de um domínio restrito, por exemplo, a partir de um formulário do InfoPath enviado como um anexo de email.</span><span class="sxs-lookup"><span data-stu-id="14aa3-134">**IMPORTANT**: The managed code assembly created for a managed code form template will not load and run when a form is opened from a Restricted domain, for example, from an InfoPath form sent as an email attachment.</span></span> <span data-ttu-id="14aa3-135">Qualquer modelo de formulário que você deseja implantar como um anexo de email deve omitir os recursos listados acima, e se o modelo de formulário contém código de formulário, o código de formulário deve ser implementado em JScript ou VBScript e deve utilizar apenas os membros do modelo de objeto com um nível de segurança de 0 (zero) .</span><span class="sxs-lookup"><span data-stu-id="14aa3-135">Any form template you wish to deploy as an email attachment must omit the features listed above, and if the form template contains form code, form code must be implemented in JScript or VBScript, and must only utilize object model members with a security level of 0 (zero).</span></span>           |
|<span data-ttu-id="14aa3-136">Domínio</span><span class="sxs-lookup"><span data-stu-id="14aa3-136">Domain</span></span>  <br/> |<span data-ttu-id="14aa3-137">Restringe a um formulário baseado em seu local em uma das zonas de segurança definidas pelo Microsoft Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="14aa3-137">Restricts a form based on its location in one of the security zones defined by Microsoft Internet Explorer.</span></span> <span data-ttu-id="14aa3-138">Por exemplo, se o formulário está localizado na zona da Intranet Local, ele pode se comunicar com outros dados dentro de seu próprio domínio, mas não é permitido para recuperar dados de outros domínios.</span><span class="sxs-lookup"><span data-stu-id="14aa3-138">For example, if the form is located in the Local Intranet zone, it is allowed to communicate with other data inside its own domain but it is not permitted to retrieve data from other domains.</span></span> <span data-ttu-id="14aa3-139">O local em uma zona de segurança do Microsoft Internet Explorer também determina se os controles ActiveX que são marcados como seguros para script terão permissão para executar.</span><span class="sxs-lookup"><span data-stu-id="14aa3-139">The location in a Microsoft Internet Explorer security zone also determines whether ActiveX controls that are marked as unsafe for scripting will be allowed to run.</span></span>  <br/> |
|<span data-ttu-id="14aa3-140">Confiança total</span><span class="sxs-lookup"><span data-stu-id="14aa3-140">Full Trust</span></span>  <br/> |<span data-ttu-id="14aa3-141">Permite a execução de um formulário com confiança total no computador onde o formulário será usado.</span><span class="sxs-lookup"><span data-stu-id="14aa3-141">Allows you to run a form with full trust on the computer where the form will be used.</span></span> <span data-ttu-id="14aa3-142">Esse nível de segurança só pode ser usado ao trabalhar com um formulário que é assinado digitalmente com uma assinatura que corresponde a um fornecedor de raiz confiável no seu computador ou criando um programa de instalação que instala o formulário e define o **requireFullTrust** atributo do elemento **xDocumentClass** como "yes" no arquivo de definição de formulário (. xsf).</span><span class="sxs-lookup"><span data-stu-id="14aa3-142">This security level can only be used when working with a form that is digitally signed with a signature that matches a trusted root publisher on your computer, or by creating an installation program that installs the form and sets the **requireFullTrust** attribute of the **xDocumentClass** element to "yes" in the form definition file (.xsf).</span></span> <span data-ttu-id="14aa3-143">Usando essa configuração, seu formulário pode acessar as chamadas de modelo de objeto que exigem o nível de segurança de modelo objeto 3, como propriedades e métodos que acessam o sistema de arquivos, e você pode desabilitar determinados avisos de segurança que aparecem durante a execução em um título mais restritivo nível.</span><span class="sxs-lookup"><span data-stu-id="14aa3-143">By using this setting, your form can access object model calls that require object model security level 3, such as properties and methods that access the file system, and you can disable certain security prompts that appear when running at a more restrictive security level.</span></span>  <br/> |
   
<span data-ttu-id="14aa3-144">Por padrão, um formulário do InfoPath é configurado para selecione automaticamente o nível de segurança de domínio ou restrito dependendo dos recursos que estão sendo usados no modelo de formulário, e onde e como o modelo de formulário é implantado.</span><span class="sxs-lookup"><span data-stu-id="14aa3-144">By default, an InfoPath form is configured to select automatically either the Restricted or Domain security level depending on the features that are being used in the form template, and where and how the form template is deployed.</span></span> <span data-ttu-id="14aa3-145">Por exemplo, um modelo de formulário implantado como um anexo de email é configurado automaticamente o nível de segurança restrito.</span><span class="sxs-lookup"><span data-stu-id="14aa3-145">For example, a form template deployed as an email attachment is automatically configured to the Restricted security level.</span></span> <span data-ttu-id="14aa3-146">A configuração de segurança é tão restritiva sempre que possível, começando restrito, para garantir um maior nível de proteção para você e seus dados.</span><span class="sxs-lookup"><span data-stu-id="14aa3-146">The security setting is always as restrictive as possible, starting at Restricted, to ensure a greater level of protection for you and your data.</span></span> <span data-ttu-id="14aa3-147">Quando um modelo de formulário que contém o código gerenciado é definido para selecionar automaticamente o nível de segurança, o modelo de formulário sempre exigirá pelo menos o nível de acesso de segurança de domínio antes de código pode ser executado.</span><span class="sxs-lookup"><span data-stu-id="14aa3-147">When a form template that contains managed code is set to automatically select the security level, the form template will always require at least the Domain security access level before code can run.</span></span> <span data-ttu-id="14aa3-148">Manualmente, você pode substituir essa configuração no tempo de design para selecionar um nível de segurança que é mais apropriado para o formulário usando o procedimento a seguir.</span><span class="sxs-lookup"><span data-stu-id="14aa3-148">You can manually override this setting at design time to select a level of security that is more appropriate for the form by using the following procedure.</span></span> 
  
### <a name="specify-a-forms-security-level"></a><span data-ttu-id="14aa3-149">Especificar o nível de segurança de um formulário</span><span class="sxs-lookup"><span data-stu-id="14aa3-149">Specify a form's security level</span></span>

1. <span data-ttu-id="14aa3-150">Abra o formulário no designer de formulários do InfoPath, clique na guia **arquivo** , clique em **Info**e, em seguida, clique em **Opções de formulário**.</span><span class="sxs-lookup"><span data-stu-id="14aa3-150">Open the form in the InfoPath form designer, click the **File** tab, click **Info**, and then click **Form Options**.</span></span>
    
2. <span data-ttu-id="14aa3-151">Na caixa de diálogo **Opções de formulário** , clique na categoria de **segurança e confiança** .</span><span class="sxs-lookup"><span data-stu-id="14aa3-151">In the **Form Options** dialog box, click the **Security and Trust** category.</span></span> 
    
3. <span data-ttu-id="14aa3-152">Limpar o **determinar o nível de segurança automaticamente (recomendado)** caixa de seleção.</span><span class="sxs-lookup"><span data-stu-id="14aa3-152">Clear the **Automatically determine security level (recommended)** check box.</span></span> 
    
4. <span data-ttu-id="14aa3-153">Selecione o nível de segurança desejado.</span><span class="sxs-lookup"><span data-stu-id="14aa3-153">Select the desired security level.</span></span>
    
> [!NOTE] 
> - <span data-ttu-id="14aa3-154">Se você selecionar o nível de segurança para um modelo de formulário de código gerenciado, o código por trás do formulário **restrito** não será carregado e executado independentemente de qual objeto membros de modelo são usados no código do formulário.</span><span class="sxs-lookup"><span data-stu-id="14aa3-154">If you the select the **Restricted** security level for a managed code form template, the code behind the form will not load and run regardless of which object model members are used in the form code.</span></span> <span data-ttu-id="14aa3-155">Esse nível de segurança destina-se principalmente para formulários do InfoPath que são implantados usando email.</span><span class="sxs-lookup"><span data-stu-id="14aa3-155">This security level is primarily designed for InfoPath forms that are deployed using email.</span></span>     
> - <span data-ttu-id="14aa3-156">Se você selecionar o nível de segurança **Confiança total** , você precisará assinar digitalmente ou instalar e registrar o formulário.</span><span class="sxs-lookup"><span data-stu-id="14aa3-156">If you select the **Full Trust** security level, you need to digitally sign or install and register the form.</span></span> <span data-ttu-id="14aa3-157">Para obter mais informações, consulte [Implantar modelos de formulário do InfoPath com código](how-to-deploy-infopath-form-templates-with-code.md).</span><span class="sxs-lookup"><span data-stu-id="14aa3-157">For more information, see [Deploy InfoPath Form Templates with Code](how-to-deploy-infopath-form-templates-with-code.md).</span></span>
    
<span data-ttu-id="14aa3-158">A tabela a seguir resume o modelo de segurança do InfoPath.</span><span class="sxs-lookup"><span data-stu-id="14aa3-158">The following table summarizes the InfoPath security model.</span></span> <span data-ttu-id="14aa3-159">A primeira coluna lista o nível especificado para ou necessários para o formulário.</span><span class="sxs-lookup"><span data-stu-id="14aa3-159">The first column lists the level specified for or required by the form.</span></span> <span data-ttu-id="14aa3-160">As colunas de segunda e terceira especificam se o formulário tem um identificador URN ou uma URL para seu local.</span><span class="sxs-lookup"><span data-stu-id="14aa3-160">The second and third columns specify whether the form has a URN or URL identifier for its location.</span></span> <span data-ttu-id="14aa3-161">As colunas remanescentes especificam o que pode ser executado.</span><span class="sxs-lookup"><span data-stu-id="14aa3-161">The remaining columns specify what is allowed to run.</span></span> <span data-ttu-id="14aa3-162">Para obter mais informações sobre a implantação de permissão e cenários define para modelos de formulário de código gerenciado, consulte a seção "Common Language Runtime código acesso recursos de segurança" mais adiante neste tópico.</span><span class="sxs-lookup"><span data-stu-id="14aa3-162">For more information on deployment scenarios and permission sets for managed code form templates, see the "Common Language Runtime Code Access Security Features" section later in this topic.</span></span>
  
|<span data-ttu-id="14aa3-163">**Nível exigido por formulário**</span><span class="sxs-lookup"><span data-stu-id="14aa3-163">**Level Required by form**</span></span>|<span data-ttu-id="14aa3-164">**Tem URN identificador**</span><span class="sxs-lookup"><span data-stu-id="14aa3-164">**Has URN Identifier**</span></span>|<span data-ttu-id="14aa3-165">**Tem um identificador de URL**</span><span class="sxs-lookup"><span data-stu-id="14aa3-165">**Has URL Identifier**</span></span>|<span data-ttu-id="14aa3-166">**ActiveX marcados não seguro para scripts**</span><span class="sxs-lookup"><span data-stu-id="14aa3-166">**ActiveX marked unsafe for scripting**</span></span>|<span data-ttu-id="14aa3-167">**Acesso entre domínios**</span><span class="sxs-lookup"><span data-stu-id="14aa3-167">**Cross-Domain Access**</span></span>|<span data-ttu-id="14aa3-168">**Código gerenciado**</span><span class="sxs-lookup"><span data-stu-id="14aa3-168">**Managed code**</span></span>|<span data-ttu-id="14aa3-169">**Segurança do modelo de objeto**</span><span class="sxs-lookup"><span data-stu-id="14aa3-169">**Object Model Security**</span></span>|
|:-----|:-----|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="14aa3-170">Restricted</span><span class="sxs-lookup"><span data-stu-id="14aa3-170">Restricted</span></span>  <br/> ||<span data-ttu-id="14aa3-171">X</span><span class="sxs-lookup"><span data-stu-id="14aa3-171">X</span></span>  <br/> |<span data-ttu-id="14aa3-172">Nenhum ActiveX mudaram</span><span class="sxs-lookup"><span data-stu-id="14aa3-172">No ActiveX at all</span></span>  <br/> |<span data-ttu-id="14aa3-173">Falhar</span><span class="sxs-lookup"><span data-stu-id="14aa3-173">Fail</span></span>  <br/> |<span data-ttu-id="14aa3-174">Formar cargas, mas gerenciada código não serão executados</span><span class="sxs-lookup"><span data-stu-id="14aa3-174">Form loads, but managed code won't run</span></span>  <br/> |<span data-ttu-id="14aa3-175">0</span><span class="sxs-lookup"><span data-stu-id="14aa3-175">0</span></span>  <br/> |
|<span data-ttu-id="14aa3-176">Domínio (zona **sites restritos** do Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="14aa3-176">Domain (Internet Explorer **Restricted sites** zone)</span></span>  <br/> |<span data-ttu-id="14aa3-177">Não é executada</span><span class="sxs-lookup"><span data-stu-id="14aa3-177">Won't run at all</span></span>  <br/> |<span data-ttu-id="14aa3-178">Não é executada</span><span class="sxs-lookup"><span data-stu-id="14aa3-178">Won't run at all</span></span>  <br/> |<span data-ttu-id="14aa3-179">Não é executada</span><span class="sxs-lookup"><span data-stu-id="14aa3-179">Won't run at all</span></span>  <br/> |<span data-ttu-id="14aa3-180">Não é executada</span><span class="sxs-lookup"><span data-stu-id="14aa3-180">Won't run at all</span></span>  <br/> |<span data-ttu-id="14aa3-181">Não é executada</span><span class="sxs-lookup"><span data-stu-id="14aa3-181">Won't run at all</span></span>  <br/> |<span data-ttu-id="14aa3-182">Não é executada</span><span class="sxs-lookup"><span data-stu-id="14aa3-182">Won't run at all</span></span>  <br/> |
|<span data-ttu-id="14aa3-183">Domínio (zona da Internet Explorer **Internet** )</span><span class="sxs-lookup"><span data-stu-id="14aa3-183">Domain (Internet Explorer **Internet** zone)</span></span>  <br/> |<span data-ttu-id="14aa3-184">X</span><span class="sxs-lookup"><span data-stu-id="14aa3-184">X</span></span>  <br/> ||<span data-ttu-id="14aa3-185">Falhar</span><span class="sxs-lookup"><span data-stu-id="14aa3-185">Fail</span></span>  <br/> |<span data-ttu-id="14aa3-186">Falhar</span><span class="sxs-lookup"><span data-stu-id="14aa3-186">Fail</span></span>  <br/> |<span data-ttu-id="14aa3-187">Não é executada</span><span class="sxs-lookup"><span data-stu-id="14aa3-187">Won't run at all</span></span>  <br/> |<span data-ttu-id="14aa3-188">0</span><span class="sxs-lookup"><span data-stu-id="14aa3-188">0</span></span>  <br/> |
|<span data-ttu-id="14aa3-189">Domínio (zona da Internet Explorer **intranet Local** )</span><span class="sxs-lookup"><span data-stu-id="14aa3-189">Domain (Internet Explorer **Local intranet** zone)</span></span>  <br/> |<span data-ttu-id="14aa3-190">X</span><span class="sxs-lookup"><span data-stu-id="14aa3-190">X</span></span>  <br/> ||<span data-ttu-id="14aa3-191">Falhar</span><span class="sxs-lookup"><span data-stu-id="14aa3-191">Fail</span></span>  <br/> |<span data-ttu-id="14aa3-192">Prompt</span><span class="sxs-lookup"><span data-stu-id="14aa3-192">Prompt</span></span>  <br/> |<span data-ttu-id="14aa3-193">Código gerenciado é executado com permissões de **intranet Local** .</span><span class="sxs-lookup"><span data-stu-id="14aa3-193">Managed code runs with **Local intranet** permissions.</span></span>  <br/> |<span data-ttu-id="14aa3-194">2</span><span class="sxs-lookup"><span data-stu-id="14aa3-194">2</span></span>  <br/> |
|<span data-ttu-id="14aa3-195">Domínio (zona **sites confiáveis** do Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="14aa3-195">Domain (Internet Explorer **Trusted sites** zone)</span></span>  <br/> |<span data-ttu-id="14aa3-196">X</span><span class="sxs-lookup"><span data-stu-id="14aa3-196">X</span></span>  <br/> ||<span data-ttu-id="14aa3-197">Prompt</span><span class="sxs-lookup"><span data-stu-id="14aa3-197">Prompt</span></span>  <br/> |<span data-ttu-id="14aa3-198">OK</span><span class="sxs-lookup"><span data-stu-id="14aa3-198">OK</span></span>  <br/> |<span data-ttu-id="14aa3-199">Código gerenciado é executado com permissões de **Internet** .</span><span class="sxs-lookup"><span data-stu-id="14aa3-199">Managed code runs with **Internet** permissions.</span></span> <span data-ttu-id="14aa3-200">Acesso entre domínios é permitido.</span><span class="sxs-lookup"><span data-stu-id="14aa3-200">Cross-domain access is allowed.</span></span> <span data-ttu-id="14aa3-201">Observe que, mesmo que o formulário está na zona **sites confiáveis** , permissões de zona da **Internet** sejam aplicadas.</span><span class="sxs-lookup"><span data-stu-id="14aa3-201">Note that even though the form is in the **Trusted sites** zone, **Internet** zone permissions are applied.</span></span>  <br/> |<span data-ttu-id="14aa3-202">2</span><span class="sxs-lookup"><span data-stu-id="14aa3-202">2</span></span>  <br/> |
|<span data-ttu-id="14aa3-203">Domínio (zona da Internet Explorer **computador Local** )</span><span class="sxs-lookup"><span data-stu-id="14aa3-203">Domain (Internet Explorer **Local computer** zone)</span></span>  <br/> |<span data-ttu-id="14aa3-204">X</span><span class="sxs-lookup"><span data-stu-id="14aa3-204">X</span></span>  <br/> |<span data-ttu-id="14aa3-205">X</span><span class="sxs-lookup"><span data-stu-id="14aa3-205">X</span></span>  <br/> |<span data-ttu-id="14aa3-206">Prompt</span><span class="sxs-lookup"><span data-stu-id="14aa3-206">Prompt</span></span>  <br/> |<span data-ttu-id="14aa3-207">Falhar</span><span class="sxs-lookup"><span data-stu-id="14aa3-207">Fail</span></span>  <br/> |<span data-ttu-id="14aa3-208">Código gerenciado é executado com permissões de **intranet Local** .</span><span class="sxs-lookup"><span data-stu-id="14aa3-208">Managed code runs with **Local intranet** permissions.</span></span>  <br/> |<span data-ttu-id="14aa3-209">2</span><span class="sxs-lookup"><span data-stu-id="14aa3-209">2</span></span>  <br/> |
|<span data-ttu-id="14aa3-210">Confiança total</span><span class="sxs-lookup"><span data-stu-id="14aa3-210">Full Trust</span></span>  <br/> |<span data-ttu-id="14aa3-211">X</span><span class="sxs-lookup"><span data-stu-id="14aa3-211">X</span></span>  <br/> |<span data-ttu-id="14aa3-212">X</span><span class="sxs-lookup"><span data-stu-id="14aa3-212">X</span></span>  <br/> |<span data-ttu-id="14aa3-213">OK</span><span class="sxs-lookup"><span data-stu-id="14aa3-213">OK</span></span>  <br/> |<span data-ttu-id="14aa3-214">OK</span><span class="sxs-lookup"><span data-stu-id="14aa3-214">OK</span></span>  <br/> |<span data-ttu-id="14aa3-215">Confiança total</span><span class="sxs-lookup"><span data-stu-id="14aa3-215">Full Trust</span></span>  <br/> |<span data-ttu-id="14aa3-216">3</span><span class="sxs-lookup"><span data-stu-id="14aa3-216">3</span></span>  <br/> |
   
> [!IMPORTANT]
> <span data-ttu-id="14aa3-217">Descrições acima o "ActiveX marcados não seguro para script" e colunas de "Acesso entre domínios" pressupõem o padrão de configurações de segurança para o Microsoft Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="14aa3-217">The descriptions above in the "ActiveX marked unsafe for scripting" and "Cross-Domain Access" columns assume the default security settings for Microsoft Internet Explorer.</span></span> <span data-ttu-id="14aa3-218">Se um usuário alterar suas configurações de segurança, InfoPath irá se comportar adequadamente.</span><span class="sxs-lookup"><span data-stu-id="14aa3-218">If a user changes their security settings, InfoPath will behave accordingly.</span></span> <span data-ttu-id="14aa3-219">Por exemplo, se na zona **da intranet Local** , **acessar fontes de dados entre domínios** estiver definida como **Habilitar**, e em seguida, os usuários não serão solicitados para permitir acesso entre domínios como descrito na tabela.</span><span class="sxs-lookup"><span data-stu-id="14aa3-219">For example, if in the **Local intranet** zone, **Access data sources across domains** is set to **Enable**, then users will not be prompted to allow cross-domain access as described in the table.</span></span> 
  
## <a name="common-language-runtime-code-access-security-features"></a><span data-ttu-id="14aa3-220">Comuns recursos de segurança do acesso em tempo de execução de código de idioma</span><span class="sxs-lookup"><span data-stu-id="14aa3-220">Common Language Runtime Code Access Security Features</span></span>

<span data-ttu-id="14aa3-221">Quando um modelo de formulário de código gerenciado é compilado de InfoPath, um assembly de código gerenciado privada é criado que contém a implementação da lógica de código do formulário.</span><span class="sxs-lookup"><span data-stu-id="14aa3-221">When an InfoPath managed code form template is compiled, a private managed code assembly is created that contains the implementation of the form code logic.</span></span>
  
<span data-ttu-id="14aa3-222">No .NET Framework, por padrão, um assembly de código gerenciado tem permissões de confiança total durante a execução na máquina local e não está concedidas permissões de confiança total ao executar na Intranet.</span><span class="sxs-lookup"><span data-stu-id="14aa3-222">In the .NET Framework, by default, a managed code assembly has Full Trust permissions when running on the local machine, and is not granted Full Trust permissions when running on the Intranet.</span></span> <span data-ttu-id="14aa3-223">Para fornecer mais controle refinado sobre diretiva de segurança e para oferecer a opção para executar o código gerenciado do InfoPath modelos de formulário como formulários totalmente confiáveis da Intranet, o InfoPath implementa a arquitetura de segurança a seguir.</span><span class="sxs-lookup"><span data-stu-id="14aa3-223">To provide more fine-grained control over security policy, and to provide the option to run InfoPath managed code form templates as fully trusted forms from the Intranet, InfoPath implements the following security architecture.</span></span>
  
- <span data-ttu-id="14aa3-224">O aplicativo InfoPath hospeda o .NET Framework common language runtime (CLR).</span><span class="sxs-lookup"><span data-stu-id="14aa3-224">The InfoPath application hosts the .NET Framework common language runtime (CLR).</span></span>
    
- <span data-ttu-id="14aa3-225">Dentro do CLR hospedado pelo InfoPath, cada modelo de formulário de código gerenciado é executado em um domínio de aplicativo separado, que é um ambiente que fornece isolamento, descarregar, e os limites de segurança para a execução de código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="14aa3-225">Within the CLR hosted by InfoPath, each managed code form template runs in a separate application domain, which is an environment that provides isolation, unloading, and security boundaries for executing managed code.</span></span>
    
- <span data-ttu-id="14aa3-226">InfoPath define uma diretiva de segurança padrão no domínio do aplicativo, dependendo do nível de confiança associado com o modelo de formulário e a URL do seu local.</span><span class="sxs-lookup"><span data-stu-id="14aa3-226">InfoPath sets a default security policy on the application domain depending on the level of trust associated with the form template and the URL of its location.</span></span>
    
- <span data-ttu-id="14aa3-227">Por padrão, um modelo de formulário de código gerenciado em execução no computador local (o grupo de códigos de zona do meu computador) obtém um nível inferior das permissões de confiança total (permissões de zona da Intranet Local).</span><span class="sxs-lookup"><span data-stu-id="14aa3-227">By default, a managed code form template running on the local computer (the My Computer Zone code group) gets a lower level of permissions than Full Trust (Local Intranet Zone permissions).</span></span> <span data-ttu-id="14aa3-228">Para ter permissões de confiança total, o formulário deve ser registrado ou assinado digitalmente com um certificado confiável.</span><span class="sxs-lookup"><span data-stu-id="14aa3-228">To have Full Trust permissions, the form must be registered or digitally signed with a trusted certificate.</span></span>
    
<span data-ttu-id="14aa3-229">A diretiva de segurança padrão definido para o domínio de aplicativo de um modelo de formulário de código gerenciado garante que os níveis de segurança de acesso de domínio do InfoPath, bem como qualquer restrição de segurança do .NET adicionais é impostas.</span><span class="sxs-lookup"><span data-stu-id="14aa3-229">The default security policy set for the application domain of a managed code form template ensures that the InfoPath domain access security levels as well as any additional .NET security restrictions are enforced.</span></span> <span data-ttu-id="14aa3-230">Para fornecer flexibilidade adicional, o sistema de segurança do InfoPath reconhece um .NET código acesso segurança código grupo chamado "Modelos de formulário do InfoPath".</span><span class="sxs-lookup"><span data-stu-id="14aa3-230">To provide additional flexibility, the InfoPath security system recognizes a .NET code access security code group named "InfoPath Form Templates".</span></span> <span data-ttu-id="14aa3-231">Se este grupo de códigos estiver presente no computador de um usuário, a configuração de segurança e as de quaisquer grupos de códigos filho dentro dele serão aplicada ao domínio do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="14aa3-231">If this code group is present on a user's computer, its security configuration, and those of any child code groups within it will be applied to the application domain.</span></span>
  
> [!IMPORTANT] 
> - <span data-ttu-id="14aa3-232">O grupo de códigos de modelos de formulário do InfoPath só se aplica ao assembly de código de formulário de código gerenciado em si.</span><span class="sxs-lookup"><span data-stu-id="14aa3-232">The InfoPath Form Templates code group applies only to the managed code form code assembly itself.</span></span> <span data-ttu-id="14aa3-233">Como resultado, se você conceder a permissão de confiança total definida como InfoPath código formulário código gerenciado, mas você não tiver instalado e registrado (ou assinada digitalmente) o modelo de formulário em si (que faz com que o modelo de formulário inteiro totalmente confiável), chama no código do formulário para segurança membros do modelo de objeto de nível 3 ainda falhará.</span><span class="sxs-lookup"><span data-stu-id="14aa3-233">As a result, if you grant the Full Trust permission set to InfoPath managed code form code, but you have not installed and registered (or digitally signed) the form template itself (which makes the entire form template fully trusted), calls in the form code to security level 3 object model members will still fail.</span></span>   
> - <span data-ttu-id="14aa3-234">Se você referenciar ou carregar explicitamente (Load) de um assembly que é configurado com uma permissão restrita definida usando Hash, nome forte ou evidência do Publisher para determinar sua condição de associação em um projeto de modelo de formulário, o assembly, mesmo assim, será carregado e executado pelo modelo de formulário.</span><span class="sxs-lookup"><span data-stu-id="14aa3-234">If you reference or explicitly load (Assembly.Load) an assembly that is configured with a restricted permission set using Hash, Strong Name, or Publisher evidence to determine its membership condition in a form template project, the assembly will nonetheless be loaded and executed by the form template.</span></span>
    
<span data-ttu-id="14aa3-235">Para obter informações sobre como criar e configurar o grupo de códigos de modelos de formulário do InfoPath, consulte [Configurar definições de segurança para modelos de formulário com código](how-to-configure-security-settings-for-form-templates-with-code.md).</span><span class="sxs-lookup"><span data-stu-id="14aa3-235">For information on how to create and configure the InfoPath Form Templates code group, see [Configure Security Settings for Form Templates with Code](how-to-configure-security-settings-for-form-templates-with-code.md).</span></span>
  
<span data-ttu-id="14aa3-236">A tabela a seguir resume os cenários de implantação e os conjuntos de permissões que se aplicam aos modelos de formulário de código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="14aa3-236">The following table summarizes the deployment scenarios and permission sets that apply to managed code form templates.</span></span>
  
|<span data-ttu-id="14aa3-237">**Cenário de implantação**</span><span class="sxs-lookup"><span data-stu-id="14aa3-237">**Deployment Scenario**</span></span>|<span data-ttu-id="14aa3-238">**Conjunto de permissões**</span><span class="sxs-lookup"><span data-stu-id="14aa3-238">**Permission Set**</span></span>|<span data-ttu-id="14aa3-239">**Notes**</span><span class="sxs-lookup"><span data-stu-id="14aa3-239">**Notes**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="14aa3-240">O modelo de formulário é publicado no computador local, e o desenvolvedor está usando o Visual Studio para escrever e depurar código do formulário.</span><span class="sxs-lookup"><span data-stu-id="14aa3-240">The form template is published on the local computer, and the developer is using Visual Studio to write and debug form code.</span></span>  <br/> |<span data-ttu-id="14aa3-241">Conjunto de permissões de Intranet local.</span><span class="sxs-lookup"><span data-stu-id="14aa3-241">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="14aa3-242">Assemblies instalados no Cache de Assembly Global (GAC) e marcados com o atributo **AllowPartiallyTrustedCallersAttribute** recebem o conjunto de permissões de confiança total.</span><span class="sxs-lookup"><span data-stu-id="14aa3-242">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set.</span></span>  <br/> |<span data-ttu-id="14aa3-243">Por padrão, os modelos de formulário executando a partir do computador local não recebem o conjunto de permissões de confiança total.</span><span class="sxs-lookup"><span data-stu-id="14aa3-243">By default, form templates running from the local computer are not granted the Full Trust permission set.</span></span> <span data-ttu-id="14aa3-244">Enquanto os membros que exigem permissões de confiança total do modelo de desenvolver modelos de formulário que usam os recursos e as chamadas para o objeto, você pode usar o procedimento descrito em [Visualizar e depurar modelos de formulário que exigem confiança total](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span><span class="sxs-lookup"><span data-stu-id="14aa3-244">While developing form templates that use features and calls to object model members that require Full Trust permissions, you can use the procedure described in [Preview and Debug Form Templates that Require Full Trust](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span></span>  <br/> |
|<span data-ttu-id="14aa3-245">O modelo de formulário é publicado no computador local e faz referência a um assembly personalizado que solicita a permissão de confiança total definida no computador local.</span><span class="sxs-lookup"><span data-stu-id="14aa3-245">The form template is published on the local computer and references a custom assembly that requests the Full Trust permission set on the local computer.</span></span>  <br/> |<span data-ttu-id="14aa3-246">Conjunto de permissões de Intranet local.</span><span class="sxs-lookup"><span data-stu-id="14aa3-246">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="14aa3-247">Assemblies instalados no Cache de Assembly Global (GAC) e marcados com o atributo **AllowPartiallyTrustedCallersAttribute** recebem o conjunto de permissões de confiança total.</span><span class="sxs-lookup"><span data-stu-id="14aa3-247">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set.</span></span> <span data-ttu-id="14aa3-248">O assembly personalizado recebe o conjunto de permissões de Intranet Local.</span><span class="sxs-lookup"><span data-stu-id="14aa3-248">The custom assembly is granted the Local Intranet permission set.</span></span>  <br/> |<span data-ttu-id="14aa3-249">Para fazer referência a assemblies externos para uso em código do modelo de formulário, o desenvolvedor deve usar o grupo de códigos de modelos de formulário do InfoPath para conceder confiança total (ou o conjunto de permissões apropriado) para o assembly externo mencionado no código do modelo de formulário.</span><span class="sxs-lookup"><span data-stu-id="14aa3-249">To reference external assemblies for use in the form template's code, the developer must use the InfoPath Form Templates code group to grant Full Trust (or the appropriate permission set) to the external assembly referenced in the form template's code.</span></span> <span data-ttu-id="14aa3-250">InfoPath não faz suposições sobre assemblies externos além daquelas instalado no Cache de Assembly Global (GAC).</span><span class="sxs-lookup"><span data-stu-id="14aa3-250">InfoPath does not make any assumptions about external assemblies other than those installed in the Global Assembly Cache (GAC).</span></span> <span data-ttu-id="14aa3-251">O desenvolvedor deve conceder explicitamente o assembly as permissões necessárias usando o grupo de códigos de modelos de formulário do InfoPath, mesmo se o assembly já foi entanto confiáveis permissões concedidas no grupo código, My_Computer_Zone.</span><span class="sxs-lookup"><span data-stu-id="14aa3-251">The developer must explicitly grant the assembly the necessary permissions using the InfoPath Form Templates code group even if the assembly is already trusted though permissions granted in the My_Computer_Zone code group.</span></span>  <br/> |
|<span data-ttu-id="14aa3-252">O modelo de formulário é publicado em um local compartilhado na intranet local, como um compartilhamento de arquivos, biblioteca de formulários do SharePoint ou um servidor Web.</span><span class="sxs-lookup"><span data-stu-id="14aa3-252">The form template is published on a shared location in the local intranet, such as a file share, SharePoint Form library, or a Web server.</span></span>  <br/> |<span data-ttu-id="14aa3-253">Conjunto de permissões de Intranet local.</span><span class="sxs-lookup"><span data-stu-id="14aa3-253">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="14aa3-254">Assemblies instalados no Cache de Assembly Global (GAC) e marcados com o atributo **AllowPartiallyTrustedCallersAttribute** recebem o conjunto de permissões de confiança total.</span><span class="sxs-lookup"><span data-stu-id="14aa3-254">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set.</span></span>  <br/> ||
|<span data-ttu-id="14aa3-255">O modelo de formulário é publicado em um local compartilhado na intranet local, como um compartilhamento de arquivos, biblioteca de formulários do SharePoint ou um servidor Web que é designado como um site confiáveis no Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="14aa3-255">The form template is published on a shared location in the local intranet, such as a file share, SharePoint Form library, or a Web server that is designated as a Trusted site in Internet Explorer.</span></span>  <br/> |<span data-ttu-id="14aa3-256">Conjunto de permissões de Internet.</span><span class="sxs-lookup"><span data-stu-id="14aa3-256">Internet permission set.</span></span>  <br/> <span data-ttu-id="14aa3-257">Assemblies assinados pela Microsoft e ECMA recebem o conjunto de permissões de confiança total.</span><span class="sxs-lookup"><span data-stu-id="14aa3-257">Assemblies signed by Microsoft and ECMA are granted the Full Trust permission set.</span></span>  <br/> |<span data-ttu-id="14aa3-258">Segurança de acesso do código CLR concede somente Internet conjunto de permissões para sites que forem designados como sites confiáveis no Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="14aa3-258">CLR code access security grants only the Internet permission set to sites that are designated as Trusted sites in Internet Explorer.</span></span> <span data-ttu-id="14aa3-259">InfoPath respeita essa diretiva.</span><span class="sxs-lookup"><span data-stu-id="14aa3-259">InfoPath respects this policy.</span></span> <span data-ttu-id="14aa3-260">Observe que isso é diferente de um modelo de formulário do InfoPath que usa o script para o código de formulário, que recebe um nível mais alto de permissões quando publicado em uma zona de sites confiáveis.</span><span class="sxs-lookup"><span data-stu-id="14aa3-260">Note that this is unlike an InfoPath form template that uses script for form code, which receives a higher level of permissions when published in a Trusted sites zone.</span></span>  <br/> |
|<span data-ttu-id="14aa3-261">O modelo de formulário é baixado ou copiado de um local da Internet.</span><span class="sxs-lookup"><span data-stu-id="14aa3-261">The form template is downloaded or copied from an Internet location.</span></span>  <br/> |<span data-ttu-id="14aa3-262">Por padrão, nenhum.</span><span class="sxs-lookup"><span data-stu-id="14aa3-262">By default, none.</span></span> <span data-ttu-id="14aa3-263">O assembly de código gerenciado para o modelo de formulário não é carregado e não é executado.</span><span class="sxs-lookup"><span data-stu-id="14aa3-263">The managed code assembly for the form template is not loaded and does not run.</span></span>  <br/> ||
   
## <a name="see-also"></a><span data-ttu-id="14aa3-264">Confira também</span><span class="sxs-lookup"><span data-stu-id="14aa3-264">See also</span></span>

- [<span data-ttu-id="14aa3-265">Definir configurações de segurança para modelos de formulário com código</span><span class="sxs-lookup"><span data-stu-id="14aa3-265">Configure Security Settings for Form Templates with Code</span></span>](how-to-configure-security-settings-for-form-templates-with-code.md)
- [<span data-ttu-id="14aa3-266">Visualizar e depurar os modelos de formulário que exijam confiança total</span><span class="sxs-lookup"><span data-stu-id="14aa3-266">Preview and Debug Form Templates that Require Full Trust</span></span>](how-to-preview-and-debug-form-templates-that-require-full-trust.md)

