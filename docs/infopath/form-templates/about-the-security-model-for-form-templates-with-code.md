---
title: Sobre o modelo de segurança para modelos de formulário com código
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- InfoPath 2007, segurança, segurança do acesso ao código [InfoPath 2007], segurança [InfoPath 2007], modelo de segurança para código gerenciado, segurança [InfoPath 2007], níveis, CAS [InfoPath 2007], modelos de formulário compatíveis com o InfoPath 2003, segurança, permissões [InfoPath 2007]
localization_priority: Normal
ms.assetid: 5e1c1c72-f98d-4871-9c57-82c315277aa1
description: Os modelos de formulário de código gerenciado do InfoPath dão suporte aos mesmos níveis de segurança que o script em execução em modelos de formulário não gerenciados, e também oferecem suporte a recursos de segurança de acesso a código adicionais que se aplicam ao código gerenciado em execução no CLR (Common Language Runtime) do. NET Framework.
ms.openlocfilehash: 97f0239a5bd6699b539ddaebf4d1d2ed7d1394db
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2019
ms.locfileid: "32303763"
---
# <a name="about-the-security-model-for-form-templates-with-code"></a><span data-ttu-id="46640-104">Sobre o modelo de segurança para modelos de formulário com código</span><span class="sxs-lookup"><span data-stu-id="46640-104">About the Security Model for Form Templates with Code</span></span>

<span data-ttu-id="46640-105">Os modelos de formulário de código gerenciado do InfoPath dão suporte aos mesmos níveis de segurança que o script em execução em modelos de formulário não gerenciados, e também oferecem suporte a recursos de segurança de acesso a código adicionais que se aplicam ao código gerenciado em execução no CLR (Common Language Runtime) do. NET Framework.</span><span class="sxs-lookup"><span data-stu-id="46640-105">InfoPath managed code form templates support the same security levels as script running in unmanaged form templates, and they also support additional code access security features that apply to managed code running under the common language runtime (CLR) of the .NET Framework.</span></span>
  
## <a name="infopath-managed-object-model-security-levels"></a><span data-ttu-id="46640-106">Níveis de segurança do modelo de objeto gerenciado do InfoPath</span><span class="sxs-lookup"><span data-stu-id="46640-106">InfoPath Managed Object Model Security Levels</span></span>

<span data-ttu-id="46640-107">A tabela a seguir descreve a relação entre os níveis de segurança para membros do modelo de objeto de script e o conjunto de permissões correspondente que é exigido para cada nível quando o membro do modelo de objeto é usado em um modelo de formulário de código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="46640-107">The following table describes the relationship between the security levels for script object model members and the corresponding permission set that is demanded for each level when the object model member is used in a managed code form template.</span></span>
  
|<span data-ttu-id="46640-108">**Nível de segurança do modelo de objeto**</span><span class="sxs-lookup"><span data-stu-id="46640-108">**Object Model Security Level**</span></span>|<span data-ttu-id="46640-109">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="46640-109">**Description**</span></span>|<span data-ttu-id="46640-110">**Conjunto de permissões exigido**</span><span class="sxs-lookup"><span data-stu-id="46640-110">**Permission Set Demanded**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="46640-111">,0</span><span class="sxs-lookup"><span data-stu-id="46640-111">0</span></span>  <br/> |<span data-ttu-id="46640-112">Podem ser acessados sem restrições.</span><span class="sxs-lookup"><span data-stu-id="46640-112">Can be accessed without restrictions.</span></span>  <br/> |<span data-ttu-id="46640-113">Nenhum</span><span class="sxs-lookup"><span data-stu-id="46640-113">None</span></span>  <br/> |
|<span data-ttu-id="46640-114">duas</span><span class="sxs-lookup"><span data-stu-id="46640-114">2</span></span>  <br/> |<span data-ttu-id="46640-115">Só pode ser acessado por formulários em execução no mesmo domínio que o formulário aberto atualmente ou por formulários que receberam permissões entre domínios.</span><span class="sxs-lookup"><span data-stu-id="46640-115">Can be accessed only by forms running in the same domain as the currently open form, or by forms that have been granted cross-domain permissions.</span></span>  <br/> |<span data-ttu-id="46640-116">Nenhum</span><span class="sxs-lookup"><span data-stu-id="46640-116">None</span></span>  <br/> |
|<span data-ttu-id="46640-117">3D</span><span class="sxs-lookup"><span data-stu-id="46640-117">3</span></span>  <br/> |<span data-ttu-id="46640-118">Só pode ser acessado por formulários totalmente confiáveis.</span><span class="sxs-lookup"><span data-stu-id="46640-118">Can be accessed only by fully trusted forms.</span></span>  <br/> |<span data-ttu-id="46640-119">FullTrust</span><span class="sxs-lookup"><span data-stu-id="46640-119">FullTrust</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="46640-120">O nível de segurança "1" não é usado pelo servidor COM do InfoPath atual e está reservado para uso futuro.</span><span class="sxs-lookup"><span data-stu-id="46640-120">The security level "1" is not used by the current InfoPath COM server and is reserved for future use.</span></span> 
  
> [!IMPORTANT]
> <span data-ttu-id="46640-121">Embora os níveis de modelo de objeto 0 e 2 não exijam qualquer conjunto de permissões, pois eles contêm código gerenciado, eles se comportam conforme definido para o nível de segurança de acesso ao domínio do domínio descrito na seção a seguir.</span><span class="sxs-lookup"><span data-stu-id="46640-121">Even though object model levels 0 and 2 do not demand any permission set, because they contain managed code, they behave as defined for the Domain domain access security level that is described in the following section.</span></span> 
  
<span data-ttu-id="46640-122">O nível de segurança de cada membro de modelo de objeto exposto pelos assemblies Microsoft. Office. InfoPath e Microsoft. Office. Interop. InfoPath. SemiTrust é especificado na seção comentários do tópico que documenta o [membro no Namespaces Microsoft. Office. InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) e [Microsoft. Office. Interop. InfoPath. SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) .</span><span class="sxs-lookup"><span data-stu-id="46640-122">The security level of each object model member exposed by the Microsoft.Office.InfoPath and Microsoft.Office.Interop.InfoPath.SemiTrust assemblies is specified in the Remarks section of the topic that documents that member in the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) and [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) namespaces.</span></span> 
  
## <a name="infopath-domain-access-security-levels"></a><span data-ttu-id="46640-123">Níveis de segurança de acesso ao domínio do InfoPath</span><span class="sxs-lookup"><span data-stu-id="46640-123">InfoPath Domain Access Security Levels</span></span>

<span data-ttu-id="46640-124">Em conjunto com os níveis de segurança do modelo de objeto que são impostos pelo servidor COM exposto pelo aplicativo InfoPath, o InfoPath define três níveis de segurança que são aplicados dependendo de onde o modelo de formulário está localizado, como o formulário é implantado e configurações definidas no modo de design.</span><span class="sxs-lookup"><span data-stu-id="46640-124">In conjunction with the object model security levels that are enforced by the COM server exposed by the InfoPath application, InfoPath defines three security levels that are applied depending on where the form template is located, how the form is deployed, and settings configured in design mode.</span></span> <span data-ttu-id="46640-125">Esses três níveis de segurança são definidos na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="46640-125">These three security levels are defined in the following table.</span></span>
  
|<span data-ttu-id="46640-126">**Nível de segurança de acesso ao domínio**</span><span class="sxs-lookup"><span data-stu-id="46640-126">**Domain Access Security Level**</span></span>|<span data-ttu-id="46640-127">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="46640-127">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="46640-128">Restrito</span><span class="sxs-lookup"><span data-stu-id="46640-128">Restricted</span></span>  <br/> |<span data-ttu-id="46640-129">Não permite qualquer comunicação fora do modelo de formulário.</span><span class="sxs-lookup"><span data-stu-id="46640-129">Does not permit any communication outside of the form template.</span></span> <span data-ttu-id="46640-130">Este nível de segurança destina-se a evitar que formulários prejudiciais transmitam dados do seu computador para um invasor mal-intencionado.</span><span class="sxs-lookup"><span data-stu-id="46640-130">This security level is intended to prevent harmful forms from transmitting any data from your computer to a malicious attacker.</span></span> <span data-ttu-id="46640-131">Ao executar nesse modo de segurança, os seguintes recursos não funcionarão: painel de tarefas personalizado, conexões de dados (exceto envio de email), controles ActiveX, código de formulário de código gerenciado, funções e fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="46640-131">When running in this security mode, the following features will not work: Custom Task Pane, Data Connections (except email submit), ActiveX controls, managed code form code, Roles, and Workflow.</span></span> <span data-ttu-id="46640-132">Modelos de formulário de código gerenciado não podem ser executados no domínio restrito.</span><span class="sxs-lookup"><span data-stu-id="46640-132">Managed code form templates cannot run in the Restricted domain.</span></span> <span data-ttu-id="46640-133">Quando um modelo de formulário de código gerenciado é definido como a configuração de **nível de segurança determinar automaticamente** na categoria **segurança e confiança** da caixa de diálogo **Opções de formulário** , o modelo de formulário sempre exigirá pelo menos o acesso de segurança do domínio nível para executar o código.</span><span class="sxs-lookup"><span data-stu-id="46640-133">When a managed code form template is set to the **Automatically determine security level** setting in the **Security and Trust** category of the **Form Options** dialog box, the form template will always require at least the Domain security access level to run code.</span></span>  <br/><br/><span data-ttu-id="46640-134">**Importante**: o assembly de código gerenciado criado para um modelo de formulário de código gerenciado não será carregado e executado quando um formulário for aberto a partir de um domínio restrito, por exemplo, de um formulário do InfoPath enviado como um anexo de email.</span><span class="sxs-lookup"><span data-stu-id="46640-134">**IMPORTANT**: The managed code assembly created for a managed code form template will not load and run when a form is opened from a Restricted domain, for example, from an InfoPath form sent as an email attachment.</span></span> <span data-ttu-id="46640-135">Qualquer modelo de formulário que você deseja implantar como um anexo de email deve omitir os recursos listados acima e, se o modelo de formulário contiver código de formulário, o código de formulário deverá ser implementado em JScript ou VBScript e só deve usar membros do modelo de objeto com um nível de segurança 0 (zero) .</span><span class="sxs-lookup"><span data-stu-id="46640-135">Any form template you wish to deploy as an email attachment must omit the features listed above, and if the form template contains form code, form code must be implemented in JScript or VBScript, and must only utilize object model members with a security level of 0 (zero).</span></span>           |
|<span data-ttu-id="46640-136">Domínio</span><span class="sxs-lookup"><span data-stu-id="46640-136">Domain</span></span>  <br/> |<span data-ttu-id="46640-137">Restringe um formulário com base em seu local em uma das zonas de segurança definidas pelo Microsoft Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="46640-137">Restricts a form based on its location in one of the security zones defined by Microsoft Internet Explorer.</span></span> <span data-ttu-id="46640-138">Por exemplo, se o formulário estiver localizado na zona Intranet local, ele terá permissão para se comunicar com outros dados dentro de seu próprio domínio, mas não será permitido recuperar dados de outros domínios.</span><span class="sxs-lookup"><span data-stu-id="46640-138">For example, if the form is located in the Local Intranet zone, it is allowed to communicate with other data inside its own domain but it is not permitted to retrieve data from other domains.</span></span> <span data-ttu-id="46640-139">O local em uma zona de segurança do Microsoft Internet Explorer também determina se os controles ActiveX marcados como não seguros para script poderão ser executados.</span><span class="sxs-lookup"><span data-stu-id="46640-139">The location in a Microsoft Internet Explorer security zone also determines whether ActiveX controls that are marked as unsafe for scripting will be allowed to run.</span></span>  <br/> |
|<span data-ttu-id="46640-140">Confiança Total</span><span class="sxs-lookup"><span data-stu-id="46640-140">Full Trust</span></span>  <br/> |<span data-ttu-id="46640-141">Permite que você execute um formulário com confiança total no computador em que o formulário será usado.</span><span class="sxs-lookup"><span data-stu-id="46640-141">Allows you to run a form with full trust on the computer where the form will be used.</span></span> <span data-ttu-id="46640-142">Este nível de segurança só pode ser usado ao trabalhar com um formulário assinado digitalmente com uma assinatura que corresponda a um fornecedor raiz confiável no seu computador ou criando um programa de instalação que instala o formulário e define o **requireFullTrust** atributo do elemento **xDocumentClass** como "Yes" no arquivo de definição de formulário (. xsf).</span><span class="sxs-lookup"><span data-stu-id="46640-142">This security level can only be used when working with a form that is digitally signed with a signature that matches a trusted root publisher on your computer, or by creating an installation program that installs the form and sets the **requireFullTrust** attribute of the **xDocumentClass** element to "yes" in the form definition file (.xsf).</span></span> <span data-ttu-id="46640-143">Usando essa configuração, seu formulário pode acessar as chamadas de modelo de objeto que exigem o nível de segurança do modelo de objeto 3, como propriedades e métodos que acessam o sistema de arquivos, e você pode desabilitar determinados prompts de segurança que aparecem ao executar em uma segurança mais restritiva antes.</span><span class="sxs-lookup"><span data-stu-id="46640-143">By using this setting, your form can access object model calls that require object model security level 3, such as properties and methods that access the file system, and you can disable certain security prompts that appear when running at a more restrictive security level.</span></span>  <br/> |
   
<span data-ttu-id="46640-144">Por padrão, um formulário do InfoPath é configurado para selecionar automaticamente o nível de segurança restrito ou de domínio, dependendo dos recursos que estão sendo usados no modelo de formulário e onde e como o modelo de formulário é implantado.</span><span class="sxs-lookup"><span data-stu-id="46640-144">By default, an InfoPath form is configured to select automatically either the Restricted or Domain security level depending on the features that are being used in the form template, and where and how the form template is deployed.</span></span> <span data-ttu-id="46640-145">Por exemplo, um modelo de formulário implantado como anexo de email é automaticamente configurado para o nível de segurança restrito.</span><span class="sxs-lookup"><span data-stu-id="46640-145">For example, a form template deployed as an email attachment is automatically configured to the Restricted security level.</span></span> <span data-ttu-id="46640-146">A configuração de segurança é sempre mais restritiva possível, começando em restritos, para garantir um nível maior de proteção para você e seus dados.</span><span class="sxs-lookup"><span data-stu-id="46640-146">The security setting is always as restrictive as possible, starting at Restricted, to ensure a greater level of protection for you and your data.</span></span> <span data-ttu-id="46640-147">Quando um modelo de formulário que contém o código gerenciado é definido para selecionar automaticamente o nível de segurança, o modelo de formulário sempre precisará pelo menos do nível de acesso de segurança do domínio antes que o código possa ser executado.</span><span class="sxs-lookup"><span data-stu-id="46640-147">When a form template that contains managed code is set to automatically select the security level, the form template will always require at least the Domain security access level before code can run.</span></span> <span data-ttu-id="46640-148">Você pode substituir manualmente essa configuração no tempo de design para selecionar um nível de segurança mais apropriado para o formulário usando o procedimento a seguir.</span><span class="sxs-lookup"><span data-stu-id="46640-148">You can manually override this setting at design time to select a level of security that is more appropriate for the form by using the following procedure.</span></span> 
  
### <a name="specify-a-forms-security-level"></a><span data-ttu-id="46640-149">Especificar o nível de segurança de um formulário</span><span class="sxs-lookup"><span data-stu-id="46640-149">Specify a form's security level</span></span>

1. <span data-ttu-id="46640-150">Abra o formulário no designer de formulários do InfoPath, clique na guia **arquivo** , em **informações**e em **Opções de formulário**.</span><span class="sxs-lookup"><span data-stu-id="46640-150">Open the form in the InfoPath form designer, click the **File** tab, click **Info**, and then click **Form Options**.</span></span>
    
2. <span data-ttu-id="46640-151">Na caixa de diálogo **Opções de Formulário**, clique na categoria **Segurança e Confiabilidade**.</span><span class="sxs-lookup"><span data-stu-id="46640-151">In the **Form Options** dialog box, click the **Security and Trust** category.</span></span> 
    
3. <span data-ttu-id="46640-152">DesMarque a caixa de seleção **determinar automaticamente o nível de segurança (recomendado)** .</span><span class="sxs-lookup"><span data-stu-id="46640-152">Clear the **Automatically determine security level (recommended)** check box.</span></span> 
    
4. <span data-ttu-id="46640-153">Escolha o nível de segurança desejado.</span><span class="sxs-lookup"><span data-stu-id="46640-153">Select the desired security level.</span></span>
    
> [!NOTE] 
> - <span data-ttu-id="46640-154">Se você selecionar o nível de segurança **restrito** para um modelo de formulário de código gerenciado, o código por trás do formulário não será carregado e executado independentemente de quais membros de modelo de objeto são usados no código de formulário.</span><span class="sxs-lookup"><span data-stu-id="46640-154">If you the select the **Restricted** security level for a managed code form template, the code behind the form will not load and run regardless of which object model members are used in the form code.</span></span> <span data-ttu-id="46640-155">Este nível de segurança é projetado principalmente para formulários do InfoPath que são implantados usando email.</span><span class="sxs-lookup"><span data-stu-id="46640-155">This security level is primarily designed for InfoPath forms that are deployed using email.</span></span>     
> - <span data-ttu-id="46640-156">Se você selecionar o nível de segurança de **confiança total** , deverá assinar ou instalar digitalmente e registrar o formulário.</span><span class="sxs-lookup"><span data-stu-id="46640-156">If you select the **Full Trust** security level, you need to digitally sign or install and register the form.</span></span> <span data-ttu-id="46640-157">Para obter mais informações, consulte [implantar modelos de formulário do InfoPath com código](how-to-deploy-infopath-form-templates-with-code.md).</span><span class="sxs-lookup"><span data-stu-id="46640-157">For more information, see [Deploy InfoPath Form Templates with Code](how-to-deploy-infopath-form-templates-with-code.md).</span></span>
    
<span data-ttu-id="46640-158">A tabela a seguir resume o modelo de segurança do InfoPath.</span><span class="sxs-lookup"><span data-stu-id="46640-158">The following table summarizes the InfoPath security model.</span></span> <span data-ttu-id="46640-159">A primeira coluna lista o nível especificado para ou exigido pelo formulário.</span><span class="sxs-lookup"><span data-stu-id="46640-159">The first column lists the level specified for or required by the form.</span></span> <span data-ttu-id="46640-160">A segunda e a terceira colunas especificam se o formulário tem um identificador URN ou de URL para seu local.</span><span class="sxs-lookup"><span data-stu-id="46640-160">The second and third columns specify whether the form has a URN or URL identifier for its location.</span></span> <span data-ttu-id="46640-161">As colunas restantes especificam o que pode ser executado.</span><span class="sxs-lookup"><span data-stu-id="46640-161">The remaining columns specify what is allowed to run.</span></span> <span data-ttu-id="46640-162">Para obter mais informações sobre cenários de implantação e conjuntos de permissões para modelos de formulário de código gerenciado, consulte a seção "recursos de segurança de acesso ao código do Common Language Runtime", mais adiante neste tópico.</span><span class="sxs-lookup"><span data-stu-id="46640-162">For more information on deployment scenarios and permission sets for managed code form templates, see the "Common Language Runtime Code Access Security Features" section later in this topic.</span></span>
  
|<span data-ttu-id="46640-163">**Nível exigido pelo formulário**</span><span class="sxs-lookup"><span data-stu-id="46640-163">**Level Required by form**</span></span>|<span data-ttu-id="46640-164">**Tem identificador de URN**</span><span class="sxs-lookup"><span data-stu-id="46640-164">**Has URN Identifier**</span></span>|<span data-ttu-id="46640-165">**Tem um identificador de URL**</span><span class="sxs-lookup"><span data-stu-id="46640-165">**Has URL Identifier**</span></span>|<span data-ttu-id="46640-166">**ActiveX marcado como não seguro para scripts**</span><span class="sxs-lookup"><span data-stu-id="46640-166">**ActiveX marked unsafe for scripting**</span></span>|<span data-ttu-id="46640-167">**Acesso entre domínios**</span><span class="sxs-lookup"><span data-stu-id="46640-167">**Cross-Domain Access**</span></span>|<span data-ttu-id="46640-168">**Código gerenciado**</span><span class="sxs-lookup"><span data-stu-id="46640-168">**Managed code**</span></span>|<span data-ttu-id="46640-169">**Segurança do modelo de objeto**</span><span class="sxs-lookup"><span data-stu-id="46640-169">**Object Model Security**</span></span>|
|:-----|:-----|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="46640-170">Restrito</span><span class="sxs-lookup"><span data-stu-id="46640-170">Restricted</span></span>  <br/> ||<span data-ttu-id="46640-171">X</span><span class="sxs-lookup"><span data-stu-id="46640-171">X</span></span>  <br/> |<span data-ttu-id="46640-172">Nenhum ActiveX é</span><span class="sxs-lookup"><span data-stu-id="46640-172">No ActiveX at all</span></span>  <br/> |<span data-ttu-id="46640-173">Malsucedida</span><span class="sxs-lookup"><span data-stu-id="46640-173">Fail</span></span>  <br/> |<span data-ttu-id="46640-174">O formulário é carregado, mas o código gerenciado não é executado</span><span class="sxs-lookup"><span data-stu-id="46640-174">Form loads, but managed code won't run</span></span>  <br/> |<span data-ttu-id="46640-175">,0</span><span class="sxs-lookup"><span data-stu-id="46640-175">0</span></span>  <br/> |
|<span data-ttu-id="46640-176">Domínio (zona de **sites restritos** do Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="46640-176">Domain (Internet Explorer **Restricted sites** zone)</span></span>  <br/> |<span data-ttu-id="46640-177">Não será executado de qualquer</span><span class="sxs-lookup"><span data-stu-id="46640-177">Won't run at all</span></span>  <br/> |<span data-ttu-id="46640-178">Não será executado de qualquer</span><span class="sxs-lookup"><span data-stu-id="46640-178">Won't run at all</span></span>  <br/> |<span data-ttu-id="46640-179">Não será executado de qualquer</span><span class="sxs-lookup"><span data-stu-id="46640-179">Won't run at all</span></span>  <br/> |<span data-ttu-id="46640-180">Não será executado de qualquer</span><span class="sxs-lookup"><span data-stu-id="46640-180">Won't run at all</span></span>  <br/> |<span data-ttu-id="46640-181">Não será executado de qualquer</span><span class="sxs-lookup"><span data-stu-id="46640-181">Won't run at all</span></span>  <br/> |<span data-ttu-id="46640-182">Não será executado de qualquer</span><span class="sxs-lookup"><span data-stu-id="46640-182">Won't run at all</span></span>  <br/> |
|<span data-ttu-id="46640-183">Domínio (zona **Internet** do Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="46640-183">Domain (Internet Explorer **Internet** zone)</span></span>  <br/> |<span data-ttu-id="46640-184">X</span><span class="sxs-lookup"><span data-stu-id="46640-184">X</span></span>  <br/> ||<span data-ttu-id="46640-185">Malsucedida</span><span class="sxs-lookup"><span data-stu-id="46640-185">Fail</span></span>  <br/> |<span data-ttu-id="46640-186">Malsucedida</span><span class="sxs-lookup"><span data-stu-id="46640-186">Fail</span></span>  <br/> |<span data-ttu-id="46640-187">Não será executado de qualquer</span><span class="sxs-lookup"><span data-stu-id="46640-187">Won't run at all</span></span>  <br/> |<span data-ttu-id="46640-188">,0</span><span class="sxs-lookup"><span data-stu-id="46640-188">0</span></span>  <br/> |
|<span data-ttu-id="46640-189">Domínio (zona **intranet local** do Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="46640-189">Domain (Internet Explorer **Local intranet** zone)</span></span>  <br/> |<span data-ttu-id="46640-190">X</span><span class="sxs-lookup"><span data-stu-id="46640-190">X</span></span>  <br/> ||<span data-ttu-id="46640-191">Malsucedida</span><span class="sxs-lookup"><span data-stu-id="46640-191">Fail</span></span>  <br/> |<span data-ttu-id="46640-192">Prompt</span><span class="sxs-lookup"><span data-stu-id="46640-192">Prompt</span></span>  <br/> |<span data-ttu-id="46640-193">O código gerenciado é executado com permissões de **intranet local** .</span><span class="sxs-lookup"><span data-stu-id="46640-193">Managed code runs with **Local intranet** permissions.</span></span>  <br/> |<span data-ttu-id="46640-194">duas</span><span class="sxs-lookup"><span data-stu-id="46640-194">2</span></span>  <br/> |
|<span data-ttu-id="46640-195">Domínio (zona de **sites confiáveis** do Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="46640-195">Domain (Internet Explorer **Trusted sites** zone)</span></span>  <br/> |<span data-ttu-id="46640-196">X</span><span class="sxs-lookup"><span data-stu-id="46640-196">X</span></span>  <br/> ||<span data-ttu-id="46640-197">Prompt</span><span class="sxs-lookup"><span data-stu-id="46640-197">Prompt</span></span>  <br/> |<span data-ttu-id="46640-198">OK</span><span class="sxs-lookup"><span data-stu-id="46640-198">OK</span></span>  <br/> |<span data-ttu-id="46640-199">O código gerenciado é executado com permissões de **Internet** .</span><span class="sxs-lookup"><span data-stu-id="46640-199">Managed code runs with **Internet** permissions.</span></span> <span data-ttu-id="46640-200">É permitido o acesso entre domínios.</span><span class="sxs-lookup"><span data-stu-id="46640-200">Cross-domain access is allowed.</span></span> <span data-ttu-id="46640-201">Observe que, embora o formulário esteja na zona **sites confiáveis** , as permissões de zona da **Internet** são aplicadas.</span><span class="sxs-lookup"><span data-stu-id="46640-201">Note that even though the form is in the **Trusted sites** zone, **Internet** zone permissions are applied.</span></span>  <br/> |<span data-ttu-id="46640-202">duas</span><span class="sxs-lookup"><span data-stu-id="46640-202">2</span></span>  <br/> |
|<span data-ttu-id="46640-203">Domínio (zona de **computador local** do Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="46640-203">Domain (Internet Explorer **Local computer** zone)</span></span>  <br/> |<span data-ttu-id="46640-204">X</span><span class="sxs-lookup"><span data-stu-id="46640-204">X</span></span>  <br/> |<span data-ttu-id="46640-205">X</span><span class="sxs-lookup"><span data-stu-id="46640-205">X</span></span>  <br/> |<span data-ttu-id="46640-206">Prompt</span><span class="sxs-lookup"><span data-stu-id="46640-206">Prompt</span></span>  <br/> |<span data-ttu-id="46640-207">Malsucedida</span><span class="sxs-lookup"><span data-stu-id="46640-207">Fail</span></span>  <br/> |<span data-ttu-id="46640-208">O código gerenciado é executado com permissões de **intranet local** .</span><span class="sxs-lookup"><span data-stu-id="46640-208">Managed code runs with **Local intranet** permissions.</span></span>  <br/> |<span data-ttu-id="46640-209">duas</span><span class="sxs-lookup"><span data-stu-id="46640-209">2</span></span>  <br/> |
|<span data-ttu-id="46640-210">Confiança Total</span><span class="sxs-lookup"><span data-stu-id="46640-210">Full Trust</span></span>  <br/> |<span data-ttu-id="46640-211">X</span><span class="sxs-lookup"><span data-stu-id="46640-211">X</span></span>  <br/> |<span data-ttu-id="46640-212">X</span><span class="sxs-lookup"><span data-stu-id="46640-212">X</span></span>  <br/> |<span data-ttu-id="46640-213">OK</span><span class="sxs-lookup"><span data-stu-id="46640-213">OK</span></span>  <br/> |<span data-ttu-id="46640-214">OK</span><span class="sxs-lookup"><span data-stu-id="46640-214">OK</span></span>  <br/> |<span data-ttu-id="46640-215">Confiança Total</span><span class="sxs-lookup"><span data-stu-id="46640-215">Full Trust</span></span>  <br/> |<span data-ttu-id="46640-216">3D</span><span class="sxs-lookup"><span data-stu-id="46640-216">3</span></span>  <br/> |
   
> [!IMPORTANT]
> <span data-ttu-id="46640-217">As descrições acima nas colunas "o ActiveX marcou não é seguro para script" e "acesso entre domínios" pressupõem as configurações de segurança padrão para o Microsoft Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="46640-217">The descriptions above in the "ActiveX marked unsafe for scripting" and "Cross-Domain Access" columns assume the default security settings for Microsoft Internet Explorer.</span></span> <span data-ttu-id="46640-218">Se um usuário alterar suas configurações de segurança, o InfoPath se comportará de acordo.</span><span class="sxs-lookup"><span data-stu-id="46640-218">If a user changes their security settings, InfoPath will behave accordingly.</span></span> <span data-ttu-id="46640-219">Por exemplo, se na zona **intranet local** , **acessar fontes de dados entre domínios** está definido como **habilitar**, os usuários não serão solicitados a permitir o acesso entre domínios, conforme descrito na tabela.</span><span class="sxs-lookup"><span data-stu-id="46640-219">For example, if in the **Local intranet** zone, **Access data sources across domains** is set to **Enable**, then users will not be prompted to allow cross-domain access as described in the table.</span></span> 
  
## <a name="common-language-runtime-code-access-security-features"></a><span data-ttu-id="46640-220">Recursos de segurança de acesso a código do Common Language Runtime</span><span class="sxs-lookup"><span data-stu-id="46640-220">Common Language Runtime Code Access Security Features</span></span>

<span data-ttu-id="46640-221">Quando um modelo de formulário de código gerenciado do InfoPath é compilado, um assembly de código gerenciado privado é criado, contendo a implementação da lógica de código de formulário.</span><span class="sxs-lookup"><span data-stu-id="46640-221">When an InfoPath managed code form template is compiled, a private managed code assembly is created that contains the implementation of the form code logic.</span></span>
  
<span data-ttu-id="46640-222">No .NET Framework, por padrão, um assembly de código gerenciado tem permissões de confiança total ao executar na máquina local e não recebe permissões de confiança total ao executar na intranet.</span><span class="sxs-lookup"><span data-stu-id="46640-222">In the .NET Framework, by default, a managed code assembly has Full Trust permissions when running on the local machine, and is not granted Full Trust permissions when running on the Intranet.</span></span> <span data-ttu-id="46640-223">Para fornecer controle mais refinado sobre a política de segurança e para fornecer a opção de executar modelos de formulário de código gerenciado do InfoPath como formulários totalmente confiáveis da intranet, o InfoPath implementa a seguinte arquitetura de segurança.</span><span class="sxs-lookup"><span data-stu-id="46640-223">To provide more fine-grained control over security policy, and to provide the option to run InfoPath managed code form templates as fully trusted forms from the Intranet, InfoPath implements the following security architecture.</span></span>
  
- <span data-ttu-id="46640-224">O aplicativo InfoPath hospeda o CLR (Common Language Runtime) do .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="46640-224">The InfoPath application hosts the .NET Framework common language runtime (CLR).</span></span>
    
- <span data-ttu-id="46640-225">Dentro do CLR hospedado pelo InfoPath, cada modelo de formulário de código gerenciado é executado em um domínio de aplicativo separado, que é um ambiente que fornece isolamento, descarregamento e limites de segurança para executar código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="46640-225">Within the CLR hosted by InfoPath, each managed code form template runs in a separate application domain, which is an environment that provides isolation, unloading, and security boundaries for executing managed code.</span></span>
    
- <span data-ttu-id="46640-226">O InfoPath define uma política de segurança padrão no domínio do aplicativo, dependendo do nível de confiança associado ao modelo de formulário e a URL de sua localização.</span><span class="sxs-lookup"><span data-stu-id="46640-226">InfoPath sets a default security policy on the application domain depending on the level of trust associated with the form template and the URL of its location.</span></span>
    
- <span data-ttu-id="46640-227">Por padrão, um modelo de formulário de código gerenciado em execução no computador local (o grupo de códigos de zona meu computador) Obtém um nível mais baixo de permissões do que confiança total (permissões de zona da intranet local).</span><span class="sxs-lookup"><span data-stu-id="46640-227">By default, a managed code form template running on the local computer (the My Computer Zone code group) gets a lower level of permissions than Full Trust (Local Intranet Zone permissions).</span></span> <span data-ttu-id="46640-228">Para ter permissões de confiança total, o formulário deve ser registrado ou assinado digitalmente com um certificado confiável.</span><span class="sxs-lookup"><span data-stu-id="46640-228">To have Full Trust permissions, the form must be registered or digitally signed with a trusted certificate.</span></span>
    
<span data-ttu-id="46640-229">A política de segurança padrão definida para o domínio de aplicativo de um modelo de formulário de código gerenciado garante que os níveis de segurança do acesso ao domínio do InfoPath, bem como quaisquer restrições de segurança adicionais do .NET, sejam aplicados.</span><span class="sxs-lookup"><span data-stu-id="46640-229">The default security policy set for the application domain of a managed code form template ensures that the InfoPath domain access security levels as well as any additional .NET security restrictions are enforced.</span></span> <span data-ttu-id="46640-230">Para fornecer flexibilidade adicional, o sistema de segurança do InfoPath reconhece um grupo de códigos de segurança do acesso ao código .NET chamado "modelos de formulário do InfoPath".</span><span class="sxs-lookup"><span data-stu-id="46640-230">To provide additional flexibility, the InfoPath security system recognizes a .NET code access security code group named "InfoPath Form Templates".</span></span> <span data-ttu-id="46640-231">Se esse grupo de códigos estiver presente no computador de um usuário, sua configuração de segurança e os de qualquer grupo de códigos filho dentro dele serão aplicados ao domínio do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="46640-231">If this code group is present on a user's computer, its security configuration, and those of any child code groups within it will be applied to the application domain.</span></span>
  
> [!IMPORTANT] 
> - <span data-ttu-id="46640-232">O grupo de códigos de modelos de formulário do InfoPath aplica-se somente ao assembly de código de formulário de código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="46640-232">The InfoPath Form Templates code group applies only to the managed code form code assembly itself.</span></span> <span data-ttu-id="46640-233">Como resultado, se você conceder o conjunto de permissões de confiança total ao código de formulário de código gerenciado do InfoPath, mas não tiver instalado e registrado (ou assinado digitalmente) o próprio modelo de formulário (que torna todo o modelo de formulário totalmente confiável), as chamadas no código de formulário para segurança os membros do modelo de objeto Level 3 ainda falharão.</span><span class="sxs-lookup"><span data-stu-id="46640-233">As a result, if you grant the Full Trust permission set to InfoPath managed code form code, but you have not installed and registered (or digitally signed) the form template itself (which makes the entire form template fully trusted), calls in the form code to security level 3 object model members will still fail.</span></span>   
> - <span data-ttu-id="46640-234">Se você referenciar ou carregar explicitamente (assembly. Load) um assembly que é configurado com um conjunto de permissões restritos usando hash, nome forte ou evidência do Publisher para determinar sua condição de associação em um projeto de modelo de formulário, o assembly mesmo assim será carregado e executado pelo modelo de formulário.</span><span class="sxs-lookup"><span data-stu-id="46640-234">If you reference or explicitly load (Assembly.Load) an assembly that is configured with a restricted permission set using Hash, Strong Name, or Publisher evidence to determine its membership condition in a form template project, the assembly will nonetheless be loaded and executed by the form template.</span></span>
    
<span data-ttu-id="46640-235">Para obter informações sobre como criar e configurar o grupo de códigos de modelos de formulário do InfoPath, consulte [definir configurações de segurança para modelos de formulário com código](how-to-configure-security-settings-for-form-templates-with-code.md).</span><span class="sxs-lookup"><span data-stu-id="46640-235">For information on how to create and configure the InfoPath Form Templates code group, see [Configure Security Settings for Form Templates with Code](how-to-configure-security-settings-for-form-templates-with-code.md).</span></span>
  
<span data-ttu-id="46640-236">A tabela a seguir resume os cenários de implantação e os conjuntos de permissões que se aplicam a modelos de formulário de código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="46640-236">The following table summarizes the deployment scenarios and permission sets that apply to managed code form templates.</span></span>
  
|<span data-ttu-id="46640-237">**Cenário de implantação**</span><span class="sxs-lookup"><span data-stu-id="46640-237">**Deployment Scenario**</span></span>|<span data-ttu-id="46640-238">**Conjunto de permissões**</span><span class="sxs-lookup"><span data-stu-id="46640-238">**Permission Set**</span></span>|<span data-ttu-id="46640-239">**Anotações**</span><span class="sxs-lookup"><span data-stu-id="46640-239">**Notes**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="46640-240">O modelo de formulário é publicado no computador local e o desenvolvedor está usando o Visual Studio para escrever e depurar o código de formulário.</span><span class="sxs-lookup"><span data-stu-id="46640-240">The form template is published on the local computer, and the developer is using Visual Studio to write and debug form code.</span></span>  <br/> |<span data-ttu-id="46640-241">Conjunto de permissões de intranet local.</span><span class="sxs-lookup"><span data-stu-id="46640-241">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="46640-242">Assemblies instalados no cache de assembly global (GAC) e marcados com o atributo **AllowPartiallyTrustedCallersAttribute** recebem o conjunto de permissões de confiança total.</span><span class="sxs-lookup"><span data-stu-id="46640-242">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set.</span></span>  <br/> |<span data-ttu-id="46640-243">Por padrão, os modelos de formulário em execução no computador local não recebem o conjunto de permissões de confiança total.</span><span class="sxs-lookup"><span data-stu-id="46640-243">By default, form templates running from the local computer are not granted the Full Trust permission set.</span></span> <span data-ttu-id="46640-244">Ao desenvolver modelos de formulário que usam recursos e chamadas para membros do modelo de objeto que exigem permissões de confiança total, você pode usar o procedimento descrito nos [modelos de formulário Visualizar e depurar que exigem confiança total](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span><span class="sxs-lookup"><span data-stu-id="46640-244">While developing form templates that use features and calls to object model members that require Full Trust permissions, you can use the procedure described in [Preview and Debug Form Templates that Require Full Trust](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span></span>  <br/> |
|<span data-ttu-id="46640-245">O modelo de formulário é publicado no computador local e faz referência a um assembly personalizado que solicita o conjunto de permissões de confiança total no computador local.</span><span class="sxs-lookup"><span data-stu-id="46640-245">The form template is published on the local computer and references a custom assembly that requests the Full Trust permission set on the local computer.</span></span>  <br/> |<span data-ttu-id="46640-246">Conjunto de permissões de intranet local.</span><span class="sxs-lookup"><span data-stu-id="46640-246">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="46640-247">Assemblies instalados no cache de assembly global (GAC) e marcados com o atributo **AllowPartiallyTrustedCallersAttribute** recebem o conjunto de permissões de confiança total.</span><span class="sxs-lookup"><span data-stu-id="46640-247">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set.</span></span> <span data-ttu-id="46640-248">O conjunto de permissões de intranet local é concedido ao assembly personalizado.</span><span class="sxs-lookup"><span data-stu-id="46640-248">The custom assembly is granted the Local Intranet permission set.</span></span>  <br/> |<span data-ttu-id="46640-249">Para fazer referência a assemblies externos para uso no código do modelo de formulário, o desenvolvedor deve usar o grupo de códigos modelos de formulário do InfoPath para conceder confiança total (ou o conjunto de permissões apropriado) ao assembly externo referenciado no código do modelo de formulário.</span><span class="sxs-lookup"><span data-stu-id="46640-249">To reference external assemblies for use in the form template's code, the developer must use the InfoPath Form Templates code group to grant Full Trust (or the appropriate permission set) to the external assembly referenced in the form template's code.</span></span> <span data-ttu-id="46640-250">O InfoPath não faz suposições sobre assemblies externos diferentes daqueles instalados no cache de assembly global (GAC).</span><span class="sxs-lookup"><span data-stu-id="46640-250">InfoPath does not make any assumptions about external assemblies other than those installed in the Global Assembly Cache (GAC).</span></span> <span data-ttu-id="46640-251">O desenvolvedor deve conceder explicitamente ao assembly as permissões necessárias usando o grupo de código modelos de formulário do InfoPath, mesmo que o assembly já seja confiável, embora permissões concedidas no grupo de códigos My_Computer_Zone.</span><span class="sxs-lookup"><span data-stu-id="46640-251">The developer must explicitly grant the assembly the necessary permissions using the InfoPath Form Templates code group even if the assembly is already trusted though permissions granted in the My_Computer_Zone code group.</span></span>  <br/> |
|<span data-ttu-id="46640-252">O modelo de formulário é publicado em um local compartilhado na intranet local, como um compartilhamento de arquivos, uma biblioteca de formulários do SharePoint ou um servidor Web.</span><span class="sxs-lookup"><span data-stu-id="46640-252">The form template is published on a shared location in the local intranet, such as a file share, SharePoint Form library, or a Web server.</span></span>  <br/> |<span data-ttu-id="46640-253">Conjunto de permissões de intranet local.</span><span class="sxs-lookup"><span data-stu-id="46640-253">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="46640-254">Assemblies instalados no cache de assembly global (GAC) e marcados com o atributo **AllowPartiallyTrustedCallersAttribute** recebem o conjunto de permissões de confiança total.</span><span class="sxs-lookup"><span data-stu-id="46640-254">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set.</span></span>  <br/> ||
|<span data-ttu-id="46640-255">O modelo de formulário é publicado em um local compartilhado na intranet local, como um compartilhamento de arquivos, uma biblioteca de formulários do SharePoint ou um servidor Web designado como um site confiável no Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="46640-255">The form template is published on a shared location in the local intranet, such as a file share, SharePoint Form library, or a Web server that is designated as a Trusted site in Internet Explorer.</span></span>  <br/> |<span data-ttu-id="46640-256">Conjunto de permissões de Internet.</span><span class="sxs-lookup"><span data-stu-id="46640-256">Internet permission set.</span></span>  <br/> <span data-ttu-id="46640-257">Assemblies assinados pela Microsoft e pela ECMA recebem o conjunto de permissões de confiança total.</span><span class="sxs-lookup"><span data-stu-id="46640-257">Assemblies signed by Microsoft and ECMA are granted the Full Trust permission set.</span></span>  <br/> |<span data-ttu-id="46640-258">A segurança do acesso ao código CLR concede apenas o conjunto de permissões da Internet aos sites designados como sites confiáveis no Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="46640-258">CLR code access security grants only the Internet permission set to sites that are designated as Trusted sites in Internet Explorer.</span></span> <span data-ttu-id="46640-259">O InfoPath respeita essa política.</span><span class="sxs-lookup"><span data-stu-id="46640-259">InfoPath respects this policy.</span></span> <span data-ttu-id="46640-260">Observe que isso é diferente de um modelo de formulário do InfoPath que usa script para o código de formulário, que recebe um nível mais alto de permissões quando é publicado em uma zona de sites confiáveis.</span><span class="sxs-lookup"><span data-stu-id="46640-260">Note that this is unlike an InfoPath form template that uses script for form code, which receives a higher level of permissions when published in a Trusted sites zone.</span></span>  <br/> |
|<span data-ttu-id="46640-261">O modelo de formulário é baixado ou copiado de um local da Internet.</span><span class="sxs-lookup"><span data-stu-id="46640-261">The form template is downloaded or copied from an Internet location.</span></span>  <br/> |<span data-ttu-id="46640-262">Por padrão, nenhum.</span><span class="sxs-lookup"><span data-stu-id="46640-262">By default, none.</span></span> <span data-ttu-id="46640-263">O assembly de código gerenciado para o modelo de formulário não é carregado e não é executado.</span><span class="sxs-lookup"><span data-stu-id="46640-263">The managed code assembly for the form template is not loaded and does not run.</span></span>  <br/> ||
   
## <a name="see-also"></a><span data-ttu-id="46640-264">Confira também</span><span class="sxs-lookup"><span data-stu-id="46640-264">See also</span></span>

- [<span data-ttu-id="46640-265">Definir configurações de segurança para modelos de formulário com código</span><span class="sxs-lookup"><span data-stu-id="46640-265">Configure Security Settings for Form Templates with Code</span></span>](how-to-configure-security-settings-for-form-templates-with-code.md)
- [<span data-ttu-id="46640-266">Visualizar e depurar modelos de formulário que exigem confiança total</span><span class="sxs-lookup"><span data-stu-id="46640-266">Preview and Debug Form Templates that Require Full Trust</span></span>](how-to-preview-and-debug-form-templates-that-require-full-trust.md)

