---
title: Sobre o modelo de segurança para modelos de formulário com código
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- infopath 2007, segurança, segurança de acesso ao código [InfoPath 2007], segurança [InfoPath 2007], modelo de segurança para código gerenciado, segurança [InfoPath 2007], níveis,CAS [InfoPath 2007],modelos de formulário compatíveis com o InfoPath 2003, segurança, permissões [InfoPath 2007]
localization_priority: Normal
ms.assetid: 5e1c1c72-f98d-4871-9c57-82c315277aa1
description: Os modelos de formulário de código gerenciado do InfoPath suportam os mesmos níveis de segurança que o script executado em modelos de formulário não gerenciados e também suportam recursos adicionais de segurança de acesso a código que se aplicam ao código gerenciado em execução no CLR (Common Language Runtime) do .NET Framework.
ms.openlocfilehash: 97f0239a5bd6699b539ddaebf4d1d2ed7d1394db
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/28/2019
ms.locfileid: "33436143"
---
# <a name="about-the-security-model-for-form-templates-with-code"></a><span data-ttu-id="6d321-104">Sobre o modelo de segurança para modelos de formulário com código</span><span class="sxs-lookup"><span data-stu-id="6d321-104">About the Security Model for Form Templates with Code</span></span>

<span data-ttu-id="6d321-105">Os modelos de formulário de código gerenciado do InfoPath suportam os mesmos níveis de segurança que o script executado em modelos de formulário não gerenciados e também suportam recursos adicionais de segurança de acesso a código que se aplicam ao código gerenciado em execução no CLR (Common Language Runtime) do .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="6d321-105">InfoPath managed code form templates support the same security levels as script running in unmanaged form templates, and they also support additional code access security features that apply to managed code running under the common language runtime (CLR) of the .NET Framework.</span></span>
  
## <a name="infopath-managed-object-model-security-levels"></a><span data-ttu-id="6d321-106">Níveis de segurança do modelo de objeto gerenciado do InfoPath</span><span class="sxs-lookup"><span data-stu-id="6d321-106">InfoPath Managed Object Model Security Levels</span></span>

<span data-ttu-id="6d321-107">A tabela a seguir descreve a relação entre os níveis de segurança para membros do modelo de objeto de script e o conjunto de permissões correspondente que é exigido para cada nível quando o membro do modelo de objeto é usado em um modelo de formulário de código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="6d321-107">The following table describes the relationship between the security levels for script object model members and the corresponding permission set that is demanded for each level when the object model member is used in a managed code form template.</span></span>
  
|<span data-ttu-id="6d321-108">**Nível de segurança do modelo de objeto**</span><span class="sxs-lookup"><span data-stu-id="6d321-108">**Object Model Security Level**</span></span>|<span data-ttu-id="6d321-109">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="6d321-109">**Description**</span></span>|<span data-ttu-id="6d321-110">**Conjunto de Permissões Exigido**</span><span class="sxs-lookup"><span data-stu-id="6d321-110">**Permission Set Demanded**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="6d321-111">0</span><span class="sxs-lookup"><span data-stu-id="6d321-111">0</span></span>  <br/> |<span data-ttu-id="6d321-112">Pode ser acessado sem restrições.</span><span class="sxs-lookup"><span data-stu-id="6d321-112">Can be accessed without restrictions.</span></span>  <br/> |<span data-ttu-id="6d321-113">Nenhum</span><span class="sxs-lookup"><span data-stu-id="6d321-113">None</span></span>  <br/> |
|<span data-ttu-id="6d321-114">2 </span><span class="sxs-lookup"><span data-stu-id="6d321-114">2</span></span>  <br/> |<span data-ttu-id="6d321-115">Pode ser acessado somente por formulários em execução no mesmo domínio que o formulário aberto no momento ou por formulários que foram concedidos com permissões entre domínios.</span><span class="sxs-lookup"><span data-stu-id="6d321-115">Can be accessed only by forms running in the same domain as the currently open form, or by forms that have been granted cross-domain permissions.</span></span>  <br/> |<span data-ttu-id="6d321-116">Nenhum</span><span class="sxs-lookup"><span data-stu-id="6d321-116">None</span></span>  <br/> |
|<span data-ttu-id="6d321-117">3 </span><span class="sxs-lookup"><span data-stu-id="6d321-117">3</span></span>  <br/> |<span data-ttu-id="6d321-118">Pode ser acessado somente por formulários totalmente confiáveis.</span><span class="sxs-lookup"><span data-stu-id="6d321-118">Can be accessed only by fully trusted forms.</span></span>  <br/> |<span data-ttu-id="6d321-119">FullTrust</span><span class="sxs-lookup"><span data-stu-id="6d321-119">FullTrust</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="6d321-120">O nível de segurança "1" não é usado pelo servidor COM atual do InfoPath e é reservado para uso futuro.</span><span class="sxs-lookup"><span data-stu-id="6d321-120">The security level "1" is not used by the current InfoPath COM server and is reserved for future use.</span></span> 
  
> [!IMPORTANT]
> <span data-ttu-id="6d321-121">Embora os níveis 0 e 2 do modelo de objeto não exijam nenhum conjunto de permissões, pois contêm código gerenciado, eles se comportam como definidos para o nível de segurança de acesso de domínio do domínio descrito na seção a seguir.</span><span class="sxs-lookup"><span data-stu-id="6d321-121">Even though object model levels 0 and 2 do not demand any permission set, because they contain managed code, they behave as defined for the Domain domain access security level that is described in the following section.</span></span> 
  
<span data-ttu-id="6d321-122">O nível de segurança de cada membro do modelo de objeto exposto pelos assemblies Microsoft.Office.InfoPath e Microsoft.Office.Interop.InfoPath.SemiTrust é especificado na seção Comentários do tópico que documenta esse membro nos namespaces [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) e [Microsoft.Office.Interop.InfoPath.SemiTrust.](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx)</span><span class="sxs-lookup"><span data-stu-id="6d321-122">The security level of each object model member exposed by the Microsoft.Office.InfoPath and Microsoft.Office.Interop.InfoPath.SemiTrust assemblies is specified in the Remarks section of the topic that documents that member in the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) and [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) namespaces.</span></span> 
  
## <a name="infopath-domain-access-security-levels"></a><span data-ttu-id="6d321-123">Níveis de segurança de acesso de domínio do InfoPath</span><span class="sxs-lookup"><span data-stu-id="6d321-123">InfoPath Domain Access Security Levels</span></span>

<span data-ttu-id="6d321-124">Em conjunto com os níveis de segurança do modelo de objeto imposto pelo servidor COM exposto pelo aplicativo InfoPath, o InfoPath define três níveis de segurança que são aplicados dependendo de onde o modelo de formulário está localizado, como o formulário é implantado e configurações definidas no modo de design.</span><span class="sxs-lookup"><span data-stu-id="6d321-124">In conjunction with the object model security levels that are enforced by the COM server exposed by the InfoPath application, InfoPath defines three security levels that are applied depending on where the form template is located, how the form is deployed, and settings configured in design mode.</span></span> <span data-ttu-id="6d321-125">Esses três níveis de segurança são definidos na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="6d321-125">These three security levels are defined in the following table.</span></span>
  
|<span data-ttu-id="6d321-126">**Nível de segurança de acesso de domínio**</span><span class="sxs-lookup"><span data-stu-id="6d321-126">**Domain Access Security Level**</span></span>|<span data-ttu-id="6d321-127">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="6d321-127">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="6d321-128">Restrito</span><span class="sxs-lookup"><span data-stu-id="6d321-128">Restricted</span></span>  <br/> |<span data-ttu-id="6d321-129">Não permite nenhuma comunicação fora do modelo de formulário.</span><span class="sxs-lookup"><span data-stu-id="6d321-129">Does not permit any communication outside of the form template.</span></span> <span data-ttu-id="6d321-130">Este nível de segurança destina-se a evitar que formulários prejudiciais transmitam dados do seu computador para um invasor mal-intencionado.</span><span class="sxs-lookup"><span data-stu-id="6d321-130">This security level is intended to prevent harmful forms from transmitting any data from your computer to a malicious attacker.</span></span> <span data-ttu-id="6d321-131">Ao executar nesse modo de segurança, os seguintes recursos não funcionarão: Painel de Tarefas Personalizado, Conexões de Dados (exceto envio de email), controles ActiveX, código de formulário de código gerenciado, Funções e Fluxo de Trabalho.</span><span class="sxs-lookup"><span data-stu-id="6d321-131">When running in this security mode, the following features will not work: Custom Task Pane, Data Connections (except email submit), ActiveX controls, managed code form code, Roles, and Workflow.</span></span> <span data-ttu-id="6d321-132">Os modelos de formulário de código gerenciado não podem ser executados no domínio Restrito.</span><span class="sxs-lookup"><span data-stu-id="6d321-132">Managed code form templates cannot run in the Restricted domain.</span></span> <span data-ttu-id="6d321-133">Quando um modelo de formulário de código gerenciado é  definido para determinar  automaticamente a configuração de nível de segurança na categoria Segurança e Confiança da caixa de diálogo Opções de Formulário, o modelo de formulário sempre exigirá pelo menos o nível de acesso de segurança domínio para executar código. </span><span class="sxs-lookup"><span data-stu-id="6d321-133">When a managed code form template is set to the **Automatically determine security level** setting in the **Security and Trust** category of the **Form Options** dialog box, the form template will always require at least the Domain security access level to run code.</span></span>  <br/><br/><span data-ttu-id="6d321-134">**IMPORTANTE:** o assembly de código gerenciado criado para um modelo de formulário de código gerenciado não será carregado e executado quando um formulário for aberto a partir de um domínio restrito, por exemplo, de um formulário do InfoPath enviado como um anexo de email.</span><span class="sxs-lookup"><span data-stu-id="6d321-134">**IMPORTANT**: The managed code assembly created for a managed code form template will not load and run when a form is opened from a Restricted domain, for example, from an InfoPath form sent as an email attachment.</span></span> <span data-ttu-id="6d321-135">Qualquer modelo de formulário que você deseja implantar como um anexo de email deve omitir os recursos listados acima e, se o modelo de formulário contiver código de formulário, o código de formulário deverá ser implementado em JScript ou VBScript e deverá utilizar apenas membros do modelo de objeto com um nível de segurança 0 (zero).</span><span class="sxs-lookup"><span data-stu-id="6d321-135">Any form template you wish to deploy as an email attachment must omit the features listed above, and if the form template contains form code, form code must be implemented in JScript or VBScript, and must only utilize object model members with a security level of 0 (zero).</span></span>           |
|<span data-ttu-id="6d321-136">Domínio</span><span class="sxs-lookup"><span data-stu-id="6d321-136">Domain</span></span>  <br/> |<span data-ttu-id="6d321-137">Restringe um formulário com base em sua localização em uma das zonas de segurança definidas pelo Microsoft Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="6d321-137">Restricts a form based on its location in one of the security zones defined by Microsoft Internet Explorer.</span></span> <span data-ttu-id="6d321-138">Por exemplo, se o formulário estiver localizado na zona da Intranet Local, ele poderá se comunicar com outros dados dentro de seu próprio domínio, mas não poderá recuperar dados de outros domínios.</span><span class="sxs-lookup"><span data-stu-id="6d321-138">For example, if the form is located in the Local Intranet zone, it is allowed to communicate with other data inside its own domain but it is not permitted to retrieve data from other domains.</span></span> <span data-ttu-id="6d321-139">O local em uma zona de segurança do Microsoft Internet Explorer também determina se os controles ActiveX marcados como não seguros para script poderão ser executados.</span><span class="sxs-lookup"><span data-stu-id="6d321-139">The location in a Microsoft Internet Explorer security zone also determines whether ActiveX controls that are marked as unsafe for scripting will be allowed to run.</span></span>  <br/> |
|<span data-ttu-id="6d321-140">Confiança Total</span><span class="sxs-lookup"><span data-stu-id="6d321-140">Full Trust</span></span>  <br/> |<span data-ttu-id="6d321-141">Permite que você execute um formulário com confiança total no computador onde o formulário será usado.</span><span class="sxs-lookup"><span data-stu-id="6d321-141">Allows you to run a form with full trust on the computer where the form will be used.</span></span> <span data-ttu-id="6d321-142">Esse nível de segurança só pode ser usado ao trabalhar com um formulário assinado digitalmente com uma assinatura que corresponde a um editor raiz confiável em seu computador ou criando um programa de instalação que instala o formulário e define o atributo **requireFullTrust** do elemento **xDocumentClass** como "sim" no arquivo de definição de formulário (.xsf).</span><span class="sxs-lookup"><span data-stu-id="6d321-142">This security level can only be used when working with a form that is digitally signed with a signature that matches a trusted root publisher on your computer, or by creating an installation program that installs the form and sets the **requireFullTrust** attribute of the **xDocumentClass** element to "yes" in the form definition file (.xsf).</span></span> <span data-ttu-id="6d321-143">Usando essa configuração, seu formulário pode acessar chamadas de modelo de objeto que exigem o nível de segurança 3 do modelo de objeto, como propriedades e métodos que acessam o sistema de arquivos, e você pode desabilitar determinados prompts de segurança que aparecem quando executados em um nível de segurança mais restritivo.</span><span class="sxs-lookup"><span data-stu-id="6d321-143">By using this setting, your form can access object model calls that require object model security level 3, such as properties and methods that access the file system, and you can disable certain security prompts that appear when running at a more restrictive security level.</span></span>  <br/> |
   
<span data-ttu-id="6d321-144">Por padrão, um formulário do InfoPath é configurado para selecionar automaticamente o nível de segurança Restrito ou domínio, dependendo dos recursos que estão sendo usados no modelo de formulário, e onde e como o modelo de formulário é implantado.</span><span class="sxs-lookup"><span data-stu-id="6d321-144">By default, an InfoPath form is configured to select automatically either the Restricted or Domain security level depending on the features that are being used in the form template, and where and how the form template is deployed.</span></span> <span data-ttu-id="6d321-145">Por exemplo, um modelo de formulário implantado como um anexo de email é configurado automaticamente para o nível de segurança Restrito.</span><span class="sxs-lookup"><span data-stu-id="6d321-145">For example, a form template deployed as an email attachment is automatically configured to the Restricted security level.</span></span> <span data-ttu-id="6d321-146">A configuração de segurança é sempre o mais restritiva possível, começando em Restrito, para garantir um nível maior de proteção para você e seus dados.</span><span class="sxs-lookup"><span data-stu-id="6d321-146">The security setting is always as restrictive as possible, starting at Restricted, to ensure a greater level of protection for you and your data.</span></span> <span data-ttu-id="6d321-147">Quando um modelo de formulário que contém código gerenciado é definido para selecionar automaticamente o nível de segurança, o modelo de formulário sempre exigirá pelo menos o nível de acesso de segurança domínio antes que o código possa ser executado.</span><span class="sxs-lookup"><span data-stu-id="6d321-147">When a form template that contains managed code is set to automatically select the security level, the form template will always require at least the Domain security access level before code can run.</span></span> <span data-ttu-id="6d321-148">You can manually override this setting at design time to select a level of security that is more appropriate for the form by using the following procedure.</span><span class="sxs-lookup"><span data-stu-id="6d321-148">You can manually override this setting at design time to select a level of security that is more appropriate for the form by using the following procedure.</span></span> 
  
### <a name="specify-a-forms-security-level"></a><span data-ttu-id="6d321-149">Especificar o nível de segurança de um formulário</span><span class="sxs-lookup"><span data-stu-id="6d321-149">Specify a form's security level</span></span>

1. <span data-ttu-id="6d321-150">Abra o formulário no designer de  formulário do InfoPath, clique na guia Arquivo, em **Informações** e em Opções **de Formulário.**</span><span class="sxs-lookup"><span data-stu-id="6d321-150">Open the form in the InfoPath form designer, click the **File** tab, click **Info**, and then click **Form Options**.</span></span>
    
2. <span data-ttu-id="6d321-151">Na caixa de diálogo **Opções de Formulário**, clique na categoria **Segurança e Confiabilidade**.</span><span class="sxs-lookup"><span data-stu-id="6d321-151">In the **Form Options** dialog box, click the **Security and Trust** category.</span></span> 
    
3. <span data-ttu-id="6d321-152">Des **marque a caixa de seleção Determinar automaticamente o nível de** segurança (recomendado).</span><span class="sxs-lookup"><span data-stu-id="6d321-152">Clear the **Automatically determine security level (recommended)** check box.</span></span> 
    
4. <span data-ttu-id="6d321-153">Escolha o nível de segurança desejado.</span><span class="sxs-lookup"><span data-stu-id="6d321-153">Select the desired security level.</span></span>
    
> [!NOTE] 
> - <span data-ttu-id="6d321-154">Se você selecionar  o nível de segurança Restrito para um modelo de formulário de código gerenciado, o código por trás do formulário não será carregado e executado independentemente de quais membros do modelo de objeto são usados no código do formulário.</span><span class="sxs-lookup"><span data-stu-id="6d321-154">If you the select the **Restricted** security level for a managed code form template, the code behind the form will not load and run regardless of which object model members are used in the form code.</span></span> <span data-ttu-id="6d321-155">Esse nível de segurança foi projetado principalmente para formulários do InfoPath implantados usando email.</span><span class="sxs-lookup"><span data-stu-id="6d321-155">This security level is primarily designed for InfoPath forms that are deployed using email.</span></span>     
> - <span data-ttu-id="6d321-156">Se você selecionar o **nível de segurança** Confiança Total, precisará assinar digitalmente ou instalar e registrar o formulário.</span><span class="sxs-lookup"><span data-stu-id="6d321-156">If you select the **Full Trust** security level, you need to digitally sign or install and register the form.</span></span> <span data-ttu-id="6d321-157">Para obter mais informações, [consulte Implantar modelos de formulário do InfoPath com código.](how-to-deploy-infopath-form-templates-with-code.md)</span><span class="sxs-lookup"><span data-stu-id="6d321-157">For more information, see [Deploy InfoPath Form Templates with Code](how-to-deploy-infopath-form-templates-with-code.md).</span></span>
    
<span data-ttu-id="6d321-158">A tabela a seguir resume o modelo de segurança do InfoPath.</span><span class="sxs-lookup"><span data-stu-id="6d321-158">The following table summarizes the InfoPath security model.</span></span> <span data-ttu-id="6d321-159">A primeira coluna lista o nível especificado ou exigido pelo formulário.</span><span class="sxs-lookup"><span data-stu-id="6d321-159">The first column lists the level specified for or required by the form.</span></span> <span data-ttu-id="6d321-160">A segunda e a terceira colunas especificam se o formulário tem um identificador URN ou URL para seu local.</span><span class="sxs-lookup"><span data-stu-id="6d321-160">The second and third columns specify whether the form has a URN or URL identifier for its location.</span></span> <span data-ttu-id="6d321-161">As colunas restantes especificam o que pode ser executado.</span><span class="sxs-lookup"><span data-stu-id="6d321-161">The remaining columns specify what is allowed to run.</span></span> <span data-ttu-id="6d321-162">Para obter mais informações sobre cenários de implantação e conjuntos de permissões para modelos de formulário de código gerenciado, consulte a seção "Common Language Runtime Code Access Security Features" posteriormente neste tópico.</span><span class="sxs-lookup"><span data-stu-id="6d321-162">For more information on deployment scenarios and permission sets for managed code form templates, see the "Common Language Runtime Code Access Security Features" section later in this topic.</span></span>
  
|<span data-ttu-id="6d321-163">**Nível exigido por formulário**</span><span class="sxs-lookup"><span data-stu-id="6d321-163">**Level Required by form**</span></span>|<span data-ttu-id="6d321-164">**Tem identificador URN**</span><span class="sxs-lookup"><span data-stu-id="6d321-164">**Has URN Identifier**</span></span>|<span data-ttu-id="6d321-165">**Tem identificador de URL**</span><span class="sxs-lookup"><span data-stu-id="6d321-165">**Has URL Identifier**</span></span>|<span data-ttu-id="6d321-166">**ActiveX marcado como não seguro para script**</span><span class="sxs-lookup"><span data-stu-id="6d321-166">**ActiveX marked unsafe for scripting**</span></span>|<span data-ttu-id="6d321-167">**Acesso entre domínios**</span><span class="sxs-lookup"><span data-stu-id="6d321-167">**Cross-Domain Access**</span></span>|<span data-ttu-id="6d321-168">**Código gerenciado**</span><span class="sxs-lookup"><span data-stu-id="6d321-168">**Managed code**</span></span>|<span data-ttu-id="6d321-169">**Segurança do modelo de objeto**</span><span class="sxs-lookup"><span data-stu-id="6d321-169">**Object Model Security**</span></span>|
|:-----|:-----|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="6d321-170">Restrito</span><span class="sxs-lookup"><span data-stu-id="6d321-170">Restricted</span></span>  <br/> ||<span data-ttu-id="6d321-171">X</span><span class="sxs-lookup"><span data-stu-id="6d321-171">X</span></span>  <br/> |<span data-ttu-id="6d321-172">Nenhum ActiveX</span><span class="sxs-lookup"><span data-stu-id="6d321-172">No ActiveX at all</span></span>  <br/> |<span data-ttu-id="6d321-173">Falha</span><span class="sxs-lookup"><span data-stu-id="6d321-173">Fail</span></span>  <br/> |<span data-ttu-id="6d321-174">O formulário é carregado, mas o código gerenciado não é executado</span><span class="sxs-lookup"><span data-stu-id="6d321-174">Form loads, but managed code won't run</span></span>  <br/> |<span data-ttu-id="6d321-175">0</span><span class="sxs-lookup"><span data-stu-id="6d321-175">0</span></span>  <br/> |
|<span data-ttu-id="6d321-176">Domínio (zona de **sites restritos do** Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="6d321-176">Domain (Internet Explorer **Restricted sites** zone)</span></span>  <br/> |<span data-ttu-id="6d321-177">Não será executado</span><span class="sxs-lookup"><span data-stu-id="6d321-177">Won't run at all</span></span>  <br/> |<span data-ttu-id="6d321-178">Não será executado</span><span class="sxs-lookup"><span data-stu-id="6d321-178">Won't run at all</span></span>  <br/> |<span data-ttu-id="6d321-179">Não será executado</span><span class="sxs-lookup"><span data-stu-id="6d321-179">Won't run at all</span></span>  <br/> |<span data-ttu-id="6d321-180">Não será executado</span><span class="sxs-lookup"><span data-stu-id="6d321-180">Won't run at all</span></span>  <br/> |<span data-ttu-id="6d321-181">Não será executado</span><span class="sxs-lookup"><span data-stu-id="6d321-181">Won't run at all</span></span>  <br/> |<span data-ttu-id="6d321-182">Não será executado</span><span class="sxs-lookup"><span data-stu-id="6d321-182">Won't run at all</span></span>  <br/> |
|<span data-ttu-id="6d321-183">Domínio (zona internet do **Internet** Explorer)</span><span class="sxs-lookup"><span data-stu-id="6d321-183">Domain (Internet Explorer **Internet** zone)</span></span>  <br/> |<span data-ttu-id="6d321-184">X</span><span class="sxs-lookup"><span data-stu-id="6d321-184">X</span></span>  <br/> ||<span data-ttu-id="6d321-185">Falha</span><span class="sxs-lookup"><span data-stu-id="6d321-185">Fail</span></span>  <br/> |<span data-ttu-id="6d321-186">Falha</span><span class="sxs-lookup"><span data-stu-id="6d321-186">Fail</span></span>  <br/> |<span data-ttu-id="6d321-187">Não será executado</span><span class="sxs-lookup"><span data-stu-id="6d321-187">Won't run at all</span></span>  <br/> |<span data-ttu-id="6d321-188">0</span><span class="sxs-lookup"><span data-stu-id="6d321-188">0</span></span>  <br/> |
|<span data-ttu-id="6d321-189">Domínio (zona **da intranet local do** Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="6d321-189">Domain (Internet Explorer **Local intranet** zone)</span></span>  <br/> |<span data-ttu-id="6d321-190">X</span><span class="sxs-lookup"><span data-stu-id="6d321-190">X</span></span>  <br/> ||<span data-ttu-id="6d321-191">Falha</span><span class="sxs-lookup"><span data-stu-id="6d321-191">Fail</span></span>  <br/> |<span data-ttu-id="6d321-192">Prompt</span><span class="sxs-lookup"><span data-stu-id="6d321-192">Prompt</span></span>  <br/> |<span data-ttu-id="6d321-193">O código gerenciado é executado **com permissões de intranet** local.</span><span class="sxs-lookup"><span data-stu-id="6d321-193">Managed code runs with **Local intranet** permissions.</span></span>  <br/> |<span data-ttu-id="6d321-194">2 </span><span class="sxs-lookup"><span data-stu-id="6d321-194">2</span></span>  <br/> |
|<span data-ttu-id="6d321-195">Domínio (zona de **sites confiáveis do** Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="6d321-195">Domain (Internet Explorer **Trusted sites** zone)</span></span>  <br/> |<span data-ttu-id="6d321-196">X</span><span class="sxs-lookup"><span data-stu-id="6d321-196">X</span></span>  <br/> ||<span data-ttu-id="6d321-197">Prompt</span><span class="sxs-lookup"><span data-stu-id="6d321-197">Prompt</span></span>  <br/> |<span data-ttu-id="6d321-198">OK</span><span class="sxs-lookup"><span data-stu-id="6d321-198">OK</span></span>  <br/> |<span data-ttu-id="6d321-199">O código gerenciado é executado com permissões da **Internet.**</span><span class="sxs-lookup"><span data-stu-id="6d321-199">Managed code runs with **Internet** permissions.</span></span> <span data-ttu-id="6d321-200">O acesso entre domínios é permitido.</span><span class="sxs-lookup"><span data-stu-id="6d321-200">Cross-domain access is allowed.</span></span> <span data-ttu-id="6d321-201">Observe que, embora o formulário está na zona **sites confiáveis,** as permissões de zona da **Internet** são aplicadas.</span><span class="sxs-lookup"><span data-stu-id="6d321-201">Note that even though the form is in the **Trusted sites** zone, **Internet** zone permissions are applied.</span></span>  <br/> |<span data-ttu-id="6d321-202">2 </span><span class="sxs-lookup"><span data-stu-id="6d321-202">2</span></span>  <br/> |
|<span data-ttu-id="6d321-203">Domínio (zona do computador **local do** Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="6d321-203">Domain (Internet Explorer **Local computer** zone)</span></span>  <br/> |<span data-ttu-id="6d321-204">X</span><span class="sxs-lookup"><span data-stu-id="6d321-204">X</span></span>  <br/> |<span data-ttu-id="6d321-205">X</span><span class="sxs-lookup"><span data-stu-id="6d321-205">X</span></span>  <br/> |<span data-ttu-id="6d321-206">Prompt</span><span class="sxs-lookup"><span data-stu-id="6d321-206">Prompt</span></span>  <br/> |<span data-ttu-id="6d321-207">Falha</span><span class="sxs-lookup"><span data-stu-id="6d321-207">Fail</span></span>  <br/> |<span data-ttu-id="6d321-208">O código gerenciado é executado **com permissões de intranet** local.</span><span class="sxs-lookup"><span data-stu-id="6d321-208">Managed code runs with **Local intranet** permissions.</span></span>  <br/> |<span data-ttu-id="6d321-209">2 </span><span class="sxs-lookup"><span data-stu-id="6d321-209">2</span></span>  <br/> |
|<span data-ttu-id="6d321-210">Confiança Total</span><span class="sxs-lookup"><span data-stu-id="6d321-210">Full Trust</span></span>  <br/> |<span data-ttu-id="6d321-211">X</span><span class="sxs-lookup"><span data-stu-id="6d321-211">X</span></span>  <br/> |<span data-ttu-id="6d321-212">X</span><span class="sxs-lookup"><span data-stu-id="6d321-212">X</span></span>  <br/> |<span data-ttu-id="6d321-213">OK</span><span class="sxs-lookup"><span data-stu-id="6d321-213">OK</span></span>  <br/> |<span data-ttu-id="6d321-214">OK</span><span class="sxs-lookup"><span data-stu-id="6d321-214">OK</span></span>  <br/> |<span data-ttu-id="6d321-215">Confiança Total</span><span class="sxs-lookup"><span data-stu-id="6d321-215">Full Trust</span></span>  <br/> |<span data-ttu-id="6d321-216">3 </span><span class="sxs-lookup"><span data-stu-id="6d321-216">3</span></span>  <br/> |
   
> [!IMPORTANT]
> <span data-ttu-id="6d321-217">As descrições acima nas colunas "ActiveX marcado como não seguro para script" e "Acesso entre Domínios" assumem as configurações de segurança padrão do Microsoft Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="6d321-217">The descriptions above in the "ActiveX marked unsafe for scripting" and "Cross-Domain Access" columns assume the default security settings for Microsoft Internet Explorer.</span></span> <span data-ttu-id="6d321-218">Se um usuário mudar suas configurações de segurança, o InfoPath se comportará de acordo.</span><span class="sxs-lookup"><span data-stu-id="6d321-218">If a user changes their security settings, InfoPath will behave accordingly.</span></span> <span data-ttu-id="6d321-219">Por exemplo, se na zona da **intranet local,** as fontes de dados do Access entre domínios estão definidas como Habilitar, os usuários não serão solicitados a permitir o acesso entre **domínios,** conforme descrito na tabela.</span><span class="sxs-lookup"><span data-stu-id="6d321-219">For example, if in the **Local intranet** zone, **Access data sources across domains** is set to **Enable**, then users will not be prompted to allow cross-domain access as described in the table.</span></span> 
  
## <a name="common-language-runtime-code-access-security-features"></a><span data-ttu-id="6d321-220">Common Language Runtime Code Access Security Features</span><span class="sxs-lookup"><span data-stu-id="6d321-220">Common Language Runtime Code Access Security Features</span></span>

<span data-ttu-id="6d321-221">Quando um modelo de formulário de código gerenciado do InfoPath é compilado, um assembly de código gerenciado privado é criado contendo a implementação da lógica de código do formulário.</span><span class="sxs-lookup"><span data-stu-id="6d321-221">When an InfoPath managed code form template is compiled, a private managed code assembly is created that contains the implementation of the form code logic.</span></span>
  
<span data-ttu-id="6d321-222">No .NET Framework, por padrão, um assembly de código gerenciado tem permissões de Confiança Total ao ser executado no computador local e não recebe permissões de Confiança Total durante a execução na Intranet.</span><span class="sxs-lookup"><span data-stu-id="6d321-222">In the .NET Framework, by default, a managed code assembly has Full Trust permissions when running on the local machine, and is not granted Full Trust permissions when running on the Intranet.</span></span> <span data-ttu-id="6d321-223">Para fornecer um controle mais preciso sobre a política de segurança e fornecer a opção de executar modelos de formulário de código gerenciado do InfoPath como formulários totalmente confiáveis da Intranet, o InfoPath implementa a seguinte arquitetura de segurança.</span><span class="sxs-lookup"><span data-stu-id="6d321-223">To provide more fine-grained control over security policy, and to provide the option to run InfoPath managed code form templates as fully trusted forms from the Intranet, InfoPath implements the following security architecture.</span></span>
  
- <span data-ttu-id="6d321-224">O aplicativo InfoPath hospeda o CLR (Common Language Runtime) do .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="6d321-224">The InfoPath application hosts the .NET Framework common language runtime (CLR).</span></span>
    
- <span data-ttu-id="6d321-225">No CLR hospedado pelo InfoPath, cada modelo de formulário de código gerenciado é executado em um domínio de aplicativo separado, que é um ambiente que fornece limites de isolamento, descarregamento e segurança para executar código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="6d321-225">Within the CLR hosted by InfoPath, each managed code form template runs in a separate application domain, which is an environment that provides isolation, unloading, and security boundaries for executing managed code.</span></span>
    
- <span data-ttu-id="6d321-226">O InfoPath define uma política de segurança padrão no domínio do aplicativo, dependendo do nível de confiança associado ao modelo de formulário e da URL de seu local.</span><span class="sxs-lookup"><span data-stu-id="6d321-226">InfoPath sets a default security policy on the application domain depending on the level of trust associated with the form template and the URL of its location.</span></span>
    
- <span data-ttu-id="6d321-227">Por padrão, um modelo de formulário de código gerenciado em execução no computador local (o grupo de códigos da Zona do Meu Computador) obtém um nível inferior de permissões do que Confiança Total (permissões de Zona da Intranet Local).</span><span class="sxs-lookup"><span data-stu-id="6d321-227">By default, a managed code form template running on the local computer (the My Computer Zone code group) gets a lower level of permissions than Full Trust (Local Intranet Zone permissions).</span></span> <span data-ttu-id="6d321-228">Para ter permissões de Confiança Total, o formulário deve ser registrado ou assinado digitalmente com um certificado confiável.</span><span class="sxs-lookup"><span data-stu-id="6d321-228">To have Full Trust permissions, the form must be registered or digitally signed with a trusted certificate.</span></span>
    
<span data-ttu-id="6d321-229">A política de segurança padrão definida para o domínio do aplicativo de um modelo de formulário de código gerenciado garante que os níveis de segurança de acesso ao domínio do InfoPath, bem como quaisquer restrições de segurança adicionais do .NET sejam impostas.</span><span class="sxs-lookup"><span data-stu-id="6d321-229">The default security policy set for the application domain of a managed code form template ensures that the InfoPath domain access security levels as well as any additional .NET security restrictions are enforced.</span></span> <span data-ttu-id="6d321-230">Para fornecer flexibilidade adicional, o sistema de segurança do InfoPath reconhece um grupo de códigos de segurança de acesso ao código .NET chamado "Modelos de Formulário do InfoPath".</span><span class="sxs-lookup"><span data-stu-id="6d321-230">To provide additional flexibility, the InfoPath security system recognizes a .NET code access security code group named "InfoPath Form Templates".</span></span> <span data-ttu-id="6d321-231">Se esse grupo de códigos estiver presente no computador de um usuário, sua configuração de segurança e as de qualquer grupo de códigos filho dentro dele serão aplicadas ao domínio do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="6d321-231">If this code group is present on a user's computer, its security configuration, and those of any child code groups within it will be applied to the application domain.</span></span>
  
> [!IMPORTANT] 
> - <span data-ttu-id="6d321-232">O grupo de códigos de Modelos de Formulário do InfoPath só se aplica ao próprio assembly de código de formulário de código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="6d321-232">The InfoPath Form Templates code group applies only to the managed code form code assembly itself.</span></span> <span data-ttu-id="6d321-233">Como resultado, se você conceder a permissão Confiança Total definida como código de formulário de código gerenciado do InfoPath, mas não tiver instalado e registrado (ou assinado digitalmente) o modelo de formulário em si (o que torna todo o modelo de formulário totalmente confiável), as chamadas no código do formulário para membros do modelo de objeto de nível 3 de segurança ainda falharão.</span><span class="sxs-lookup"><span data-stu-id="6d321-233">As a result, if you grant the Full Trust permission set to InfoPath managed code form code, but you have not installed and registered (or digitally signed) the form template itself (which makes the entire form template fully trusted), calls in the form code to security level 3 object model members will still fail.</span></span>   
> - <span data-ttu-id="6d321-234">Se você referenciar ou carregar explicitamente (Assembly.Load) um assembly configurado com um conjunto de permissões restritas usando evidências de Hash, Nome Forte ou Publisher para determinar sua condição de associação em um projeto de modelo de formulário, o assembly será carregado e executado pelo modelo de formulário.</span><span class="sxs-lookup"><span data-stu-id="6d321-234">If you reference or explicitly load (Assembly.Load) an assembly that is configured with a restricted permission set using Hash, Strong Name, or Publisher evidence to determine its membership condition in a form template project, the assembly will nonetheless be loaded and executed by the form template.</span></span>
    
<span data-ttu-id="6d321-235">Para obter informações sobre como criar e configurar o grupo de códigos de Modelos de Formulário do InfoPath, consulte Definir configurações de segurança para modelos de [formulário com código.](how-to-configure-security-settings-for-form-templates-with-code.md)</span><span class="sxs-lookup"><span data-stu-id="6d321-235">For information on how to create and configure the InfoPath Form Templates code group, see [Configure Security Settings for Form Templates with Code](how-to-configure-security-settings-for-form-templates-with-code.md).</span></span>
  
<span data-ttu-id="6d321-236">A tabela a seguir resume os cenários de implantação e conjuntos de permissões que se aplicam aos modelos de formulário de código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="6d321-236">The following table summarizes the deployment scenarios and permission sets that apply to managed code form templates.</span></span>
  
|<span data-ttu-id="6d321-237">**Cenário de implantação**</span><span class="sxs-lookup"><span data-stu-id="6d321-237">**Deployment Scenario**</span></span>|<span data-ttu-id="6d321-238">**Conjunto de Permissões**</span><span class="sxs-lookup"><span data-stu-id="6d321-238">**Permission Set**</span></span>|<span data-ttu-id="6d321-239">**Anotações**</span><span class="sxs-lookup"><span data-stu-id="6d321-239">**Notes**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="6d321-240">O modelo de formulário é publicado no computador local e o desenvolvedor está usando o Visual Studio para escrever e depurar o código do formulário.</span><span class="sxs-lookup"><span data-stu-id="6d321-240">The form template is published on the local computer, and the developer is using Visual Studio to write and debug form code.</span></span>  <br/> |<span data-ttu-id="6d321-241">Conjunto de permissões da Intranet Local.</span><span class="sxs-lookup"><span data-stu-id="6d321-241">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="6d321-242">Os assemblies instalados no GaC (Cache de Assembly Global) e marcados com o atributo **AllowPartiallyTrustedCallersAttribute** são concedidos com o conjunto de permissões Confiança Total.</span><span class="sxs-lookup"><span data-stu-id="6d321-242">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set.</span></span>  <br/> |<span data-ttu-id="6d321-243">Por padrão, modelos de formulário em execução no computador local não são concedidos com o conjunto de permissões Confiança Total.</span><span class="sxs-lookup"><span data-stu-id="6d321-243">By default, form templates running from the local computer are not granted the Full Trust permission set.</span></span> <span data-ttu-id="6d321-244">Ao desenvolver modelos de formulário que usam recursos e chamadas para membros do modelo de objeto que exigem permissões de Confiança Total, você pode usar o procedimento descrito em Visualizar e [Depurar](how-to-preview-and-debug-form-templates-that-require-full-trust.md)Modelos de Formulário que Exigem Confiança Total .</span><span class="sxs-lookup"><span data-stu-id="6d321-244">While developing form templates that use features and calls to object model members that require Full Trust permissions, you can use the procedure described in [Preview and Debug Form Templates that Require Full Trust](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span></span>  <br/> |
|<span data-ttu-id="6d321-245">O modelo de formulário é publicado no computador local e faz referência a um assembly personalizado que solicita o conjunto de permissões Confiança Total no computador local.</span><span class="sxs-lookup"><span data-stu-id="6d321-245">The form template is published on the local computer and references a custom assembly that requests the Full Trust permission set on the local computer.</span></span>  <br/> |<span data-ttu-id="6d321-246">Conjunto de permissões da Intranet Local.</span><span class="sxs-lookup"><span data-stu-id="6d321-246">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="6d321-247">Os assemblies instalados no GaC (Cache de Assembly Global) e marcados com o atributo **AllowPartiallyTrustedCallersAttribute** são concedidos com o conjunto de permissões Confiança Total.</span><span class="sxs-lookup"><span data-stu-id="6d321-247">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set.</span></span> <span data-ttu-id="6d321-248">O assembly personalizado é concedido ao conjunto de permissões da Intranet Local.</span><span class="sxs-lookup"><span data-stu-id="6d321-248">The custom assembly is granted the Local Intranet permission set.</span></span>  <br/> |<span data-ttu-id="6d321-249">Para fazer referência a assemblies externos para uso no código do modelo de formulário, o desenvolvedor deve usar o grupo de códigos de Modelos de Formulário do InfoPath para conceder Confiança Total (ou o conjunto de permissões apropriado) ao assembly externo referenciado no código do modelo de formulário.</span><span class="sxs-lookup"><span data-stu-id="6d321-249">To reference external assemblies for use in the form template's code, the developer must use the InfoPath Form Templates code group to grant Full Trust (or the appropriate permission set) to the external assembly referenced in the form template's code.</span></span> <span data-ttu-id="6d321-250">O InfoPath não faz suposições sobre assemblies externos que não os instalados no CACHE de Assembly Global (GAC).</span><span class="sxs-lookup"><span data-stu-id="6d321-250">InfoPath does not make any assumptions about external assemblies other than those installed in the Global Assembly Cache (GAC).</span></span> <span data-ttu-id="6d321-251">O desenvolvedor deve conceder explicitamente ao assembly as permissões necessárias usando o grupo de códigos de Modelos de Formulário do InfoPath, mesmo se o assembly já for confiável, embora as permissões concedidas no grupo My_Computer_Zone código.</span><span class="sxs-lookup"><span data-stu-id="6d321-251">The developer must explicitly grant the assembly the necessary permissions using the InfoPath Form Templates code group even if the assembly is already trusted though permissions granted in the My_Computer_Zone code group.</span></span>  <br/> |
|<span data-ttu-id="6d321-252">O modelo de formulário é publicado em um local compartilhado na intranet local, como um compartilhamento de arquivos, uma biblioteca de formulário do SharePoint ou um servidor Web.</span><span class="sxs-lookup"><span data-stu-id="6d321-252">The form template is published on a shared location in the local intranet, such as a file share, SharePoint Form library, or a Web server.</span></span>  <br/> |<span data-ttu-id="6d321-253">Conjunto de permissões da Intranet Local.</span><span class="sxs-lookup"><span data-stu-id="6d321-253">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="6d321-254">Os assemblies instalados no GaC (Cache de Assembly Global) e marcados com o atributo **AllowPartiallyTrustedCallersAttribute** são concedidos com o conjunto de permissões Confiança Total.</span><span class="sxs-lookup"><span data-stu-id="6d321-254">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set.</span></span>  <br/> ||
|<span data-ttu-id="6d321-255">O modelo de formulário é publicado em um local compartilhado na intranet local, como um compartilhamento de arquivos, uma biblioteca de formulário do SharePoint ou um servidor Web designado como um site confiável no Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="6d321-255">The form template is published on a shared location in the local intranet, such as a file share, SharePoint Form library, or a Web server that is designated as a Trusted site in Internet Explorer.</span></span>  <br/> |<span data-ttu-id="6d321-256">Conjunto de permissões da Internet.</span><span class="sxs-lookup"><span data-stu-id="6d321-256">Internet permission set.</span></span>  <br/> <span data-ttu-id="6d321-257">Os assemblies assinados pela Microsoft e pelo ECMA são concedidos com o conjunto de permissões Confiança Total.</span><span class="sxs-lookup"><span data-stu-id="6d321-257">Assemblies signed by Microsoft and ECMA are granted the Full Trust permission set.</span></span>  <br/> |<span data-ttu-id="6d321-258">A segurança de acesso ao código CLR concede apenas o conjunto de permissões de Internet para sites designados como sites confiáveis no Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="6d321-258">CLR code access security grants only the Internet permission set to sites that are designated as Trusted sites in Internet Explorer.</span></span> <span data-ttu-id="6d321-259">O InfoPath respeita essa política.</span><span class="sxs-lookup"><span data-stu-id="6d321-259">InfoPath respects this policy.</span></span> <span data-ttu-id="6d321-260">Observe que isso é diferente de um modelo de formulário do InfoPath que usa script para código de formulário, que recebe um nível mais alto de permissões quando publicado em uma zona de sites confiáveis.</span><span class="sxs-lookup"><span data-stu-id="6d321-260">Note that this is unlike an InfoPath form template that uses script for form code, which receives a higher level of permissions when published in a Trusted sites zone.</span></span>  <br/> |
|<span data-ttu-id="6d321-261">O modelo de formulário é baixado ou copiado de um local da Internet.</span><span class="sxs-lookup"><span data-stu-id="6d321-261">The form template is downloaded or copied from an Internet location.</span></span>  <br/> |<span data-ttu-id="6d321-262">Por padrão, nenhum.</span><span class="sxs-lookup"><span data-stu-id="6d321-262">By default, none.</span></span> <span data-ttu-id="6d321-263">O assembly de código gerenciado para o modelo de formulário não é carregado e não é executado.</span><span class="sxs-lookup"><span data-stu-id="6d321-263">The managed code assembly for the form template is not loaded and does not run.</span></span>  <br/> ||
   
## <a name="see-also"></a><span data-ttu-id="6d321-264">Confira também</span><span class="sxs-lookup"><span data-stu-id="6d321-264">See also</span></span>

- [<span data-ttu-id="6d321-265">Definir configurações de segurança para modelos de formulário com código</span><span class="sxs-lookup"><span data-stu-id="6d321-265">Configure Security Settings for Form Templates with Code</span></span>](how-to-configure-security-settings-for-form-templates-with-code.md)
- [<span data-ttu-id="6d321-266">Visualizar e depurar modelos de formulário que exigem confiança total</span><span class="sxs-lookup"><span data-stu-id="6d321-266">Preview and Debug Form Templates that Require Full Trust</span></span>](how-to-preview-and-debug-form-templates-that-require-full-trust.md)

